var Nc=Object.defineProperty;var kc=(t,e,n)=>e in t?Nc(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ut=(t,e,n)=>(kc(t,typeof e!="symbol"?e+"":e,n),n);import{j as S,Q as Pc,a as Lc}from"./query-73861c9c.js";import{c as xc,r as A,R as es}from"./vendor-2fbe36df.js";import{B as $c,R as Dc,a as ue,N as ts}from"./router-241b6e81.js";import{c as Fc}from"./state-acab8a68.js";import{C as Uc,t as Hs}from"./ui-300eb2b0.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var wr={},Bs=xc;wr.createRoot=Bs.createRoot,wr.hydrateRoot=Bs.hydrateRoot;const Mc="modulepreload",jc=function(t){return"/"+t},qs={},$e=function(e,n,r){if(!n||n.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(n.map(i=>{if(i=jc(i),i in qs)return;qs[i]=!0;const o=i.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let l=s.length-1;l>=0;l--){const d=s[l];if(d.href===i&&(!o||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":Mc,o||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),o)return new Promise((l,d)=>{u.addEventListener("load",l),u.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})};class Q extends Error{constructor(e){var n,r,s,i;super("ClientResponseError"),this.url="",this.status=0,this.response={},this.isAbort=!1,this.originalError=null,Object.setPrototypeOf(this,Q.prototype),e!==null&&typeof e=="object"&&(this.url=typeof e.url=="string"?e.url:"",this.status=typeof e.status=="number"?e.status:0,this.isAbort=!!e.isAbort,this.originalError=e.originalError,e.response!==null&&typeof e.response=="object"?this.response=e.response:e.data!==null&&typeof e.data=="object"?this.response=e.data:this.response={}),this.originalError||e instanceof Q||(this.originalError=e),typeof DOMException<"u"&&e instanceof DOMException&&(this.isAbort=!0),this.name="ClientResponseError "+this.status,this.message=(n=this.response)==null?void 0:n.message,this.message||(this.isAbort?this.message="The request was autocancelled. You can find more info in https://github.com/pocketbase/js-sdk#auto-cancellation.":(i=(s=(r=this.originalError)==null?void 0:r.cause)==null?void 0:s.message)!=null&&i.includes("ECONNREFUSED ::1")?this.message="Failed to connect to the PocketBase server. Try changing the SDK URL from localhost to 127.0.0.1 (https://github.com/pocketbase/js-sdk/issues/21).":this.message="Something went wrong."),this.cause=this.originalError}get data(){return this.response}toJSON(){return{...this}}}const un=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function Hc(t,e){const n={};if(typeof t!="string")return n;const r=Object.assign({},e||{}).decode||Bc;let s=0;for(;s<t.length;){const i=t.indexOf("=",s);if(i===-1)break;let o=t.indexOf(";",s);if(o===-1)o=t.length;else if(o<i){s=t.lastIndexOf(";",i-1)+1;continue}const a=t.slice(s,i).trim();if(n[a]===void 0){let c=t.slice(i+1,o).trim();c.charCodeAt(0)===34&&(c=c.slice(1,-1));try{n[a]=r(c)}catch{n[a]=c}}s=o+1}return n}function Vs(t,e,n){const r=Object.assign({},n||{}),s=r.encode||qc;if(!un.test(t))throw new TypeError("argument name is invalid");const i=s(e);if(i&&!un.test(i))throw new TypeError("argument val is invalid");let o=t+"="+i;if(r.maxAge!=null){const a=r.maxAge-0;if(isNaN(a)||!isFinite(a))throw new TypeError("option maxAge is invalid");o+="; Max-Age="+Math.floor(a)}if(r.domain){if(!un.test(r.domain))throw new TypeError("option domain is invalid");o+="; Domain="+r.domain}if(r.path){if(!un.test(r.path))throw new TypeError("option path is invalid");o+="; Path="+r.path}if(r.expires){if(!function(c){return Object.prototype.toString.call(c)==="[object Date]"||c instanceof Date}(r.expires)||isNaN(r.expires.valueOf()))throw new TypeError("option expires is invalid");o+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(o+="; HttpOnly"),r.secure&&(o+="; Secure"),r.priority)switch(typeof r.priority=="string"?r.priority.toLowerCase():r.priority){case"low":o+="; Priority=Low";break;case"medium":o+="; Priority=Medium";break;case"high":o+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return o}function Bc(t){return t.indexOf("%")!==-1?decodeURIComponent(t):t}function qc(t){return encodeURIComponent(t)}const Vc=typeof navigator<"u"&&navigator.product==="ReactNative"||typeof global<"u"&&global.HermesInternal;let mo;function ft(t){if(t)try{const e=decodeURIComponent(mo(t.split(".")[1]).split("").map(function(n){return"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)||{}}catch{}return{}}function _o(t,e=0){let n=ft(t);return!(Object.keys(n).length>0&&(!n.exp||n.exp-e>Date.now()/1e3))}mo=typeof atob!="function"||Vc?t=>{let e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,r,s=0,i=0,o="";r=e.charAt(i++);~r&&(n=s%4?64*n+r:r,s++%4)?o+=String.fromCharCode(255&n>>(-2*s&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return o}:atob;const Gs="pb_auth";class ns{constructor(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}get token(){return this.baseToken}get record(){return this.baseModel}get model(){return this.baseModel}get isValid(){return!_o(this.token)}get isSuperuser(){var n,r;let e=ft(this.token);return e.type=="auth"&&(((n=this.record)==null?void 0:n.collectionName)=="_superusers"||!((r=this.record)!=null&&r.collectionName)&&e.collectionId=="pbc_3142635823")}get isAdmin(){return console.warn("Please replace pb.authStore.isAdmin with pb.authStore.isSuperuser OR simply check the value of pb.authStore.record?.collectionName"),this.isSuperuser}get isAuthRecord(){return console.warn("Please replace pb.authStore.isAuthRecord with !pb.authStore.isSuperuser OR simply check the value of pb.authStore.record?.collectionName"),ft(this.token).type=="auth"&&!this.isSuperuser}save(e,n){this.baseToken=e||"",this.baseModel=n||null,this.triggerChange()}clear(){this.baseToken="",this.baseModel=null,this.triggerChange()}loadFromCookie(e,n=Gs){const r=Hc(e||"")[n]||"";let s={};try{s=JSON.parse(r),(typeof s===null||typeof s!="object"||Array.isArray(s))&&(s={})}catch{}this.save(s.token||"",s.record||s.model||null)}exportToCookie(e,n=Gs){var c,u;const r={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},s=ft(this.token);r.expires=s!=null&&s.exp?new Date(1e3*s.exp):new Date("1970-01-01"),e=Object.assign({},r,e);const i={token:this.token,record:this.record?JSON.parse(JSON.stringify(this.record)):null};let o=Vs(n,JSON.stringify(i),e);const a=typeof Blob<"u"?new Blob([o]).size:o.length;if(i.record&&a>4096){i.record={id:(c=i.record)==null?void 0:c.id,email:(u=i.record)==null?void 0:u.email};const l=["collectionId","collectionName","verified"];for(const d in this.record)l.includes(d)&&(i.record[d]=this.record[d]);o=Vs(n,JSON.stringify(i),e)}return o}onChange(e,n=!1){return this._onChangeCallbacks.push(e),n&&e(this.token,this.record),()=>{for(let r=this._onChangeCallbacks.length-1;r>=0;r--)if(this._onChangeCallbacks[r]==e)return delete this._onChangeCallbacks[r],void this._onChangeCallbacks.splice(r,1)}}triggerChange(){for(const e of this._onChangeCallbacks)e&&e(this.token,this.record)}}class Gc extends ns{constructor(e="pocketbase_auth"){super(),this.storageFallback={},this.storageKey=e,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get record(){const e=this._storageGet(this.storageKey)||{};return e.record||e.model||null}get model(){return this.record}save(e,n){this._storageSet(this.storageKey,{token:e,record:n}),super.save(e,n)}clear(){this._storageRemove(this.storageKey),super.clear()}_storageGet(e){if(typeof window<"u"&&(window!=null&&window.localStorage)){const n=window.localStorage.getItem(e)||"";try{return JSON.parse(n)}catch{return n}}return this.storageFallback[e]}_storageSet(e,n){if(typeof window<"u"&&(window!=null&&window.localStorage)){let r=n;typeof n!="string"&&(r=JSON.stringify(n)),window.localStorage.setItem(e,r)}else this.storageFallback[e]=n}_storageRemove(e){var n;typeof window<"u"&&(window!=null&&window.localStorage)&&((n=window.localStorage)==null||n.removeItem(e)),delete this.storageFallback[e]}_bindStorageEvent(){typeof window<"u"&&(window!=null&&window.localStorage)&&window.addEventListener&&window.addEventListener("storage",e=>{if(e.key!=this.storageKey)return;const n=this._storageGet(this.storageKey)||{};super.save(n.token||"",n.record||n.model||null)})}}class Ee{constructor(e){this.client=e}}class zc extends Ee{async getAll(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/settings",e)}async update(e,n){return n=Object.assign({method:"PATCH",body:e},n),this.client.send("/api/settings",n)}async testS3(e="storage",n){return n=Object.assign({method:"POST",body:{filesystem:e}},n),this.client.send("/api/settings/test/s3",n).then(()=>!0)}async testEmail(e,n,r,s){return s=Object.assign({method:"POST",body:{email:n,template:r,collection:e}},s),this.client.send("/api/settings/test/email",s).then(()=>!0)}async generateAppleClientSecret(e,n,r,s,i,o){return o=Object.assign({method:"POST",body:{clientId:e,teamId:n,keyId:r,privateKey:s,duration:i}},o),this.client.send("/api/settings/apple/generate-client-secret",o)}}const Wc=["requestKey","$cancelKey","$autoCancel","fetch","headers","body","query","params","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];function rs(t){if(t){t.query=t.query||{};for(let e in t)Wc.includes(e)||(t.query[e]=t[e],delete t[e])}}function So(t){const e=[];for(const n in t){const r=encodeURIComponent(n),s=Array.isArray(t[n])?t[n]:[t[n]];for(let i of s)i=Kc(i),i!==null&&e.push(r+"="+i)}return e.join("&")}function Kc(t){return t==null?null:t instanceof Date?encodeURIComponent(t.toISOString().replace("T"," ")):encodeURIComponent(typeof t=="object"?JSON.stringify(t):t)}class Eo extends Ee{constructor(){super(...arguments),this.clientId="",this.eventSource=null,this.subscriptions={},this.lastSentSubscriptions=[],this.maxConnectTimeout=15e3,this.reconnectAttempts=0,this.maxReconnectAttempts=1/0,this.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],this.pendingConnects=[]}get isConnected(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length}async subscribe(e,n,r){var o;if(!e)throw new Error("topic must be set.");let s=e;if(r){rs(r=Object.assign({},r));const a="options="+encodeURIComponent(JSON.stringify({query:r.query,headers:r.headers}));s+=(s.includes("?")?"&":"?")+a}const i=function(a){const c=a;let u;try{u=JSON.parse(c==null?void 0:c.data)}catch{}n(u||{})};return this.subscriptions[s]||(this.subscriptions[s]=[]),this.subscriptions[s].push(i),this.isConnected?this.subscriptions[s].length===1?await this.submitSubscriptions():(o=this.eventSource)==null||o.addEventListener(s,i):await this.connect(),async()=>this.unsubscribeByTopicAndListener(e,i)}async unsubscribe(e){var r;let n=!1;if(e){const s=this.getSubscriptionsByTopic(e);for(let i in s)if(this.hasSubscriptionListeners(i)){for(let o of this.subscriptions[i])(r=this.eventSource)==null||r.removeEventListener(i,o);delete this.subscriptions[i],n||(n=!0)}}else this.subscriptions={};this.hasSubscriptionListeners()?n&&await this.submitSubscriptions():this.disconnect()}async unsubscribeByPrefix(e){var r;let n=!1;for(let s in this.subscriptions)if((s+"?").startsWith(e)){n=!0;for(let i of this.subscriptions[s])(r=this.eventSource)==null||r.removeEventListener(s,i);delete this.subscriptions[s]}n&&(this.hasSubscriptionListeners()?await this.submitSubscriptions():this.disconnect())}async unsubscribeByTopicAndListener(e,n){var i;let r=!1;const s=this.getSubscriptionsByTopic(e);for(let o in s){if(!Array.isArray(this.subscriptions[o])||!this.subscriptions[o].length)continue;let a=!1;for(let c=this.subscriptions[o].length-1;c>=0;c--)this.subscriptions[o][c]===n&&(a=!0,delete this.subscriptions[o][c],this.subscriptions[o].splice(c,1),(i=this.eventSource)==null||i.removeEventListener(o,n));a&&(this.subscriptions[o].length||delete this.subscriptions[o],r||this.hasSubscriptionListeners(o)||(r=!0))}this.hasSubscriptionListeners()?r&&await this.submitSubscriptions():this.disconnect()}hasSubscriptionListeners(e){var n,r;if(this.subscriptions=this.subscriptions||{},e)return!!((n=this.subscriptions[e])!=null&&n.length);for(let s in this.subscriptions)if((r=this.subscriptions[s])!=null&&r.length)return!0;return!1}async submitSubscriptions(){if(this.clientId)return this.addAllSubscriptionListeners(),this.lastSentSubscriptions=this.getNonEmptySubscriptionKeys(),this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentSubscriptions},requestKey:this.getSubscriptionsCancelKey()}).catch(e=>{if(!(e!=null&&e.isAbort))throw e})}getSubscriptionsCancelKey(){return"realtime_"+this.clientId}getSubscriptionsByTopic(e){const n={};e=e.includes("?")?e:e+"?";for(let r in this.subscriptions)(r+"?").startsWith(e)&&(n[r]=this.subscriptions[r]);return n}getNonEmptySubscriptionKeys(){const e=[];for(let n in this.subscriptions)this.subscriptions[n].length&&e.push(n);return e}addAllSubscriptionListeners(){if(this.eventSource){this.removeAllSubscriptionListeners();for(let e in this.subscriptions)for(let n of this.subscriptions[e])this.eventSource.addEventListener(e,n)}}removeAllSubscriptionListeners(){if(this.eventSource)for(let e in this.subscriptions)for(let n of this.subscriptions[e])this.eventSource.removeEventListener(e,n)}async connect(){if(!(this.reconnectAttempts>0))return new Promise((e,n)=>{this.pendingConnects.push({resolve:e,reject:n}),this.pendingConnects.length>1||this.initConnect()})}initConnect(){this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{this.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildURL("/api/realtime")),this.eventSource.onerror=e=>{this.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",e=>{const n=e;this.clientId=n==null?void 0:n.lastEventId,this.submitSubscriptions().then(async()=>{let r=3;for(;this.hasUnsentSubscriptions()&&r>0;)r--,await this.submitSubscriptions()}).then(()=>{for(let s of this.pendingConnects)s.resolve();this.pendingConnects=[],this.reconnectAttempts=0,clearTimeout(this.reconnectTimeoutId),clearTimeout(this.connectTimeoutId);const r=this.getSubscriptionsByTopic("PB_CONNECT");for(let s in r)for(let i of r[s])i(e)}).catch(r=>{this.clientId="",this.connectErrorHandler(r)})})}hasUnsentSubscriptions(){const e=this.getNonEmptySubscriptionKeys();if(e.length!=this.lastSentSubscriptions.length)return!0;for(const n of e)if(!this.lastSentSubscriptions.includes(n))return!0;return!1}connectErrorHandler(e){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(let r of this.pendingConnects)r.reject(new Q(e));return this.pendingConnects=[],void this.disconnect()}this.disconnect(!0);const n=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(()=>{this.initConnect()},n)}disconnect(e=!1){var n;if(this.clientId&&this.onDisconnect&&this.onDisconnect(Object.keys(this.subscriptions)),clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),this.client.cancelRequest(this.getSubscriptionsCancelKey()),(n=this.eventSource)==null||n.close(),this.eventSource=null,this.clientId="",!e){this.reconnectAttempts=0;for(let r of this.pendingConnects)r.resolve();this.pendingConnects=[]}}}class yo extends Ee{decode(e){return e}async getFullList(e,n){if(typeof e=="number")return this._getFullList(e,n);let r=500;return(n=Object.assign({},e,n)).batch&&(r=n.batch,delete n.batch),this._getFullList(r,n)}async getList(e=1,n=30,r){return(r=Object.assign({method:"GET"},r)).query=Object.assign({page:e,perPage:n},r.query),this.client.send(this.baseCrudPath,r).then(s=>{var i;return s.items=((i=s.items)==null?void 0:i.map(o=>this.decode(o)))||[],s})}async getFirstListItem(e,n){return(n=Object.assign({requestKey:"one_by_filter_"+this.baseCrudPath+"_"+e},n)).query=Object.assign({filter:e,skipTotal:1},n.query),this.getList(1,1,n).then(r=>{var s;if(!((s=r==null?void 0:r.items)!=null&&s.length))throw new Q({status:404,response:{code:404,message:"The requested resource wasn't found.",data:{}}});return r.items[0]})}async getOne(e,n){if(!e)throw new Q({url:this.client.buildURL(this.baseCrudPath+"/"),status:404,response:{code:404,message:"Missing required record id.",data:{}}});return n=Object.assign({method:"GET"},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),n).then(r=>this.decode(r))}async create(e,n){return n=Object.assign({method:"POST",body:e},n),this.client.send(this.baseCrudPath,n).then(r=>this.decode(r))}async update(e,n,r){return r=Object.assign({method:"PATCH",body:n},r),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),r).then(s=>this.decode(s))}async delete(e,n){return n=Object.assign({method:"DELETE"},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),n).then(()=>!0)}_getFullList(e=500,n){(n=n||{}).query=Object.assign({skipTotal:1},n.query);let r=[],s=async i=>this.getList(i,e||500,n).then(o=>{const a=o.items;return r=r.concat(a),a.length==o.perPage?s(i+1):r});return s(1)}}function ve(t,e,n,r){const s=r!==void 0;return s||n!==void 0?s?(console.warn(t),e.body=Object.assign({},e.body,n),e.query=Object.assign({},e.query,r),e):Object.assign(e,n):e}function ir(t){var e;(e=t._resetAutoRefresh)==null||e.call(t)}class Yc extends yo{constructor(e,n){super(e),this.collectionIdOrName=n}get baseCrudPath(){return this.baseCollectionPath+"/records"}get baseCollectionPath(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)}get isSuperusers(){return this.collectionIdOrName=="_superusers"||this.collectionIdOrName=="_pbc_2773867675"}async subscribe(e,n,r){if(!e)throw new Error("Missing topic.");if(!n)throw new Error("Missing subscription callback.");return this.client.realtime.subscribe(this.collectionIdOrName+"/"+e,n,r)}async unsubscribe(e){return e?this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+e):this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)}async getFullList(e,n){if(typeof e=="number")return super.getFullList(e,n);const r=Object.assign({},e,n);return super.getFullList(r)}async getList(e=1,n=30,r){return super.getList(e,n,r)}async getFirstListItem(e,n){return super.getFirstListItem(e,n)}async getOne(e,n){return super.getOne(e,n)}async create(e,n){return super.create(e,n)}async update(e,n,r){return super.update(e,n,r).then(s=>{var i,o,a;if(((i=this.client.authStore.record)==null?void 0:i.id)===(s==null?void 0:s.id)&&(((o=this.client.authStore.record)==null?void 0:o.collectionId)===this.collectionIdOrName||((a=this.client.authStore.record)==null?void 0:a.collectionName)===this.collectionIdOrName)){let c=Object.assign({},this.client.authStore.record.expand),u=Object.assign({},this.client.authStore.record,s);c&&(u.expand=Object.assign(c,s.expand)),this.client.authStore.save(this.client.authStore.token,u)}return s})}async delete(e,n){return super.delete(e,n).then(r=>{var s,i,o;return!r||((s=this.client.authStore.record)==null?void 0:s.id)!==e||((i=this.client.authStore.record)==null?void 0:i.collectionId)!==this.collectionIdOrName&&((o=this.client.authStore.record)==null?void 0:o.collectionName)!==this.collectionIdOrName||this.client.authStore.clear(),r})}authResponse(e){const n=this.decode((e==null?void 0:e.record)||{});return this.client.authStore.save(e==null?void 0:e.token,n),Object.assign({},e,{token:(e==null?void 0:e.token)||"",record:n})}async listAuthMethods(e){return e=Object.assign({method:"GET",fields:"mfa,otp,password,oauth2"},e),this.client.send(this.baseCollectionPath+"/auth-methods",e)}async authWithPassword(e,n,r){let s;r=Object.assign({method:"POST",body:{identity:e,password:n}},r),this.isSuperusers&&(s=r.autoRefreshThreshold,delete r.autoRefreshThreshold,r.autoRefresh||ir(this.client));let i=await this.client.send(this.baseCollectionPath+"/auth-with-password",r);return i=this.authResponse(i),s&&this.isSuperusers&&function(a,c,u,l){ir(a);const d=a.beforeSend,p=a.authStore.record,f=a.authStore.onChange((_,h)=>{(!_||(h==null?void 0:h.id)!=(p==null?void 0:p.id)||(h!=null&&h.collectionId||p!=null&&p.collectionId)&&(h==null?void 0:h.collectionId)!=(p==null?void 0:p.collectionId))&&ir(a)});a._resetAutoRefresh=function(){f(),a.beforeSend=d,delete a._resetAutoRefresh},a.beforeSend=async(_,h)=>{var y;const b=a.authStore.token;if((y=h.query)!=null&&y.autoRefresh)return d?d(_,h):{url:_,sendOptions:h};let v=a.authStore.isValid;if(v&&_o(a.authStore.token,c))try{await u()}catch{v=!1}v||await l();const E=h.headers||{};for(let m in E)if(m.toLowerCase()=="authorization"&&b==E[m]&&a.authStore.token){E[m]=a.authStore.token;break}return h.headers=E,d?d(_,h):{url:_,sendOptions:h}}}(this.client,s,()=>this.authRefresh({autoRefresh:!0}),()=>this.authWithPassword(e,n,Object.assign({autoRefresh:!0},r))),i}async authWithOAuth2Code(e,n,r,s,i,o,a){let c={method:"POST",body:{provider:e,code:n,codeVerifier:r,redirectURL:s,createData:i}};return c=ve("This form of authWithOAuth2Code(provider, code, codeVerifier, redirectURL, createData?, body?, query?) is deprecated. Consider replacing it with authWithOAuth2Code(provider, code, codeVerifier, redirectURL, createData?, options?).",c,o,a),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",c).then(u=>this.authResponse(u))}authWithOAuth2(...e){if(e.length>1||typeof(e==null?void 0:e[0])=="string")return console.warn("PocketBase: This form of authWithOAuth2() is deprecated and may get removed in the future. Please replace with authWithOAuth2Code() OR use the authWithOAuth2() realtime form as shown in https://pocketbase.io/docs/authentication/#oauth2-integration."),this.authWithOAuth2Code((e==null?void 0:e[0])||"",(e==null?void 0:e[1])||"",(e==null?void 0:e[2])||"",(e==null?void 0:e[3])||"",(e==null?void 0:e[4])||{},(e==null?void 0:e[5])||{},(e==null?void 0:e[6])||{});const n=(e==null?void 0:e[0])||{};let r=null;n.urlCallback||(r=zs(void 0));const s=new Eo(this.client);function i(){r==null||r.close(),s.unsubscribe()}const o={},a=n.requestKey;return a&&(o.requestKey=a),this.listAuthMethods(o).then(c=>{var p;const u=c.oauth2.providers.find(f=>f.name===n.provider);if(!u)throw new Q(new Error(`Missing or invalid provider "${n.provider}".`));const l=this.client.buildURL("/api/oauth2-redirect"),d=a?(p=this.client.cancelControllers)==null?void 0:p[a]:void 0;return d&&(d.signal.onabort=()=>{i()}),new Promise(async(f,_)=>{var h;try{await s.subscribe("@oauth2",async y=>{var g;const m=s.clientId;try{if(!y.state||m!==y.state)throw new Error("State parameters don't match.");if(y.error||!y.code)throw new Error("OAuth2 redirect error or missing code: "+y.error);const C=Object.assign({},n);delete C.provider,delete C.scopes,delete C.createData,delete C.urlCallback,(g=d==null?void 0:d.signal)!=null&&g.onabort&&(d.signal.onabort=null);const q=await this.authWithOAuth2Code(u.name,y.code,u.codeVerifier,l,n.createData,C);f(q)}catch(C){_(new Q(C))}i()});const b={state:s.clientId};(h=n.scopes)!=null&&h.length&&(b.scope=n.scopes.join(" "));const v=this._replaceQueryParams(u.authURL+l,b);await(n.urlCallback||function(y){r?r.location.href=y:r=zs(y)})(v)}catch(b){i(),_(new Q(b))}})}).catch(c=>{throw i(),c})}async authRefresh(e,n){let r={method:"POST"};return r=ve("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",r,e,n),this.client.send(this.baseCollectionPath+"/auth-refresh",r).then(s=>this.authResponse(s))}async requestPasswordReset(e,n,r){let s={method:"POST",body:{email:e}};return s=ve("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",s,n,r),this.client.send(this.baseCollectionPath+"/request-password-reset",s).then(()=>!0)}async confirmPasswordReset(e,n,r,s,i){let o={method:"POST",body:{token:e,password:n,passwordConfirm:r}};return o=ve("This form of confirmPasswordReset(token, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(token, password, passwordConfirm, options?).",o,s,i),this.client.send(this.baseCollectionPath+"/confirm-password-reset",o).then(()=>!0)}async requestVerification(e,n,r){let s={method:"POST",body:{email:e}};return s=ve("This form of requestVerification(email, body?, query?) is deprecated. Consider replacing it with requestVerification(email, options?).",s,n,r),this.client.send(this.baseCollectionPath+"/request-verification",s).then(()=>!0)}async confirmVerification(e,n,r){let s={method:"POST",body:{token:e}};return s=ve("This form of confirmVerification(token, body?, query?) is deprecated. Consider replacing it with confirmVerification(token, options?).",s,n,r),this.client.send(this.baseCollectionPath+"/confirm-verification",s).then(()=>{const i=ft(e),o=this.client.authStore.record;return o&&!o.verified&&o.id===i.id&&o.collectionId===i.collectionId&&(o.verified=!0,this.client.authStore.save(this.client.authStore.token,o)),!0})}async requestEmailChange(e,n,r){let s={method:"POST",body:{newEmail:e}};return s=ve("This form of requestEmailChange(newEmail, body?, query?) is deprecated. Consider replacing it with requestEmailChange(newEmail, options?).",s,n,r),this.client.send(this.baseCollectionPath+"/request-email-change",s).then(()=>!0)}async confirmEmailChange(e,n,r,s){let i={method:"POST",body:{token:e,password:n}};return i=ve("This form of confirmEmailChange(token, password, body?, query?) is deprecated. Consider replacing it with confirmEmailChange(token, password, options?).",i,r,s),this.client.send(this.baseCollectionPath+"/confirm-email-change",i).then(()=>{const o=ft(e),a=this.client.authStore.record;return a&&a.id===o.id&&a.collectionId===o.collectionId&&this.client.authStore.clear(),!0})}async listExternalAuths(e,n){return this.client.collection("_externalAuths").getFullList(Object.assign({},n,{filter:this.client.filter("recordRef = {:id}",{id:e})}))}async unlinkExternalAuth(e,n,r){const s=await this.client.collection("_externalAuths").getFirstListItem(this.client.filter("recordRef = {:recordId} && provider = {:provider}",{recordId:e,provider:n}));return this.client.collection("_externalAuths").delete(s.id,r).then(()=>!0)}async requestOTP(e,n){return n=Object.assign({method:"POST",body:{email:e}},n),this.client.send(this.baseCollectionPath+"/request-otp",n)}async authWithOTP(e,n,r){return r=Object.assign({method:"POST",body:{otpId:e,password:n}},r),this.client.send(this.baseCollectionPath+"/auth-with-otp",r).then(s=>this.authResponse(s))}async impersonate(e,n,r){(r=Object.assign({method:"POST",body:{duration:n}},r)).headers=r.headers||{},r.headers.Authorization||(r.headers.Authorization=this.client.authStore.token);const s=new ss(this.client.baseURL,new ns,this.client.lang),i=await s.send(this.baseCollectionPath+"/impersonate/"+encodeURIComponent(e),r);return s.authStore.save(i==null?void 0:i.token,this.decode((i==null?void 0:i.record)||{})),s}_replaceQueryParams(e,n={}){let r=e,s="";e.indexOf("?")>=0&&(r=e.substring(0,e.indexOf("?")),s=e.substring(e.indexOf("?")+1));const i={},o=s.split("&");for(const a of o){if(a=="")continue;const c=a.split("=");i[decodeURIComponent(c[0].replace(/\+/g," "))]=decodeURIComponent((c[1]||"").replace(/\+/g," "))}for(let a in n)n.hasOwnProperty(a)&&(n[a]==null?delete i[a]:i[a]=n[a]);s="";for(let a in i)i.hasOwnProperty(a)&&(s!=""&&(s+="&"),s+=encodeURIComponent(a.replace(/%20/g,"+"))+"="+encodeURIComponent(i[a].replace(/%20/g,"+")));return s!=""?r+"?"+s:r}}function zs(t){if(typeof window>"u"||!(window!=null&&window.open))throw new Q(new Error("Not in a browser context - please pass a custom urlCallback function."));let e=1024,n=768,r=window.innerWidth,s=window.innerHeight;e=e>r?r:e,n=n>s?s:n;let i=r/2-e/2,o=s/2-n/2;return window.open(t,"popup_window","width="+e+",height="+n+",top="+o+",left="+i+",resizable,menubar=no")}class Jc extends yo{get baseCrudPath(){return"/api/collections"}async import(e,n=!1,r){return r=Object.assign({method:"PUT",body:{collections:e,deleteMissing:n}},r),this.client.send(this.baseCrudPath+"/import",r).then(()=>!0)}async getScaffolds(e){return e=Object.assign({method:"GET"},e),this.client.send(this.baseCrudPath+"/meta/scaffolds",e)}async truncate(e,n){return n=Object.assign({method:"DELETE"},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/truncate",n).then(()=>!0)}}class Xc extends Ee{async getList(e=1,n=30,r){return(r=Object.assign({method:"GET"},r)).query=Object.assign({page:e,perPage:n},r.query),this.client.send("/api/logs",r)}async getOne(e,n){if(!e)throw new Q({url:this.client.buildURL("/api/logs/"),status:404,response:{code:404,message:"Missing required log id.",data:{}}});return n=Object.assign({method:"GET"},n),this.client.send("/api/logs/"+encodeURIComponent(e),n)}async getStats(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/logs/stats",e)}}class Qc extends Ee{async check(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/health",e)}}class Zc extends Ee{getUrl(e,n,r={}){return console.warn("Please replace pb.files.getUrl() with pb.files.getURL()"),this.getURL(e,n,r)}getURL(e,n,r={}){if(!n||!(e!=null&&e.id)||!(e!=null&&e.collectionId)&&!(e!=null&&e.collectionName))return"";const s=[];s.push("api"),s.push("files"),s.push(encodeURIComponent(e.collectionId||e.collectionName)),s.push(encodeURIComponent(e.id)),s.push(encodeURIComponent(n));let i=this.client.buildURL(s.join("/"));if(Object.keys(r).length){r.download===!1&&delete r.download;const o=new URLSearchParams(r);i+=(i.includes("?")?"&":"?")+o}return i}async getToken(e){return e=Object.assign({method:"POST"},e),this.client.send("/api/files/token",e).then(n=>(n==null?void 0:n.token)||"")}}class eu extends Ee{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/backups",e)}async create(e,n){return n=Object.assign({method:"POST",body:{name:e}},n),this.client.send("/api/backups",n).then(()=>!0)}async upload(e,n){return n=Object.assign({method:"POST",body:e},n),this.client.send("/api/backups/upload",n).then(()=>!0)}async delete(e,n){return n=Object.assign({method:"DELETE"},n),this.client.send(`/api/backups/${encodeURIComponent(e)}`,n).then(()=>!0)}async restore(e,n){return n=Object.assign({method:"POST"},n),this.client.send(`/api/backups/${encodeURIComponent(e)}/restore`,n).then(()=>!0)}getDownloadUrl(e,n){return console.warn("Please replace pb.backups.getDownloadUrl() with pb.backups.getDownloadURL()"),this.getDownloadURL(e,n)}getDownloadURL(e,n){return this.client.buildURL(`/api/backups/${encodeURIComponent(n)}?token=${encodeURIComponent(e)}`)}}class tu extends Ee{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/crons",e)}async run(e,n){return n=Object.assign({method:"POST"},n),this.client.send(`/api/crons/${encodeURIComponent(e)}`,n).then(()=>!0)}}function Cr(t){return typeof Blob<"u"&&t instanceof Blob||typeof File<"u"&&t instanceof File||t!==null&&typeof t=="object"&&t.uri&&(typeof navigator<"u"&&navigator.product==="ReactNative"||typeof global<"u"&&global.HermesInternal)}function Ar(t){return t&&(t.constructor.name==="FormData"||typeof FormData<"u"&&t instanceof FormData)}function Ws(t){for(const e in t){const n=Array.isArray(t[e])?t[e]:[t[e]];for(const r of n)if(Cr(r))return!0}return!1}const nu=/^[\-\.\d]+$/;function Ks(t){if(typeof t!="string")return t;if(t=="true")return!0;if(t=="false")return!1;if((t[0]==="-"||t[0]>="0"&&t[0]<="9")&&nu.test(t)){let e=+t;if(""+e===t)return e}return t}class ru extends Ee{constructor(){super(...arguments),this.requests=[],this.subs={}}collection(e){return this.subs[e]||(this.subs[e]=new su(this.requests,e)),this.subs[e]}async send(e){const n=new FormData,r=[];for(let s=0;s<this.requests.length;s++){const i=this.requests[s];if(r.push({method:i.method,url:i.url,headers:i.headers,body:i.json}),i.files)for(let o in i.files){const a=i.files[o]||[];for(let c of a)n.append("requests."+s+"."+o,c)}}return n.append("@jsonPayload",JSON.stringify({requests:r})),e=Object.assign({method:"POST",body:n},e),this.client.send("/api/batch",e)}}class su{constructor(e,n){this.requests=[],this.requests=e,this.collectionIdOrName=n}upsert(e,n){n=Object.assign({body:e||{}},n);const r={method:"PUT",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records"};this.prepareRequest(r,n),this.requests.push(r)}create(e,n){n=Object.assign({body:e||{}},n);const r={method:"POST",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records"};this.prepareRequest(r,n),this.requests.push(r)}update(e,n,r){r=Object.assign({body:n||{}},r);const s={method:"PATCH",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records/"+encodeURIComponent(e)};this.prepareRequest(s,r),this.requests.push(s)}delete(e,n){n=Object.assign({},n);const r={method:"DELETE",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records/"+encodeURIComponent(e)};this.prepareRequest(r,n),this.requests.push(r)}prepareRequest(e,n){if(rs(n),e.headers=n.headers,e.json={},e.files={},n.query!==void 0){const s=So(n.query);s&&(e.url+=(e.url.includes("?")?"&":"?")+s)}let r=n.body;Ar(r)&&(r=function(i){let o={};return i.forEach((a,c)=>{if(c==="@jsonPayload"&&typeof a=="string")try{let u=JSON.parse(a);Object.assign(o,u)}catch(u){console.warn("@jsonPayload error:",u)}else o[c]!==void 0?(Array.isArray(o[c])||(o[c]=[o[c]]),o[c].push(Ks(a))):o[c]=Ks(a)}),o}(r));for(const s in r){const i=r[s];if(Cr(i))e.files[s]=e.files[s]||[],e.files[s].push(i);else if(Array.isArray(i)){const o=[],a=[];for(const c of i)Cr(c)?o.push(c):a.push(c);if(o.length>0&&o.length==i.length){e.files[s]=e.files[s]||[];for(let c of o)e.files[s].push(c)}else if(e.json[s]=a,o.length>0){let c=s;s.startsWith("+")||s.endsWith("+")||(c+="+"),e.files[c]=e.files[c]||[];for(let u of o)e.files[c].push(u)}}else e.json[s]=i}}}let ss=class{get baseUrl(){return this.baseURL}set baseUrl(e){this.baseURL=e}constructor(e="/",n,r="en-US"){this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseURL=e,this.lang=r,n?this.authStore=n:typeof window<"u"&&window.Deno?this.authStore=new ns:this.authStore=new Gc,this.collections=new Jc(this),this.files=new Zc(this),this.logs=new Xc(this),this.settings=new zc(this),this.realtime=new Eo(this),this.health=new Qc(this),this.backups=new eu(this),this.crons=new tu(this)}get admins(){return this.collection("_superusers")}createBatch(){return new ru(this)}collection(e){return this.recordServices[e]||(this.recordServices[e]=new Yc(this,e)),this.recordServices[e]}autoCancellation(e){return this.enableAutoCancellation=!!e,this}cancelRequest(e){return this.cancelControllers[e]&&(this.cancelControllers[e].abort(),delete this.cancelControllers[e]),this}cancelAllRequests(){for(let e in this.cancelControllers)this.cancelControllers[e].abort();return this.cancelControllers={},this}filter(e,n){if(!n)return e;for(let r in n){let s=n[r];switch(typeof s){case"boolean":case"number":s=""+s;break;case"string":s="'"+s.replace(/'/g,"\\'")+"'";break;default:s=s===null?"null":s instanceof Date?"'"+s.toISOString().replace("T"," ")+"'":"'"+JSON.stringify(s).replace(/'/g,"\\'")+"'"}e=e.replaceAll("{:"+r+"}",s)}return e}getFileUrl(e,n,r={}){return console.warn("Please replace pb.getFileUrl() with pb.files.getURL()"),this.files.getURL(e,n,r)}buildUrl(e){return console.warn("Please replace pb.buildUrl() with pb.buildURL()"),this.buildURL(e)}buildURL(e){var r;let n=this.baseURL;return typeof window>"u"||!window.location||n.startsWith("https://")||n.startsWith("http://")||(n=(r=window.location.origin)!=null&&r.endsWith("/")?window.location.origin.substring(0,window.location.origin.length-1):window.location.origin||"",this.baseURL.startsWith("/")||(n+=window.location.pathname||"/",n+=n.endsWith("/")?"":"/"),n+=this.baseURL),e&&(n+=n.endsWith("/")?"":"/",n+=e.startsWith("/")?e.substring(1):e),n}async send(e,n){n=this.initSendOptions(e,n);let r=this.buildURL(e);if(this.beforeSend){const s=Object.assign({},await this.beforeSend(r,n));s.url!==void 0||s.options!==void 0?(r=s.url||r,n=s.options||n):Object.keys(s).length&&(n=s,console!=null&&console.warn&&console.warn("Deprecated format of beforeSend return: please use `return { url, options }`, instead of `return options`."))}if(n.query!==void 0){const s=So(n.query);s&&(r+=(r.includes("?")?"&":"?")+s),delete n.query}return this.getHeader(n.headers,"Content-Type")=="application/json"&&n.body&&typeof n.body!="string"&&(n.body=JSON.stringify(n.body)),(n.fetch||fetch)(r,n).then(async s=>{let i={};try{i=await s.json()}catch{}if(this.afterSend&&(i=await this.afterSend(s,i,n)),s.status>=400)throw new Q({url:s.url,status:s.status,data:i});return i}).catch(s=>{throw new Q(s)})}initSendOptions(e,n){if((n=Object.assign({method:"GET"},n)).body=function(s){if(typeof FormData>"u"||s===void 0||typeof s!="object"||s===null||Ar(s)||!Ws(s))return s;const i=new FormData;for(const o in s){const a=s[o];if(a!==void 0)if(typeof a!="object"||Ws({data:a})){const c=Array.isArray(a)?a:[a];for(let u of c)i.append(o,u)}else{let c={};c[o]=a,i.append("@jsonPayload",JSON.stringify(c))}}return i}(n.body),rs(n),n.query=Object.assign({},n.params,n.query),n.requestKey===void 0&&(n.$autoCancel===!1||n.query.$autoCancel===!1?n.requestKey=null:(n.$cancelKey||n.query.$cancelKey)&&(n.requestKey=n.$cancelKey||n.query.$cancelKey)),delete n.$autoCancel,delete n.query.$autoCancel,delete n.$cancelKey,delete n.query.$cancelKey,this.getHeader(n.headers,"Content-Type")!==null||Ar(n.body)||(n.headers=Object.assign({},n.headers,{"Content-Type":"application/json"})),this.getHeader(n.headers,"Accept-Language")===null&&(n.headers=Object.assign({},n.headers,{"Accept-Language":this.lang})),this.authStore.token&&this.getHeader(n.headers,"Authorization")===null&&(n.headers=Object.assign({},n.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&n.requestKey!==null){const r=n.requestKey||(n.method||"GET")+e;delete n.requestKey,this.cancelRequest(r);const s=new AbortController;this.cancelControllers[r]=s,n.signal=s.signal}return n}getHeader(e,n){e=e||{},n=n.toLowerCase();for(let r in e)if(r.toLowerCase()==n)return e[r];return null}};const To=A.createContext(null);function iu({children:t}){const e=A.useMemo(()=>{const E=new ss("http://127.0.0.1:8090"),y=localStorage.getItem("pocketbase_auth");if(y)try{const m=JSON.parse(y);E.authStore.save(m.token,m.model)}catch(m){console.warn("Failed to load persisted auth:",m),localStorage.removeItem("pocketbase_auth")}return E},[]),[n,r]=A.useState(e.authStore.token),[s,i]=A.useState(e.authStore.model),[o,a]=A.useState(!1),[c,u]=A.useState(null),[l,d]=A.useState(!1);A.useEffect(()=>e.authStore.onChange((y,m)=>{console.log("PocketBase authStore changed:",{hasToken:!!y,userEmail:m==null?void 0:m.email}),r(y),i(m),y&&m?localStorage.setItem("pocketbase_auth",JSON.stringify({token:y,model:m})):localStorage.removeItem("pocketbase_auth")}),[e]),A.useEffect(()=>{(async()=>{a(!0);try{e.authStore.isValid&&(console.log("Validating existing auth token..."),await e.collection("_pb_users_auth_").authRefresh(),console.log("Auth token validated successfully"))}catch(y){console.warn("Auth validation failed, clearing invalid token:",y),e.authStore.clear()}finally{d(!0),a(!1)}})()},[e]),A.useEffect(()=>{const E=setInterval(async()=>{if(e.authStore.isValid)try{console.log("Auto-refreshing token..."),await e.collection("_pb_users_auth_").authRefresh()}catch(y){console.error("Token refresh failed:",y),e.authStore.clear()}},12e4);return()=>clearInterval(E)},[e]);const p=A.useCallback(async(E,y)=>{var m;a(!0),u(null);try{console.log("PocketContext: Attempting login for:",E);const g=await e.collection("_pb_users_auth_").authWithPassword(E,y);return console.log("PocketContext: Login successful:",{userEmail:(m=g.record)==null?void 0:m.email,hasToken:!!g.token}),g}catch(g){throw console.error("PocketContext: Login failed:",g),u(g.message||"Login failed"),g}finally{a(!1)}},[e]),f=A.useCallback(async E=>{a(!0),u(null);try{console.log("PocketContext: Attempting registration for:",E.email);const y={email:E.email,password:E.password,passwordConfirm:E.password};(E.firstName||E.lastName)&&(y.name=`${E.firstName||""} ${E.lastName||""}`.trim());const m=await e.collection("_pb_users_auth_").create(y);return console.log("PocketContext: Registration successful for:",m.email),{user:m,requiresLogin:!0}}catch(y){throw console.error("PocketContext: Registration failed:",y),u(y.message||"Registration failed"),y}finally{a(!1)}},[e]),_=A.useCallback(async(E=!1)=>{console.log("PocketContext: Logging out",{invalidateTokens:E});try{E&&e.authStore.isValid&&await e.collection("_pb_users_auth_").authRefresh({invalidate:!0})}catch(y){console.warn("Failed to invalidate tokens during logout:",y)}e.authStore.clear(),u(null)},[e]),h=A.useCallback(async E=>{a(!0),u(null);try{console.log("PocketContext: Updating profile");const y=E.password&&E.passwordConfirm,m=E.email&&E.email!==(s==null?void 0:s.email),g=await e.collection("_pb_users_auth_").update(e.authStore.model.id,E);if(y||m){console.log("Password/email changed, invalidating other sessions...");try{await e.collection("_pb_users_auth_").authRefresh({invalidate:!0})}catch(C){console.warn("Failed to invalidate other sessions:",C)}}return i(g),console.log("PocketContext: Profile updated successfully"),{user:g}}catch(y){throw console.error("PocketContext: Profile update failed:",y),u(y.message||"Profile update failed"),y}finally{a(!1)}},[e,s==null?void 0:s.email]),b=A.useCallback(()=>{u(null)},[]),v=A.useMemo(()=>({pb:e,token:n,user:s,isLoading:o,error:c,isInitialized:l,isAuthenticated:!!n&&e.authStore.isValid,login:p,register:f,logout:_,updateProfile:h,clearError:b}),[e,n,s,o,c,l,p,f,_,h,b]);return S.jsx(To.Provider,{value:v,children:t})}const Vn=()=>{const t=A.useContext(To);if(!t)throw new Error("usePocket must be used within a PocketProvider");return t};class ou{constructor(){this.pb=new ss("http://127.0.0.1:8090"),this.authStore=this.pb.authStore,this.pendingRequests=new Map}async signUp(e){try{const n={email:e.email,password:e.password,passwordConfirm:e.password};(e.firstName||e.lastName)&&(n.name=`${e.firstName||""} ${e.lastName||""}`.trim()),console.log("Creating user with minimal data:",{email:e.email,hasPassword:!!e.password,hasName:!!n.name});const r=await this.pb.collection("_pb_users_auth_").create(n);return console.log("User created successfully:",r.email),console.log("Registration successful, skipping auto-login for now"),{user:r,token:null,requiresLogin:!0}}catch(n){if(console.error("SignUp error details:",{message:n.message,status:n.status,data:n.data,response:n.response}),n.data&&n.data.email)throw n.data.email.code==="validation_invalid_email"?new Error("This email address is already registered. Please use a different email or try logging in."):new Error(`Email error: ${n.data.email.message}`);if(n.data&&n.data.password)throw new Error(`Password error: ${n.data.password.message}`);if(n.status===400){if(n.message.includes("create record"))throw new Error("Registration failed. The email might already be in use. Please try a different email.");if(n.message.includes("invalid formatting"))throw new Error("Registration data format error. Please check all fields and try again.")}const r=this.handleConnectionError(n);throw new Error(r)}}async signIn(e,n){const r=`auth:${e}`;if(this.pendingRequests.has(r))return console.log("Login request already pending for:",e),this.pendingRequests.get(r);const s=this._performLogin(e,n);this.pendingRequests.set(r,s);try{return await s}finally{this.pendingRequests.delete(r)}}async _performLogin(e,n){var r;try{console.log("Attempting login with:",{email:e,password:`${n.substring(0,3)}***`}),this.clearPendingRequests();const s=await this.pb.collection("_pb_users_auth_").authWithPassword(e,n);return console.log("Login successful:",{user:(r=s.record)==null?void 0:r.email,hasToken:!!s.token}),{user:s.record,token:s.token}}catch(s){if(console.error("PocketBase signIn error:",{message:s.message,status:s.status,data:s.data}),s.status===400)throw new Error("Invalid email or password. Please check your credentials.");const i=this.handleConnectionError(s);throw new Error(`Login failed: ${i}`)}}async signOut(){this.pb.authStore.clear(),this.clearPendingRequests()}clearPendingRequests(){console.log("Clearing all pending requests"),this.pendingRequests.clear()}async getCurrentUser(){return this.authStore.isValid?this.authStore.model:null}async updateProfile(e){try{return{user:await this.pb.collection("_pb_users_auth_").update(this.authStore.model.id,e)}}catch(n){throw new Error(n.message)}}async create(e,n){try{return{data:await this.pb.collection(e).create(n),error:null}}catch(r){return{data:null,error:this.handleConnectionError(r)}}}async getList(e,n={}){var u;const{page:r=1,perPage:s=50,sort:i="-created",filter:o=""}=n,a=`getList:${e}:${r}:${s}:${i}:${o}:${((u=this.authStore.model)==null?void 0:u.id)||"anonymous"}`;if(this.pendingRequests.has(a)){const l=this.pendingRequests.get(a);return console.log(`Reusing pending ${e} request`),l}const c=this._performGetList(e,{page:r,perPage:s,sort:i,filter:o});this.pendingRequests.set(a,c);try{return await c}finally{setTimeout(()=>{this.pendingRequests.delete(a)},100)}}async _performGetList(e,{page:n,perPage:r,sort:s,filter:i}){try{console.log(`Fetching ${e} with filter: ${i}`);const o=await this.pb.collection(e).getList(n,r,{sort:s,filter:i});return console.log(`Successfully fetched ${o.items.length} ${e} records`),{data:o.items,count:o.totalItems,error:null}}catch(o){console.error(`PocketBase error fetching ${e}:`,{message:o.message,status:o.status,collection:e,filter:i});const a=this.handleConnectionError(o);return{data:[],count:0,error:a}}}async getOne(e,n){try{return{data:await this.pb.collection(e).getOne(n),error:null}}catch(r){return{data:null,error:this.handleConnectionError(r)}}}async update(e,n,r){try{return{data:await this.pb.collection(e).update(n,r),error:null}}catch(s){return{data:null,error:this.handleConnectionError(s)}}}async delete(e,n){try{return await this.pb.collection(e).delete(n),{data:{success:!0},error:null}}catch(r){return{data:null,error:this.handleConnectionError(r)}}}subscribe(e,n){return this.pb.collection(e).subscribe("*",n)}subscribeToRecord(e,n,r){return this.pb.collection(e).subscribe(n,r)}async uploadFile(e){try{const n=new FormData;return n.append("file",e),{data:await this.pb.collection("files").create(n),error:null}}catch(n){return{data:null,error:n.message}}}getFileUrl(e,n,r){return this.pb.files.getUrl(e,n,r)}isAuthenticated(){return this.authStore.isValid}getToken(){return this.authStore.token}setToken(e){this.authStore.save(e,this.authStore.model)}handleConnectionError(e){var n,r;return(n=e.message)!=null&&n.includes("fetch")||(r=e.message)!=null&&r.includes("Failed to fetch")?"Unable to connect to server. Please check your connection and try again.":e.status===404?"Collection not found. This feature may not be configured yet.":e.status===401?"Authentication required. Please log in again.":e.status===403?"Access denied. You do not have permission for this action.":e.message||"An unexpected error occurred."}}const bo=new ou;class au{constructor(){this.memoryCache=new Map,this.ttl=new Map,this.maxSize=1e3,this.defaultTTL=5*60*1e3,this.hitCount=0,this.missCount=0,setInterval(()=>this.cleanup(),60*1e3)}set(e,n,r=this.defaultTTL){this.memoryCache.size>=this.maxSize&&this.evictOldest(),this.memoryCache.set(e,n),this.ttl.set(e,Date.now()+r)}get(e){const n=this.ttl.get(e);return!n||Date.now()>n?(this.delete(e),this.missCount++,null):(this.hitCount++,this.memoryCache.get(e))}delete(e){this.memoryCache.delete(e),this.ttl.delete(e)}clear(){this.memoryCache.clear(),this.ttl.clear(),this.hitCount=0,this.missCount=0}has(e){return this.get(e)!==null}size(){return this.memoryCache.size}getStats(){return{size:this.memoryCache.size,maxSize:this.maxSize,hitRate:this.calculateHitRate(),hits:this.hitCount,misses:this.missCount}}evictOldest(){const e=Array.from(this.ttl.entries());e.sort((r,s)=>r[1]-s[1]);const n=Math.ceil(this.maxSize*.2);e.slice(0,n).forEach(([r])=>{this.delete(r)})}cleanup(){const e=Date.now();for(const[n,r]of this.ttl.entries())e>r&&this.delete(n)}calculateHitRate(){const e=this.hitCount+this.missCount;return e>0?this.hitCount/e*100:0}async cache(e,n,r=this.defaultTTL){const s=this.get(e);if(s)return s;const i=await n();return this.set(e,i,r),i}invalidatePattern(e){const n=new RegExp(e);for(const r of this.memoryCache.keys())n.test(r)&&this.delete(r)}invalidate(e){this.delete(e)}}const x=new au,cu=t=>{const e=new Date;switch(t){case"1d":return new Date(e.getTime()-24*60*60*1e3);case"7d":return new Date(e.getTime()-7*24*60*60*1e3);case"30d":return new Date(e.getTime()-30*24*60*60*1e3);case"90d":return new Date(e.getTime()-90*24*60*60*1e3);case"all":return null;default:return new Date(e.getTime()-7*24*60*60*1e3)}},uu=t=>{if(!t||t.length===0)return 0;const e=t.map(s=>new Date(s.session_date)).sort((s,i)=>i-s);let n=0,r=new Date;r.setHours(0,0,0,0);for(let s=0;s<e.length;s++){const i=new Date(e[s]);i.setHours(0,0,0,0);const o=r-i;if(Math.ceil(o/(1e3*60*60*24))<=1)n++,r=i;else break}return n},Ys=t=>{if(!t||t<1)return"0m";const e=Math.floor(t/60),n=t%60;return e===0?`${n}m`:n===0?`${e}h`:`${e}h ${n}m`};class lu{constructor(){this.pocketbase=null,this.config=null}_getPocketbase(){return this.pocketbase||(this.pocketbase=bo),this.pocketbase}_getConfig(){return this.config||(this.config={pocketbaseUrl:"http://127.0.0.1:8090",apiTimeout:3e4,cacheTTL:5*60*1e3,maxRetries:3}),this.config}async getSessions(e={}){return this.getTrainingSessions(e)}async getStats(e="7d"){return this.getTrainingStats(e)}async getGoals(e={}){return this.getTrainingGoals(e)}async getTrainingSessions(e={}){const n=`training:sessions:${JSON.stringify(e)}`,r=x.get(n);if(r)return r;try{const s=this._getPocketbase();if(!s.isAuthenticated())return console.log("User not authenticated, returning empty training sessions"),[];const i={page:e.page||1,perPage:e.perPage||50,sort:e.sort||"-created",filter:this.buildFilterString(e)},o=await s.getList("training_sessions",i);if(o.error)throw console.error("PocketBase error fetching training sessions:",o.error),new Error(`Failed to fetch training sessions: ${o.error}`);return x.set(n,o.data,2*60*1e3),o.data}catch(s){if(console.error("Training sessions service error:",s.message),s.message.includes("User not authenticated")||s.message.includes("401"))return[];throw s}}async createTrainingSession(e){var n;try{const r=this._getPocketbase(),s=await r.create("training_sessions",{...e,user_id:(n=r.authStore.model)==null?void 0:n.id,created:new Date().toISOString()});if(s.error)throw new Error(s.error);return x.invalidatePattern("training:sessions"),x.invalidatePattern("training:stats"),s.data}catch(r){throw console.error("Failed to create training session:",r),r}}async updateTrainingSession(e,n){try{const r=await this._getPocketbase().update("training_sessions",e,{...n,updated:new Date().toISOString()});if(r.error)throw new Error(r.error);return x.invalidatePattern("training:sessions"),x.invalidatePattern("training:stats"),r.data}catch(r){throw console.error("Failed to update training session:",r),r}}async deleteTrainingSession(e){try{const n=await this._getPocketbase().delete("training_sessions",e);if(n.error)throw new Error(n.error);return x.invalidatePattern("training:sessions"),x.invalidatePattern("training:stats"),n.data}catch(n){throw console.error("Failed to delete training session:",n),n}}async getTrainingStats(e="7d"){const n=`training:stats:${e}`,r=x.get(n);if(r)return r;try{if(!this._getPocketbase().isAuthenticated())return console.log("User not authenticated, returning empty training stats"),{totalSessions:0,totalDuration:0,averageDuration:0,streakDays:0,formattedTotalDuration:"0m",formattedAverageDuration:"0m"};const i=cu(e),o=i?`created >= "${i.toISOString()}"`:"",a=await this.getTrainingSessions({filter:o}),c={totalSessions:a.length,totalDuration:a.reduce((u,l)=>u+(l.duration||0),0),averageDuration:a.length>0?Math.round(a.reduce((u,l)=>u+(l.duration||0),0)/a.length):0,streakDays:uu(a),formattedTotalDuration:Ys(a.reduce((u,l)=>u+(l.duration||0),0)),formattedAverageDuration:Ys(a.length>0?Math.round(a.reduce((u,l)=>u+(l.duration||0),0)/a.length):0)};return x.set(n,c,5*60*1e3),c}catch(s){if(console.error("Training stats service error:",s.message),s.message.includes("User not authenticated")||s.message.includes("401"))return{totalSessions:0,totalDuration:0,averageDuration:0,streakDays:0,formattedTotalDuration:"0m",formattedAverageDuration:"0m"};throw s}}async getTrainingGoals(e={}){const n=`training:goals:${JSON.stringify(e)}`,r=x.get(n);if(r)return r;try{const s=this._getPocketbase();if(!s.isAuthenticated())return console.log("User not authenticated, returning empty training goals"),[];const i={page:e.page||1,perPage:e.perPage||50,sort:e.sort||"-created",filter:this.buildFilterString(e)},o=await s.getList("training_goals",i);if(o.error)throw console.error("PocketBase error fetching training goals:",o.error),new Error(`Failed to fetch training goals: ${o.error}`);return x.set(n,o.data,5*60*1e3),o.data}catch(s){if(console.error("Training goals service error:",s.message),s.message.includes("User not authenticated")||s.message.includes("401"))return[];throw s}}async createTrainingGoal(e){var n;try{const r=this._getPocketbase(),s=await r.create("training_goals",{...e,user_id:(n=r.authStore.model)==null?void 0:n.id,created:new Date().toISOString()});if(s.error)throw new Error(s.error);return x.invalidatePattern("training:goals"),s.data}catch(r){throw console.error("Failed to create training goal:",r),r}}async updateTrainingGoal(e,n){try{const r=await this._getPocketbase().update("training_goals",e,{...n,updated:new Date().toISOString()});if(r.error)throw new Error(r.error);return x.invalidatePattern("training:goals"),r.data}catch(r){throw console.error("Failed to update training goal:",r),r}}async deleteTrainingGoal(e){try{const n=await this._getPocketbase().delete("training_goals",e);if(n.error)throw new Error(n.error);return x.invalidatePattern("training:goals"),n.data}catch(n){throw console.error("Failed to delete training goal:",n),n}}buildFilterString(e){var i;const n=[],r=this._getPocketbase(),s=e.userId||((i=r.authStore.model)==null?void 0:i.id);return s&&n.push(`user_id = "${s}"`),e.dateFrom&&n.push(`created >= "${e.dateFrom}"`),e.dateTo&&n.push(`created <= "${e.dateTo}"`),e.type&&n.push(`type = "${e.type}"`),e.status&&n.push(`status = "${e.status}"`),e.filter&&n.push(e.filter),n.join(" && ")}subscribeToTrainingSessions(e){return this._getPocketbase().subscribe("training_sessions",e)}subscribeToTrainingGoals(e){return this._getPocketbase().subscribe("training_goals",e)}getMockTrainingSessions(){return[{id:"mock-1",session_type:"Agility Training",duration:45,exercises:[{name:"Cone Drills",sets:3,reps:10},{name:"Sprint Intervals",sets:4,reps:5}],notes:"Focus on quick direction changes",created:new Date(Date.now()-24*60*60*1e3).toISOString(),user_id:"mock-user"},{id:"mock-2",session_type:"Strength Training",duration:60,exercises:[{name:"Squats",sets:3,reps:12},{name:"Push-ups",sets:3,reps:15}],notes:"Great progress on form",created:new Date(Date.now()-2*24*60*60*1e3).toISOString(),user_id:"mock-user"}]}getMockTrainingGoals(){return[{id:"goal-1",title:"Improve Sprint Speed",description:"Reduce 40-yard dash time by 0.5 seconds",target_date:new Date(Date.now()+30*24*60*60*1e3).toISOString(),completed:!1,progress:25,created:new Date(Date.now()-7*24*60*60*1e3).toISOString(),user_id:"mock-user"},{id:"goal-2",title:"Increase Endurance",description:"Run 2 miles without stopping",target_date:new Date(Date.now()+45*24*60*60*1e3).toISOString(),completed:!1,progress:60,created:new Date(Date.now()-14*24*60*60*1e3).toISOString(),user_id:"mock-user"}]}getMockTrainingStats(){return{totalSessions:5,totalDuration:270,averageDuration:54,streakDays:3,formattedTotalDuration:"4h 30m",formattedAverageDuration:"54m"}}}const re=new lu,du={sessions:[],currentSession:null,isLoading:!1,error:null,stats:{totalSessions:0,totalDuration:0,averageScore:0,streakDays:0},goals:[],progress:{}},R={FETCH_SESSIONS_START:"FETCH_SESSIONS_START",FETCH_SESSIONS_SUCCESS:"FETCH_SESSIONS_SUCCESS",FETCH_SESSIONS_FAILURE:"FETCH_SESSIONS_FAILURE",CREATE_SESSION_START:"CREATE_SESSION_START",CREATE_SESSION_SUCCESS:"CREATE_SESSION_SUCCESS",CREATE_SESSION_FAILURE:"CREATE_SESSION_FAILURE",UPDATE_SESSION_START:"UPDATE_SESSION_START",UPDATE_SESSION_SUCCESS:"UPDATE_SESSION_SUCCESS",UPDATE_SESSION_FAILURE:"UPDATE_SESSION_FAILURE",DELETE_SESSION_START:"DELETE_SESSION_START",DELETE_SESSION_SUCCESS:"DELETE_SESSION_SUCCESS",DELETE_SESSION_FAILURE:"DELETE_SESSION_FAILURE",SET_CURRENT_SESSION:"SET_CURRENT_SESSION",CLEAR_CURRENT_SESSION:"CLEAR_CURRENT_SESSION",FETCH_STATS_START:"FETCH_STATS_START",FETCH_STATS_SUCCESS:"FETCH_STATS_SUCCESS",FETCH_STATS_FAILURE:"FETCH_STATS_FAILURE",FETCH_GOALS_START:"FETCH_GOALS_START",FETCH_GOALS_SUCCESS:"FETCH_GOALS_SUCCESS",FETCH_GOALS_FAILURE:"FETCH_GOALS_FAILURE",UPDATE_GOAL_START:"UPDATE_GOAL_START",UPDATE_GOAL_SUCCESS:"UPDATE_GOAL_SUCCESS",UPDATE_GOAL_FAILURE:"UPDATE_GOAL_FAILURE",CLEAR_ERROR:"CLEAR_ERROR"},pu=(t,e)=>{var n,r;switch(e.type){case R.FETCH_SESSIONS_START:case R.CREATE_SESSION_START:case R.UPDATE_SESSION_START:case R.DELETE_SESSION_START:case R.FETCH_STATS_START:case R.FETCH_GOALS_START:case R.UPDATE_GOAL_START:return{...t,isLoading:!0,error:null};case R.FETCH_SESSIONS_SUCCESS:return{...t,sessions:e.payload,isLoading:!1,error:null};case R.CREATE_SESSION_SUCCESS:return{...t,sessions:[e.payload,...t.sessions],isLoading:!1,error:null};case R.UPDATE_SESSION_SUCCESS:return{...t,sessions:t.sessions.map(s=>s.id===e.payload.id?e.payload:s),currentSession:((n=t.currentSession)==null?void 0:n.id)===e.payload.id?e.payload:t.currentSession,isLoading:!1,error:null};case R.DELETE_SESSION_SUCCESS:return{...t,sessions:t.sessions.filter(s=>s.id!==e.payload),currentSession:((r=t.currentSession)==null?void 0:r.id)===e.payload?null:t.currentSession,isLoading:!1,error:null};case R.SET_CURRENT_SESSION:return{...t,currentSession:e.payload};case R.CLEAR_CURRENT_SESSION:return{...t,currentSession:null};case R.FETCH_STATS_SUCCESS:return{...t,stats:e.payload,isLoading:!1,error:null};case R.FETCH_GOALS_SUCCESS:return{...t,goals:e.payload,isLoading:!1,error:null};case R.UPDATE_GOAL_SUCCESS:return{...t,goals:t.goals.map(s=>s.id===e.payload.id?e.payload:s),isLoading:!1,error:null};case R.FETCH_SESSIONS_FAILURE:case R.CREATE_SESSION_FAILURE:case R.UPDATE_SESSION_FAILURE:case R.DELETE_SESSION_FAILURE:case R.FETCH_STATS_FAILURE:case R.FETCH_GOALS_FAILURE:case R.UPDATE_GOAL_FAILURE:return{...t,isLoading:!1,error:e.payload};case R.CLEAR_ERROR:return{...t,error:null};default:return t}},Io=A.createContext(),fu=({children:t})=>{const[e,n]=A.useReducer(pu,du),r=A.useCallback(async(m={})=>{try{n({type:R.FETCH_SESSIONS_START});const g=await re.getSessions(m);return n({type:R.FETCH_SESSIONS_SUCCESS,payload:g}),g}catch(g){return n({type:R.FETCH_SESSIONS_FAILURE,payload:g.message}),console.error("Failed to fetch sessions:",g),[]}},[]),s=A.useCallback(async(m="all")=>{try{n({type:R.FETCH_STATS_START});const g=await re.getStats(m);return n({type:R.FETCH_STATS_SUCCESS,payload:g}),g}catch(g){return n({type:R.FETCH_STATS_FAILURE,payload:g.message}),console.error("Failed to fetch stats:",g),{totalSessions:0,totalDuration:0,averageScore:0,streakDays:0}}},[]),i=A.useCallback(async()=>{try{n({type:R.FETCH_GOALS_START});const m=await re.getGoals();return n({type:R.FETCH_GOALS_SUCCESS,payload:m}),m}catch(m){return n({type:R.FETCH_GOALS_FAILURE,payload:m.message}),console.error("Failed to fetch goals:",m),[]}},[]),{isAuthenticated:o,isLoading:a}=Vn();A.useEffect(()=>{!a&&o?(console.log("Initializing training data for authenticated user..."),(async()=>{try{await Promise.all([r(),s(),i()]),console.log("Training data initialization completed")}catch(g){console.error("Failed to initialize training data:",g)}})()):console.log("Skipping training data initialization - auth not ready:",{authLoading:a,isAuthenticated:o})},[o,a]);const y={...e,fetchSessions:r,createSession:async m=>{n({type:R.CREATE_SESSION_START});const g=await re.createSession(m);return n({type:R.CREATE_SESSION_SUCCESS,payload:g}),g},updateSession:async(m,g)=>{n({type:R.UPDATE_SESSION_START});const C=await re.updateSession(m,g);return n({type:R.UPDATE_SESSION_SUCCESS,payload:C}),C},deleteSession:async m=>{n({type:R.DELETE_SESSION_START}),await re.deleteSession(m),n({type:R.DELETE_SESSION_SUCCESS,payload:m})},setCurrentSession:m=>{n({type:R.SET_CURRENT_SESSION,payload:m})},clearCurrentSession:()=>{n({type:R.CLEAR_CURRENT_SESSION})},fetchStats:s,fetchGoals:i,updateGoal:async(m,g)=>{n({type:R.UPDATE_GOAL_START});const C=await re.updateGoal(m,g);return n({type:R.UPDATE_GOAL_SUCCESS,payload:C}),C},createGoal:async m=>{n({type:R.UPDATE_GOAL_START});const g=await re.createGoal(m);return n({type:R.UPDATE_GOAL_SUCCESS,payload:g}),g},deleteGoal:async m=>{n({type:R.UPDATE_GOAL_START}),await re.deleteGoal(m),await i()},getSessionById:async m=>await re.getSessionById(m),getRecommendedDrills:async(m={})=>await re.getRecommendedDrills(m),clearError:()=>{n({type:R.CLEAR_ERROR})}};return S.jsx(Io.Provider,{value:y,children:t})},B_=()=>{const t=A.useContext(Io);if(!t)throw new Error("useTraining must be used within a TrainingProvider");return t};class hu{constructor(){this.pocketbase=null,this.config=null}_getPocketbase(){return this.pocketbase||(this.pocketbase=bo),this.pocketbase}_getConfig(){return this.config||(this.config={pocketbaseUrl:"http://127.0.0.1:8090",apiTimeout:3e4,cacheTTL:5*60*1e3,maxRetries:3}),this.config}async trackEvent(e){var n;try{const r=await this._getPocketbase().create("analytics_events",{event_type:e.type,event_data:e,user_id:(n=this._getPocketbase().authStore.model)==null?void 0:n.id,session_id:e.sessionId,timestamp:e.timestamp||new Date().toISOString(),page_url:e.pageUrl,user_agent:e.userAgent});if(r.error)throw new Error(r.error);return r.data}catch(r){throw new Error(`Failed to track event: ${r.message}`)}}async getEvents(e={}){try{const n=this._getPocketbase();if(!n.isAuthenticated())return console.log("User not authenticated, returning empty analytics events"),[];const r=`analytics:events:${JSON.stringify(e)}`,s=x.get(r);if(s)return s;const i={page:e.page||1,perPage:e.perPage||50,sort:e.sort||"-timestamp",filter:this.buildEventFilterString(e)},o=await n.getList("analytics_events",i);if(o.error)throw console.error("PocketBase error fetching analytics events:",o.error),new Error(`Failed to fetch analytics events: ${o.error}`);return x.set(r,o.data,2*60*1e3),o.data}catch(n){return console.warn("Analytics events service error (returning empty array):",n.message),[]}}async getMetrics(e="7d"){try{const n=`analytics:metrics:${e}`,r=x.get(n);if(r)return r;const s=this.getStartDateForTimeframe(e),i=s?`timestamp >= "${s.toISOString()}"`:"",o=await this.getEvents({filter:i}),a={pageViews:o.filter(c=>c.event_type==="page_view").length,uniqueUsers:new Set(o.map(c=>c.user_id).filter(Boolean)).size,sessionDuration:this.calculateAverageSessionDuration(o),conversionRate:this.calculateConversionRate(o)};return x.set(n,a,5*60*1e3),a}catch(n){return console.warn("Analytics metrics service error (returning empty metrics):",n.message),{pageViews:0,uniqueUsers:0,sessionDuration:0,conversionRate:0}}}calculateAverageSessionDuration(e){const n={};e.forEach(s=>{n[s.session_id]||(n[s.session_id]={start:null,end:null});const i=new Date(s.timestamp);(!n[s.session_id].start||i<n[s.session_id].start)&&(n[s.session_id].start=i),(!n[s.session_id].end||i>n[s.session_id].end)&&(n[s.session_id].end=i)});const r=Object.values(n).filter(s=>s.start&&s.end).map(s=>s.end-s.start);return r.length>0?r.reduce((s,i)=>s+i,0)/r.length:0}calculateConversionRate(e){const n=new Set(e.map(s=>s.user_id).filter(Boolean)).size,r=new Set(e.filter(s=>s.event_type==="conversion").map(s=>s.user_id).filter(Boolean)).size;return n>0?r/n*100:0}async getUserBehavior(e={}){try{const n=`analytics:behavior:${JSON.stringify(e)}`,r=x.get(n);if(r)return r;const s=await this.getEvents({...e,eventType:"page_view"}),i={mostVisitedPages:this.getMostVisitedPages(s),userJourney:this.getUserJourney(s),dropoffPoints:this.getDropoffPoints(s)};return x.set(n,i,10*60*1e3),i}catch(n){return console.warn("Analytics user behavior service error (returning empty behavior):",n.message),{mostVisitedPages:[],userJourney:[],dropoffPoints:[]}}}getMostVisitedPages(e){const n={};return e.forEach(r=>{var i;const s=((i=r.event_data)==null?void 0:i.pageUrl)||"unknown";n[s]=(n[s]||0)+1}),Object.entries(n).map(([r,s])=>({page:r,count:s})).sort((r,s)=>s.count-r.count).slice(0,10)}getUserJourney(e){const n={};return e.forEach(r=>{var i;const s=r.user_id;n[s]||(n[s]=[]),n[s].push({page:((i=r.event_data)==null?void 0:i.pageUrl)||"unknown",timestamp:r.timestamp})}),Object.values(n).filter(r=>r.length>1).slice(0,50)}getDropoffPoints(e){const n={},r={},s={};return e.forEach(i=>{var u;const o=i.session_id,a=i.user_id,c=((u=i.event_data)==null?void 0:u.pageUrl)||"unknown";s[o]||(s[o]=[]),s[o].push({page:c,timestamp:i.timestamp,userId:a}),r[c]=(r[c]||0)+1}),Object.values(s).forEach(i=>{var o;i.sort((a,c)=>new Date(a.timestamp)-new Date(c.timestamp));for(let a=0;a<i.length;a++){const c=i[a].page;((o=i[a+1])==null?void 0:o.page)||(n[c]=(n[c]||0)+1)}}),Object.entries(r).map(([i,o])=>{const a=n[i]||0,c=o>0?a/o*100:0;return{page:i,entrances:o,exits:a,dropoffRate:Math.round(c*100)/100}}).sort((i,o)=>o.dropoffRate-i.dropoffRate).slice(0,10)}async getPerformance(e="7d"){try{const n=`analytics:performance:${e}`,r=x.get(n);if(r)return r;const s=await this.getEvents({eventType:"performance",timeframe:e}),i={loadTimes:s.map(o=>{var a;return((a=o.event_data)==null?void 0:a.loadTime)||0}),errorRates:this.calculateErrorRates(s),apiResponseTimes:s.map(o=>{var a;return((a=o.event_data)==null?void 0:a.apiResponseTime)||0})};return x.set(n,i,5*60*1e3),i}catch(n){return console.warn("Analytics performance service error (returning empty performance):",n.message),{loadTimes:[],errorRates:[],apiResponseTimes:[]}}}calculateErrorRates(e){const n=e.length,r=e.filter(s=>{var i;return(i=s.event_data)==null?void 0:i.hasError}).length;return n>0?r/n*100:0}async getConversionFunnel(e){const n=`analytics:funnel:${e}`,r=x.get(n);if(r)return r;try{const s=await this._getPocketbase().getOne("conversion_funnels",e);if(s.error)throw new Error(s.error);return x.set(n,s.data,15*60*1e3),s.data}catch(s){throw new Error(`Failed to fetch conversion funnel: ${s.message}`)}}async getABTestResults(e){const n=`analytics:ab_test:${e}`,r=x.get(n);if(r)return r;try{const s=await this._getPocketbase().getList("ab_test_results",{filter:`test_id = "${e}"`});if(s.error)throw new Error(s.error);return x.set(n,s.data,10*60*1e3),s.data}catch(s){throw new Error(`Failed to fetch A/B test results: ${s.message}`)}}async exportData(e="csv",n={}){try{const r=await this.getEvents(n);return e==="csv"?[["timestamp","event_type","user_id","page_url","event_data"].join(","),...r.map(o=>[o.timestamp,o.event_type,o.user_id,o.page_url,JSON.stringify(o.event_data)].join(","))].join(`
`):r}catch(r){throw new Error(`Failed to export data: ${r.message}`)}}buildEventFilterString(e){var i;const n=[],r=this._getPocketbase(),s=e.userId||((i=r.authStore.model)==null?void 0:i.id);return s&&n.push(`user_id = "${s}"`),e.eventType&&e.eventType!=="all"&&n.push(`event_type = "${e.eventType}"`),e.dateFrom&&n.push(`timestamp >= "${e.dateFrom}"`),e.dateTo&&n.push(`timestamp <= "${e.dateTo}"`),e.filter&&n.push(e.filter),n.join(" && ")}getStartDateForTimeframe(e){const n=new Date;switch(e){case"1d":return new Date(n.getTime()-24*60*60*1e3);case"7d":return new Date(n.getTime()-7*24*60*60*1e3);case"30d":return new Date(n.getTime()-30*24*60*60*1e3);case"90d":return new Date(n.getTime()-90*24*60*60*1e3);case"all":return null;default:return new Date(n.getTime()-7*24*60*60*1e3)}}getMockAnalyticsEvents(){return[{id:"event-1",event_type:"performance",event_data:{metric:"sprint_time",value:4.2,unit:"seconds"},timestamp:new Date(Date.now()-2*60*60*1e3).toISOString(),user_id:"mock-user"},{id:"event-2",event_type:"training_session",event_data:{session_type:"agility",duration:45,exercises_completed:8},timestamp:new Date(Date.now()-24*60*60*1e3).toISOString(),user_id:"mock-user"}]}}const Re=new hu,gu={events:[],metrics:{pageViews:0,uniqueUsers:0,sessionDuration:0,conversionRate:0},userBehavior:{mostVisitedPages:[],userJourney:[],dropoffPoints:[]},performance:{loadTimes:[],errorRates:[],apiResponseTimes:[]},isLoading:!1,error:null,filters:{dateRange:"7d",eventType:"all",userId:null}},N={FETCH_EVENTS_START:"FETCH_EVENTS_START",FETCH_EVENTS_SUCCESS:"FETCH_EVENTS_SUCCESS",FETCH_EVENTS_FAILURE:"FETCH_EVENTS_FAILURE",TRACK_EVENT_START:"TRACK_EVENT_START",TRACK_EVENT_SUCCESS:"TRACK_EVENT_SUCCESS",TRACK_EVENT_FAILURE:"TRACK_EVENT_FAILURE",FETCH_METRICS_START:"FETCH_METRICS_START",FETCH_METRICS_SUCCESS:"FETCH_METRICS_SUCCESS",FETCH_METRICS_FAILURE:"FETCH_METRICS_FAILURE",FETCH_USER_BEHAVIOR_START:"FETCH_USER_BEHAVIOR_START",FETCH_USER_BEHAVIOR_SUCCESS:"FETCH_USER_BEHAVIOR_SUCCESS",FETCH_USER_BEHAVIOR_FAILURE:"FETCH_USER_BEHAVIOR_FAILURE",FETCH_PERFORMANCE_START:"FETCH_PERFORMANCE_START",FETCH_PERFORMANCE_SUCCESS:"FETCH_PERFORMANCE_SUCCESS",FETCH_PERFORMANCE_FAILURE:"FETCH_PERFORMANCE_FAILURE",SET_FILTERS:"SET_FILTERS",CLEAR_FILTERS:"CLEAR_FILTERS",CLEAR_ERROR:"CLEAR_ERROR"},mu=(t,e)=>{switch(e.type){case N.FETCH_EVENTS_START:case N.TRACK_EVENT_START:case N.FETCH_METRICS_START:case N.FETCH_USER_BEHAVIOR_START:case N.FETCH_PERFORMANCE_START:return{...t,isLoading:!0,error:null};case N.FETCH_EVENTS_SUCCESS:return{...t,events:e.payload,isLoading:!1,error:null};case N.TRACK_EVENT_SUCCESS:return{...t,events:[e.payload,...t.events],isLoading:!1,error:null};case N.FETCH_METRICS_SUCCESS:return{...t,metrics:e.payload,isLoading:!1,error:null};case N.FETCH_USER_BEHAVIOR_SUCCESS:return{...t,userBehavior:e.payload,isLoading:!1,error:null};case N.FETCH_PERFORMANCE_SUCCESS:return{...t,performance:e.payload,isLoading:!1,error:null};case N.SET_FILTERS:return{...t,filters:{...t.filters,...e.payload}};case N.CLEAR_FILTERS:return{...t,filters:{dateRange:"7d",eventType:"all",userId:null}};case N.FETCH_EVENTS_FAILURE:case N.TRACK_EVENT_FAILURE:case N.FETCH_METRICS_FAILURE:case N.FETCH_USER_BEHAVIOR_FAILURE:case N.FETCH_PERFORMANCE_FAILURE:return{...t,isLoading:!1,error:e.payload};case N.CLEAR_ERROR:return{...t,error:null};default:return t}},vo=A.createContext(),_u=({children:t})=>{const[e,n]=A.useReducer(mu,gu),{isAuthenticated:r,isLoading:s}=Vn();A.useEffect(()=>{!s&&r?(console.log("Initializing analytics data for authenticated user..."),(async()=>{try{await Promise.all([a(),c(),u()]),console.log("Analytics data initialization completed")}catch(g){console.error("Failed to initialize analytics data:",g)}})()):console.log("Skipping analytics data initialization - auth not ready:",{authLoading:s,isAuthenticated:r})},[r,s]);const i=async(m={})=>{try{n({type:N.FETCH_EVENTS_START});const g=await Re.getEvents(m);return n({type:N.FETCH_EVENTS_SUCCESS,payload:g}),g}catch(g){throw n({type:N.FETCH_EVENTS_FAILURE,payload:g.message}),g}},o=async m=>{try{n({type:N.TRACK_EVENT_START});const g=await Re.trackEvent(m);return n({type:N.TRACK_EVENT_SUCCESS,payload:g}),g}catch(g){throw n({type:N.TRACK_EVENT_FAILURE,payload:g.message}),g}},a=async(m="7d")=>{try{n({type:N.FETCH_METRICS_START});const g=await Re.getMetrics(m);return n({type:N.FETCH_METRICS_SUCCESS,payload:g}),g}catch(g){throw n({type:N.FETCH_METRICS_FAILURE,payload:g.message}),g}},c=async(m={})=>{try{n({type:N.FETCH_USER_BEHAVIOR_START});const g=await Re.getUserBehavior(m);return n({type:N.FETCH_USER_BEHAVIOR_SUCCESS,payload:g}),g}catch(g){throw n({type:N.FETCH_USER_BEHAVIOR_FAILURE,payload:g.message}),g}},u=async(m="7d")=>{try{n({type:N.FETCH_PERFORMANCE_START});const g=await Re.getPerformance(m);return n({type:N.FETCH_PERFORMANCE_SUCCESS,payload:g}),g}catch(g){throw n({type:N.FETCH_PERFORMANCE_FAILURE,payload:g.message}),g}},y={...e,fetchEvents:i,trackEvent:o,fetchMetrics:a,fetchUserBehavior:c,fetchPerformance:u,setFilters:m=>{n({type:N.SET_FILTERS,payload:m})},clearFilters:()=>{n({type:N.CLEAR_FILTERS})},trackPageView:async m=>{try{const g={type:"page_view",timestamp:new Date().toISOString(),...m};await o(g)}catch(g){console.error("Failed to track page view:",g)}},trackInteraction:async m=>{try{const g={type:"user_interaction",timestamp:new Date().toISOString(),...m};await o(g)}catch(g){console.error("Failed to track interaction:",g)}},trackPerformance:async m=>{try{const g={type:"performance",timestamp:new Date().toISOString(),...m};await o(g)}catch(g){console.error("Failed to track performance:",g)}},getConversionFunnel:async m=>Re.getConversionFunnel(m),getABTestResults:async m=>Re.getABTestResults(m),exportData:async(m="csv",g={})=>Re.exportData(m,g),clearError:()=>{n({type:N.CLEAR_ERROR})}};return S.jsx(vo.Provider,{value:y,children:t})},q_=()=>{const t=A.useContext(vo);if(!t)throw new Error("useAnalytics must be used within an AnalyticsProvider");return t};var Su=function(){return null};const Eu=new Pc({defaultOptions:{queries:{staleTime:5*60*1e3,gcTime:10*60*1e3,retry:(t,e)=>(e==null?void 0:e.status)===404?!1:t<3,refetchOnWindowFocus:!1},mutations:{retry:!1}}}),yu=({children:t})=>S.jsxs(Lc,{client:Eu,children:[t,S.jsx(Su,{initialIsOpen:!1})]}),Tu=()=>{const[t,e]=A.useState(navigator.onLine),[n,r]=A.useState("unknown"),[s,i]=A.useState(null);return A.useEffect(()=>{const o=()=>{e(navigator.onLine)},a=()=>{if("connection"in navigator){const c=navigator.connection;switch(i({effectiveType:c.effectiveType,downlink:c.downlink,rtt:c.rtt,saveData:c.saveData}),c.effectiveType){case"4g":r("excellent");break;case"3g":r("good");break;case"2g":r("poor");break;case"slow-2g":r("very-poor");break;default:r("unknown")}}};return a(),window.addEventListener("online",o),window.addEventListener("offline",o),"connection"in navigator&&navigator.connection.addEventListener("change",a),()=>{window.removeEventListener("online",o),window.removeEventListener("offline",o),"connection"in navigator&&navigator.connection.removeEventListener("change",a)}},[]),{isOnline:t,networkQuality:n,connectionInfo:s}},jt=new Map,ln=t=>{const e=jt.get(t);return e?Object.fromEntries(Object.entries(e.stores).map(([n,r])=>[n,r.getState()])):{}},bu=(t,e,n)=>{if(t===void 0)return{type:"untracked",connection:e.connect(n)};const r=jt.get(n.name);if(r)return{type:"tracked",store:t,...r};const s={connection:e.connect(n),stores:{}};return jt.set(n.name,s),{type:"tracked",store:t,...s}},Iu=(t,e)=>{if(e===void 0)return;const n=jt.get(t);n&&(delete n.stores[e],Object.keys(n.stores).length===0&&jt.delete(t))},vu=t=>{var e,n;if(!t)return;const r=t.split(`
`),s=r.findIndex(o=>o.includes("api.setState"));if(s<0)return;const i=((e=r[s+1])==null?void 0:e.trim())||"";return(n=/.+ (.+) .+/.exec(i))==null?void 0:n[1]},Ru=(t,e={})=>(n,r,s)=>{const{enabled:i,anonymousActionType:o,store:a,...c}=e;let u;try{u=(i??!1)&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!u)return t(n,r,s);const{connection:l,...d}=bu(a,u,c);let p=!0;s.setState=(h,b,v)=>{const E=n(h,b);if(!p)return E;const y=v===void 0?{type:o||vu(new Error().stack)||"anonymous"}:typeof v=="string"?{type:v}:v;return a===void 0?(l==null||l.send(y,r()),E):(l==null||l.send({...y,type:`${a}/${y.type}`},{...ln(c.name),[a]:s.getState()}),E)},s.devtools={cleanup:()=>{l&&typeof l.unsubscribe=="function"&&l.unsubscribe(),Iu(c.name,a)}};const f=(...h)=>{const b=p;p=!1,n(...h),p=b},_=t(s.setState,r,s);if(d.type==="untracked"?l==null||l.init(_):(d.stores[d.store]=s,l==null||l.init(Object.fromEntries(Object.entries(d.stores).map(([h,b])=>[h,h===d.store?_:b.getState()])))),s.dispatchFromDevtools&&typeof s.dispatch=="function"){let h=!1;const b=s.dispatch;s.dispatch=(...v)=>{b(...v)}}return l.subscribe(h=>{var b;switch(h.type){case"ACTION":if(typeof h.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return or(h.payload,v=>{if(v.type==="__setState"){if(a===void 0){f(v.state);return}Object.keys(v.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const E=v.state[a];if(E==null)return;JSON.stringify(s.getState())!==JSON.stringify(E)&&f(E);return}s.dispatchFromDevtools&&typeof s.dispatch=="function"&&s.dispatch(v)});case"DISPATCH":switch(h.payload.type){case"RESET":return f(_),a===void 0?l==null?void 0:l.init(s.getState()):l==null?void 0:l.init(ln(c.name));case"COMMIT":if(a===void 0){l==null||l.init(s.getState());return}return l==null?void 0:l.init(ln(c.name));case"ROLLBACK":return or(h.state,v=>{if(a===void 0){f(v),l==null||l.init(s.getState());return}f(v[a]),l==null||l.init(ln(c.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return or(h.state,v=>{if(a===void 0){f(v);return}JSON.stringify(s.getState())!==JSON.stringify(v[a])&&f(v[a])});case"IMPORT_STATE":{const{nextLiftedState:v}=h.payload,E=(b=v.computedStates.slice(-1)[0])==null?void 0:b.state;if(!E)return;f(a===void 0?E:E[a]),l==null||l.send(null,v);return}case"PAUSE_RECORDING":return p=!p}return}}),_},wu=Ru,or=(t,e)=>{let n;try{n=JSON.parse(t)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}n!==void 0&&e(n)};function Cu(t,e){let n;try{n=t()}catch{return}return{getItem:s=>{var i;const o=c=>c===null?null:JSON.parse(c,e==null?void 0:e.reviver),a=(i=n.getItem(s))!=null?i:null;return a instanceof Promise?a.then(o):o(a)},setItem:(s,i)=>n.setItem(s,JSON.stringify(i,e==null?void 0:e.replacer)),removeItem:s=>n.removeItem(s)}}const Or=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return Or(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return Or(r)(n)}}}},Au=(t,e)=>(n,r,s)=>{let i={storage:Cu(()=>localStorage),partialize:h=>h,version:0,merge:(h,b)=>({...b,...h}),...e},o=!1;const a=new Set,c=new Set;let u=i.storage;if(!u)return t((...h)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...h)},r,s);const l=()=>{const h=i.partialize({...r()});return u.setItem(i.name,{state:h,version:i.version})},d=s.setState;s.setState=(h,b)=>{d(h,b),l()};const p=t((...h)=>{n(...h),l()},r,s);s.getInitialState=()=>p;let f;const _=()=>{var h,b;if(!u)return;o=!1,a.forEach(E=>{var y;return E((y=r())!=null?y:p)});const v=((b=i.onRehydrateStorage)==null?void 0:b.call(i,(h=r())!=null?h:p))||void 0;return Or(u.getItem.bind(u))(i.name).then(E=>{if(E)if(typeof E.version=="number"&&E.version!==i.version){if(i.migrate){const y=i.migrate(E.state,E.version);return y instanceof Promise?y.then(m=>[!0,m]):[!0,y]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,E.state];return[!1,void 0]}).then(E=>{var y;const[m,g]=E;if(f=i.merge(g,(y=r())!=null?y:p),n(f,!0),m)return l()}).then(()=>{v==null||v(f,void 0),f=r(),o=!0,c.forEach(E=>E(f))}).catch(E=>{v==null||v(void 0,E)})};return s.persist={setOptions:h=>{i={...i,...h},h.storage&&(u=h.storage)},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>_(),hasHydrated:()=>o,onHydrate:h=>(a.add(h),()=>{a.delete(h)}),onFinishHydration:h=>(c.add(h),()=>{c.delete(h)})},i.skipHydration||_(),f||p},Ou=Au,Nu=Fc()(wu(Ou((t,e)=>({user:null,isAuthenticated:!1,theme:"light",currentProgram:null,sessions:[],loading:!1,errors:[],setUser:n=>t({user:n,isAuthenticated:!!n}),clearUser:()=>t({user:null,isAuthenticated:!1}),setTheme:n=>t({theme:n}),toggleTheme:()=>t(n=>({theme:n.theme==="light"?"dark":"light"})),setCurrentProgram:n=>t({currentProgram:n}),setSessions:n=>t({sessions:n}),addSession:n=>t(r=>({sessions:[...r.sessions,n]})),updateSession:(n,r)=>t(s=>({sessions:s.sessions.map(i=>i.id===n?{...i,...r}:i)})),removeSession:n=>t(r=>({sessions:r.sessions.filter(s=>s.id!==n)})),setLoading:n=>t({loading:n}),addError:n=>t(r=>({errors:[...r.errors,{id:Date.now(),message:n}]})),removeError:n=>t(r=>({errors:r.errors.filter(s=>s.id!==n)})),clearErrors:()=>t({errors:[]}),get isLoading(){return e().loading},get hasErrors(){return e().errors.length>0},get isDarkMode(){return e().theme==="dark"}}),{name:"flagfit-app-store",partialize:t=>({theme:t.theme,user:t.user,isAuthenticated:t.isAuthenticated,currentProgram:t.currentProgram})}),{name:"flagfit-app-store"})),Gn=es.memo(({size:t="md",className:e=""})=>{const n={sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12",xl:"w-16 h-16"};return S.jsx("div",{className:`flex justify-center items-center ${e}`,children:S.jsx("div",{className:`${n[t]} border-4 border-gray-200 border-t-green-600 rounded-full animate-spin`,role:"status","aria-label":"Loading",children:S.jsx("span",{className:"sr-only",children:"Loading..."})})})});Gn.displayName="LoadingSpinner";const ku=()=>S.jsx("div",{className:"bg-yellow-500 text-white px-4 py-2 text-center text-sm font-medium",children:S.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[S.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),S.jsx("span",{children:"You are currently offline. Some features may be limited."})]})});class Pu{constructor(){this.config=this.loadConfig(),this.validateConfig()}loadConfig(){return{app:{name:"FlagFit Pro",version:"1.0.0",environment:"development"},api:{pocketbaseUrl:"http://127.0.0.1:8090",timeout:parseInt("30000")||3e4,cacheTTL:parseInt("300000")||3e5,baseUrl:"http://localhost:3001",aiServiceUrl:"http://localhost:8080"},features:{analytics:!1,pushNotifications:!0,wearableSync:!1},dev:{devMode:!0,debugLogging:!1},sentry:{dsn:null,environment:{}.VITE_SENTRY_ENVIRONMENT||"development"}}}validateConfig(){const e=[];this.isValidUrl(this.config.api.pocketbaseUrl)||e.push("VITE_POCKETBASE_URL must be a valid URL"),this.config.api.timeout<1e3&&e.push("VITE_API_TIMEOUT must be at least 1000ms"),this.config.api.cacheTTL<6e4&&e.push("VITE_CACHE_TTL must be at least 60000ms (1 minute)");const n=["development","staging","production"];if(n.includes(this.config.app.environment)||e.push(`VITE_APP_ENVIRONMENT must be one of: ${n.join(", ")}`),e.length>0&&(console.error("Environment configuration errors:",e),this.config.app.environment==="production"))throw new Error(`Invalid environment configuration: ${e.join(", ")}`)}isValidUrl(e){try{return new URL(e),!0}catch{return!1}}isValidSentryDsn(e){return/^https:\/\/[a-f0-9]+@[a-z0-9.-]+\/\d+$/.test(e)}get isProduction(){return this.config.app.environment==="production"}get isDevelopment(){return this.config.app.environment==="development"}get isStaging(){return this.config.app.environment==="staging"}get debugMode(){return this.config.dev.devMode&&this.config.dev.debugLogging}getConfig(){return this.config}getSection(e){return this.config[e]}}const de=new Pu,Me={ERROR:0,WARN:1,INFO:2,DEBUG:3};class Lu{constructor(){ut(this,"consoleTransport",e=>{const{level:n,message:r,meta:s}=e,i=this.getConsoleStyle(n);console.groupCollapsed(`%c[${n}] ${r}`,i),console.log("Timestamp:",e.timestamp),console.log("Meta:",s),console.groupEnd()});ut(this,"localStorageTransport",e=>{try{const n=JSON.parse(localStorage.getItem("app_logs")||"[]");n.push(e),n.length>100&&n.splice(0,n.length-100),localStorage.setItem("app_logs",JSON.stringify(n))}catch(n){console.warn("Failed to save log to localStorage:",n)}});ut(this,"remoteTransport",async e=>{try{await fetch("/api/logs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(n){console.warn("Failed to send log to remote endpoint:",n)}});this.logLevel=de.debugMode?Me.DEBUG:Me.INFO,this.transports=new Set,this.setupDefaultTransports()}setupDefaultTransports(){(de.isDevelopment||de.debugMode)&&this.addTransport("console",this.consoleTransport),de.isProduction&&this.addTransport("remote",this.remoteTransport),this.addTransport("localStorage",this.localStorageTransport)}addTransport(e,n){this.transports.add({name:e,transport:n})}removeTransport(e){this.transports=new Set([...this.transports].filter(n=>n.name!==e))}log(e,n,r={}){if(e>this.logLevel)return;const s={timestamp:new Date().toISOString(),level:Object.keys(Me)[e],message:n,meta:{...r,userAgent:navigator.userAgent,url:window.location.href,userId:this.getCurrentUserId(),sessionId:this.getSessionId(),buildVersion:de.getConfig().app.version}};this.transports.forEach(({transport:i})=>{try{i(s)}catch(o){console.error("Logging transport failed:",o),this.consoleTransport(s)}})}error(e,n={}){this.log(Me.ERROR,e,n)}warn(e,n={}){this.log(Me.WARN,e,n)}info(e,n={}){this.log(Me.INFO,e,n)}debug(e,n={}){this.log(Me.DEBUG,e,n)}getConsoleStyle(e){const n={ERROR:"color: #ff6b6b; font-weight: bold;",WARN:"color: #feca57; font-weight: bold;",INFO:"color: #48dbfb; font-weight: bold;",DEBUG:"color: #ff9ff3; font-weight: bold;"};return n[e]||n.INFO}getCurrentUserId(){var e;try{return((e=JSON.parse(localStorage.getItem("pocketbase_auth")||"{}").model)==null?void 0:e.id)||"anonymous"}catch{return"anonymous"}}getSessionId(){return sessionStorage.getItem("session_id")||sessionStorage.setItem("session_id",this.generateSessionId()),sessionStorage.getItem("session_id")}generateSessionId(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}startTimer(e){const n=performance.now();return{end:()=>{const r=performance.now()-n;return this.debug(`Timer [${e}]`,{duration:`${r.toFixed(2)}ms`}),r}}}logRequest(e,n,r,s){const i={url:e,method:n,status:r,duration:s};r>=400?this.error(`HTTP ${r} - ${n} ${e}`,i):r>=300?this.warn(`HTTP ${r} - ${n} ${e}`,i):this.debug(`HTTP ${r} - ${n} ${e}`,i)}logUserAction(e,n,r={}){this.info(`User Action: ${e}`,{action:e,target:n,...r})}logError(e,n=""){this.error(`${n?`${n}: `:""}${e.message}`,{stack:e.stack,name:e.name,context:n})}getStoredLogs(){try{return JSON.parse(localStorage.getItem("app_logs")||"[]")}catch{return[]}}clearStoredLogs(){localStorage.removeItem("app_logs")}}const je=new Lu,I=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,k=globalThis,Be="9.38.0";function tt(){return zn(k),k}function zn(t){const e=t.__SENTRY__=t.__SENTRY__||{};return e.version=e.version||Be,e[Be]=e[Be]||{}}function Wn(t,e,n=k){const r=n.__SENTRY__=n.__SENTRY__||{},s=r[Be]=r[Be]||{};return s[t]||(s[t]=e())}const xu=["debug","info","warn","error","log","assert","trace"],$u="Sentry Logger ",An={};function bt(t){if(!("console"in k))return t();const e=k.console,n={},r=Object.keys(An);r.forEach(s=>{const i=An[s];n[s]=e[s],e[s]=i});try{return t()}finally{r.forEach(s=>{e[s]=n[s]})}}function Ro(){os().enabled=!0}function wo(){os().enabled=!1}function is(){return os().enabled}function Co(...t){nt("log",...t)}function Du(...t){nt("info",...t)}function Ao(...t){nt("warn",...t)}function Oo(...t){nt("error",...t)}function Fu(...t){nt("debug",...t)}function Uu(...t){nt("assert",...t)}function Mu(...t){nt("trace",...t)}function nt(t,...e){I&&is()&&bt(()=>{k.console[t](`${$u}[${t}]:`,...e)})}function os(){return I?Wn("loggerSettings",()=>({enabled:!1})):{enabled:!1}}const ee={enable:Ro,disable:wo,isEnabled:is,log:Co,info:Du,warn:Ao,error:Oo,debug:Fu,assert:Uu,trace:Mu},T={enable:Ro,disable:wo,isEnabled:is,log:Co,warn:Ao,error:Oo},No=50,Ke="?",Js=/\(error: (.*)\)/,Xs=/captureMessage|captureException/;function ko(...t){const e=t.sort((n,r)=>n[0]-r[0]).map(n=>n[1]);return(n,r=0,s=0)=>{const i=[],o=n.split(`
`);for(let a=r;a<o.length;a++){const c=o[a];if(c.length>1024)continue;const u=Js.test(c)?c.replace(Js,"$1"):c;if(!u.match(/\S*Error: /)){for(const l of e){const d=l(u);if(d){i.push(d);break}}if(i.length>=No+s)break}}return Hu(i.slice(s))}}function ju(t){return Array.isArray(t)?ko(...t):t}function Hu(t){if(!t.length)return[];const e=Array.from(t);return/sentryWrapped/.test(dn(e).function||"")&&e.pop(),e.reverse(),Xs.test(dn(e).function||"")&&(e.pop(),Xs.test(dn(e).function||"")&&e.pop()),e.slice(0,No).map(n=>({...n,filename:n.filename||dn(e).filename,function:n.function||Ke}))}function dn(t){return t[t.length-1]||{}}const ar="<anonymous>";function Ae(t){try{return!t||typeof t!="function"?ar:t.name||ar}catch{return ar}}function Qs(t){const e=t.exception;if(e){const n=[];try{return e.values.forEach(r=>{r.stacktrace.frames&&n.push(...r.stacktrace.frames)}),n}catch{return}}}const yn={},Zs={};function Jt(t,e){yn[t]=yn[t]||[],yn[t].push(e)}function Xt(t,e){if(!Zs[t]){Zs[t]=!0;try{e()}catch(n){I&&T.error(`Error while instrumenting ${t}`,n)}}}function qe(t,e){const n=t&&yn[t];if(n)for(const r of n)try{r(e)}catch(s){I&&T.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${Ae(r)}
Error:`,s)}}let cr=null;function Po(t){const e="error";Jt(e,t),Xt(e,Bu)}function Bu(){cr=k.onerror,k.onerror=function(t,e,n,r,s){return qe("error",{column:r,error:s,line:n,msg:t,url:e}),cr?cr.apply(this,arguments):!1},k.onerror.__SENTRY_INSTRUMENTED__=!0}let ur=null;function Lo(t){const e="unhandledrejection";Jt(e,t),Xt(e,qu)}function qu(){ur=k.onunhandledrejection,k.onunhandledrejection=function(t){return qe("unhandledrejection",t),ur?ur.apply(this,arguments):!0},k.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const xo=Object.prototype.toString;function as(t){switch(xo.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return me(t,Error)}}function It(t,e){return xo.call(t)===`[object ${e}]`}function $o(t){return It(t,"ErrorEvent")}function ei(t){return It(t,"DOMError")}function Vu(t){return It(t,"DOMException")}function Ht(t){return It(t,"String")}function cs(t){return typeof t=="object"&&t!==null&&"__sentry_template_string__"in t&&"__sentry_template_values__"in t}function us(t){return t===null||cs(t)||typeof t!="object"&&typeof t!="function"}function Bt(t){return It(t,"Object")}function Kn(t){return typeof Event<"u"&&me(t,Event)}function Gu(t){return typeof Element<"u"&&me(t,Element)}function zu(t){return It(t,"RegExp")}function Yn(t){return!!(t!=null&&t.then&&typeof t.then=="function")}function Wu(t){return Bt(t)&&"nativeEvent"in t&&"preventDefault"in t&&"stopPropagation"in t}function me(t,e){try{return t instanceof e}catch{return!1}}function Do(t){return!!(typeof t=="object"&&t!==null&&(t.__isVue||t._isVue))}function Fo(t){return typeof Request<"u"&&me(t,Request)}const ls=k,Ku=80;function Uo(t,e={}){if(!t)return"<unknown>";try{let n=t;const r=5,s=[];let i=0,o=0;const a=" > ",c=a.length;let u;const l=Array.isArray(e)?e:e.keyAttrs,d=!Array.isArray(e)&&e.maxStringLength||Ku;for(;n&&i++<r&&(u=Yu(n,l),!(u==="html"||i>1&&o+s.length*c+u.length>=d));)s.push(u),o+=u.length,n=n.parentNode;return s.reverse().join(a)}catch{return"<unknown>"}}function Yu(t,e){const n=t,r=[];if(!(n!=null&&n.tagName))return"";if(ls.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const s=e!=null&&e.length?e.filter(o=>n.getAttribute(o)).map(o=>[o,n.getAttribute(o)]):null;if(s!=null&&s.length)s.forEach(o=>{r.push(`[${o[0]}="${o[1]}"]`)});else{n.id&&r.push(`#${n.id}`);const o=n.className;if(o&&Ht(o)){const a=o.split(/\s+/);for(const c of a)r.push(`.${c}`)}}const i=["aria-label","type","name","title","alt"];for(const o of i){const a=n.getAttribute(o);a&&r.push(`[${o}="${a}"]`)}return r.join("")}function Qt(){try{return ls.document.location.href}catch{return""}}function Ju(t){if(!ls.HTMLElement)return null;let e=t;const n=5;for(let r=0;r<n;r++){if(!e)return null;if(e instanceof HTMLElement){if(e.dataset.sentryComponent)return e.dataset.sentryComponent;if(e.dataset.sentryElement)return e.dataset.sentryElement}e=e.parentNode}return null}function On(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:`${t.slice(0,e)}...`}function ti(t,e){if(!Array.isArray(t))return"";const n=[];for(let r=0;r<t.length;r++){const s=t[r];try{Do(s)?n.push("[VueViewModel]"):n.push(String(s))}catch{n.push("[value cannot be serialized]")}}return n.join(e)}function Xu(t,e,n=!1){return Ht(t)?zu(e)?e.test(t):Ht(e)?n?t===e:t.includes(e):!1:!1}function Ve(t,e=[],n=!1){return e.some(r=>Xu(t,r,n))}function he(t,e,n){if(!(e in t))return;const r=t[e];if(typeof r!="function")return;const s=n(r);typeof s=="function"&&Mo(s,r);try{t[e]=s}catch{I&&T.log(`Failed to replace method "${e}" in object`,t)}}function oe(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch{I&&T.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function Mo(t,e){try{const n=e.prototype||{};t.prototype=e.prototype=n,oe(t,"__sentry_original__",e)}catch{}}function ds(t){return t.__sentry_original__}function jo(t){if(as(t))return{message:t.message,name:t.name,stack:t.stack,...ri(t)};if(Kn(t)){const e={type:t.type,target:ni(t.target),currentTarget:ni(t.currentTarget),...ri(t)};return typeof CustomEvent<"u"&&me(t,CustomEvent)&&(e.detail=t.detail),e}else return t}function ni(t){try{return Gu(t)?Uo(t):Object.prototype.toString.call(t)}catch{return"<unknown>"}}function ri(t){if(typeof t=="object"&&t!==null){const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}else return{}}function Qu(t,e=40){const n=Object.keys(jo(t));n.sort();const r=n[0];if(!r)return"[object has no keys]";if(r.length>=e)return On(r,e);for(let s=n.length;s>0;s--){const i=n.slice(0,s).join(", ");if(!(i.length>e))return s===n.length?i:On(i,e)}return""}function Zu(){const t=k;return t.crypto||t.msCrypto}function se(t=Zu()){let e=()=>Math.random()*16;try{if(t!=null&&t.randomUUID)return t.randomUUID().replace(/-/g,"");t!=null&&t.getRandomValues&&(e=()=>{const n=new Uint8Array(1);return t.getRandomValues(n),n[0]})}catch{}return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,n=>(n^(e()&15)>>n/4).toString(16))}function Ho(t){var e,n;return(n=(e=t.exception)==null?void 0:e.values)==null?void 0:n[0]}function He(t){const{message:e,event_id:n}=t;if(e)return e;const r=Ho(t);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function Nr(t,e,n){const r=t.exception=t.exception||{},s=r.values=r.values||[],i=s[0]=s[0]||{};i.value||(i.value=e||""),i.type||(i.type=n||"Error")}function mt(t,e){const n=Ho(t);if(!n)return;const r={type:"generic",handled:!0},s=n.mechanism;if(n.mechanism={...r,...s,...e},e&&"data"in e){const i={...s==null?void 0:s.data,...e.data};n.mechanism.data=i}}function si(t){if(el(t))return!0;try{oe(t,"__sentry_captured__",!0)}catch{}return!1}function el(t){try{return t.__sentry_captured__}catch{}}const Bo=1e3;function rt(){return Date.now()/Bo}function tl(){const{performance:t}=k;if(!(t!=null&&t.now)||!t.timeOrigin)return rt;const e=t.timeOrigin;return()=>(e+t.now())/Bo}let ii;function Z(){return(ii??(ii=tl()))()}let lr;function nl(){var l;const{performance:t}=k;if(!(t!=null&&t.now))return[void 0,"none"];const e=3600*1e3,n=t.now(),r=Date.now(),s=t.timeOrigin?Math.abs(t.timeOrigin+n-r):e,i=s<e,o=(l=t.timing)==null?void 0:l.navigationStart,c=typeof o=="number"?Math.abs(o+n-r):e,u=c<e;return i||u?s<=c?[t.timeOrigin,"timeOrigin"]:[o,"navigationStart"]:[r,"dateNow"]}function ps(){return lr||(lr=nl()),lr[0]}function rl(t){const e=Z(),n={sid:se(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>il(n)};return t&&_t(n,t),n}function _t(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),!t.did&&!e.did&&(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||Z(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:se()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const n=t.timestamp-t.started;t.duration=n>=0?n:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function sl(t,e){let n={};e?n={status:e}:t.status==="ok"&&(n={status:"exited"}),_t(t,n)}function il(t){return{sid:`${t.sid}`,init:t.init,started:new Date(t.started*1e3).toISOString(),timestamp:new Date(t.timestamp*1e3).toISOString(),status:t.status,errors:t.errors,did:typeof t.did=="number"||typeof t.did=="string"?`${t.did}`:void 0,duration:t.duration,abnormal_mechanism:t.abnormal_mechanism,attrs:{release:t.release,environment:t.environment,ip_address:t.ipAddress,user_agent:t.userAgent}}}function Zt(t,e,n=2){if(!e||typeof e!="object"||n<=0)return e;if(t&&Object.keys(e).length===0)return t;const r={...t};for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=Zt(r[s],e[s],n-1));return r}function Oe(){return se()}function en(){return se().substring(16)}const kr="_sentrySpan";function qt(t,e){e?oe(t,kr,e):delete t[kr]}function Nn(t){return t[kr]}const ol=100;let Ye=class Pr{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:Oe(),sampleRand:Math.random()}}clone(){const e=new Pr;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,qt(e,Nn(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&_t(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,n){return this._tags={...this._tags,[e]:n},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,n){return this._extra={...this._extra,[e]:n},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,n){return n===null?delete this._contexts[e]:this._contexts[e]=n,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const n=typeof e=="function"?e(this):e,r=n instanceof Pr?n.getScopeData():Bt(n)?e:void 0,{tags:s,extra:i,user:o,contexts:a,level:c,fingerprint:u=[],propagationContext:l}=r||{};return this._tags={...this._tags,...s},this._extra={...this._extra,...i},this._contexts={...this._contexts,...a},o&&Object.keys(o).length&&(this._user=o),c&&(this._level=c),u.length&&(this._fingerprint=u),l&&(this._propagationContext=l),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,qt(this,void 0),this._attachments=[],this.setPropagationContext({traceId:Oe(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(e,n){var i;const r=typeof n=="number"?n:ol;if(r<=0)return this;const s={timestamp:rt(),...e,message:e.message?On(e.message,2048):e.message};return this._breadcrumbs.push(s),this._breadcrumbs.length>r&&(this._breadcrumbs=this._breadcrumbs.slice(-r),(i=this._client)==null||i.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:Nn(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=Zt(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,n){const r=(n==null?void 0:n.event_id)||se();if(!this._client)return I&&T.warn("No client configured on scope - will not capture exception!"),r;const s=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:s,...n,event_id:r},this),r}captureMessage(e,n,r){const s=(r==null?void 0:r.event_id)||se();if(!this._client)return I&&T.warn("No client configured on scope - will not capture message!"),s;const i=new Error(e);return this._client.captureMessage(e,n,{originalException:e,syntheticException:i,...r,event_id:s},this),s}captureEvent(e,n){const r=(n==null?void 0:n.event_id)||se();return this._client?(this._client.captureEvent(e,{...n,event_id:r},this),r):(I&&T.warn("No client configured on scope - will not capture event!"),r)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}};function al(){return Wn("defaultCurrentScope",()=>new Ye)}function cl(){return Wn("defaultIsolationScope",()=>new Ye)}let ul=class{constructor(e,n){let r;e?r=e:r=new Ye;let s;n?s=n:s=new Ye,this._stack=[{scope:r}],this._isolationScope=s}withScope(e){const n=this._pushScope();let r;try{r=e(n)}catch(s){throw this._popScope(),s}return Yn(r)?r.then(s=>(this._popScope(),s),s=>{throw this._popScope(),s}):(this._popScope(),r)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}};function St(){const t=tt(),e=zn(t);return e.stack=e.stack||new ul(al(),cl())}function ll(t){return St().withScope(t)}function dl(t,e){const n=St();return n.withScope(()=>(n.getStackTop().scope=t,e(t)))}function oi(t){return St().withScope(()=>t(St().getIsolationScope()))}function pl(){return{withIsolationScope:oi,withScope:ll,withSetScope:dl,withSetIsolationScope:(t,e)=>oi(e),getCurrentScope:()=>St().getScope(),getIsolationScope:()=>St().getIsolationScope()}}function vt(t){const e=zn(t);return e.acs?e.acs:pl()}function U(){const t=tt();return vt(t).getCurrentScope()}function ae(){const t=tt();return vt(t).getIsolationScope()}function fl(){return Wn("globalScope",()=>new Ye)}function Vt(...t){const e=tt(),n=vt(e);if(t.length===2){const[r,s]=t;return r?n.withSetScope(r,s):n.withScope(s)}return n.withScope(t[0])}function P(){return U().getClient()}function hl(t){const e=t.getPropagationContext(),{traceId:n,parentSpanId:r,propagationSpanId:s}=e,i={trace_id:n,span_id:s||en()};return r&&(i.parent_span_id=r),i}const ge="sentry.source",fs="sentry.sample_rate",qo="sentry.previous_trace_sample_rate",Gt="sentry.op",Je="sentry.origin",kn="sentry.idle_span_finish_reason",gl="sentry.measurement_unit",ml="sentry.measurement_value",ai="sentry.custom_span_name",hs="sentry.profile_id",gs="sentry.exclusive_time",_l="sentry.link.type",Sl=0,Vo=1,G=2;function El(t){if(t<400&&t>=100)return{code:Vo};if(t>=400&&t<500)switch(t){case 401:return{code:G,message:"unauthenticated"};case 403:return{code:G,message:"permission_denied"};case 404:return{code:G,message:"not_found"};case 409:return{code:G,message:"already_exists"};case 413:return{code:G,message:"failed_precondition"};case 429:return{code:G,message:"resource_exhausted"};case 499:return{code:G,message:"cancelled"};default:return{code:G,message:"invalid_argument"}}if(t>=500&&t<600)switch(t){case 501:return{code:G,message:"unimplemented"};case 503:return{code:G,message:"unavailable"};case 504:return{code:G,message:"deadline_exceeded"};default:return{code:G,message:"internal_error"}}return{code:G,message:"unknown_error"}}function Go(t,e){t.setAttribute("http.response.status_code",e);const n=El(e);n.message!=="unknown_error"&&t.setStatus(n)}const zo="_sentryScope",Wo="_sentryIsolationScope";function yl(t,e,n){t&&(oe(t,Wo,n),oe(t,zo,e))}function Pn(t){return{scope:t[zo],isolationScope:t[Wo]}}const ms="sentry-",Tl=/^sentry-/,bl=8192;function Ko(t){const e=vl(t);if(!e)return;const n=Object.entries(e).reduce((r,[s,i])=>{if(s.match(Tl)){const o=s.slice(ms.length);r[o]=i}return r},{});if(Object.keys(n).length>0)return n}function Il(t){if(!t)return;const e=Object.entries(t).reduce((n,[r,s])=>(s&&(n[`${ms}${r}`]=s),n),{});return Rl(e)}function vl(t){if(!(!t||!Ht(t)&&!Array.isArray(t)))return Array.isArray(t)?t.reduce((e,n)=>{const r=ci(n);return Object.entries(r).forEach(([s,i])=>{e[s]=i}),e},{}):ci(t)}function ci(t){return t.split(",").map(e=>e.split("=").map(n=>{try{return decodeURIComponent(n.trim())}catch{return}})).reduce((e,[n,r])=>(n&&r&&(e[n]=r),e),{})}function Rl(t){if(Object.keys(t).length!==0)return Object.entries(t).reduce((e,[n,r],s)=>{const i=`${encodeURIComponent(n)}=${encodeURIComponent(r)}`,o=s===0?i:`${e},${i}`;return o.length>bl?(I&&T.warn(`Not adding key: ${n} with val: ${r} to baggage header due to exceeding baggage size limits.`),e):o},"")}function zt(t){if(typeof t=="boolean")return Number(t);const e=typeof t=="string"?parseFloat(t):t;if(!(typeof e!="number"||isNaN(e)||e<0||e>1))return e}const Yo=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function wl(t){if(!t)return;const e=t.match(Yo);if(!e)return;let n;return e[3]==="1"?n=!0:e[3]==="0"&&(n=!1),{traceId:e[1],parentSampled:n,parentSpanId:e[2]}}function Cl(t,e){const n=wl(t),r=Ko(e);if(!(n!=null&&n.traceId))return{traceId:Oe(),sampleRand:Math.random()};const s=Al(n,r);r&&(r.sample_rand=s.toString());const{traceId:i,parentSpanId:o,parentSampled:a}=n;return{traceId:i,parentSpanId:o,sampled:a,dsc:r||{},sampleRand:s}}function Jo(t=Oe(),e=en(),n){let r="";return n!==void 0&&(r=n?"-1":"-0"),`${t}-${e}${r}`}function Al(t,e){const n=zt(e==null?void 0:e.sample_rand);if(n!==void 0)return n;const r=zt(e==null?void 0:e.sample_rate);return r&&(t==null?void 0:t.parentSampled)!==void 0?t.parentSampled?Math.random()*r:r+Math.random()*(1-r):Math.random()}const Xo=0,_s=1;let ui=!1;function Ol(t){const{spanId:e,traceId:n}=t.spanContext(),{data:r,op:s,parent_span_id:i,status:o,origin:a,links:c}=F(t);return{parent_span_id:i,span_id:e,trace_id:n,data:r,op:s,status:o,origin:a,links:c}}function Nl(t){const{spanId:e,traceId:n,isRemote:r}=t.spanContext(),s=r?e:F(t).parent_span_id,i=Pn(t).scope,o=r?(i==null?void 0:i.getPropagationContext().propagationSpanId)||en():e;return{parent_span_id:s,span_id:o,trace_id:n}}function kl(t){const{traceId:e,spanId:n}=t.spanContext(),r=st(t);return Jo(e,n,r)}function Qo(t){if(t&&t.length>0)return t.map(({context:{spanId:e,traceId:n,traceFlags:r,...s},attributes:i})=>({span_id:e,trace_id:n,sampled:r===_s,attributes:i,...s}))}function Ge(t){return typeof t=="number"?li(t):Array.isArray(t)?t[0]+t[1]/1e9:t instanceof Date?li(t.getTime()):Z()}function li(t){return t>9999999999?t/1e3:t}function F(t){var r;if(Ll(t))return t.getSpanJSON();const{spanId:e,traceId:n}=t.spanContext();if(Pl(t)){const{attributes:s,startTime:i,name:o,endTime:a,status:c,links:u}=t,l="parentSpanId"in t?t.parentSpanId:"parentSpanContext"in t?(r=t.parentSpanContext)==null?void 0:r.spanId:void 0;return{span_id:e,trace_id:n,data:s,description:o,parent_span_id:l,start_timestamp:Ge(i),timestamp:Ge(a)||void 0,status:Zo(c),op:s[Gt],origin:s[Je],links:Qo(u)}}return{span_id:e,trace_id:n,start_timestamp:0,data:{}}}function Pl(t){const e=t;return!!e.attributes&&!!e.startTime&&!!e.name&&!!e.endTime&&!!e.status}function Ll(t){return typeof t.getSpanJSON=="function"}function st(t){const{traceFlags:e}=t.spanContext();return e===_s}function Zo(t){if(!(!t||t.code===Sl))return t.code===Vo?"ok":t.message||"unknown_error"}const ze="_sentryChildSpans",Lr="_sentryRootSpan";function ea(t,e){const n=t[Lr]||t;oe(e,Lr,n),t[ze]?t[ze].add(e):oe(t,ze,new Set([e]))}function xl(t,e){t[ze]&&t[ze].delete(e)}function Tn(t){const e=new Set;function n(r){if(!e.has(r)&&st(r)){e.add(r);const s=r[ze]?Array.from(r[ze]):[];for(const i of s)n(i)}}return n(t),Array.from(e)}function ie(t){return t[Lr]||t}function Rt(){const t=tt(),e=vt(t);return e.getActiveSpan?e.getActiveSpan():Nn(U())}function xr(){ui||(bt(()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly.")}),ui=!0)}let di=!1;function $l(){di||(di=!0,Po($r),Lo($r))}function $r(){const t=Rt(),e=t&&ie(t);if(e){const n="internal_error";I&&T.log(`[Tracing] Root span: ${n} -> Global error occurred`),e.setStatus({code:G,message:n})}}$r.tag="sentry_tracingErrorCallback";function Ne(t){var n;if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const e=t||((n=P())==null?void 0:n.getOptions());return!!e&&(e.tracesSampleRate!=null||!!e.tracesSampler)}const Ss="production",Dl=/^o(\d+)\./,Fl=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function Ul(t){return t==="http"||t==="https"}function wt(t,e=!1){const{host:n,path:r,pass:s,port:i,projectId:o,protocol:a,publicKey:c}=t;return`${a}://${c}${e&&s?`:${s}`:""}@${n}${i?`:${i}`:""}/${r&&`${r}/`}${o}`}function Ml(t){const e=Fl.exec(t);if(!e){bt(()=>{console.error(`Invalid Sentry Dsn: ${t}`)});return}const[n,r,s="",i="",o="",a=""]=e.slice(1);let c="",u=a;const l=u.split("/");if(l.length>1&&(c=l.slice(0,-1).join("/"),u=l.pop()),u){const d=u.match(/^\d+/);d&&(u=d[0])}return ta({host:i,pass:s,path:c,projectId:u,port:o,protocol:n,publicKey:r})}function ta(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function jl(t){if(!I)return!0;const{port:e,projectId:n,protocol:r}=t;return["protocol","publicKey","host","projectId"].find(o=>t[o]?!1:(T.error(`Invalid Sentry Dsn: ${o} missing`),!0))?!1:n.match(/^\d+$/)?Ul(r)?e&&isNaN(parseInt(e,10))?(T.error(`Invalid Sentry Dsn: Invalid port ${e}`),!1):!0:(T.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),!1):(T.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1)}function Hl(t){const e=t.match(Dl);return e==null?void 0:e[1]}function na(t){const e=typeof t=="string"?Ml(t):ta(t);if(!(!e||!jl(e)))return e}const ra="_frozenDsc";function bn(t,e){oe(t,ra,e)}function sa(t,e){const n=e.getOptions(),{publicKey:r,host:s}=e.getDsn()||{};let i;n.orgId?i=String(n.orgId):s&&(i=Hl(s));const o={environment:n.environment||Ss,release:n.release,public_key:r,trace_id:t,org_id:i};return e.emit("createDsc",o),o}function ia(t,e){const n=e.getPropagationContext();return n.dsc||sa(n.traceId,t)}function ke(t){var _;const e=P();if(!e)return{};const n=ie(t),r=F(n),s=r.data,i=n.spanContext().traceState,o=(i==null?void 0:i.get("sentry.sample_rate"))??s[fs]??s[qo];function a(h){return(typeof o=="number"||typeof o=="string")&&(h.sample_rate=`${o}`),h}const c=n[ra];if(c)return a(c);const u=i==null?void 0:i.get("sentry.dsc"),l=u&&Ko(u);if(l)return a(l);const d=sa(t.spanContext().traceId,e),p=s[ge],f=r.description;return p!=="url"&&f&&(d.transaction=f),Ne()&&(d.sampled=String(st(n)),d.sample_rand=(i==null?void 0:i.get("sentry.sample_rand"))??((_=Pn(n).scope)==null?void 0:_.getPropagationContext().sampleRand.toString())),a(d),e.emit("createDsc",d,n),d}let Xe=class{constructor(e={}){this._traceId=e.traceId||Oe(),this._spanId=e.spanId||en()}spanContext(){return{spanId:this._spanId,traceId:this._traceId,traceFlags:Xo}}end(e){}setAttribute(e,n){return this}setAttributes(e){return this}setStatus(e){return this}updateName(e){return this}isRecording(){return!1}addEvent(e,n,r){return this}addLink(e){return this}addLinks(e){return this}recordException(e,n){}};function Bl(t){if(!I)return;const{description:e="< unknown name >",op:n="< unknown op >",parent_span_id:r}=F(t),{spanId:s}=t.spanContext(),i=st(t),o=ie(t),a=o===t,c=`[Tracing] Starting ${i?"sampled":"unsampled"} ${a?"root ":""}span`,u=[`op: ${n}`,`name: ${e}`,`ID: ${s}`];if(r&&u.push(`parent ID: ${r}`),!a){const{op:l,description:d}=F(o);u.push(`root ID: ${o.spanContext().spanId}`),l&&u.push(`root op: ${l}`),d&&u.push(`root description: ${d}`)}T.log(`${c}
  ${u.join(`
  `)}`)}function ql(t){if(!I)return;const{description:e="< unknown name >",op:n="< unknown op >"}=F(t),{spanId:r}=t.spanContext(),i=ie(t)===t,o=`[Tracing] Finishing "${n}" ${i?"root ":""}span "${e}" with ID ${r}`;T.log(o)}function Vl(t,e,n){if(!Ne(t))return[!1];let r,s;typeof t.tracesSampler=="function"?(s=t.tracesSampler({...e,inheritOrSampleWith:a=>typeof e.parentSampleRate=="number"?e.parentSampleRate:typeof e.parentSampled=="boolean"?Number(e.parentSampled):a}),r=!0):e.parentSampled!==void 0?s=e.parentSampled:typeof t.tracesSampleRate<"u"&&(s=t.tracesSampleRate,r=!0);const i=zt(s);if(i===void 0)return I&&T.warn(`[Tracing] Discarding root span because of invalid sample rate. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(s)} of type ${JSON.stringify(typeof s)}.`),[!1];if(!i)return I&&T.log(`[Tracing] Discarding transaction because ${typeof t.tracesSampler=="function"?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`),[!1,i,r];const o=n<i;return o||I&&T.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(s)})`),[o,i,r]}function fe(t,e=100,n=1/0){try{return Dr("",t,e,n)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function oa(t,e=3,n=100*1024){const r=fe(t,e);return Kl(r)>n?oa(t,e-1,n):r}function Dr(t,e,n=1/0,r=1/0,s=Yl()){const[i,o]=s;if(e==null||["boolean","string"].includes(typeof e)||typeof e=="number"&&Number.isFinite(e))return e;const a=Gl(t,e);if(!a.startsWith("[object "))return a;if(e.__sentry_skip_normalization__)return e;const c=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:n;if(c===0)return a.replace("object ","");if(i(e))return"[Circular ~]";const u=e;if(u&&typeof u.toJSON=="function")try{const f=u.toJSON();return Dr("",f,c-1,r,s)}catch{}const l=Array.isArray(e)?[]:{};let d=0;const p=jo(e);for(const f in p){if(!Object.prototype.hasOwnProperty.call(p,f))continue;if(d>=r){l[f]="[MaxProperties ~]";break}const _=p[f];l[f]=Dr(f,_,c-1,r,s),d++}return o(e),l}function Gl(t,e){try{if(t==="domain"&&e&&typeof e=="object"&&e._events)return"[Domain]";if(t==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&e===global)return"[Global]";if(typeof window<"u"&&e===window)return"[Window]";if(typeof document<"u"&&e===document)return"[Document]";if(Do(e))return"[VueViewModel]";if(Wu(e))return"[SyntheticEvent]";if(typeof e=="number"&&!Number.isFinite(e))return`[${e}]`;if(typeof e=="function")return`[Function: ${Ae(e)}]`;if(typeof e=="symbol")return`[${String(e)}]`;if(typeof e=="bigint")return`[BigInt: ${String(e)}]`;const n=zl(e);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(n){return`**non-serializable** (${n})`}}function zl(t){const e=Object.getPrototypeOf(t);return e!=null&&e.constructor?e.constructor.name:"null prototype"}function Wl(t){return~-encodeURI(t).split(/%..|./).length}function Kl(t){return Wl(JSON.stringify(t))}function Yl(){const t=new WeakSet;function e(r){return t.has(r)?!0:(t.add(r),!1)}function n(r){t.delete(r)}return[e,n]}function Ct(t,e=[]){return[t,e]}function Jl(t,e){const[n,r]=t;return[n,[...r,e]]}function pi(t,e){const n=t[1];for(const r of n){const s=r[0].type;if(e(r,s))return!0}return!1}function Fr(t){const e=zn(k);return e.encodePolyfill?e.encodePolyfill(t):new TextEncoder().encode(t)}function Xl(t){const[e,n]=t;let r=JSON.stringify(e);function s(i){typeof r=="string"?r=typeof i=="string"?r+i:[Fr(r),i]:r.push(typeof i=="string"?Fr(i):i)}for(const i of n){const[o,a]=i;if(s(`
${JSON.stringify(o)}
`),typeof a=="string"||a instanceof Uint8Array)s(a);else{let c;try{c=JSON.stringify(a)}catch{c=JSON.stringify(fe(a))}s(c)}}return typeof r=="string"?r:Ql(r)}function Ql(t){const e=t.reduce((s,i)=>s+i.length,0),n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}function Zl(t){return[{type:"span"},t]}function ed(t){const e=typeof t.data=="string"?Fr(t.data):t.data;return[{type:"attachment",length:e.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType},e]}const td={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",raw_security:"security",log:"log_item"};function fi(t){return td[t]}function aa(t){if(!(t!=null&&t.sdk))return;const{name:e,version:n}=t.sdk;return{name:e,version:n}}function nd(t,e,n,r){var i;const s=(i=t.sdkProcessingMetadata)==null?void 0:i.dynamicSamplingContext;return{event_id:t.event_id,sent_at:new Date().toISOString(),...e&&{sdk:e},...!!n&&r&&{dsn:wt(r)},...s&&{trace:s}}}function rd(t,e){return e&&(t.sdk=t.sdk||{},t.sdk.name=t.sdk.name||e.name,t.sdk.version=t.sdk.version||e.version,t.sdk.integrations=[...t.sdk.integrations||[],...e.integrations||[]],t.sdk.packages=[...t.sdk.packages||[],...e.packages||[]]),t}function sd(t,e,n,r){const s=aa(n),i={sent_at:new Date().toISOString(),...s&&{sdk:s},...!!r&&e&&{dsn:wt(e)}},o="aggregates"in t?[{type:"sessions"},t]:[{type:"session"},t.toJSON()];return Ct(i,[o])}function id(t,e,n,r){const s=aa(n),i=t.type&&t.type!=="replay_event"?t.type:"event";rd(t,n==null?void 0:n.sdk);const o=nd(t,s,r,e);return delete t.sdkProcessingMetadata,Ct(o,[[{type:i},t]])}function od(t,e){function n(l){return!!l.trace_id&&!!l.public_key}const r=ke(t[0]),s=e==null?void 0:e.getDsn(),i=e==null?void 0:e.getOptions().tunnel,o={sent_at:new Date().toISOString(),...n(r)&&{trace:r},...!!i&&s&&{dsn:wt(s)}},a=e==null?void 0:e.getOptions().beforeSendSpan,c=a?l=>{const d=F(l),p=a(d);return p||(xr(),d)}:F,u=[];for(const l of t){const d=c(l);d&&u.push(Zl(d))}return Ct(o,u)}function hi(t){if(!t||t.length===0)return;const e={};return t.forEach(n=>{const r=n.attributes||{},s=r[gl],i=r[ml];typeof s=="string"&&typeof i=="number"&&(e[n.name]={value:i,unit:s})}),e}const gi=1e3;let Es=class{constructor(e={}){this._traceId=e.traceId||Oe(),this._spanId=e.spanId||en(),this._startTime=e.startTimestamp||Z(),this._links=e.links,this._attributes={},this.setAttributes({[Je]:"manual",[Gt]:e.op,...e.attributes}),this._name=e.name,e.parentSpanId&&(this._parentSpanId=e.parentSpanId),"sampled"in e&&(this._sampled=e.sampled),e.endTimestamp&&(this._endTime=e.endTimestamp),this._events=[],this._isStandaloneSpan=e.isStandalone,this._endTime&&this._onSpanEnded()}addLink(e){return this._links?this._links.push(e):this._links=[e],this}addLinks(e){return this._links?this._links.push(...e):this._links=e,this}recordException(e,n){}spanContext(){const{_spanId:e,_traceId:n,_sampled:r}=this;return{spanId:e,traceId:n,traceFlags:r?_s:Xo}}setAttribute(e,n){return n===void 0?delete this._attributes[e]:this._attributes[e]=n,this}setAttributes(e){return Object.keys(e).forEach(n=>this.setAttribute(n,e[n])),this}updateStartTime(e){this._startTime=Ge(e)}setStatus(e){return this._status=e,this}updateName(e){return this._name=e,this.setAttribute(ge,"custom"),this}end(e){this._endTime||(this._endTime=Ge(e),ql(this),this._onSpanEnded())}getSpanJSON(){return{data:this._attributes,description:this._name,op:this._attributes[Gt],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:Zo(this._status),timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes[Je],profile_id:this._attributes[hs],exclusive_time:this._attributes[gs],measurements:hi(this._events),is_segment:this._isStandaloneSpan&&ie(this)===this||void 0,segment_id:this._isStandaloneSpan?ie(this).spanContext().spanId:void 0,links:Qo(this._links)}}isRecording(){return!this._endTime&&!!this._sampled}addEvent(e,n,r){I&&T.log("[Tracing] Adding an event to span:",e);const s=mi(n)?n:r||Z(),i=mi(n)?{}:n||{},o={name:e,time:Ge(s),attributes:i};return this._events.push(o),this}isStandaloneSpan(){return!!this._isStandaloneSpan}_onSpanEnded(){const e=P();if(e&&e.emit("spanEnd",this),!(this._isStandaloneSpan||this===ie(this)))return;if(this._isStandaloneSpan){this._sampled?cd(od([this],e)):(I&&T.log("[Tracing] Discarding standalone span because its trace was not chosen to be sampled."),e&&e.recordDroppedEvent("sample_rate","span"));return}const r=this._convertSpanToTransaction();r&&(Pn(this).scope||U()).captureEvent(r)}_convertSpanToTransaction(){var l;if(!_i(F(this)))return;this._name||(I&&T.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>");const{scope:e,isolationScope:n}=Pn(this),r=(l=e==null?void 0:e.getScopeData().sdkProcessingMetadata)==null?void 0:l.normalizedRequest;if(this._sampled!==!0)return;const i=Tn(this).filter(d=>d!==this&&!ad(d)).map(d=>F(d)).filter(_i),o=this._attributes[ge];delete this._attributes[ai],i.forEach(d=>{delete d.data[ai]});const a={contexts:{trace:Ol(this)},spans:i.length>gi?i.sort((d,p)=>d.start_timestamp-p.start_timestamp).slice(0,gi):i,start_timestamp:this._startTime,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{capturedSpanScope:e,capturedSpanIsolationScope:n,dynamicSamplingContext:ke(this)},request:r,...o&&{transaction_info:{source:o}}},c=hi(this._events);return c&&Object.keys(c).length&&(I&&T.log("[Measurements] Adding measurements to transaction event",JSON.stringify(c,void 0,2)),a.measurements=c),a}};function mi(t){return t&&typeof t=="number"||t instanceof Date||Array.isArray(t)}function _i(t){return!!t.start_timestamp&&!!t.timestamp&&!!t.span_id&&!!t.trace_id}function ad(t){return t instanceof Es&&t.isStandaloneSpan()}function cd(t){const e=P();if(!e)return;const n=t[1];if(!n||n.length===0){e.recordDroppedEvent("before_send","span");return}e.sendEnvelope(t)}const ca="__SENTRY_SUPPRESS_TRACING__";function Jn(t){const e=ua();if(e.startInactiveSpan)return e.startInactiveSpan(t);const n=dd(t),{forceTransaction:r,parentSpan:s}=t;return(t.scope?o=>Vt(t.scope,o):s!==void 0?o=>ud(s,o):o=>o())(()=>{const o=U(),a=fd(o,s);return t.onlyIfParent&&!a?new Xe:ld({parentSpan:a,spanArguments:n,forceTransaction:r,scope:o})})}function ud(t,e){const n=ua();return n.withActiveSpan?n.withActiveSpan(t,e):Vt(r=>(qt(r,t||void 0),e(r)))}function ld({parentSpan:t,spanArguments:e,forceTransaction:n,scope:r}){if(!Ne()){const o=new Xe;if(n||!t){const a={sampled:"false",sample_rate:"0",transaction:e.name,...ke(o)};bn(o,a)}return o}const s=ae();let i;if(t&&!n)i=pd(t,r,e),ea(t,i);else if(t){const o=ke(t),{traceId:a,spanId:c}=t.spanContext(),u=st(t);i=Si({traceId:a,parentSpanId:c,...e},r,u),bn(i,o)}else{const{traceId:o,dsc:a,parentSpanId:c,sampled:u}={...s.getPropagationContext(),...r.getPropagationContext()};i=Si({traceId:o,parentSpanId:c,...e},r,u),a&&bn(i,a)}return Bl(i),yl(i,r,s),i}function dd(t){const n={isStandalone:(t.experimental||{}).standalone,...t};if(t.startTime){const r={...n};return r.startTimestamp=Ge(t.startTime),delete r.startTime,r}return n}function ua(){const t=tt();return vt(t)}function Si(t,e,n){var _;const r=P(),s=(r==null?void 0:r.getOptions())||{},{name:i=""}=t,o={spanAttributes:{...t.attributes},spanName:i,parentSampled:n};r==null||r.emit("beforeSampling",o,{decision:!1});const a=o.parentSampled??n,c=o.spanAttributes,u=e.getPropagationContext(),[l,d,p]=e.getScopeData().sdkProcessingMetadata[ca]?[!1]:Vl(s,{name:i,parentSampled:a,attributes:c,parentSampleRate:zt((_=u.dsc)==null?void 0:_.sample_rate)},u.sampleRand),f=new Es({...t,attributes:{[ge]:"custom",[fs]:d!==void 0&&p?d:void 0,...c},sampled:l});return!l&&r&&(I&&T.log("[Tracing] Discarding root span because its trace was not chosen to be sampled."),r.recordDroppedEvent("sample_rate","transaction")),r&&r.emit("spanStart",f),f}function pd(t,e,n){const{spanId:r,traceId:s}=t.spanContext(),i=e.getScopeData().sdkProcessingMetadata[ca]?!1:st(t),o=i?new Es({...n,parentSpanId:r,traceId:s,sampled:i}):new Xe({traceId:s});ea(t,o);const a=P();return a&&(a.emit("spanStart",o),n.endTimestamp&&a.emit("spanEnd",o)),o}function fd(t,e){if(e)return e;if(e===null)return;const n=Nn(t);if(!n)return;const r=P();return(r?r.getOptions():{}).parentSpanIsAlwaysRootSpan?ie(n):n}const In={idleTimeout:1e3,finalTimeout:3e4,childSpanTimeout:15e3},hd="heartbeatFailed",gd="idleTimeout",md="finalTimeout",_d="externalFinish";function la(t,e={}){const n=new Map;let r=!1,s,i=_d,o=!e.disableAutoFinish;const a=[],{idleTimeout:c=In.idleTimeout,finalTimeout:u=In.finalTimeout,childSpanTimeout:l=In.childSpanTimeout,beforeSpanEnd:d}=e,p=P();if(!p||!Ne()){const C=new Xe,q={sample_rate:"0",sampled:"false",...ke(C)};return bn(C,q),C}const f=U(),_=Rt(),h=Sd(t);h.end=new Proxy(h.end,{apply(C,q,at){if(d&&d(h),q instanceof Xe)return;const[Lt,...ct]=at,Fe=Lt||Z(),M=Ge(Fe),Ue=Tn(h).filter(H=>H!==h);if(!Ue.length)return g(M),Reflect.apply(C,q,[M,...ct]);const Te=Ue.map(H=>F(H).timestamp).filter(H=>!!H),$=Te.length?Math.max(...Te):void 0,j=F(h).start_timestamp,L=Math.min(j?j+u/1e3:1/0,Math.max(j||-1/0,Math.min(M,$||1/0)));return g(L),Reflect.apply(C,q,[L,...ct])}});function b(){s&&(clearTimeout(s),s=void 0)}function v(C){b(),s=setTimeout(()=>{!r&&n.size===0&&o&&(i=gd,h.end(C))},c)}function E(C){s=setTimeout(()=>{!r&&o&&(i=hd,h.end(C))},l)}function y(C){b(),n.set(C,!0);const q=Z();E(q+l/1e3)}function m(C){if(n.has(C)&&n.delete(C),n.size===0){const q=Z();v(q+c/1e3)}}function g(C){r=!0,n.clear(),a.forEach(M=>M()),qt(f,_);const q=F(h),{start_timestamp:at}=q;if(!at)return;q.data[kn]||h.setAttribute(kn,i),T.log(`[Tracing] Idle span "${q.op}" finished`);const ct=Tn(h).filter(M=>M!==h);let Fe=0;ct.forEach(M=>{M.isRecording()&&(M.setStatus({code:G,message:"cancelled"}),M.end(C),I&&T.log("[Tracing] Cancelling span since span ended early",JSON.stringify(M,void 0,2)));const Ue=F(M),{timestamp:Te=0,start_timestamp:$=0}=Ue,j=$<=C,L=(u+c)/1e3,H=Te-$<=L;if(I){const V=JSON.stringify(M,void 0,2);j?H||T.log("[Tracing] Discarding span since it finished after idle span final timeout",V):T.log("[Tracing] Discarding span since it happened after idle span was finished",V)}(!H||!j)&&(xl(h,M),Fe++)}),Fe>0&&h.setAttribute("sentry.idle_span_discarded_spans",Fe)}return a.push(p.on("spanStart",C=>{if(r||C===h||F(C).timestamp)return;Tn(h).includes(C)&&y(C.spanContext().spanId)})),a.push(p.on("spanEnd",C=>{r||m(C.spanContext().spanId)})),a.push(p.on("idleSpanEnableAutoFinish",C=>{C===h&&(o=!0,v(),n.size&&E())})),e.disableAutoFinish||v(),setTimeout(()=>{r||(h.setStatus({code:G,message:"deadline_exceeded"}),i=md,h.end())},u),h}function Sd(t){const e=Jn(t);return qt(U(),e),I&&T.log("[Tracing] Started span is an idle span"),e}const dr=0,Ei=1,yi=2;function Qe(t){return new Pe(e=>{e(t)})}function Ln(t){return new Pe((e,n)=>{n(t)})}class Pe{constructor(e){this._state=dr,this._handlers=[],this._runExecutor(e)}then(e,n){return new Pe((r,s)=>{this._handlers.push([!1,i=>{if(!e)r(i);else try{r(e(i))}catch(o){s(o)}},i=>{if(!n)s(i);else try{r(n(i))}catch(o){s(o)}}]),this._executeHandlers()})}catch(e){return this.then(n=>n,e)}finally(e){return new Pe((n,r)=>{let s,i;return this.then(o=>{i=!1,s=o,e&&e()},o=>{i=!0,s=o,e&&e()}).then(()=>{if(i){r(s);return}n(s)})})}_executeHandlers(){if(this._state===dr)return;const e=this._handlers.slice();this._handlers=[],e.forEach(n=>{n[0]||(this._state===Ei&&n[1](this._value),this._state===yi&&n[2](this._value),n[0]=!0)})}_runExecutor(e){const n=(i,o)=>{if(this._state===dr){if(Yn(o)){o.then(r,s);return}this._state=i,this._value=o,this._executeHandlers()}},r=i=>{n(Ei,i)},s=i=>{n(yi,i)};try{e(r,s)}catch(i){s(i)}}}function Ur(t,e,n,r=0){return new Pe((s,i)=>{const o=t[r];if(e===null||typeof o!="function")s(e);else{const a=o({...e},n);I&&o.id&&a===null&&T.log(`Event processor "${o.id}" dropped event`),Yn(a)?a.then(c=>Ur(t,c,n,r+1).then(s)).then(null,i):Ur(t,a,n,r+1).then(s).then(null,i)}})}function Ed(t,e){const{fingerprint:n,span:r,breadcrumbs:s,sdkProcessingMetadata:i}=e;yd(t,e),r&&Id(t,r),vd(t,n),Td(t,s),bd(t,i)}function Ti(t,e){const{extra:n,tags:r,user:s,contexts:i,level:o,sdkProcessingMetadata:a,breadcrumbs:c,fingerprint:u,eventProcessors:l,attachments:d,propagationContext:p,transactionName:f,span:_}=e;pn(t,"extra",n),pn(t,"tags",r),pn(t,"user",s),pn(t,"contexts",i),t.sdkProcessingMetadata=Zt(t.sdkProcessingMetadata,a,2),o&&(t.level=o),f&&(t.transactionName=f),_&&(t.span=_),c.length&&(t.breadcrumbs=[...t.breadcrumbs,...c]),u.length&&(t.fingerprint=[...t.fingerprint,...u]),l.length&&(t.eventProcessors=[...t.eventProcessors,...l]),d.length&&(t.attachments=[...t.attachments,...d]),t.propagationContext={...t.propagationContext,...p}}function pn(t,e,n){t[e]=Zt(t[e],n,1)}function yd(t,e){const{extra:n,tags:r,user:s,contexts:i,level:o,transactionName:a}=e;Object.keys(n).length&&(t.extra={...n,...t.extra}),Object.keys(r).length&&(t.tags={...r,...t.tags}),Object.keys(s).length&&(t.user={...s,...t.user}),Object.keys(i).length&&(t.contexts={...i,...t.contexts}),o&&(t.level=o),a&&t.type!=="transaction"&&(t.transaction=a)}function Td(t,e){const n=[...t.breadcrumbs||[],...e];t.breadcrumbs=n.length?n:void 0}function bd(t,e){t.sdkProcessingMetadata={...t.sdkProcessingMetadata,...e}}function Id(t,e){t.contexts={trace:Nl(e),...t.contexts},t.sdkProcessingMetadata={dynamicSamplingContext:ke(e),...t.sdkProcessingMetadata};const n=ie(e),r=F(n).description;r&&!t.transaction&&t.type==="transaction"&&(t.transaction=r)}function vd(t,e){t.fingerprint=t.fingerprint?Array.isArray(t.fingerprint)?t.fingerprint:[t.fingerprint]:[],e&&(t.fingerprint=t.fingerprint.concat(e)),t.fingerprint.length||delete t.fingerprint}let fn,bi,hn;function Rd(t){const e=k._sentryDebugIds;if(!e)return{};const n=Object.keys(e);return hn&&n.length===bi||(bi=n.length,hn=n.reduce((r,s)=>{fn||(fn={});const i=fn[s];if(i)r[i[0]]=i[1];else{const o=t(s);for(let a=o.length-1;a>=0;a--){const c=o[a],u=c==null?void 0:c.filename,l=e[s];if(u&&l){r[u]=l,fn[s]=[u,l];break}}}return r},{})),hn}function wd(t,e,n,r,s,i){const{normalizeDepth:o=3,normalizeMaxBreadth:a=1e3}=t,c={...e,event_id:e.event_id||n.event_id||se(),timestamp:e.timestamp||rt()},u=n.integrations||t.integrations.map(b=>b.name);Cd(c,t),Nd(c,u),s&&s.emit("applyFrameMetadata",e),e.type===void 0&&Ad(c,t.stackParser);const l=Pd(r,n.captureContext);n.mechanism&&mt(c,n.mechanism);const d=s?s.getEventProcessors():[],p=fl().getScopeData();if(i){const b=i.getScopeData();Ti(p,b)}if(l){const b=l.getScopeData();Ti(p,b)}const f=[...n.attachments||[],...p.attachments];f.length&&(n.attachments=f),Ed(c,p);const _=[...d,...p.eventProcessors];return Ur(_,c,n).then(b=>(b&&Od(b),typeof o=="number"&&o>0?kd(b,o,a):b))}function Cd(t,e){const{environment:n,release:r,dist:s,maxValueLength:i=250}=e;t.environment=t.environment||n||Ss,!t.release&&r&&(t.release=r),!t.dist&&s&&(t.dist=s);const o=t.request;o!=null&&o.url&&(o.url=On(o.url,i))}function Ad(t,e){var r,s;const n=Rd(e);(s=(r=t.exception)==null?void 0:r.values)==null||s.forEach(i=>{var o,a;(a=(o=i.stacktrace)==null?void 0:o.frames)==null||a.forEach(c=>{c.filename&&(c.debug_id=n[c.filename])})})}function Od(t){var r,s;const e={};if((s=(r=t.exception)==null?void 0:r.values)==null||s.forEach(i=>{var o,a;(a=(o=i.stacktrace)==null?void 0:o.frames)==null||a.forEach(c=>{c.debug_id&&(c.abs_path?e[c.abs_path]=c.debug_id:c.filename&&(e[c.filename]=c.debug_id),delete c.debug_id)})}),Object.keys(e).length===0)return;t.debug_meta=t.debug_meta||{},t.debug_meta.images=t.debug_meta.images||[];const n=t.debug_meta.images;Object.entries(e).forEach(([i,o])=>{n.push({type:"sourcemap",code_file:i,debug_id:o})})}function Nd(t,e){e.length>0&&(t.sdk=t.sdk||{},t.sdk.integrations=[...t.sdk.integrations||[],...e])}function kd(t,e,n){var s,i;if(!t)return null;const r={...t,...t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map(o=>({...o,...o.data&&{data:fe(o.data,e,n)}}))},...t.user&&{user:fe(t.user,e,n)},...t.contexts&&{contexts:fe(t.contexts,e,n)},...t.extra&&{extra:fe(t.extra,e,n)}};return(s=t.contexts)!=null&&s.trace&&r.contexts&&(r.contexts.trace=t.contexts.trace,t.contexts.trace.data&&(r.contexts.trace.data=fe(t.contexts.trace.data,e,n))),t.spans&&(r.spans=t.spans.map(o=>({...o,...o.data&&{data:fe(o.data,e,n)}}))),(i=t.contexts)!=null&&i.flags&&r.contexts&&(r.contexts.flags=fe(t.contexts.flags,3,n)),r}function Pd(t,e){if(!e)return t;const n=t?t.clone():new Ye;return n.update(e),n}function Ld(t){if(t)return xd(t)?{captureContext:t}:Dd(t)?{captureContext:t}:t}function xd(t){return t instanceof Ye||typeof t=="function"}const $d=["user","level","extra","contexts","tags","fingerprint","propagationContext"];function Dd(t){return Object.keys(t).some(e=>$d.includes(e))}function da(t,e){return U().captureException(t,Ld(e))}function Fd(t,e){const n=typeof e=="string"?e:void 0,r=typeof e!="string"?{captureContext:e}:void 0;return U().captureMessage(t,n,r)}function pa(t,e){return U().captureEvent(t,e)}function fa(t,e){ae().setContext(t,e)}function Ud(t,e){ae().setTag(t,e)}function Ii(t){ae().setUser(t)}function Md(){return ae().lastEventId()}function jd(){const t=P();return(t==null?void 0:t.getOptions().enabled)!==!1&&!!(t!=null&&t.getTransport())}function vi(t){const e=ae(),n=U(),{userAgent:r}=k.navigator||{},s=rl({user:n.getUser()||e.getUser(),...r&&{userAgent:r},...t}),i=e.getSession();return(i==null?void 0:i.status)==="ok"&&_t(i,{status:"exited"}),ha(),e.setSession(s),s}function ha(){const t=ae(),n=U().getSession()||t.getSession();n&&sl(n),ga(),t.setSession()}function ga(){const t=ae(),e=P(),n=t.getSession();n&&e&&e.captureSession(n)}function Ri(t=!1){if(t){ha();return}ga()}const Hd="7";function ma(t){const e=t.protocol?`${t.protocol}:`:"",n=t.port?`:${t.port}`:"";return`${e}//${t.host}${n}${t.path?`/${t.path}`:""}/api/`}function Bd(t){return`${ma(t)}${t.projectId}/envelope/`}function qd(t,e){const n={sentry_version:Hd};return t.publicKey&&(n.sentry_key=t.publicKey),e&&(n.sentry_client=`${e.name}/${e.version}`),new URLSearchParams(n).toString()}function Vd(t,e,n){return e||`${Bd(t)}?${qd(t,n)}`}function Gd(t,e){const n=na(t);if(!n)return"";const r=`${ma(n)}embed/error-page/`;let s=`dsn=${wt(n)}`;for(const i in e)if(i!=="dsn"&&i!=="onClose")if(i==="user"){const o=e.user;if(!o)continue;o.name&&(s+=`&name=${encodeURIComponent(o.name)}`),o.email&&(s+=`&email=${encodeURIComponent(o.email)}`)}else s+=`&${encodeURIComponent(i)}=${encodeURIComponent(e[i])}`;return`${r}?${s}`}const wi=[];function zd(t){const e={};return t.forEach(n=>{const{name:r}=n,s=e[r];s&&!s.isDefaultInstance&&n.isDefaultInstance||(e[r]=n)}),Object.values(e)}function Wd(t){const e=t.defaultIntegrations||[],n=t.integrations;e.forEach(s=>{s.isDefaultInstance=!0});let r;if(Array.isArray(n))r=[...e,...n];else if(typeof n=="function"){const s=n(e);r=Array.isArray(s)?s:[s]}else r=e;return zd(r)}function Kd(t,e){const n={};return e.forEach(r=>{r&&_a(t,r,n)}),n}function Ci(t,e){for(const n of e)n!=null&&n.afterAllSetup&&n.afterAllSetup(t)}function _a(t,e,n){if(n[e.name]){I&&T.log(`Integration skipped because it was already installed: ${e.name}`);return}if(n[e.name]=e,wi.indexOf(e.name)===-1&&typeof e.setupOnce=="function"&&(e.setupOnce(),wi.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(t),typeof e.preprocessEvent=="function"){const r=e.preprocessEvent.bind(e);t.on("preprocessEvent",(s,i)=>r(s,i,t))}if(typeof e.processEvent=="function"){const r=e.processEvent.bind(e),s=Object.assign((i,o)=>r(i,o,t),{id:e.name});t.addEventProcessor(s)}I&&T.log(`Integration installed: ${e.name}`)}function Yd(t,e,n){const r=[{type:"client_report"},{timestamp:n||rt(),discarded_events:t}];return Ct(e?{dsn:e}:{},[r])}function Sa(t){const e=[];t.message&&e.push(t.message);try{const n=t.exception.values[t.exception.values.length-1];n!=null&&n.value&&(e.push(n.value),n.type&&e.push(`${n.type}: ${n.value}`))}catch{}return e}function Jd(t){var c;const{trace_id:e,parent_span_id:n,span_id:r,status:s,origin:i,data:o,op:a}=((c=t.contexts)==null?void 0:c.trace)??{};return{data:o??{},description:t.transaction,op:a,parent_span_id:n,span_id:r??"",start_timestamp:t.start_timestamp??0,status:s,timestamp:t.timestamp,trace_id:e??"",origin:i,profile_id:o==null?void 0:o[hs],exclusive_time:o==null?void 0:o[gs],measurements:t.measurements,is_segment:!0}}function Xd(t){return{type:"transaction",timestamp:t.timestamp,start_timestamp:t.start_timestamp,transaction:t.description,contexts:{trace:{trace_id:t.trace_id,span_id:t.span_id,parent_span_id:t.parent_span_id,op:t.op,status:t.status,origin:t.origin,data:{...t.data,...t.profile_id&&{[hs]:t.profile_id},...t.exclusive_time&&{[gs]:t.exclusive_time}}}},measurements:t.measurements}}const Ai="Not capturing exception because it's already been captured.",Oi="Discarded session because of missing or non-string release",Ea=Symbol.for("SentryInternalError"),ya=Symbol.for("SentryDoNotSendEventError");function vn(t){return{message:t,[Ea]:!0}}function pr(t){return{message:t,[ya]:!0}}function Ni(t){return!!t&&typeof t=="object"&&Ea in t}function ki(t){return!!t&&typeof t=="object"&&ya in t}class Qd{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=na(e.dsn):I&&T.warn("No DSN provided, client will not send events."),this._dsn){const n=Vd(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:n})}}captureException(e,n,r){const s=se();if(si(e))return I&&T.log(Ai),s;const i={event_id:s,...n};return this._process(this.eventFromException(e,i).then(o=>this._captureEvent(o,i,r))),i.event_id}captureMessage(e,n,r,s){const i={event_id:se(),...r},o=cs(e)?e:String(e),a=us(e)?this.eventFromMessage(o,n,i):this.eventFromException(e,i);return this._process(a.then(c=>this._captureEvent(c,i,s))),i.event_id}captureEvent(e,n,r){const s=se();if(n!=null&&n.originalException&&si(n.originalException))return I&&T.log(Ai),s;const i={event_id:s,...n},o=e.sdkProcessingMetadata||{},a=o.capturedSpanScope,c=o.capturedSpanIsolationScope;return this._process(this._captureEvent(e,i,a||r,c)),i.event_id}captureSession(e){this.sendSession(e),_t(e,{init:!1})}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const n=this._transport;return n?(this.emit("flush"),this._isClientDoneProcessing(e).then(r=>n.flush(e).then(s=>r&&s))):Qe(!0)}close(e){return this.flush(e).then(n=>(this.getOptions().enabled=!1,this.emit("close"),n))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some(({name:e})=>e.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const n=this._integrations[e.name];_a(this,e,this._integrations),n||Ci(this,[e])}sendEvent(e,n={}){this.emit("beforeSendEvent",e,n);let r=id(e,this._dsn,this._options._metadata,this._options.tunnel);for(const i of n.attachments||[])r=Jl(r,ed(i));const s=this.sendEnvelope(r);s&&s.then(i=>this.emit("afterSendEvent",e,i),null)}sendSession(e){const{release:n,environment:r=Ss}=this._options;if("aggregates"in e){const i=e.attrs||{};if(!i.release&&!n){I&&T.warn(Oi);return}i.release=i.release||n,i.environment=i.environment||r,e.attrs=i}else{if(!e.release&&!n){I&&T.warn(Oi);return}e.release=e.release||n,e.environment=e.environment||r}this.emit("beforeSendSession",e);const s=sd(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(s)}recordDroppedEvent(e,n,r=1){if(this._options.sendClientReports){const s=`${e}:${n}`;I&&T.log(`Recording outcome: "${s}"${r>1?` (${r} times)`:""}`),this._outcomes[s]=(this._outcomes[s]||0)+r}}on(e,n){const r=this._hooks[e]=this._hooks[e]||[];return r.push(n),()=>{const s=r.indexOf(n);s>-1&&r.splice(s,1)}}emit(e,...n){const r=this._hooks[e];r&&r.forEach(s=>s(...n))}sendEnvelope(e){return this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport?this._transport.send(e).then(null,n=>(I&&T.error("Error while sending envelope:",n),n)):(I&&T.error("Transport disabled"),Qe({}))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=Kd(this,e),Ci(this,e)}_updateSessionFromEvent(e,n){var c;let r=n.level==="fatal",s=!1;const i=(c=n.exception)==null?void 0:c.values;if(i){s=!0;for(const u of i){const l=u.mechanism;if((l==null?void 0:l.handled)===!1){r=!0;break}}}const o=e.status==="ok";(o&&e.errors===0||o&&r)&&(_t(e,{...r&&{status:"crashed"},errors:e.errors||Number(s||r)}),this.captureSession(e))}_isClientDoneProcessing(e){return new Pe(n=>{let r=0;const s=1,i=setInterval(()=>{this._numProcessing==0?(clearInterval(i),n(!0)):(r+=s,e&&r>=e&&(clearInterval(i),n(!1)))},s)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,n,r,s){const i=this.getOptions(),o=Object.keys(this._integrations);return!n.integrations&&(o!=null&&o.length)&&(n.integrations=o),this.emit("preprocessEvent",e,n),e.type||s.setLastEventId(e.event_id||n.event_id),wd(i,e,n,r,this,s).then(a=>{if(a===null)return a;this.emit("postprocessEvent",a,n),a.contexts={trace:hl(r),...a.contexts};const c=ia(this,r);return a.sdkProcessingMetadata={dynamicSamplingContext:c,...a.sdkProcessingMetadata},a})}_captureEvent(e,n={},r=U(),s=ae()){return I&&Mr(e)&&T.log(`Captured error event \`${Sa(e)[0]||"<unknown>"}\``),this._processEvent(e,n,r,s).then(i=>i.event_id,i=>{I&&(ki(i)?T.log(i.message):Ni(i)?T.warn(i.message):T.warn(i))})}_processEvent(e,n,r,s){const i=this.getOptions(),{sampleRate:o}=i,a=Ta(e),c=Mr(e),u=e.type||"error",l=`before send for type \`${u}\``,d=typeof o>"u"?void 0:zt(o);if(c&&typeof d=="number"&&Math.random()>d)return this.recordDroppedEvent("sample_rate","error"),Ln(pr(`Discarding event because it's not included in the random sample (sampling rate = ${o})`));const p=u==="replay_event"?"replay":u;return this._prepareEvent(e,n,r,s).then(f=>{if(f===null)throw this.recordDroppedEvent("event_processor",p),pr("An event processor returned `null`, will not send event.");if(n.data&&n.data.__sentry__===!0)return f;const h=ep(this,i,f,n);return Zd(h,l)}).then(f=>{var b;if(f===null){if(this.recordDroppedEvent("before_send",p),a){const E=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",E)}throw pr(`${l} returned \`null\`, will not send event.`)}const _=r.getSession()||s.getSession();if(c&&_&&this._updateSessionFromEvent(_,f),a){const v=((b=f.sdkProcessingMetadata)==null?void 0:b.spanCountBeforeProcessing)||0,E=f.spans?f.spans.length:0,y=v-E;y>0&&this.recordDroppedEvent("before_send","span",y)}const h=f.transaction_info;if(a&&h&&f.transaction!==e.transaction){const v="custom";f.transaction_info={...h,source:v}}return this.sendEvent(f,n),f}).then(null,f=>{throw ki(f)||Ni(f)?f:(this.captureException(f,{data:{__sentry__:!0},originalException:f}),vn(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${f}`))})}_process(e){this._numProcessing++,e.then(n=>(this._numProcessing--,n),n=>(this._numProcessing--,n))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map(([n,r])=>{const[s,i]=n.split(":");return{reason:s,category:i,quantity:r}})}_flushOutcomes(){I&&T.log("Flushing outcomes...");const e=this._clearOutcomes();if(e.length===0){I&&T.log("No outcomes to send");return}if(!this._dsn){I&&T.log("No dsn provided, will not send outcomes");return}I&&T.log("Sending outcomes:",e);const n=Yd(e,this._options.tunnel&&wt(this._dsn));this.sendEnvelope(n)}}function Zd(t,e){const n=`${e} must return \`null\` or a valid event.`;if(Yn(t))return t.then(r=>{if(!Bt(r)&&r!==null)throw vn(n);return r},r=>{throw vn(`${e} rejected with ${r}`)});if(!Bt(t)&&t!==null)throw vn(n);return t}function ep(t,e,n,r){const{beforeSend:s,beforeSendTransaction:i,beforeSendSpan:o}=e;let a=n;if(Mr(a)&&s)return s(a,r);if(Ta(a)){if(o){const c=o(Jd(a));if(c?a=Zt(n,Xd(c)):xr(),a.spans){const u=[];for(const l of a.spans){const d=o(l);d?u.push(d):(xr(),u.push(l))}a.spans=u}}if(i){if(a.spans){const c=a.spans.length;a.sdkProcessingMetadata={...n.sdkProcessingMetadata,spanCountBeforeProcessing:c}}return i(a,r)}}return a}function Mr(t){return t.type===void 0}function Ta(t){return t.type==="transaction"}function tp(t){return[{type:"log",item_count:t.length,content_type:"application/vnd.sentry.items.log+json"},{items:t}]}function np(t,e,n,r){const s={};return e!=null&&e.sdk&&(s.sdk={name:e.sdk.name,version:e.sdk.version}),n&&r&&(s.dsn=wt(r)),Ct(s,[tp(t)])}k._sentryClientToLogBufferMap=new WeakMap;function fr(t,e){var i;const n=e??rp(t)??[];if(n.length===0)return;const r=t.getOptions(),s=np(n,r._metadata,r.tunnel,t.getDsn());(i=k._sentryClientToLogBufferMap)==null||i.set(t,[]),t.emit("flushLogs"),t.sendEnvelope(s)}function rp(t){var e;return(e=k._sentryClientToLogBufferMap)==null?void 0:e.get(t)}function sp(t,e){e.debug===!0&&(I?T.enable():bt(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})),U().update(e.initialScope);const r=new t(e);return ip(r),r.init(),r}function ip(t){U().setClient(t)}const ba=Symbol.for("SentryBufferFullError");function op(t){const e=[];function n(){return t===void 0||e.length<t}function r(o){return e.splice(e.indexOf(o),1)[0]||Promise.resolve(void 0)}function s(o){if(!n())return Ln(ba);const a=o();return e.indexOf(a)===-1&&e.push(a),a.then(()=>r(a)).then(null,()=>r(a).then(null,()=>{})),a}function i(o){return new Pe((a,c)=>{let u=e.length;if(!u)return a(!0);const l=setTimeout(()=>{o&&o>0&&a(!1)},o);e.forEach(d=>{Qe(d).then(()=>{--u||(clearTimeout(l),a(!0))},c)})})}return{$:e,add:s,drain:i}}const ap=60*1e3;function cp(t,e=Date.now()){const n=parseInt(`${t}`,10);if(!isNaN(n))return n*1e3;const r=Date.parse(`${t}`);return isNaN(r)?ap:r-e}function up(t,e){return t[e]||t.all||0}function lp(t,e,n=Date.now()){return up(t,e)>n}function dp(t,{statusCode:e,headers:n},r=Date.now()){const s={...t},i=n==null?void 0:n["x-sentry-rate-limits"],o=n==null?void 0:n["retry-after"];if(i)for(const a of i.trim().split(",")){const[c,u,,,l]=a.split(":",5),d=parseInt(c,10),p=(isNaN(d)?60:d)*1e3;if(!u)s.all=r+p;else for(const f of u.split(";"))f==="metric_bucket"?(!l||l.split(";").includes("custom"))&&(s[f]=r+p):s[f]=r+p}else o?s.all=r+cp(o,r):e===429&&(s.all=r+60*1e3);return s}const pp=64;function fp(t,e,n=op(t.bufferSize||pp)){let r={};const s=o=>n.drain(o);function i(o){const a=[];if(pi(o,(d,p)=>{const f=fi(p);lp(r,f)?t.recordDroppedEvent("ratelimit_backoff",f):a.push(d)}),a.length===0)return Qe({});const c=Ct(o[0],a),u=d=>{pi(c,(p,f)=>{t.recordDroppedEvent(d,fi(f))})},l=()=>e({body:Xl(c)}).then(d=>(d.statusCode!==void 0&&(d.statusCode<200||d.statusCode>=300)&&I&&T.warn(`Sentry responded with status code ${d.statusCode} to sent event.`),r=dp(r,d),d),d=>{throw u("network_error"),I&&T.error("Encountered error running transport request:",d),d});return n.add(l).then(d=>d,d=>{if(d===ba)return I&&T.error("Skipped sending event because buffer is full."),u("queue_overflow"),Qe({});throw d})}return{send:i,flush:s}}function hp(t){var e;((e=t.user)==null?void 0:e.ip_address)===void 0&&(t.user={...t.user,ip_address:"{{auto}}"})}function gp(t){var e;"aggregates"in t?((e=t.attrs)==null?void 0:e.ip_address)===void 0&&(t.attrs={...t.attrs,ip_address:"{{auto}}"}):t.ipAddress===void 0&&(t.ipAddress="{{auto}}")}function mp(t,e,n=[e],r="npm"){const s=t._metadata||{};s.sdk||(s.sdk={name:`sentry.javascript.${e}`,packages:n.map(i=>({name:`${r}:@sentry/${i}`,version:Be})),version:Be}),t._metadata=s}function Ia(t={}){const e=t.client||P();if(!jd()||!e)return{};const n=tt(),r=vt(n);if(r.getTraceData)return r.getTraceData(t);const s=t.scope||U(),i=t.span||Rt(),o=i?kl(i):_p(s),a=i?ke(i):ia(e,s),c=Il(a);return Yo.test(o)?{"sentry-trace":o,baggage:c}:(T.warn("Invalid sentry-trace data. Cannot generate trace data"),{})}function _p(t){const{traceId:e,sampled:n,propagationSpanId:r}=t.getPropagationContext();return Jo(e,r,n)}const Sp=100;function Le(t,e){const n=P(),r=ae();if(!n)return;const{beforeBreadcrumb:s=null,maxBreadcrumbs:i=Sp}=n.getOptions();if(i<=0)return;const a={timestamp:rt(),...t},c=s?bt(()=>s(a,e)):a;c!==null&&(n.emit&&n.emit("beforeAddBreadcrumb",c,e),r.addBreadcrumb(c,i))}let Pi;const Ep="FunctionToString",Li=new WeakMap,yp=()=>({name:Ep,setupOnce(){Pi=Function.prototype.toString;try{Function.prototype.toString=function(...t){const e=ds(this),n=Li.has(P())&&e!==void 0?e:this;return Pi.apply(n,t)}}catch{}},setup(t){Li.set(t,!0)}}),Tp=yp,bp=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,/^Can't find variable: gmo$/,/^undefined is not an object \(evaluating 'a\.[A-Z]'\)$/,`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/,/^Java exception was raised during method invocation$/],Ip="EventFilters",vp=(t={})=>{let e;return{name:Ip,setup(n){const r=n.getOptions();e=xi(t,r)},processEvent(n,r,s){if(!e){const i=s.getOptions();e=xi(t,i)}return wp(n,e)?null:n}}},Rp=(t={})=>({...vp(t),name:"InboundFilters"});function xi(t={},e={}){return{allowUrls:[...t.allowUrls||[],...e.allowUrls||[]],denyUrls:[...t.denyUrls||[],...e.denyUrls||[]],ignoreErrors:[...t.ignoreErrors||[],...e.ignoreErrors||[],...t.disableErrorDefaults?[]:bp],ignoreTransactions:[...t.ignoreTransactions||[],...e.ignoreTransactions||[]]}}function wp(t,e){if(t.type){if(t.type==="transaction"&&Ap(t,e.ignoreTransactions))return I&&T.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${He(t)}`),!0}else{if(Cp(t,e.ignoreErrors))return I&&T.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${He(t)}`),!0;if(Pp(t))return I&&T.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${He(t)}`),!0;if(Op(t,e.denyUrls))return I&&T.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${He(t)}.
Url: ${xn(t)}`),!0;if(!Np(t,e.allowUrls))return I&&T.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${He(t)}.
Url: ${xn(t)}`),!0}return!1}function Cp(t,e){return e!=null&&e.length?Sa(t).some(n=>Ve(n,e)):!1}function Ap(t,e){if(!(e!=null&&e.length))return!1;const n=t.transaction;return n?Ve(n,e):!1}function Op(t,e){if(!(e!=null&&e.length))return!1;const n=xn(t);return n?Ve(n,e):!1}function Np(t,e){if(!(e!=null&&e.length))return!0;const n=xn(t);return n?Ve(n,e):!0}function kp(t=[]){for(let e=t.length-1;e>=0;e--){const n=t[e];if(n&&n.filename!=="<anonymous>"&&n.filename!=="[native code]")return n.filename||null}return null}function xn(t){var e,n;try{const r=[...((e=t.exception)==null?void 0:e.values)??[]].reverse().find(i=>{var o,a,c;return((o=i.mechanism)==null?void 0:o.parent_id)===void 0&&((c=(a=i.stacktrace)==null?void 0:a.frames)==null?void 0:c.length)}),s=(n=r==null?void 0:r.stacktrace)==null?void 0:n.frames;return s?kp(s):null}catch{return I&&T.error(`Cannot extract url for event ${He(t)}`),null}}function Pp(t){var e,n;return(n=(e=t.exception)==null?void 0:e.values)!=null&&n.length?!t.message&&!t.exception.values.some(r=>r.stacktrace||r.type&&r.type!=="Error"||r.value):!1}function Lp(t,e,n,r,s,i){var a;if(!((a=s.exception)!=null&&a.values)||!i||!me(i.originalException,Error))return;const o=s.exception.values.length>0?s.exception.values[s.exception.values.length-1]:void 0;o&&(s.exception.values=jr(t,e,r,i.originalException,n,s.exception.values,o,0))}function jr(t,e,n,r,s,i,o,a){if(i.length>=n+1)return i;let c=[...i];if(me(r[s],Error)){$i(o,a);const u=t(e,r[s]),l=c.length;Di(u,s,l,a),c=jr(t,e,n,r[s],s,[u,...c],u,l)}return Array.isArray(r.errors)&&r.errors.forEach((u,l)=>{if(me(u,Error)){$i(o,a);const d=t(e,u),p=c.length;Di(d,`errors[${l}]`,p,a),c=jr(t,e,n,u,s,[d,...c],d,p)}}),c}function $i(t,e){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,...t.type==="AggregateError"&&{is_exception_group:!0},exception_id:e}}function Di(t,e,n,r){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,type:"chained",source:e,exception_id:n,parent_id:r}}function xp(t){const e="console";Jt(e,t),Xt(e,$p)}function $p(){"console"in k&&xu.forEach(function(t){t in k.console&&he(k.console,t,function(e){return An[t]=e,function(...n){qe("console",{args:n,level:t});const s=An[t];s==null||s.apply(k.console,n)}})})}function Dp(t){return t==="warn"?"warning":["fatal","error","warning","log","info","debug"].includes(t)?t:"log"}const Fp="Dedupe",Up=()=>{let t;return{name:Fp,processEvent(e){if(e.type)return e;try{if(jp(e,t))return I&&T.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return t=e}}},Mp=Up;function jp(t,e){return e?!!(Hp(t,e)||Bp(t,e)):!1}function Hp(t,e){const n=t.message,r=e.message;return!(!n&&!r||n&&!r||!n&&r||n!==r||!Ra(t,e)||!va(t,e))}function Bp(t,e){const n=Fi(e),r=Fi(t);return!(!n||!r||n.type!==r.type||n.value!==r.value||!Ra(t,e)||!va(t,e))}function va(t,e){let n=Qs(t),r=Qs(e);if(!n&&!r)return!0;if(n&&!r||!n&&r||(n=n,r=r,r.length!==n.length))return!1;for(let s=0;s<r.length;s++){const i=r[s],o=n[s];if(i.filename!==o.filename||i.lineno!==o.lineno||i.colno!==o.colno||i.function!==o.function)return!1}return!0}function Ra(t,e){let n=t.fingerprint,r=e.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;n=n,r=r;try{return n.join("")===r.join("")}catch{return!1}}function Fi(t){var e;return((e=t.exception)==null?void 0:e.values)&&t.exception.values[0]}const qp="thismessage:/";function wa(t){return"isRelative"in t}function Ca(t,e){const n=t.indexOf("://")<=0&&t.indexOf("//")!==0,r=e??(n?qp:void 0);try{if("canParse"in URL&&!URL.canParse(t,r))return;const s=new URL(t,r);return n?{isRelative:n,pathname:s.pathname,search:s.search,hash:s.hash}:s}catch{}}function Vp(t){if(wa(t))return t.pathname;const e=new URL(t);return e.search="",e.hash="",["80","443"].includes(e.port)&&(e.port=""),e.password&&(e.password="%filtered%"),e.username&&(e.username="%filtered%"),e.toString()}function ht(t){if(!t)return{};const e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const n=e[6]||"",r=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:n,hash:r,relative:e[5]+n+r}}function Gp(t){return t.split(/[?#]/,1)[0]}function zp(t,e,n,r,s="auto.http.browser"){if(!t.fetchData)return;const{method:i,url:o}=t.fetchData,a=Ne()&&e(o);if(t.endTimestamp&&a){const d=t.fetchData.__span;if(!d)return;const p=r[d];p&&(Kp(p,t),delete r[d]);return}const c=!!Rt(),u=a&&c?Jn(Jp(o,i,s)):new Xe;if(t.fetchData.__span=u.spanContext().spanId,r[u.spanContext().spanId]=u,n(t.fetchData.url)){const d=t.args[0],p=t.args[1]||{},f=Wp(d,p,Ne()&&c?u:void 0);f&&(t.args[1]=p,p.headers=f)}const l=P();if(l){const d={input:t.args,response:t.response,startTimestamp:t.startTimestamp,endTimestamp:t.endTimestamp};l.emit("beforeOutgoingRequestSpan",u,d)}return u}function Wp(t,e,n){const r=Ia({span:n}),s=r["sentry-trace"],i=r.baggage;if(!s)return;const o=e.headers||(Fo(t)?t.headers:void 0);if(o)if(Yp(o)){const a=new Headers(o);if(a.get("sentry-trace")||a.set("sentry-trace",s),i){const c=a.get("baggage");c?gn(c)||a.set("baggage",`${c},${i}`):a.set("baggage",i)}return a}else if(Array.isArray(o)){const a=[...o];o.find(u=>u[0]==="sentry-trace")||a.push(["sentry-trace",s]);const c=o.find(u=>u[0]==="baggage"&&gn(u[1]));return i&&!c&&a.push(["baggage",i]),a}else{const a="sentry-trace"in o?o["sentry-trace"]:void 0,c="baggage"in o?o.baggage:void 0,u=c?Array.isArray(c)?[...c]:[c]:[],l=c&&(Array.isArray(c)?c.find(d=>gn(d)):gn(c));return i&&!l&&u.push(i),{...o,"sentry-trace":a??s,baggage:u.length>0?u.join(","):void 0}}else return{...r}}function Kp(t,e){var n;if(e.response){Go(t,e.response.status);const r=((n=e.response)==null?void 0:n.headers)&&e.response.headers.get("content-length");if(r){const s=parseInt(r);s>0&&t.setAttribute("http.response_content_length",s)}}else e.error&&t.setStatus({code:G,message:"internal_error"});t.end()}function gn(t){return t.split(",").some(e=>e.trim().startsWith(ms))}function Yp(t){return typeof Headers<"u"&&me(t,Headers)}function Jp(t,e,n){const r=Ca(t);return{name:r?`${e} ${Vp(r)}`:e,attributes:Xp(t,r,e,n)}}function Xp(t,e,n,r){const s={url:t,type:"fetch","http.method":n,[Je]:r,[Gt]:"http.client"};return e&&(wa(e)||(s["http.url"]=e.href,s["server.address"]=e.host),e.search&&(s["http.query"]=e.search),e.hash&&(s["http.fragment"]=e.hash)),s}function Aa(t){if(t!==void 0)return t>=400&&t<500?"warning":t>=500?"error":void 0}const Hr=k;function Qp(){if(!("fetch"in Hr))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function Ui(t){return t&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}function Zp(){var n;if(typeof EdgeRuntime=="string")return!0;if(!Qp())return!1;if(Ui(Hr.fetch))return!0;let t=!1;const e=Hr.document;if(e&&typeof e.createElement=="function")try{const r=e.createElement("iframe");r.hidden=!0,e.head.appendChild(r),(n=r.contentWindow)!=null&&n.fetch&&(t=Ui(r.contentWindow.fetch)),e.head.removeChild(r)}catch(r){I&&T.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",r)}return t}function Oa(t,e){const n="fetch";Jt(n,t),Xt(n,()=>Na(void 0,e))}function ef(t){const e="fetch-body-resolved";Jt(e,t),Xt(e,()=>Na(nf))}function Na(t,e=!1){e&&!Zp()||he(k,"fetch",function(n){return function(...r){const s=new Error,{method:i,url:o}=rf(r),a={args:r,fetchData:{method:i,url:o},startTimestamp:Z()*1e3,virtualError:s,headers:sf(r)};return t||qe("fetch",{...a}),n.apply(k,r).then(async c=>(t?t(c):qe("fetch",{...a,endTimestamp:Z()*1e3,response:c}),c),c=>{if(qe("fetch",{...a,endTimestamp:Z()*1e3,error:c}),as(c)&&c.stack===void 0&&(c.stack=s.stack,oe(c,"framesToPop",1)),c instanceof TypeError&&(c.message==="Failed to fetch"||c.message==="Load failed"||c.message==="NetworkError when attempting to fetch resource."))try{const u=new URL(a.fetchData.url);c.message=`${c.message} (${u.host})`}catch{}throw c})}})}async function tf(t,e){if(t!=null&&t.body){const n=t.body,r=n.getReader(),s=setTimeout(()=>{n.cancel().then(null,()=>{})},90*1e3);let i=!0;for(;i;){let o;try{o=setTimeout(()=>{n.cancel().then(null,()=>{})},5e3);const{done:a}=await r.read();clearTimeout(o),a&&(e(),i=!1)}catch{i=!1}finally{clearTimeout(o)}}clearTimeout(s),r.releaseLock(),n.cancel().then(null,()=>{})}}function nf(t){let e;try{e=t.clone()}catch{return}tf(e,()=>{qe("fetch-body-resolved",{endTimestamp:Z()*1e3,response:t})})}function Br(t,e){return!!t&&typeof t=="object"&&!!t[e]}function Mi(t){return typeof t=="string"?t:t?Br(t,"url")?t.url:t.toString?t.toString():"":""}function rf(t){if(t.length===0)return{method:"GET",url:""};if(t.length===2){const[n,r]=t;return{url:Mi(n),method:Br(r,"method")?String(r.method).toUpperCase():"GET"}}const e=t[0];return{url:Mi(e),method:Br(e,"method")?String(e.method).toUpperCase():"GET"}}function sf(t){const[e,n]=t;try{if(typeof n=="object"&&n!==null&&"headers"in n&&n.headers)return new Headers(n.headers);if(Fo(e))return new Headers(e.headers)}catch{}}function of(){return"npm"}const O=k;let qr=0;function ka(){return qr>0}function af(){qr++,setTimeout(()=>{qr--})}function Et(t,e={}){function n(s){return typeof s=="function"}if(!n(t))return t;try{const s=t.__sentry_wrapped__;if(s)return typeof s=="function"?s:t;if(ds(t))return t}catch{return t}const r=function(...s){try{const i=s.map(o=>Et(o,e));return t.apply(this,i)}catch(i){throw af(),Vt(o=>{o.addEventProcessor(a=>(e.mechanism&&(Nr(a,void 0,void 0),mt(a,e.mechanism)),a.extra={...a.extra,arguments:s},a)),da(i)}),i}};try{for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=t[s])}catch{}Mo(r,t),oe(t,"__sentry_wrapped__",r);try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get(){return t.name}})}catch{}return r}function ys(){const t=Qt(),{referrer:e}=O.document||{},{userAgent:n}=O.navigator||{},r={...e&&{Referer:e},...n&&{"User-Agent":n}};return{url:t,headers:r}}function Ts(t,e){const n=bs(t,e),r={type:pf(e),value:ff(e)};return n.length&&(r.stacktrace={frames:n}),r.type===void 0&&r.value===""&&(r.value="Unrecoverable error caught"),r}function cf(t,e,n,r){const s=P(),i=s==null?void 0:s.getOptions().normalizeDepth,o=Sf(e),a={__serialized__:oa(e,i)};if(o)return{exception:{values:[Ts(t,o)]},extra:a};const c={exception:{values:[{type:Kn(e)?e.constructor.name:r?"UnhandledRejection":"Error",value:mf(e,{isUnhandledRejection:r})}]},extra:a};if(n){const u=bs(t,n);u.length&&(c.exception.values[0].stacktrace={frames:u})}return c}function hr(t,e){return{exception:{values:[Ts(t,e)]}}}function bs(t,e){const n=e.stacktrace||e.stack||"",r=lf(e),s=df(e);try{return t(n,r,s)}catch{}return[]}const uf=/Minified React error #\d+;/i;function lf(t){return t&&uf.test(t.message)?1:0}function df(t){return typeof t.framesToPop=="number"?t.framesToPop:0}function Pa(t){return typeof WebAssembly<"u"&&typeof WebAssembly.Exception<"u"?t instanceof WebAssembly.Exception:!1}function pf(t){const e=t==null?void 0:t.name;return!e&&Pa(t)?t.message&&Array.isArray(t.message)&&t.message.length==2?t.message[0]:"WebAssembly.Exception":e}function ff(t){const e=t==null?void 0:t.message;return Pa(t)?Array.isArray(t.message)&&t.message.length==2?t.message[1]:"wasm exception":e?e.error&&typeof e.error.message=="string"?e.error.message:e:"No error message"}function hf(t,e,n,r){const s=(n==null?void 0:n.syntheticException)||void 0,i=Is(t,e,s,r);return mt(i),i.level="error",n!=null&&n.event_id&&(i.event_id=n.event_id),Qe(i)}function gf(t,e,n="info",r,s){const i=(r==null?void 0:r.syntheticException)||void 0,o=Vr(t,e,i,s);return o.level=n,r!=null&&r.event_id&&(o.event_id=r.event_id),Qe(o)}function Is(t,e,n,r,s){let i;if($o(e)&&e.error)return hr(t,e.error);if(ei(e)||Vu(e)){const o=e;if("stack"in e)i=hr(t,e);else{const a=o.name||(ei(o)?"DOMError":"DOMException"),c=o.message?`${a}: ${o.message}`:a;i=Vr(t,c,n,r),Nr(i,c)}return"code"in o&&(i.tags={...i.tags,"DOMException.code":`${o.code}`}),i}return as(e)?hr(t,e):Bt(e)||Kn(e)?(i=cf(t,e,n,s),mt(i,{synthetic:!0}),i):(i=Vr(t,e,n,r),Nr(i,`${e}`,void 0),mt(i,{synthetic:!0}),i)}function Vr(t,e,n,r){const s={};if(r&&n){const i=bs(t,n);i.length&&(s.exception={values:[{value:e,stacktrace:{frames:i}}]}),mt(s,{synthetic:!0})}if(cs(e)){const{__sentry_template_string__:i,__sentry_template_values__:o}=e;return s.logentry={message:i,params:o},s}return s.message=e,s}function mf(t,{isUnhandledRejection:e}){const n=Qu(t),r=e?"promise rejection":"exception";return $o(t)?`Event \`ErrorEvent\` captured as ${r} with message \`${t.message}\``:Kn(t)?`Event \`${_f(t)}\` (type=${t.type}) captured as ${r}`:`Object captured as ${r} with keys: ${n}`}function _f(t){try{const e=Object.getPrototypeOf(t);return e?e.constructor.name:void 0}catch{}}function Sf(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const n=t[e];if(n instanceof Error)return n}}const Ef=5e3;class yf extends Qd{constructor(e){const n=Tf(e),r=O.SENTRY_SDK_SOURCE||of();mp(n,"browser",["browser"],r),super(n);const{sendDefaultPii:s,sendClientReports:i,_experiments:o}=this._options,a=o==null?void 0:o.enableLogs;O.document&&(i||a)&&O.document.addEventListener("visibilitychange",()=>{O.document.visibilityState==="hidden"&&(i&&this._flushOutcomes(),a&&fr(this))}),a&&(this.on("flush",()=>{fr(this)}),this.on("afterCaptureLog",()=>{this._logFlushIdleTimeout&&clearTimeout(this._logFlushIdleTimeout),this._logFlushIdleTimeout=setTimeout(()=>{fr(this)},Ef)})),s&&(this.on("postprocessEvent",hp),this.on("beforeSendSession",gp))}eventFromException(e,n){return hf(this._options.stackParser,e,n,this._options.attachStacktrace)}eventFromMessage(e,n="info",r){return gf(this._options.stackParser,e,n,r,this._options.attachStacktrace)}_prepareEvent(e,n,r,s){return e.platform=e.platform||"javascript",super._prepareEvent(e,n,r,s)}}function Tf(t){var e;return{release:typeof __SENTRY_RELEASE__=="string"?__SENTRY_RELEASE__:(e=O.SENTRY_RELEASE)==null?void 0:e.id,sendClientReports:!0,parentSpanIsAlwaysRootSpan:!0,...t}}const B=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,ne=globalThis,Dt="9.38.0";function At(){return vs(ne),ne}function vs(t){const e=t.__SENTRY__=t.__SENTRY__||{};return e.version=e.version||Dt,e[Dt]=e[Dt]||{}}function Rs(t,e,n=ne){const r=n.__SENTRY__=n.__SENTRY__||{},s=r[Dt]=r[Dt]||{};return s[t]||(s[t]=e())}const bf="Sentry Logger ",ji={};function La(t){if(!("console"in ne))return t();const e=ne.console,n={},r=Object.keys(ji);r.forEach(s=>{const i=ji[s];n[s]=e[s],e[s]=i});try{return t()}finally{r.forEach(s=>{e[s]=n[s]})}}function xa(){Cs().enabled=!0}function $a(){Cs().enabled=!1}function ws(){return Cs().enabled}function Da(...t){it("log",...t)}function If(...t){it("info",...t)}function Fa(...t){it("warn",...t)}function Ua(...t){it("error",...t)}function vf(...t){it("debug",...t)}function Rf(...t){it("assert",...t)}function wf(...t){it("trace",...t)}function it(t,...e){B&&ws()&&La(()=>{ne.console[t](`${bf}[${t}]:`,...e)})}function Cs(){return B?Rs("loggerSettings",()=>({enabled:!1})):{enabled:!1}}const Xn={enable:xa,disable:$a,isEnabled:ws,log:Da,info:If,warn:Fa,error:Ua,debug:vf,assert:Rf,trace:wf},W={enable:xa,disable:$a,isEnabled:ws,log:Da,warn:Fa,error:Ua},gr="<anonymous>";function Ma(t){try{return!t||typeof t!="function"?gr:t.name||gr}catch{return gr}}const Rn={},Hi={};function As(t,e){Rn[t]=Rn[t]||[],Rn[t].push(e)}function Os(t,e){if(!Hi[t]){Hi[t]=!0;try{e()}catch(n){B&&W.error(`Error while instrumenting ${t}`,n)}}}function Wt(t,e){const n=t&&Rn[t];if(n)for(const r of n)try{r(e)}catch(s){B&&W.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${Ma(r)}
Error:`,s)}}const Cf=Object.prototype.toString;function Ns(t,e){return Cf.call(t)===`[object ${e}]`}function we(t){return Ns(t,"String")}function Af(t){return typeof t=="object"&&t!==null&&"__sentry_template_string__"in t&&"__sentry_template_values__"in t}function Bi(t){return t===null||Af(t)||typeof t!="object"&&typeof t!="function"}function Of(t){return Ns(t,"Object")}function Nf(t){return Ns(t,"RegExp")}function ja(t){return!!(t!=null&&t.then&&typeof t.then=="function")}const Ha=ne,kf=80;function xe(t,e={}){if(!t)return"<unknown>";try{let n=t;const r=5,s=[];let i=0,o=0;const a=" > ",c=a.length;let u;const l=Array.isArray(e)?e:e.keyAttrs,d=!Array.isArray(e)&&e.maxStringLength||kf;for(;n&&i++<r&&(u=Pf(n,l),!(u==="html"||i>1&&o+s.length*c+u.length>=d));)s.push(u),o+=u.length,n=n.parentNode;return s.reverse().join(a)}catch{return"<unknown>"}}function Pf(t,e){const n=t,r=[];if(!(n!=null&&n.tagName))return"";if(Ha.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const s=e!=null&&e.length?e.filter(o=>n.getAttribute(o)).map(o=>[o,n.getAttribute(o)]):null;if(s!=null&&s.length)s.forEach(o=>{r.push(`[${o[0]}="${o[1]}"]`)});else{n.id&&r.push(`#${n.id}`);const o=n.className;if(o&&we(o)){const a=o.split(/\s+/);for(const c of a)r.push(`.${c}`)}}const i=["aria-label","type","name","title","alt"];for(const o of i){const a=n.getAttribute(o);a&&r.push(`[${o}="${a}"]`)}return r.join("")}function Lf(t){if(!Ha.HTMLElement)return null;let e=t;const n=5;for(let r=0;r<n;r++){if(!e)return null;if(e instanceof HTMLElement){if(e.dataset.sentryComponent)return e.dataset.sentryComponent;if(e.dataset.sentryElement)return e.dataset.sentryElement}e=e.parentNode}return null}function xf(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:`${t.slice(0,e)}...`}function $f(t,e,n=!1){return we(t)?Nf(e)?e.test(t):we(e)?n?t===e:t.includes(e):!1:!1}function Df(t,e=[],n=!1){return e.some(r=>$f(t,r,n))}function $n(t,e,n){if(!(e in t))return;const r=t[e];if(typeof r!="function")return;const s=n(r);typeof s=="function"&&Ff(s,r);try{t[e]=s}catch{B&&W.log(`Failed to replace method "${e}" in object`,t)}}function _e(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch{B&&W.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function Ff(t,e){try{const n=e.prototype||{};t.prototype=e.prototype=n,_e(t,"__sentry_original__",e)}catch{}}function Uf(){const t=ne;return t.crypto||t.msCrypto}function We(t=Uf()){let e=()=>Math.random()*16;try{if(t!=null&&t.randomUUID)return t.randomUUID().replace(/-/g,"");t!=null&&t.getRandomValues&&(e=()=>{const n=new Uint8Array(1);return t.getRandomValues(n),n[0]})}catch{}return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,n=>(n^(e()&15)>>n/4).toString(16))}const Ba=1e3;function qa(){return Date.now()/Ba}function Mf(){const{performance:t}=ne;if(!(t!=null&&t.now)||!t.timeOrigin)return qa;const e=t.timeOrigin;return()=>(e+t.now())/Ba}let qi;function Ce(){return(qi??(qi=Mf()))()}let mr;function jf(){var l;const{performance:t}=ne;if(!(t!=null&&t.now))return[void 0,"none"];const e=3600*1e3,n=t.now(),r=Date.now(),s=t.timeOrigin?Math.abs(t.timeOrigin+n-r):e,i=s<e,o=(l=t.timing)==null?void 0:l.navigationStart,c=typeof o=="number"?Math.abs(o+n-r):e,u=c<e;return i||u?s<=c?[t.timeOrigin,"timeOrigin"]:[o,"navigationStart"]:[r,"dateNow"]}function ce(){return mr||(mr=jf()),mr[0]}function Hf(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),!t.did&&!e.did&&(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||Ce(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:We()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const n=t.timestamp-t.started;t.duration=n>=0?n:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function Va(t,e,n=2){if(!e||typeof e!="object"||n<=0)return e;if(t&&Object.keys(e).length===0)return t;const r={...t};for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=Va(r[s],e[s],n-1));return r}function Dn(){return We()}function Ga(){return We().substring(16)}const Gr="_sentrySpan";function Fn(t,e){e?_e(t,Gr,e):delete t[Gr]}function Un(t){return t[Gr]}const Bf=100;class Ze{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:Dn(),sampleRand:Math.random()}}clone(){const e=new Ze;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,Fn(e,Un(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&Hf(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,n){return this._tags={...this._tags,[e]:n},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,n){return this._extra={...this._extra,[e]:n},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,n){return n===null?delete this._contexts[e]:this._contexts[e]=n,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const n=typeof e=="function"?e(this):e,r=n instanceof Ze?n.getScopeData():Of(n)?e:void 0,{tags:s,extra:i,user:o,contexts:a,level:c,fingerprint:u=[],propagationContext:l}=r||{};return this._tags={...this._tags,...s},this._extra={...this._extra,...i},this._contexts={...this._contexts,...a},o&&Object.keys(o).length&&(this._user=o),c&&(this._level=c),u.length&&(this._fingerprint=u),l&&(this._propagationContext=l),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,Fn(this,void 0),this._attachments=[],this.setPropagationContext({traceId:Dn(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(e,n){var i;const r=typeof n=="number"?n:Bf;if(r<=0)return this;const s={timestamp:qa(),...e,message:e.message?xf(e.message,2048):e.message};return this._breadcrumbs.push(s),this._breadcrumbs.length>r&&(this._breadcrumbs=this._breadcrumbs.slice(-r),(i=this._client)==null||i.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:Un(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=Va(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,n){const r=(n==null?void 0:n.event_id)||We();if(!this._client)return B&&W.warn("No client configured on scope - will not capture exception!"),r;const s=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:s,...n,event_id:r},this),r}captureMessage(e,n,r){const s=(r==null?void 0:r.event_id)||We();if(!this._client)return B&&W.warn("No client configured on scope - will not capture message!"),s;const i=new Error(e);return this._client.captureMessage(e,n,{originalException:e,syntheticException:i,...r,event_id:s},this),s}captureEvent(e,n){const r=(n==null?void 0:n.event_id)||We();return this._client?(this._client.captureEvent(e,{...n,event_id:r},this),r):(B&&W.warn("No client configured on scope - will not capture event!"),r)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}function qf(){return Rs("defaultCurrentScope",()=>new Ze)}function Vf(){return Rs("defaultIsolationScope",()=>new Ze)}class Gf{constructor(e,n){let r;e?r=e:r=new Ze;let s;n?s=n:s=new Ze,this._stack=[{scope:r}],this._isolationScope=s}withScope(e){const n=this._pushScope();let r;try{r=e(n)}catch(s){throw this._popScope(),s}return ja(r)?r.then(s=>(this._popScope(),s),s=>{throw this._popScope(),s}):(this._popScope(),r)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}}function yt(){const t=At(),e=vs(t);return e.stack=e.stack||new Gf(qf(),Vf())}function zf(t){return yt().withScope(t)}function Wf(t,e){const n=yt();return n.withScope(()=>(n.getStackTop().scope=t,e(t)))}function Vi(t){return yt().withScope(()=>t(yt().getIsolationScope()))}function Kf(){return{withIsolationScope:Vi,withScope:zf,withSetScope:Wf,withSetIsolationScope:(t,e)=>Vi(e),getCurrentScope:()=>yt().getScope(),getIsolationScope:()=>yt().getIsolationScope()}}function tn(t){const e=vs(t);return e.acs?e.acs:Kf()}function pe(){const t=At();return tn(t).getCurrentScope()}function Yf(){const t=At();return tn(t).getIsolationScope()}function ks(...t){const e=At(),n=tn(e);if(t.length===2){const[r,s]=t;return r?n.withSetScope(r,s):n.withScope(s)}return n.withScope(t[0])}function ye(){return pe().getClient()}const Kt="sentry.source",za="sentry.sample_rate",Jf="sentry.previous_trace_sample_rate",et="sentry.op",Y="sentry.origin",nn="sentry.measurement_unit",rn="sentry.measurement_value",Gi="sentry.custom_span_name",Xf="sentry.profile_id",Qn="sentry.exclusive_time",Qf=0,Zf=1,eh=2,Wa="_sentryScope",Ka="_sentryIsolationScope";function th(t,e,n){t&&(_e(t,Ka,n),_e(t,Wa,e))}function zr(t){return{scope:t[Wa],isolationScope:t[Ka]}}const nh="sentry-",rh=/^sentry-/;function sh(t){const e=ih(t);if(!e)return;const n=Object.entries(e).reduce((r,[s,i])=>{if(s.match(rh)){const o=s.slice(nh.length);r[o]=i}return r},{});if(Object.keys(n).length>0)return n}function ih(t){if(!(!t||!we(t)&&!Array.isArray(t)))return Array.isArray(t)?t.reduce((e,n)=>{const r=zi(n);return Object.entries(r).forEach(([s,i])=>{e[s]=i}),e},{}):zi(t)}function zi(t){return t.split(",").map(e=>e.split("=").map(n=>{try{return decodeURIComponent(n.trim())}catch{return}})).reduce((e,[n,r])=>(n&&r&&(e[n]=r),e),{})}function Ya(t){if(typeof t=="boolean")return Number(t);const e=typeof t=="string"?parseFloat(t):t;if(!(typeof e!="number"||isNaN(e)||e<0||e>1))return e}const Ja=0,Ps=1;let Wi=!1;function oh(t){const{spanId:e,traceId:n}=t.spanContext(),{data:r,op:s,parent_span_id:i,status:o,origin:a,links:c}=K(t);return{parent_span_id:i,span_id:e,trace_id:n,data:r,op:s,status:o,origin:a,links:c}}function Xa(t){if(t&&t.length>0)return t.map(({context:{spanId:e,traceId:n,traceFlags:r,...s},attributes:i})=>({span_id:e,trace_id:n,sampled:r===Ps,attributes:i,...s}))}function gt(t){return typeof t=="number"?Ki(t):Array.isArray(t)?t[0]+t[1]/1e9:t instanceof Date?Ki(t.getTime()):Ce()}function Ki(t){return t>9999999999?t/1e3:t}function K(t){var r;if(ch(t))return t.getSpanJSON();const{spanId:e,traceId:n}=t.spanContext();if(ah(t)){const{attributes:s,startTime:i,name:o,endTime:a,status:c,links:u}=t,l="parentSpanId"in t?t.parentSpanId:"parentSpanContext"in t?(r=t.parentSpanContext)==null?void 0:r.spanId:void 0;return{span_id:e,trace_id:n,data:s,description:o,parent_span_id:l,start_timestamp:gt(i),timestamp:gt(a)||void 0,status:Qa(c),op:s[et],origin:s[Y],links:Xa(u)}}return{span_id:e,trace_id:n,start_timestamp:0,data:{}}}function ah(t){const e=t;return!!e.attributes&&!!e.startTime&&!!e.name&&!!e.endTime&&!!e.status}function ch(t){return typeof t.getSpanJSON=="function"}function sn(t){const{traceFlags:e}=t.spanContext();return e===Ps}function Qa(t){if(!(!t||t.code===Qf))return t.code===Zf?"ok":t.message||"unknown_error"}const Ft="_sentryChildSpans",Wr="_sentryRootSpan";function Za(t,e){const n=t[Wr]||t;_e(e,Wr,n),t[Ft]?t[Ft].add(e):_e(t,Ft,new Set([e]))}function uh(t){const e=new Set;function n(r){if(!e.has(r)&&sn(r)){e.add(r);const s=r[Ft]?Array.from(r[Ft]):[];for(const i of s)n(i)}}return n(t),Array.from(e)}function te(t){return t[Wr]||t}function De(){const t=At(),e=tn(t);return e.getActiveSpan?e.getActiveSpan():Un(pe())}function lh(){Wi||(La(()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly.")}),Wi=!0)}function Ls(t){var n;if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const e=t||((n=ye())==null?void 0:n.getOptions());return!!e&&(e.tracesSampleRate!=null||!!e.tracesSampler)}const dh="production",ph=/^o(\d+)\./;function fh(t,e=!1){const{host:n,path:r,pass:s,port:i,projectId:o,protocol:a,publicKey:c}=t;return`${a}://${c}${e&&s?`:${s}`:""}@${n}${i?`:${i}`:""}/${r&&`${r}/`}${o}`}function hh(t){const e=t.match(ph);return e==null?void 0:e[1]}const ec="_frozenDsc";function _r(t,e){_e(t,ec,e)}function gh(t,e){const n=e.getOptions(),{publicKey:r,host:s}=e.getDsn()||{};let i;n.orgId?i=String(n.orgId):s&&(i=hh(s));const o={environment:n.environment||dh,release:n.release,public_key:r,trace_id:t,org_id:i};return e.emit("createDsc",o),o}function Mn(t){var _;const e=ye();if(!e)return{};const n=te(t),r=K(n),s=r.data,i=n.spanContext().traceState,o=(i==null?void 0:i.get("sentry.sample_rate"))??s[za]??s[Jf];function a(h){return(typeof o=="number"||typeof o=="string")&&(h.sample_rate=`${o}`),h}const c=n[ec];if(c)return a(c);const u=i==null?void 0:i.get("sentry.dsc"),l=u&&sh(u);if(l)return a(l);const d=gh(t.spanContext().traceId,e),p=s[Kt],f=r.description;return p!=="url"&&f&&(d.transaction=f),Ls()&&(d.sampled=String(sn(n)),d.sample_rand=(i==null?void 0:i.get("sentry.sample_rand"))??((_=zr(n).scope)==null?void 0:_.getPropagationContext().sampleRand.toString())),a(d),e.emit("createDsc",d,n),d}class Zn{constructor(e={}){this._traceId=e.traceId||Dn(),this._spanId=e.spanId||Ga()}spanContext(){return{spanId:this._spanId,traceId:this._traceId,traceFlags:Ja}}end(e){}setAttribute(e,n){return this}setAttributes(e){return this}setStatus(e){return this}updateName(e){return this}isRecording(){return!1}addEvent(e,n,r){return this}addLink(e){return this}addLinks(e){return this}recordException(e,n){}}function mh(t,e,n=()=>{}){let r;try{r=t()}catch(s){throw e(s),n(),s}return _h(r,e,n)}function _h(t,e,n){return ja(t)?t.then(r=>(n(),r),r=>{throw e(r),n(),r}):(n(),t)}function Sh(t){if(!B)return;const{description:e="< unknown name >",op:n="< unknown op >",parent_span_id:r}=K(t),{spanId:s}=t.spanContext(),i=sn(t),o=te(t),a=o===t,c=`[Tracing] Starting ${i?"sampled":"unsampled"} ${a?"root ":""}span`,u=[`op: ${n}`,`name: ${e}`,`ID: ${s}`];if(r&&u.push(`parent ID: ${r}`),!a){const{op:l,description:d}=K(o);u.push(`root ID: ${o.spanContext().spanId}`),l&&u.push(`root op: ${l}`),d&&u.push(`root description: ${d}`)}W.log(`${c}
  ${u.join(`
  `)}`)}function Eh(t){if(!B)return;const{description:e="< unknown name >",op:n="< unknown op >"}=K(t),{spanId:r}=t.spanContext(),i=te(t)===t,o=`[Tracing] Finishing "${n}" ${i?"root ":""}span "${e}" with ID ${r}`;W.log(o)}function yh(t,e,n){if(!Ls(t))return[!1];let r,s;typeof t.tracesSampler=="function"?(s=t.tracesSampler({...e,inheritOrSampleWith:a=>typeof e.parentSampleRate=="number"?e.parentSampleRate:typeof e.parentSampled=="boolean"?Number(e.parentSampled):a}),r=!0):e.parentSampled!==void 0?s=e.parentSampled:typeof t.tracesSampleRate<"u"&&(s=t.tracesSampleRate,r=!0);const i=Ya(s);if(i===void 0)return B&&W.warn(`[Tracing] Discarding root span because of invalid sample rate. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(s)} of type ${JSON.stringify(typeof s)}.`),[!1];if(!i)return B&&W.log(`[Tracing] Discarding transaction because ${typeof t.tracesSampler=="function"?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`),[!1,i,r];const o=n<i;return o||B&&W.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(s)})`),[o,i,r]}function Th(t,e=[]){return[t,e]}function bh(t){return[{type:"span"},t]}function Ih(t,e){function n(l){return!!l.trace_id&&!!l.public_key}const r=Mn(t[0]),s=e==null?void 0:e.getDsn(),i=e==null?void 0:e.getOptions().tunnel,o={sent_at:new Date().toISOString(),...n(r)&&{trace:r},...!!i&&s&&{dsn:fh(s)}},a=e==null?void 0:e.getOptions().beforeSendSpan,c=a?l=>{const d=K(l),p=a(d);return p||(lh(),d)}:K,u=[];for(const l of t){const d=c(l);d&&u.push(bh(d))}return Th(o,u)}function vh(t,e,n,r=De()){const s=r&&te(r);s&&(B&&W.log(`[Measurement] Setting measurement on root span: ${t} = ${e} ${n}`),s.addEvent(t,{[rn]:e,[nn]:n}))}function Yi(t){if(!t||t.length===0)return;const e={};return t.forEach(n=>{const r=n.attributes||{},s=r[nn],i=r[rn];typeof s=="string"&&typeof i=="number"&&(e[n.name]={value:i,unit:s})}),e}const Ji=1e3;class xs{constructor(e={}){this._traceId=e.traceId||Dn(),this._spanId=e.spanId||Ga(),this._startTime=e.startTimestamp||Ce(),this._links=e.links,this._attributes={},this.setAttributes({[Y]:"manual",[et]:e.op,...e.attributes}),this._name=e.name,e.parentSpanId&&(this._parentSpanId=e.parentSpanId),"sampled"in e&&(this._sampled=e.sampled),e.endTimestamp&&(this._endTime=e.endTimestamp),this._events=[],this._isStandaloneSpan=e.isStandalone,this._endTime&&this._onSpanEnded()}addLink(e){return this._links?this._links.push(e):this._links=[e],this}addLinks(e){return this._links?this._links.push(...e):this._links=e,this}recordException(e,n){}spanContext(){const{_spanId:e,_traceId:n,_sampled:r}=this;return{spanId:e,traceId:n,traceFlags:r?Ps:Ja}}setAttribute(e,n){return n===void 0?delete this._attributes[e]:this._attributes[e]=n,this}setAttributes(e){return Object.keys(e).forEach(n=>this.setAttribute(n,e[n])),this}updateStartTime(e){this._startTime=gt(e)}setStatus(e){return this._status=e,this}updateName(e){return this._name=e,this.setAttribute(Kt,"custom"),this}end(e){this._endTime||(this._endTime=gt(e),Eh(this),this._onSpanEnded())}getSpanJSON(){return{data:this._attributes,description:this._name,op:this._attributes[et],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:Qa(this._status),timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes[Y],profile_id:this._attributes[Xf],exclusive_time:this._attributes[Qn],measurements:Yi(this._events),is_segment:this._isStandaloneSpan&&te(this)===this||void 0,segment_id:this._isStandaloneSpan?te(this).spanContext().spanId:void 0,links:Xa(this._links)}}isRecording(){return!this._endTime&&!!this._sampled}addEvent(e,n,r){B&&W.log("[Tracing] Adding an event to span:",e);const s=Xi(n)?n:r||Ce(),i=Xi(n)?{}:n||{},o={name:e,time:gt(s),attributes:i};return this._events.push(o),this}isStandaloneSpan(){return!!this._isStandaloneSpan}_onSpanEnded(){const e=ye();if(e&&e.emit("spanEnd",this),!(this._isStandaloneSpan||this===te(this)))return;if(this._isStandaloneSpan){this._sampled?wh(Ih([this],e)):(B&&W.log("[Tracing] Discarding standalone span because its trace was not chosen to be sampled."),e&&e.recordDroppedEvent("sample_rate","span"));return}const r=this._convertSpanToTransaction();r&&(zr(this).scope||pe()).captureEvent(r)}_convertSpanToTransaction(){var l;if(!Qi(K(this)))return;this._name||(B&&W.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>");const{scope:e,isolationScope:n}=zr(this),r=(l=e==null?void 0:e.getScopeData().sdkProcessingMetadata)==null?void 0:l.normalizedRequest;if(this._sampled!==!0)return;const i=uh(this).filter(d=>d!==this&&!Rh(d)).map(d=>K(d)).filter(Qi),o=this._attributes[Kt];delete this._attributes[Gi],i.forEach(d=>{delete d.data[Gi]});const a={contexts:{trace:oh(this)},spans:i.length>Ji?i.sort((d,p)=>d.start_timestamp-p.start_timestamp).slice(0,Ji):i,start_timestamp:this._startTime,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{capturedSpanScope:e,capturedSpanIsolationScope:n,dynamicSamplingContext:Mn(this)},request:r,...o&&{transaction_info:{source:o}}},c=Yi(this._events);return c&&Object.keys(c).length&&(B&&W.log("[Measurements] Adding measurements to transaction event",JSON.stringify(c,void 0,2)),a.measurements=c),a}}function Xi(t){return t&&typeof t=="number"||t instanceof Date||Array.isArray(t)}function Qi(t){return!!t.start_timestamp&&!!t.timestamp&&!!t.span_id&&!!t.trace_id}function Rh(t){return t instanceof xs&&t.isStandaloneSpan()}function wh(t){const e=ye();if(!e)return;const n=t[1];if(!n||n.length===0){e.recordDroppedEvent("before_send","span");return}e.sendEnvelope(t)}const tc="__SENTRY_SUPPRESS_TRACING__";function Ch(t,e){const n=Ds();if(n.startSpan)return n.startSpan(t,e);const r=sc(t),{forceTransaction:s,parentSpan:i,scope:o}=t,a=o==null?void 0:o.clone();return ks(a,()=>Oh(i)(()=>{const u=pe(),l=ic(u,i),p=t.onlyIfParent&&!l?new Zn:rc({parentSpan:l,spanArguments:r,forceTransaction:s,scope:u});return Fn(u,p),mh(()=>e(p),()=>{const{status:f}=K(p);p.isRecording()&&(!f||f==="ok")&&p.setStatus({code:eh,message:"internal_error"})},()=>{p.end()})}))}function nc(t){const e=Ds();if(e.startInactiveSpan)return e.startInactiveSpan(t);const n=sc(t),{forceTransaction:r,parentSpan:s}=t;return(t.scope?o=>ks(t.scope,o):s!==void 0?o=>$s(s,o):o=>o())(()=>{const o=pe(),a=ic(o,s);return t.onlyIfParent&&!a?new Zn:rc({parentSpan:a,spanArguments:n,forceTransaction:r,scope:o})})}function $s(t,e){const n=Ds();return n.withActiveSpan?n.withActiveSpan(t,e):ks(r=>(Fn(r,t||void 0),e(r)))}function rc({parentSpan:t,spanArguments:e,forceTransaction:n,scope:r}){if(!Ls()){const o=new Zn;if(n||!t){const a={sampled:"false",sample_rate:"0",transaction:e.name,...Mn(o)};_r(o,a)}return o}const s=Yf();let i;if(t&&!n)i=Ah(t,r,e),Za(t,i);else if(t){const o=Mn(t),{traceId:a,spanId:c}=t.spanContext(),u=sn(t);i=Zi({traceId:a,parentSpanId:c,...e},r,u),_r(i,o)}else{const{traceId:o,dsc:a,parentSpanId:c,sampled:u}={...s.getPropagationContext(),...r.getPropagationContext()};i=Zi({traceId:o,parentSpanId:c,...e},r,u),a&&_r(i,a)}return Sh(i),th(i,r,s),i}function sc(t){const n={isStandalone:(t.experimental||{}).standalone,...t};if(t.startTime){const r={...n};return r.startTimestamp=gt(t.startTime),delete r.startTime,r}return n}function Ds(){const t=At();return tn(t)}function Zi(t,e,n){var _;const r=ye(),s=(r==null?void 0:r.getOptions())||{},{name:i=""}=t,o={spanAttributes:{...t.attributes},spanName:i,parentSampled:n};r==null||r.emit("beforeSampling",o,{decision:!1});const a=o.parentSampled??n,c=o.spanAttributes,u=e.getPropagationContext(),[l,d,p]=e.getScopeData().sdkProcessingMetadata[tc]?[!1]:yh(s,{name:i,parentSampled:a,attributes:c,parentSampleRate:Ya((_=u.dsc)==null?void 0:_.sample_rate)},u.sampleRand),f=new xs({...t,attributes:{[Kt]:"custom",[za]:d!==void 0&&p?d:void 0,...c},sampled:l});return!l&&r&&(B&&W.log("[Tracing] Discarding root span because its trace was not chosen to be sampled."),r.recordDroppedEvent("sample_rate","transaction")),r&&r.emit("spanStart",f),f}function Ah(t,e,n){const{spanId:r,traceId:s}=t.spanContext(),i=e.getScopeData().sdkProcessingMetadata[tc]?!1:sn(t),o=i?new xs({...n,parentSpanId:r,traceId:s,sampled:i}):new Zn({traceId:s});Za(t,o);const a=ye();return a&&(a.emit("spanStart",o),n.endTimestamp&&a.emit("spanEnd",o)),o}function ic(t,e){if(e)return e;if(e===null)return;const n=Un(t);if(!n)return;const r=ye();return(r?r.getOptions():{}).parentSpanIsAlwaysRootSpan?te(n):n}function Oh(t){return t!==void 0?e=>$s(t,e):e=>e()}function Nh(t){if(!t)return{};const e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const n=e[6]||"",r=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:n,hash:r,relative:e[5]+n+r}}const eo=ne;function kh(){return"history"in eo&&!!eo.history}function Ph(t){return t&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}const er=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,w=ne,Lh=(t,e)=>t>e[1]?"poor":t>e[0]?"needs-improvement":"good",Ot=(t,e,n,r)=>{let s,i;return o=>{e.value>=0&&(o||r)&&(i=e.value-(s??0),(i||s===void 0)&&(s=e.value,e.delta=i,e.rating=Lh(e.value,n),t(e)))}},xh=()=>`v5-${Date.now()}-${Math.floor(Math.random()*(9e12-1))+1e12}`,on=(t=!0)=>{var n,r;const e=(r=(n=w.performance)==null?void 0:n.getEntriesByType)==null?void 0:r.call(n,"navigation")[0];if(!t||e&&e.responseStart>0&&e.responseStart<performance.now())return e},Nt=()=>{const t=on();return(t==null?void 0:t.activationStart)??0},kt=(t,e=-1)=>{var i,o;const n=on();let r="navigate";return n&&((i=w.document)!=null&&i.prerendering||Nt()>0?r="prerender":(o=w.document)!=null&&o.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-"))),{name:t,value:e,rating:"good",delta:0,entries:[],id:xh(),navigationType:r}},Sr=new WeakMap;function Fs(t,e){return Sr.get(t)||Sr.set(t,new e),Sr.get(t)}class jn{constructor(){jn.prototype.__init.call(this),jn.prototype.__init2.call(this)}__init(){this._sessionValue=0}__init2(){this._sessionEntries=[]}_processEntry(e){var s;if(e.hadRecentInput)return;const n=this._sessionEntries[0],r=this._sessionEntries[this._sessionEntries.length-1];this._sessionValue&&n&&r&&e.startTime-r.startTime<1e3&&e.startTime-n.startTime<5e3?(this._sessionValue+=e.value,this._sessionEntries.push(e)):(this._sessionValue=e.value,this._sessionEntries=[e]),(s=this._onAfterProcessingUnexpectedShift)==null||s.call(this,e)}}const ot=(t,e,n={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){const r=new PerformanceObserver(s=>{Promise.resolve().then(()=>{e(s.getEntries())})});return r.observe({type:t,buffered:!0,...n}),r}}catch{}},tr=t=>{let e=!1;return()=>{e||(t(),e=!0)}};let Ut=-1;const $h=()=>{var t,e;return((t=w.document)==null?void 0:t.visibilityState)==="hidden"&&!((e=w.document)!=null&&e.prerendering)?0:1/0},Hn=t=>{w.document.visibilityState==="hidden"&&Ut>-1&&(Ut=t.type==="visibilitychange"?t.timeStamp:0,Fh())},Dh=()=>{addEventListener("visibilitychange",Hn,!0),addEventListener("prerenderingchange",Hn,!0)},Fh=()=>{removeEventListener("visibilitychange",Hn,!0),removeEventListener("prerenderingchange",Hn,!0)},nr=()=>{var t;if(w.document&&Ut<0){const e=Nt();Ut=(w.document.prerendering||(t=globalThis.performance.getEntriesByType("visibility-state").filter(r=>r.name==="hidden"&&r.startTime>e)[0])==null?void 0:t.startTime)??$h(),Dh()}return{get firstHiddenTime(){return Ut}}},an=t=>{var e;(e=w.document)!=null&&e.prerendering?addEventListener("prerenderingchange",()=>t(),!0):t()},Uh=[1800,3e3],Mh=(t,e={})=>{an(()=>{const n=nr(),r=kt("FCP");let s;const o=ot("paint",a=>{for(const c of a)c.name==="first-contentful-paint"&&(o.disconnect(),c.startTime<n.firstHiddenTime&&(r.value=Math.max(c.startTime-Nt(),0),r.entries.push(c),s(!0)))});o&&(s=Ot(t,r,Uh,e.reportAllChanges))})},jh=[.1,.25],Hh=(t,e={})=>{Mh(tr(()=>{var a,c;const n=kt("CLS",0);let r;const s=Fs(e,jn),i=u=>{for(const l of u)s._processEntry(l);s._sessionValue>n.value&&(n.value=s._sessionValue,n.entries=s._sessionEntries,r())},o=ot("layout-shift",i);o&&(r=Ot(t,n,jh,e.reportAllChanges),(a=w.document)==null||a.addEventListener("visibilitychange",()=>{var u;((u=w.document)==null?void 0:u.visibilityState)==="hidden"&&(i(o.takeRecords()),r(!0))}),(c=w==null?void 0:w.setTimeout)==null||c.call(w,r))}))},rr=t=>{const e=n=>{var r;(n.type==="pagehide"||((r=w.document)==null?void 0:r.visibilityState)==="hidden")&&t(n)};w.document&&(addEventListener("visibilitychange",e,!0),addEventListener("pagehide",e,!0))},Bh=[100,300],qh=(t,e={})=>{an(()=>{const n=nr(),r=kt("FID");let s;const i=c=>{c.startTime<n.firstHiddenTime&&(r.value=c.processingStart-c.startTime,r.entries.push(c),s(!0))},o=c=>{c.forEach(i)},a=ot("first-input",o);s=Ot(t,r,Bh,e.reportAllChanges),a&&rr(tr(()=>{o(a.takeRecords()),a.disconnect()}))})};let oc=0,Er=1/0,mn=0;const Vh=t=>{t.forEach(e=>{e.interactionId&&(Er=Math.min(Er,e.interactionId),mn=Math.max(mn,e.interactionId),oc=mn?(mn-Er)/7+1:0)})};let Kr;const ac=()=>Kr?oc:performance.interactionCount||0,Gh=()=>{"interactionCount"in performance||Kr||(Kr=ot("event",Vh,{type:"event",buffered:!0,durationThreshold:0}))},yr=10;let cc=0;const zh=()=>ac()-cc;class Bn{constructor(){Bn.prototype.__init.call(this),Bn.prototype.__init2.call(this)}__init(){this._longestInteractionList=[]}__init2(){this._longestInteractionMap=new Map}_resetInteractions(){cc=ac(),this._longestInteractionList.length=0,this._longestInteractionMap.clear()}_estimateP98LongestInteraction(){const e=Math.min(this._longestInteractionList.length-1,Math.floor(zh()/50));return this._longestInteractionList[e]}_processEntry(e){var s,i;if((s=this._onBeforeProcessingEntry)==null||s.call(this,e),!(e.interactionId||e.entryType==="first-input"))return;const n=this._longestInteractionList.at(-1);let r=this._longestInteractionMap.get(e.interactionId);if(r||this._longestInteractionList.length<yr||e.duration>n._latency){if(r?e.duration>r._latency?(r.entries=[e],r._latency=e.duration):e.duration===r._latency&&e.startTime===r.entries[0].startTime&&r.entries.push(e):(r={id:e.interactionId,entries:[e],_latency:e.duration},this._longestInteractionMap.set(r.id,r),this._longestInteractionList.push(r)),this._longestInteractionList.sort((o,a)=>a._latency-o._latency),this._longestInteractionList.length>yr){const o=this._longestInteractionList.splice(yr);for(const a of o)this._longestInteractionMap.delete(a.id)}(i=this._onAfterProcessingINPCandidate)==null||i.call(this,r)}}}const uc=t=>{var n;const e=w.requestIdleCallback||w.setTimeout;((n=w.document)==null?void 0:n.visibilityState)==="hidden"?t():(t=tr(t),e(t),rr(t))},Wh=[200,500],Kh=40,Yh=(t,e={})=>{globalThis.PerformanceEventTiming&&"interactionId"in PerformanceEventTiming.prototype&&an(()=>{Gh();const n=kt("INP");let r;const s=Fs(e,Bn),i=a=>{uc(()=>{for(const u of a)s._processEntry(u);const c=s._estimateP98LongestInteraction();c&&c._latency!==n.value&&(n.value=c._latency,n.entries=c.entries,r())})},o=ot("event",i,{durationThreshold:e.durationThreshold??Kh});r=Ot(t,n,Wh,e.reportAllChanges),o&&(o.observe({type:"first-input",buffered:!0}),rr(()=>{i(o.takeRecords()),r(!0)}))})};class Jh{_processEntry(e){var n;(n=this._onBeforeProcessingEntry)==null||n.call(this,e)}}const Xh=[2500,4e3],Qh=(t,e={})=>{an(()=>{const n=nr(),r=kt("LCP");let s;const i=Fs(e,Jh),o=c=>{e.reportAllChanges||(c=c.slice(-1));for(const u of c)i._processEntry(u),u.startTime<n.firstHiddenTime&&(r.value=Math.max(u.startTime-Nt(),0),r.entries=[u],s())},a=ot("largest-contentful-paint",o);if(a){s=Ot(t,r,Xh,e.reportAllChanges);const c=tr(()=>{o(a.takeRecords()),a.disconnect(),s(!0)});for(const u of["keydown","click","visibilitychange"])w.document&&addEventListener(u,()=>uc(c),{capture:!0,once:!0})}})},Zh=[800,1800],Yr=t=>{var e,n;(e=w.document)!=null&&e.prerendering?an(()=>Yr(t)):((n=w.document)==null?void 0:n.readyState)!=="complete"?addEventListener("load",()=>Yr(t),!0):setTimeout(t)},eg=(t,e={})=>{const n=kt("TTFB"),r=Ot(t,n,Zh,e.reportAllChanges);Yr(()=>{const s=on();s&&(n.value=Math.max(s.responseStart-Nt(),0),n.entries=[s],r(!0))})},Mt={},qn={};let lc,dc,pc,fc,hc;function gc(t,e=!1){return cn("cls",t,sg,lc,e)}function mc(t,e=!1){return cn("lcp",t,og,pc,e)}function tg(t){return cn("fid",t,ig,dc)}function ng(t){return cn("ttfb",t,ag,fc)}function rg(t){return cn("inp",t,cg,hc)}function Tt(t,e){return _c(t,e),qn[t]||(ug(t),qn[t]=!0),Sc(t,e)}function Pt(t,e){const n=Mt[t];if(n!=null&&n.length)for(const r of n)try{r(e)}catch(s){er&&Xn.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${Ma(r)}
Error:`,s)}}function sg(){return Hh(t=>{Pt("cls",{metric:t}),lc=t},{reportAllChanges:!0})}function ig(){return qh(t=>{Pt("fid",{metric:t}),dc=t})}function og(){return Qh(t=>{Pt("lcp",{metric:t}),pc=t},{reportAllChanges:!0})}function ag(){return eg(t=>{Pt("ttfb",{metric:t}),fc=t})}function cg(){return Yh(t=>{Pt("inp",{metric:t}),hc=t})}function cn(t,e,n,r,s=!1){_c(t,e);let i;return qn[t]||(i=n(),qn[t]=!0),r&&e({metric:r}),Sc(t,e,s?i:void 0)}function ug(t){const e={};t==="event"&&(e.durationThreshold=0),ot(t,n=>{Pt(t,{entries:n})},e)}function _c(t,e){Mt[t]=Mt[t]||[],Mt[t].push(e)}function Sc(t,e,n){return()=>{n&&n();const r=Mt[t];if(!r)return;const s=r.indexOf(e);s!==-1&&r.splice(s,1)}}function lg(t){return"duration"in t}function Tr(t){return typeof t=="number"&&isFinite(t)}function Se(t,e,n,{...r}){const s=K(t).start_timestamp;return s&&s>e&&typeof t.updateStartTime=="function"&&t.updateStartTime(e),$s(t,()=>{const i=nc({startTime:e,...r});return i&&i.end(n),i})}function Us(t){var b;const e=ye();if(!e)return;const{name:n,transaction:r,attributes:s,startTime:i}=t,{release:o,environment:a,sendDefaultPii:c}=e.getOptions(),u=e.getIntegrationByName("Replay"),l=u==null?void 0:u.getReplayId(),d=pe(),p=d.getUser(),f=p!==void 0?p.email||p.id||p.ip_address:void 0;let _;try{_=d.getScopeData().contexts.profile.profile_id}catch{}const h={release:o,environment:a,user:f||void 0,profile_id:_||void 0,replay_id:l||void 0,transaction:r,"user_agent.original":(b=w.navigator)==null?void 0:b.userAgent,"client.address":c?"{{auto}}":void 0,...s};return nc({name:n,attributes:h,startTime:i,experimental:{standalone:!0}})}function sr(){return w.addEventListener&&w.performance}function D(t){return t/1e3}function Ec(t){let e="unknown",n="unknown",r="";for(const s of t){if(s==="/"){[e,n]=t.split("/");break}if(!isNaN(Number(s))){e=r==="h"?"http":r,n=t.split(r)[1];break}r+=s}return r===t&&(e=r),{name:e,version:n}}function yc(t){try{return PerformanceObserver.supportedEntryTypes.includes(t)}catch{return!1}}function Tc(t){let e,n=!1;function r(s){!n&&e&&t(s,e),n=!0}rr(()=>{n||r("pagehide")}),setTimeout(()=>{const s=ye();if(!s)return;const i=s.on("beforeStartNavigationSpan",(a,c)=>{c!=null&&c.isRedirect||(r("navigation"),i==null||i())}),o=De();if(o){const a=te(o);K(a).op==="pageload"&&(e=a.spanContext().spanId)}},0)}function dg(){let t=0,e;if(!yc("layout-shift"))return;const n=gc(({metric:r})=>{const s=r.entries[r.entries.length-1];s&&(t=r.value,e=s)},!0);Tc((r,s)=>{pg(t,e,s,r),n()})}function pg(t,e,n,r){var u;er&&Xn.log(`Sending CLS span (${t})`);const s=D((ce()||0)+((e==null?void 0:e.startTime)||0)),i=pe().getScopeData().transactionName,o=e?xe((u=e.sources[0])==null?void 0:u.node):"Layout shift",a={[Y]:"auto.http.browser.cls",[et]:"ui.webvital.cls",[Qn]:(e==null?void 0:e.duration)||0,"sentry.pageload.span_id":n,"sentry.report_event":r};e!=null&&e.sources&&e.sources.forEach((l,d)=>{a[`cls.source.${d+1}`]=xe(l.node)});const c=Us({name:o,transaction:i,attributes:a,startTime:s});c&&(c.addEvent("cls",{[nn]:"",[rn]:t}),c.end(s))}function fg(){let t=0,e;if(!yc("largest-contentful-paint"))return;const n=mc(({metric:r})=>{const s=r.entries[r.entries.length-1];s&&(t=r.value,e=s)},!0);Tc((r,s)=>{hg(t,e,s,r),n()})}function hg(t,e,n,r){er&&Xn.log(`Sending LCP span (${t})`);const s=D((ce()||0)+((e==null?void 0:e.startTime)||0)),i=pe().getScopeData().transactionName,o=e?xe(e.element):"Largest contentful paint",a={[Y]:"auto.http.browser.lcp",[et]:"ui.webvital.lcp",[Qn]:0,"sentry.pageload.span_id":n,"sentry.report_event":r};e&&(e.element&&(a["lcp.element"]=xe(e.element)),e.id&&(a["lcp.id"]=e.id),e.url&&(a["lcp.url"]=e.url.trim().slice(0,200)),e.loadTime!=null&&(a["lcp.loadTime"]=e.loadTime),e.renderTime!=null&&(a["lcp.renderTime"]=e.renderTime),e.size!=null&&(a["lcp.size"]=e.size));const c=Us({name:o,transaction:i,attributes:a,startTime:s});c&&(c.addEvent("lcp",{[nn]:"millisecond",[rn]:t}),c.end(s))}const gg=2147483647;let to=0,z={},J,dt;function mg({recordClsStandaloneSpans:t,recordLcpStandaloneSpans:e}){const n=sr();if(n&&ce()){n.mark&&w.performance.mark("sentry-tracing-init");const r=bg(),s=e?fg():Tg(),i=Ig(),o=t?dg():yg();return()=>{r(),s==null||s(),i(),o==null||o()}}return()=>{}}function _g(){Tt("longtask",({entries:t})=>{const e=De();if(!e)return;const{op:n,start_timestamp:r}=K(e);for(const s of t){const i=D(ce()+s.startTime),o=D(s.duration);n==="navigation"&&r&&i<r||Se(e,i,i+o,{name:"Main UI thread blocked",op:"ui.long-task",attributes:{[Y]:"auto.ui.browser.metrics"}})}})}function Sg(){new PerformanceObserver(e=>{const n=De();if(n)for(const r of e.getEntries()){if(!r.scripts[0])continue;const s=D(ce()+r.startTime),{start_timestamp:i,op:o}=K(n);if(o==="navigation"&&i&&s<i)continue;const a=D(r.duration),c={[Y]:"auto.ui.browser.metrics"},u=r.scripts[0],{invoker:l,invokerType:d,sourceURL:p,sourceFunctionName:f,sourceCharPosition:_}=u;c["browser.script.invoker"]=l,c["browser.script.invoker_type"]=d,p&&(c["code.filepath"]=p),f&&(c["code.function"]=f),_!==-1&&(c["browser.script.source_char_position"]=_),Se(n,s,s+a,{name:"Main UI thread blocked",op:"ui.long-animation-frame",attributes:c})}}).observe({type:"long-animation-frame",buffered:!0})}function Eg(){Tt("event",({entries:t})=>{const e=De();if(e){for(const n of t)if(n.name==="click"){const r=D(ce()+n.startTime),s=D(n.duration),i={name:xe(n.target),op:`ui.interaction.${n.name}`,startTime:r,attributes:{[Y]:"auto.ui.browser.metrics"}},o=Lf(n.target);o&&(i.attributes["ui.component_name"]=o),Se(e,r,r+s,i)}}})}function yg(){return gc(({metric:t})=>{const e=t.entries[t.entries.length-1];e&&(z.cls={value:t.value,unit:""},dt=e)},!0)}function Tg(){return mc(({metric:t})=>{const e=t.entries[t.entries.length-1];e&&(z.lcp={value:t.value,unit:"millisecond"},J=e)},!0)}function bg(){return tg(({metric:t})=>{const e=t.entries[t.entries.length-1];if(!e)return;const n=D(ce()),r=D(e.startTime);z.fid={value:t.value,unit:"millisecond"},z["mark.fid"]={value:n+r,unit:"second"}})}function Ig(){return ng(({metric:t})=>{t.entries[t.entries.length-1]&&(z.ttfb={value:t.value,unit:"millisecond"})})}function vg(t,e){const n=sr(),r=ce();if(!(n!=null&&n.getEntries)||!r)return;const s=D(r),i=n.getEntries(),{op:o,start_timestamp:a}=K(t);if(i.slice(to).forEach(c=>{const u=D(c.startTime),l=D(Math.max(0,c.duration));if(!(o==="navigation"&&a&&s+u<a))switch(c.entryType){case"navigation":{Cg(t,c,s);break}case"mark":case"paint":case"measure":{Rg(t,c,u,l,s,e.ignorePerformanceApiSpans);const d=nr(),p=c.startTime<d.firstHiddenTime;c.name==="first-paint"&&p&&(z.fp={value:c.startTime,unit:"millisecond"}),c.name==="first-contentful-paint"&&p&&(z.fcp={value:c.startTime,unit:"millisecond"});break}case"resource":{Ng(t,c,c.name,u,l,s,e.ignoreResourceSpans);break}}}),to=Math.max(i.length-1,0),kg(t),o==="pageload"){Lg(z);const c=z["mark.fid"];c&&z.fid&&(Se(t,c.value,c.value+D(z.fid.value),{name:"first input delay",op:"ui.action",attributes:{[Y]:"auto.ui.browser.metrics"}}),delete z["mark.fid"]),(!("fcp"in z)||!e.recordClsOnPageloadSpan)&&delete z.cls,e.recordLcpOnPageloadSpan||delete z.lcp,Object.entries(z).forEach(([u,l])=>{vh(u,l.value,l.unit)}),t.setAttribute("performance.timeOrigin",s),t.setAttribute("performance.activationStart",Nt()),Pg(t,e)}J=void 0,dt=void 0,z={}}function Rg(t,e,n,r,s,i){if(["mark","measure"].includes(e.entryType)&&Df(e.name,i))return;const o=on(!1),a=D(o?o.requestStart:0),c=s+Math.max(n,a),u=s+n,l=u+r,d={[Y]:"auto.resource.browser.metrics"};c!==u&&(d["sentry.browser.measure_happened_before_request"]=!0,d["sentry.browser.measure_start_time"]=c),wg(d,e),c<=l&&Se(t,c,l,{name:e.name,op:e.entryType,attributes:d})}function wg(t,e){try{const n=e.detail;if(!n)return;if(typeof n=="object"){for(const[r,s]of Object.entries(n))if(s&&Bi(s))t[`sentry.browser.measure.detail.${r}`]=s;else if(s!==void 0)try{t[`sentry.browser.measure.detail.${r}`]=JSON.stringify(s)}catch{}return}if(Bi(n)){t["sentry.browser.measure.detail"]=n;return}try{t["sentry.browser.measure.detail"]=JSON.stringify(n)}catch{}}catch{}}function Cg(t,e,n){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach(r=>{_n(t,e,r,n)}),_n(t,e,"secureConnection",n,"TLS/SSL"),_n(t,e,"fetch",n,"cache"),_n(t,e,"domainLookup",n,"DNS"),Og(t,e,n)}function _n(t,e,n,r,s=n){const i=Ag(n),o=e[i],a=e[`${n}Start`];!a||!o||Se(t,r+D(a),r+D(o),{op:`browser.${s}`,name:e.name,attributes:{[Y]:"auto.ui.browser.metrics",...n==="redirect"&&e.redirectCount!=null?{"http.redirect_count":e.redirectCount}:{}}})}function Ag(t){return t==="secureConnection"?"connectEnd":t==="fetch"?"domainLookupStart":`${t}End`}function Og(t,e,n){const r=n+D(e.requestStart),s=n+D(e.responseEnd),i=n+D(e.responseStart);e.responseEnd&&(Se(t,r,s,{op:"browser.request",name:e.name,attributes:{[Y]:"auto.ui.browser.metrics"}}),Se(t,i,s,{op:"browser.response",name:e.name,attributes:{[Y]:"auto.ui.browser.metrics"}}))}function Ng(t,e,n,r,s,i,o){if(e.initiatorType==="xmlhttprequest"||e.initiatorType==="fetch")return;const a=e.initiatorType?`resource.${e.initiatorType}`:"resource.other";if(o!=null&&o.includes(a))return;const c=Nh(n),u={[Y]:"auto.resource.browser.metrics"};br(u,e,"transferSize","http.response_transfer_size"),br(u,e,"encodedBodySize","http.response_content_length"),br(u,e,"decodedBodySize","http.decoded_response_content_length");const l=e.deliveryType;l!=null&&(u["http.response_delivery_type"]=l);const d=e.renderBlockingStatus;if(d&&(u["resource.render_blocking_status"]=d),c.protocol&&(u["url.scheme"]=c.protocol.split(":").pop()),c.host&&(u["server.address"]=c.host),u["url.same_origin"]=n.includes(w.location.origin),e.nextHopProtocol!=null){const{name:_,version:h}=Ec(e.nextHopProtocol);u["network.protocol.name"]=_,u["network.protocol.version"]=h}const p=i+r,f=p+s;Se(t,p,f,{name:n.replace(w.location.origin,""),op:a,attributes:u})}function kg(t){const e=w.navigator;if(!e)return;const n=e.connection;n&&(n.effectiveType&&t.setAttribute("effectiveConnectionType",n.effectiveType),n.type&&t.setAttribute("connectionType",n.type),Tr(n.rtt)&&(z["connection.rtt"]={value:n.rtt,unit:"millisecond"})),Tr(e.deviceMemory)&&t.setAttribute("deviceMemory",`${e.deviceMemory} GB`),Tr(e.hardwareConcurrency)&&t.setAttribute("hardwareConcurrency",String(e.hardwareConcurrency))}function Pg(t,e){J&&e.recordLcpOnPageloadSpan&&(J.element&&t.setAttribute("lcp.element",xe(J.element)),J.id&&t.setAttribute("lcp.id",J.id),J.url&&t.setAttribute("lcp.url",J.url.trim().slice(0,200)),J.loadTime!=null&&t.setAttribute("lcp.loadTime",J.loadTime),J.renderTime!=null&&t.setAttribute("lcp.renderTime",J.renderTime),t.setAttribute("lcp.size",J.size)),dt!=null&&dt.sources&&e.recordClsOnPageloadSpan&&dt.sources.forEach((n,r)=>t.setAttribute(`cls.source.${r+1}`,xe(n.node)))}function br(t,e,n,r){const s=e[n];s!=null&&s<gg&&(t[r]=s)}function Lg(t){const e=on(!1);if(!e)return;const{responseStart:n,requestStart:r}=e;r<=n&&(t["ttfb.requestTime"]={value:n-r,unit:"millisecond"})}function xg(){return sr()&&ce()?Tt("element",$g):()=>{}}const $g=({entries:t})=>{const e=De(),n=e?te(e):void 0,r=n?K(n).description:pe().getScopeData().transactionName;t.forEach(s=>{var f,_;const i=s;if(!i.identifier)return;const o=i.name,a=i.renderTime,c=i.loadTime,[u,l]=c?[D(c),"load-time"]:a?[D(a),"render-time"]:[Ce(),"entry-emission"],d=o==="image-paint"?D(Math.max(0,(a??0)-(c??0))):0,p={[Y]:"auto.ui.browser.elementtiming",[et]:"ui.elementtiming",[Kt]:"component","sentry.span_start_time_source":l,"sentry.transaction_name":r,"element.id":i.id,"element.type":((_=(f=i.element)==null?void 0:f.tagName)==null?void 0:_.toLowerCase())||"unknown","element.size":i.naturalWidth&&i.naturalHeight?`${i.naturalWidth}x${i.naturalHeight}`:void 0,"element.render_time":a,"element.load_time":c,"element.url":i.url||void 0,"element.identifier":i.identifier,"element.paint_type":o};Ch({name:`element[${i.identifier}]`,attributes:p,startTime:u,onlyIfParent:!0},h=>{h.end(u+d)})})},Dg=1e3;let no,Jr,Xr;function Fg(t){const e="dom";As(e,t),Os(e,Ug)}function Ug(){if(!w.document)return;const t=Wt.bind(null,"dom"),e=ro(t,!0);w.document.addEventListener("click",e,!1),w.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(n=>{var i,o;const s=(i=w[n])==null?void 0:i.prototype;(o=s==null?void 0:s.hasOwnProperty)!=null&&o.call(s,"addEventListener")&&($n(s,"addEventListener",function(a){return function(c,u,l){if(c==="click"||c=="keypress")try{const d=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},p=d[c]=d[c]||{refCount:0};if(!p.handler){const f=ro(t);p.handler=f,a.call(this,c,f,l)}p.refCount++}catch{}return a.call(this,c,u,l)}}),$n(s,"removeEventListener",function(a){return function(c,u,l){if(c==="click"||c=="keypress")try{const d=this.__sentry_instrumentation_handlers__||{},p=d[c];p&&(p.refCount--,p.refCount<=0&&(a.call(this,c,p.handler,l),p.handler=void 0,delete d[c]),Object.keys(d).length===0&&delete this.__sentry_instrumentation_handlers__)}catch{}return a.call(this,c,u,l)}}))})}function Mg(t){if(t.type!==Jr)return!1;try{if(!t.target||t.target._sentryId!==Xr)return!1}catch{}return!0}function jg(t,e){return t!=="keypress"?!1:e!=null&&e.tagName?!(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable):!0}function ro(t,e=!1){return n=>{if(!n||n._sentryCaptured)return;const r=Hg(n);if(jg(n.type,r))return;_e(n,"_sentryCaptured",!0),r&&!r._sentryId&&_e(r,"_sentryId",We());const s=n.type==="keypress"?"input":n.type;Mg(n)||(t({event:n,name:s,global:e}),Jr=n.type,Xr=r?r._sentryId:void 0),clearTimeout(no),no=w.setTimeout(()=>{Xr=void 0,Jr=void 0},Dg)}}function Hg(t){try{return t.target}catch{return null}}let Sn;function Ms(t){const e="history";As(e,t),Os(e,Bg)}function Bg(){if(w.addEventListener("popstate",()=>{const e=w.location.href,n=Sn;if(Sn=e,n===e)return;Wt("history",{from:n,to:e})}),!kh())return;function t(e){return function(...n){const r=n.length>2?n[2]:void 0;if(r){const s=Sn,i=qg(String(r));if(Sn=i,s===i)return e.apply(this,n);Wt("history",{from:s,to:i})}return e.apply(this,n)}}$n(w.history,"pushState",t),$n(w.history,"replaceState",t)}function qg(t){try{return new URL(t,w.location.origin).toString()}catch{return t}}const wn={};function Vg(t){const e=wn[t];if(e)return e;let n=w[t];if(Ph(n))return wn[t]=n.bind(w);const r=w.document;if(r&&typeof r.createElement=="function")try{const s=r.createElement("iframe");s.hidden=!0,r.head.appendChild(s);const i=s.contentWindow;i!=null&&i[t]&&(n=i[t]),r.head.removeChild(s)}catch(s){er&&Xn.warn(`Could not create sandbox iframe for ${t} check, bailing to window.${t}: `,s)}return n&&(wn[t]=n.bind(w))}function so(t){wn[t]=void 0}const pt="__sentry_xhr_v3__";function bc(t){const e="xhr";As(e,t),Os(e,Gg)}function Gg(){if(!w.XMLHttpRequest)return;const t=XMLHttpRequest.prototype;t.open=new Proxy(t.open,{apply(e,n,r){const s=new Error,i=Ce()*1e3,o=we(r[0])?r[0].toUpperCase():void 0,a=zg(r[1]);if(!o||!a)return e.apply(n,r);n[pt]={method:o,url:a,request_headers:{}},o==="POST"&&a.match(/sentry_key/)&&(n.__sentry_own_request__=!0);const c=()=>{const u=n[pt];if(u&&n.readyState===4){try{u.status_code=n.status}catch{}const l={endTimestamp:Ce()*1e3,startTimestamp:i,xhr:n,virtualError:s};Wt("xhr",l)}};return"onreadystatechange"in n&&typeof n.onreadystatechange=="function"?n.onreadystatechange=new Proxy(n.onreadystatechange,{apply(u,l,d){return c(),u.apply(l,d)}}):n.addEventListener("readystatechange",c),n.setRequestHeader=new Proxy(n.setRequestHeader,{apply(u,l,d){const[p,f]=d,_=l[pt];return _&&we(p)&&we(f)&&(_.request_headers[p.toLowerCase()]=f),u.apply(l,d)}}),e.apply(n,r)}}),t.send=new Proxy(t.send,{apply(e,n,r){const s=n[pt];if(!s)return e.apply(n,r);r[0]!==void 0&&(s.body=r[0]);const i={startTimestamp:Ce()*1e3,xhr:n};return Wt("xhr",i),e.apply(n,r)}})}function zg(t){if(we(t))return t;try{return t.toString()}catch{}}const Ir=[],Cn=new Map,Wg=60;function Kg(){if(sr()&&ce()){const e=Yg();return()=>{e()}}return()=>{}}const io={click:"click",pointerdown:"click",pointerup:"click",mousedown:"click",mouseup:"click",touchstart:"click",touchend:"click",mouseover:"hover",mouseout:"hover",mouseenter:"hover",mouseleave:"hover",pointerover:"hover",pointerout:"hover",pointerenter:"hover",pointerleave:"hover",dragstart:"drag",dragend:"drag",drag:"drag",dragenter:"drag",dragleave:"drag",dragover:"drag",drop:"drag",keydown:"press",keyup:"press",keypress:"press",input:"press"};function Yg(){return rg(Jg)}const Jg=({metric:t})=>{if(t.value==null)return;const e=D(t.value);if(e>Wg)return;const n=t.entries.find(_=>_.duration===t.value&&io[_.name]);if(!n)return;const{interactionId:r}=n,s=io[n.name],i=D(ce()+n.startTime),o=De(),a=o?te(o):void 0,u=(r!=null?Cn.get(r):void 0)||a,l=u?K(u).description:pe().getScopeData().transactionName,d=xe(n.target),p={[Y]:"auto.http.browser.inp",[et]:`ui.interaction.${s}`,[Qn]:n.duration},f=Us({name:d,transaction:l,attributes:p,startTime:i});f&&(f.addEvent("inp",{[nn]:"millisecond",[rn]:t.value}),f.end(i+e))};function Xg(){const t=({entries:e})=>{const n=De(),r=n&&te(n);e.forEach(s=>{if(!lg(s)||!r)return;const i=s.interactionId;if(i!=null&&!Cn.has(i)){if(Ir.length>10){const o=Ir.shift();Cn.delete(o)}Ir.push(i),Cn.set(i,r)}})};Tt("event",t),Tt("first-input",t)}function Qg(t,e=Vg("fetch")){let n=0,r=0;function s(i){const o=i.body.length;n+=o,r++;const a={body:i.body,method:"POST",referrerPolicy:"strict-origin",headers:t.headers,keepalive:n<=6e4&&r<15,...t.fetchOptions};if(!e)return so("fetch"),Ln("No fetch implementation available");try{return e(t.url,a).then(c=>(n-=o,r--,{statusCode:c.status,headers:{"x-sentry-rate-limits":c.headers.get("X-Sentry-Rate-Limits"),"retry-after":c.headers.get("Retry-After")}}))}catch(c){return so("fetch"),n-=o,r--,Ln(c)}}return fp(t,s)}const Zg=30,em=50;function Qr(t,e,n,r){const s={filename:t,function:e==="<anonymous>"?Ke:e,in_app:!0};return n!==void 0&&(s.lineno=n),r!==void 0&&(s.colno=r),s}const tm=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,nm=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,rm=/\((\S*)(?::(\d+))(?::(\d+))\)/,sm=t=>{const e=tm.exec(t);if(e){const[,r,s,i]=e;return Qr(r,Ke,+s,+i)}const n=nm.exec(t);if(n){if(n[2]&&n[2].indexOf("eval")===0){const o=rm.exec(n[2]);o&&(n[2]=o[1],n[3]=o[2],n[4]=o[3])}const[s,i]=Ic(n[1]||Ke,n[2]);return Qr(i,s,n[3]?+n[3]:void 0,n[4]?+n[4]:void 0)}},im=[Zg,sm],om=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,am=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,cm=t=>{const e=om.exec(t);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const i=am.exec(e[3]);i&&(e[1]=e[1]||"eval",e[3]=i[1],e[4]=i[2],e[5]="")}let r=e[3],s=e[1]||Ke;return[s,r]=Ic(s,r),Qr(r,s,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}},um=[em,cm],lm=[im,um],dm=ko(...lm),Ic=(t,e)=>{const n=t.indexOf("safari-extension")!==-1,r=t.indexOf("safari-web-extension")!==-1;return n||r?[t.indexOf("@")!==-1?t.split("@")[0]:Ke,n?`safari-extension:${e}`:`safari-web-extension:${e}`]:[t,e]},X=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,En=1024,pm="Breadcrumbs",fm=(t={})=>{const e={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...t};return{name:pm,setup(n){e.console&&xp(_m(n)),e.dom&&Fg(mm(n,e.dom)),e.xhr&&bc(Sm(n)),e.fetch&&Oa(Em(n)),e.history&&Ms(ym(n)),e.sentry&&n.on("beforeSendEvent",gm(n))}}},hm=fm;function gm(t){return function(n){P()===t&&Le({category:`sentry.${n.type==="transaction"?"transaction":"event"}`,event_id:n.event_id,level:n.level,message:He(n)},{event:n})}}function mm(t,e){return function(r){if(P()!==t)return;let s,i,o=typeof e=="object"?e.serializeAttribute:void 0,a=typeof e=="object"&&typeof e.maxStringLength=="number"?e.maxStringLength:void 0;a&&a>En&&(X&&ee.warn(`\`dom.maxStringLength\` cannot exceed ${En}, but a value of ${a} was configured. Sentry will use ${En} instead.`),a=En),typeof o=="string"&&(o=[o]);try{const u=r.event,l=Tm(u)?u.target:u;s=Uo(l,{keyAttrs:o,maxStringLength:a}),i=Ju(l)}catch{s="<unknown>"}if(s.length===0)return;const c={category:`ui.${r.name}`,message:s};i&&(c.data={"ui.component_name":i}),Le(c,{event:r.event,name:r.name,global:r.global})}}function _m(t){return function(n){if(P()!==t)return;const r={category:"console",data:{arguments:n.args,logger:"console"},level:Dp(n.level),message:ti(n.args," ")};if(n.level==="assert")if(n.args[0]===!1)r.message=`Assertion failed: ${ti(n.args.slice(1)," ")||"console.assert"}`,r.data.arguments=n.args.slice(1);else return;Le(r,{input:n.args,level:n.level})}}function Sm(t){return function(n){if(P()!==t)return;const{startTimestamp:r,endTimestamp:s}=n,i=n.xhr[pt];if(!r||!s||!i)return;const{method:o,url:a,status_code:c,body:u}=i,l={method:o,url:a,status_code:c},d={xhr:n.xhr,input:u,startTimestamp:r,endTimestamp:s},p={category:"xhr",data:l,type:"http",level:Aa(c)};t.emit("beforeOutgoingRequestBreadcrumb",p,d),Le(p,d)}}function Em(t){return function(n){if(P()!==t)return;const{startTimestamp:r,endTimestamp:s}=n;if(s&&!(n.fetchData.url.match(/sentry_key/)&&n.fetchData.method==="POST"))if(n.fetchData.method,n.fetchData.url,n.error){const i=n.fetchData,o={data:n.error,input:n.args,startTimestamp:r,endTimestamp:s},a={category:"fetch",data:i,level:"error",type:"http"};t.emit("beforeOutgoingRequestBreadcrumb",a,o),Le(a,o)}else{const i=n.response,o={...n.fetchData,status_code:i==null?void 0:i.status};n.fetchData.request_body_size,n.fetchData.response_body_size,i==null||i.status;const a={input:n.args,response:i,startTimestamp:r,endTimestamp:s},c={category:"fetch",data:o,type:"http",level:Aa(o.status_code)};t.emit("beforeOutgoingRequestBreadcrumb",c,a),Le(c,a)}}}function ym(t){return function(n){if(P()!==t)return;let r=n.from,s=n.to;const i=ht(O.location.href);let o=r?ht(r):void 0;const a=ht(s);o!=null&&o.path||(o=i),i.protocol===a.protocol&&i.host===a.host&&(s=a.relative),i.protocol===o.protocol&&i.host===o.host&&(r=o.relative),Le({category:"navigation",data:{from:r,to:s}})}}function Tm(t){return!!t&&!!t.target}const bm=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],Im="BrowserApiErrors",vm=(t={})=>{const e={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,unregisterOriginalCallbacks:!1,...t};return{name:Im,setupOnce(){e.setTimeout&&he(O,"setTimeout",oo),e.setInterval&&he(O,"setInterval",oo),e.requestAnimationFrame&&he(O,"requestAnimationFrame",wm),e.XMLHttpRequest&&"XMLHttpRequest"in O&&he(XMLHttpRequest.prototype,"send",Cm);const n=e.eventTarget;n&&(Array.isArray(n)?n:bm).forEach(s=>Am(s,e))}}},Rm=vm;function oo(t){return function(...e){const n=e[0];return e[0]=Et(n,{mechanism:{data:{function:Ae(t)},handled:!1,type:"instrument"}}),t.apply(this,e)}}function wm(t){return function(e){return t.apply(this,[Et(e,{mechanism:{data:{function:"requestAnimationFrame",handler:Ae(t)},handled:!1,type:"instrument"}})])}}function Cm(t){return function(...e){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(s=>{s in n&&typeof n[s]=="function"&&he(n,s,function(i){const o={mechanism:{data:{function:s,handler:Ae(i)},handled:!1,type:"instrument"}},a=ds(i);return a&&(o.mechanism.data.handler=Ae(a)),Et(i,o)})}),t.apply(this,e)}}function Am(t,e){var s,i;const r=(s=O[t])==null?void 0:s.prototype;(i=r==null?void 0:r.hasOwnProperty)!=null&&i.call(r,"addEventListener")&&(he(r,"addEventListener",function(o){return function(a,c,u){try{Om(c)&&(c.handleEvent=Et(c.handleEvent,{mechanism:{data:{function:"handleEvent",handler:Ae(c),target:t},handled:!1,type:"instrument"}}))}catch{}return e.unregisterOriginalCallbacks&&Nm(this,a,c),o.apply(this,[a,Et(c,{mechanism:{data:{function:"addEventListener",handler:Ae(c),target:t},handled:!1,type:"instrument"}}),u])}}),he(r,"removeEventListener",function(o){return function(a,c,u){try{const l=c.__sentry_wrapped__;l&&o.call(this,a,l,u)}catch{}return o.call(this,a,c,u)}}))}function Om(t){return typeof t.handleEvent=="function"}function Nm(t,e,n){t&&typeof t=="object"&&"removeEventListener"in t&&typeof t.removeEventListener=="function"&&t.removeEventListener(e,n)}const km=()=>({name:"BrowserSession",setupOnce(){if(typeof O.document>"u"){X&&ee.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.");return}vi({ignoreDuration:!0}),Ri(),Ms(({from:t,to:e})=>{t!==void 0&&t!==e&&(vi({ignoreDuration:!0}),Ri())})}}),Pm="GlobalHandlers",Lm=(t={})=>{const e={onerror:!0,onunhandledrejection:!0,...t};return{name:Pm,setupOnce(){Error.stackTraceLimit=50},setup(n){e.onerror&&($m(n),ao("onerror")),e.onunhandledrejection&&(Dm(n),ao("onunhandledrejection"))}}},xm=Lm;function $m(t){Po(e=>{const{stackParser:n,attachStacktrace:r}=vc();if(P()!==t||ka())return;const{msg:s,url:i,line:o,column:a,error:c}=e,u=Mm(Is(n,c||s,void 0,r,!1),i,o,a);u.level="error",pa(u,{originalException:c,mechanism:{handled:!1,type:"onerror"}})})}function Dm(t){Lo(e=>{const{stackParser:n,attachStacktrace:r}=vc();if(P()!==t||ka())return;const s=Fm(e),i=us(s)?Um(s):Is(n,s,void 0,r,!0);i.level="error",pa(i,{originalException:s,mechanism:{handled:!1,type:"onunhandledrejection"}})})}function Fm(t){if(us(t))return t;try{if("reason"in t)return t.reason;if("detail"in t&&"reason"in t.detail)return t.detail.reason}catch{}return t}function Um(t){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(t)}`}]}}}function Mm(t,e,n,r){const s=t.exception=t.exception||{},i=s.values=s.values||[],o=i[0]=i[0]||{},a=o.stacktrace=o.stacktrace||{},c=a.frames=a.frames||[],u=r,l=n,d=Ht(e)&&e.length>0?e:Qt();return c.length===0&&c.push({colno:u,filename:d,function:Ke,in_app:!0,lineno:l}),t}function ao(t){X&&ee.log(`Global Handler attached: ${t}`)}function vc(){const t=P();return(t==null?void 0:t.getOptions())||{stackParser:()=>[],attachStacktrace:!1}}const jm=()=>({name:"HttpContext",preprocessEvent(t){var r;if(!O.navigator&&!O.location&&!O.document)return;const e=ys(),n={...e.headers,...(r=t.request)==null?void 0:r.headers};t.request={...e,...t.request,headers:n}}}),Hm="cause",Bm=5,qm="LinkedErrors",Vm=(t={})=>{const e=t.limit||Bm,n=t.key||Hm;return{name:qm,preprocessEvent(r,s,i){const o=i.getOptions();Lp(Ts,o.stackParser,n,e,r,s)}}},Gm=Vm;function zm(){return Wm()?(X&&bt(()=>{console.error("[Sentry] You cannot use Sentry.init() in a browser extension, see: https://docs.sentry.io/platforms/javascript/best-practices/browser-extensions/")}),!0):!1}function Wm(){var i;if(typeof O.window>"u")return!1;const t=O;if(t.nw)return!1;const e=t.chrome||t.browser;if(!((i=e==null?void 0:e.runtime)!=null&&i.id))return!1;const n=Qt(),r=["chrome-extension","moz-extension","ms-browser-extension","safari-web-extension"];return!(O===O.top&&r.some(o=>n.startsWith(`${o}://`)))}function Km(t){return[Rp(),Tp(),Rm(),hm(),xm(),Gm(),Mp(),jm(),km()]}function Ym(t={}){const e=!t.skipBrowserExtensionCheck&&zm(),n={...t,enabled:e?!1:t.enabled,stackParser:ju(t.stackParser||dm),integrations:Wd({integrations:t.integrations,defaultIntegrations:t.defaultIntegrations==null?Km():t.defaultIntegrations}),transport:t.transport||Qg};return sp(yf,n)}function Jm(t={}){const e=O.document,n=(e==null?void 0:e.head)||(e==null?void 0:e.body);if(!n){X&&ee.error("[showReportDialog] Global document not defined");return}const r=U(),s=P(),i=s==null?void 0:s.getDsn();if(!i){X&&ee.error("[showReportDialog] DSN not configured");return}const o={...t,user:{...r.getUser(),...t.user},eventId:t.eventId||Md()},a=O.document.createElement("script");a.async=!0,a.crossOrigin="anonymous",a.src=Gd(i,o);const{onLoad:c,onClose:u}=o;if(c&&(a.onload=c),u){const l=d=>{if(d.data==="__sentry_reportdialog_closed__")try{u()}finally{O.removeEventListener("message",l)}};O.addEventListener("message",l)}n.appendChild(a)}function le(t=0){return((ps()||performance.timeOrigin)+t)/1e3}function Xm(t){const e=[];if(t.nextHopProtocol!=null){const{name:n,version:r}=Ec(t.nextHopProtocol);e.push(["network.protocol.version",r],["network.protocol.name",n])}return ps()?[...e,["http.request.redirect_start",le(t.redirectStart)],["http.request.fetch_start",le(t.fetchStart)],["http.request.domain_lookup_start",le(t.domainLookupStart)],["http.request.domain_lookup_end",le(t.domainLookupEnd)],["http.request.connect_start",le(t.connectStart)],["http.request.secure_connection_start",le(t.secureConnectionStart)],["http.request.connection_end",le(t.connectEnd)],["http.request.request_start",le(t.requestStart)],["http.request.response_start",le(t.responseStart)],["http.request.response_end",le(t.responseEnd)]]:e}const co=new WeakMap,vr=new Map,Rc={traceFetch:!0,traceXHR:!0,enableHTTPTimings:!0,trackFetchStreamPerformance:!1};function Qm(t,e){const{traceFetch:n,traceXHR:r,trackFetchStreamPerformance:s,shouldCreateSpanForRequest:i,enableHTTPTimings:o,tracePropagationTargets:a,onRequestSpanStart:c}={...Rc,...e},u=typeof i=="function"?i:p=>!0,l=p=>e_(p,a),d={};n&&(t.addEventProcessor(p=>(p.type==="transaction"&&p.spans&&p.spans.forEach(f=>{if(f.op==="http.client"){const _=vr.get(f.span_id);_&&(f.timestamp=_/1e3,vr.delete(f.span_id))}}),p)),s&&ef(p=>{if(p.response){const f=co.get(p.response);f&&p.endTimestamp&&vr.set(f,p.endTimestamp)}}),Oa(p=>{const f=zp(p,u,l,d);if(p.response&&p.fetchData.__span&&co.set(p.response,p.fetchData.__span),f){const _=wc(p.fetchData.url),h=_?ht(_).host:void 0;f.setAttributes({"http.url":_,"server.address":h}),o&&uo(f),c==null||c(f,{headers:p.headers})}})),r&&bc(p=>{var _;const f=t_(p,u,l,d);if(f){o&&uo(f);let h;try{h=new Headers((_=p.xhr.__sentry_xhr_v3__)==null?void 0:_.request_headers)}catch{}c==null||c(f,{headers:h})}})}function Zm(t){return t.entryType==="resource"&&"initiatorType"in t&&typeof t.nextHopProtocol=="string"&&(t.initiatorType==="fetch"||t.initiatorType==="xmlhttprequest")}function uo(t){const{url:e}=F(t).data;if(!e||typeof e!="string")return;const n=Tt("resource",({entries:r})=>{r.forEach(s=>{Zm(s)&&s.name.endsWith(e)&&(Xm(s).forEach(o=>t.setAttribute(...o)),setTimeout(n))})})}function e_(t,e){const n=Qt();if(n){let r,s;try{r=new URL(t,n),s=new URL(n).origin}catch{return!1}const i=r.origin===s;return e?Ve(r.toString(),e)||i&&Ve(r.pathname,e):i}else{const r=!!t.match(/^\/(?!\/)/);return e?Ve(t,e):r}}function t_(t,e,n,r){const s=t.xhr,i=s==null?void 0:s[pt];if(!s||s.__sentry_own_request__||!i)return;const{url:o,method:a}=i,c=Ne()&&e(o);if(t.endTimestamp&&c){const h=s.__sentry_xhr_span_id__;if(!h)return;const b=r[h];b&&i.status_code!==void 0&&(Go(b,i.status_code),b.end(),delete r[h]);return}const u=wc(o),l=ht(u||o),d=Gp(o),p=!!Rt(),f=c&&p?Jn({name:`${a} ${d}`,attributes:{url:o,type:"xhr","http.method":a,"http.url":u,"server.address":l==null?void 0:l.host,[Je]:"auto.http.browser",[Gt]:"http.client",...(l==null?void 0:l.search)&&{"http.query":l==null?void 0:l.search},...(l==null?void 0:l.hash)&&{"http.fragment":l==null?void 0:l.hash}}}):new Xe;s.__sentry_xhr_span_id__=f.spanContext().spanId,r[s.__sentry_xhr_span_id__]=f,n(o)&&n_(s,Ne()&&p?f:void 0);const _=P();return _&&_.emit("beforeOutgoingRequestSpan",f,t),f}function n_(t,e){const{"sentry-trace":n,baggage:r}=Ia({span:e});n&&r_(t,n,r)}function r_(t,e,n){var s;const r=(s=t.__sentry_xhr_v3__)==null?void 0:s.request_headers;if(!(r!=null&&r["sentry-trace"]))try{if(t.setRequestHeader("sentry-trace",e),n){const i=r==null?void 0:r.baggage;(!i||!s_(i))&&t.setRequestHeader("baggage",n)}}catch{}}function s_(t){return t.split(",").some(e=>e.trim().startsWith("sentry-"))}function wc(t){try{return new URL(t,O.location.origin).href}catch{return}}function i_(){O.document?O.document.addEventListener("visibilitychange",()=>{const t=Rt();if(!t)return;const e=ie(t);if(O.document.hidden&&e){const n="cancelled",{op:r,status:s}=F(e);X&&ee.log(`[Tracing] Transaction: ${n} -> since tab moved to the background, op: ${r}`),s||e.setStatus({code:G,message:n}),e.setAttribute("sentry.cancellation_reason","document.hidden"),e.end()}}):X&&ee.warn("[Tracing] Could not set up background tab detection due to lack of global document")}const o_=3600,Cc="sentry_previous_trace",a_="sentry.previous_trace";function c_(t,{linkPreviousTrace:e,consistentTraceSampling:n}){const r=e==="session-storage";let s=r?d_():void 0;t.on("spanStart",o=>{if(ie(o)!==o)return;const a=U().getPropagationContext();s=u_(s,o,a),r&&l_(s)});let i=!0;n&&t.on("beforeSampling",o=>{if(!s)return;const a=U(),c=a.getPropagationContext();if(i&&c.parentSpanId){i=!1;return}a.setPropagationContext({...c,dsc:{...c.dsc,sample_rate:String(s.sampleRate),sampled:String(Zr(s.spanContext))},sampleRand:s.sampleRand}),o.parentSampled=Zr(s.spanContext),o.parentSampleRate=s.sampleRate,o.spanAttributes={...o.spanAttributes,[qo]:s.sampleRate}})}function u_(t,e,n){const r=F(e);function s(){var a,c;try{return Number((a=n.dsc)==null?void 0:a.sample_rate)??Number((c=r.data)==null?void 0:c[fs])}catch{return 0}}const i={spanContext:e.spanContext(),startTimestamp:r.start_timestamp,sampleRate:s(),sampleRand:n.sampleRand};if(!t)return i;const o=t.spanContext;return o.traceId===r.trace_id?t:(Date.now()/1e3-t.startTimestamp<=o_&&(X&&ee.info(`Adding previous_trace ${o} link to span ${{op:r.op,...e.spanContext()}}`),e.addLink({context:o,attributes:{[_l]:"previous_trace"}}),e.setAttribute(a_,`${o.traceId}-${o.spanId}-${Zr(o)?1:0}`)),i)}function l_(t){try{O.sessionStorage.setItem(Cc,JSON.stringify(t))}catch(e){X&&ee.warn("Could not store previous trace in sessionStorage",e)}}function d_(){var t;try{const e=(t=O.sessionStorage)==null?void 0:t.getItem(Cc);return JSON.parse(e)}catch{return}}function Zr(t){return t.traceFlags===1}const p_="BrowserTracing",f_={...In,instrumentNavigation:!0,instrumentPageLoad:!0,markBackgroundSpan:!0,enableLongTask:!0,enableLongAnimationFrame:!0,enableInp:!0,enableElementTiming:!0,ignoreResourceSpans:[],ignorePerformanceApiSpans:[],detectRedirects:!0,linkPreviousTrace:"in-memory",consistentTraceSampling:!1,_experiments:{},...Rc},h_=(t={})=>{const e={name:void 0,source:void 0},n=O.document,{enableInp:r,enableElementTiming:s,enableLongTask:i,enableLongAnimationFrame:o,_experiments:{enableInteractions:a,enableStandaloneClsSpans:c,enableStandaloneLcpSpans:u},beforeStartSpan:l,idleTimeout:d,finalTimeout:p,childSpanTimeout:f,markBackgroundSpan:_,traceFetch:h,traceXHR:b,trackFetchStreamPerformance:v,shouldCreateSpanForRequest:E,enableHTTPTimings:y,ignoreResourceSpans:m,ignorePerformanceApiSpans:g,instrumentPageLoad:C,instrumentNavigation:q,detectRedirects:at,linkPreviousTrace:Lt,consistentTraceSampling:ct,onRequestSpanStart:Fe}={...f_,...t};let M,Ue;function Te($,j,L=!0){const H=j.op==="pageload",V=l?l(j):j,be=V.attributes||{};if(j.name!==V.name&&(be[ge]="custom",V.attributes=be),!L){const $t=rt();Jn({...V,startTime:$t}).end($t);return}e.name=V.name,e.source=be[ge];const Ie=la(V,{idleTimeout:d,finalTimeout:p,childSpanTimeout:f,disableAutoFinish:H,beforeSpanEnd:$t=>{M==null||M(),vg($t,{recordClsOnPageloadSpan:!c,recordLcpOnPageloadSpan:!u,ignoreResourceSpans:m,ignorePerformanceApiSpans:g}),po($,void 0);const js=U(),Oc=js.getPropagationContext();js.setPropagationContext({...Oc,traceId:Ie.spanContext().traceId,sampled:st(Ie),dsc:ke($t)})}});po($,Ie);function xt(){n&&["interactive","complete"].includes(n.readyState)&&$.emit("idleSpanEnableAutoFinish",Ie)}H&&n&&(n.addEventListener("readystatechange",()=>{xt()}),xt())}return{name:p_,setup($){if($l(),M=mg({recordClsStandaloneSpans:c||!1,recordLcpStandaloneSpans:u||!1}),r&&Kg(),s&&xg(),o&&k.PerformanceObserver&&PerformanceObserver.supportedEntryTypes&&PerformanceObserver.supportedEntryTypes.includes("long-animation-frame")?Sg():i&&_g(),a&&Eg(),at&&n){const L=()=>{Ue=Z()};addEventListener("click",L,{capture:!0}),addEventListener("keydown",L,{capture:!0,passive:!0})}function j(){const L=Yt($);L&&!F(L).timestamp&&(X&&ee.log(`[Tracing] Finishing current active span with op: ${F(L).op}`),L.setAttribute(kn,"cancelled"),L.end())}$.on("startNavigationSpan",(L,H)=>{if(P()!==$)return;if(H!=null&&H.isRedirect){X&&ee.warn("[Tracing] Detected redirect, navigation span will not be the root span, but a child span."),Te($,{op:"navigation.redirect",...L},!1);return}j(),ae().setPropagationContext({traceId:Oe(),sampleRand:Math.random()});const V=U();V.setPropagationContext({traceId:Oe(),sampleRand:Math.random()}),V.setSDKProcessingMetadata({normalizedRequest:void 0}),Te($,{op:"navigation",...L})}),$.on("startPageLoadSpan",(L,H={})=>{if(P()!==$)return;j();const V=H.sentryTrace||lo("sentry-trace"),be=H.baggage||lo("baggage"),Ie=Cl(V,be),xt=U();xt.setPropagationContext(Ie),xt.setSDKProcessingMetadata({normalizedRequest:ys()}),Te($,{op:"pageload",...L})})},afterAllSetup($){let j=Qt();if(Lt!=="off"&&c_($,{linkPreviousTrace:Lt,consistentTraceSampling:ct}),O.location){if(C){const L=ps();g_($,{name:O.location.pathname,startTime:L?L/1e3:void 0,attributes:{[ge]:"url",[Je]:"auto.pageload.browser"}})}q&&Ms(({to:L,from:H})=>{if(H===void 0&&(j==null?void 0:j.indexOf(L))!==-1){j=void 0;return}j=void 0;const V=Ca(L),be=Yt($),Ie=be&&at&&S_(be,Ue);m_($,{name:(V==null?void 0:V.pathname)||O.location.pathname,attributes:{[ge]:"url",[Je]:"auto.navigation.browser"}},{url:L,isRedirect:Ie})})}_&&i_(),a&&__($,d,p,f,e),r&&Xg(),Qm($,{traceFetch:h,traceXHR:b,trackFetchStreamPerformance:v,tracePropagationTargets:$.getOptions().tracePropagationTargets,shouldCreateSpanForRequest:E,enableHTTPTimings:y,onRequestSpanStart:Fe})}}};function g_(t,e,n){return t.emit("startPageLoadSpan",e,n),U().setTransactionName(e.name),Yt(t)}function m_(t,e,n){const{url:r,isRedirect:s}=n||{};t.emit("beforeStartNavigationSpan",e,{isRedirect:s}),t.emit("startNavigationSpan",e,{isRedirect:s});const i=U();return i.setTransactionName(e.name),r&&!s&&i.setSDKProcessingMetadata({normalizedRequest:{...ys(),url:r}}),Yt(t)}function lo(t){const e=O.document,n=e==null?void 0:e.querySelector(`meta[name=${t}]`);return(n==null?void 0:n.getAttribute("content"))||void 0}function __(t,e,n,r,s){const i=O.document;let o;const a=()=>{const c="ui.action.click",u=Yt(t);if(u){const l=F(u).op;if(["navigation","pageload"].includes(l)){X&&ee.warn(`[Tracing] Did not create ${c} span because a pageload or navigation span is in progress.`);return}}if(o&&(o.setAttribute(kn,"interactionInterrupted"),o.end(),o=void 0),!s.name){X&&ee.warn(`[Tracing] Did not create ${c} transaction because _latestRouteName is missing.`);return}o=la({name:s.name,op:c,attributes:{[ge]:s.source||"url"}},{idleTimeout:e,finalTimeout:n,childSpanTimeout:r})};i&&addEventListener("click",a,{capture:!0})}const Ac="_sentry_idleSpan";function Yt(t){return t[Ac]}function po(t,e){oe(t,Ac,e)}const fo=.3;function S_(t,e){const n=F(t),r=rt(),s=n.start_timestamp;return!(r-s>fo||e&&r-e<=fo)}const ho="9.38.0";function E_(t,e,n=[e],r="npm"){const s=t._metadata||{};s.sdk||(s.sdk={name:`sentry.javascript.${e}`,packages:n.map(i=>({name:`${r}:@sentry/${i}`,version:ho})),version:ho}),t._metadata=s}function y_(t){const e={...t};return E_(e,"react"),fa("react",{version:A.version}),Ym(e)}class T_{constructor(){this.isInitialized=!1,console.log("Sentry explicitly disabled via VITE_ENABLE_SENTRY")}init(){const e=de.getConfig();if(!e.sentry.dsn){je.warn("Sentry DSN not provided, error tracking disabled");return}try{y_({dsn:e.sentry.dsn,environment:e.sentry.environment,debug:de.isDevelopment,integrations:[h_({tracePropagationTargets:[e.api.pocketbaseUrl,e.api.baseUrl,e.api.aiServiceUrl]})],tracesSampleRate:de.isProduction?.1:1,sampleRate:de.isProduction?.8:1,release:`${e.app.name}@${e.app.version}`,beforeSend:(n,r)=>this.beforeSendFilter(n,r),initialScope:{tags:{component:"react-app",version:e.app.version}}}),this.isInitialized=!0,je.info("Sentry initialized successfully")}catch(n){je.error("Failed to initialize Sentry",{error:n.message})}}beforeSendFilter(e,n){var r,s,i,o,a,c,u,l;return de.isDevelopment&&(o=(i=(s=(r=e.exception)==null?void 0:r.values)==null?void 0:s[0])==null?void 0:i.value)!=null&&o.includes("Loading chunk")||(l=(u=(c=(a=e.exception)==null?void 0:a.values)==null?void 0:c[0])==null?void 0:u.value)!=null&&l.includes("Extension context invalidated")?null:(n.originalException&&(e.extra={...e.extra,originalException:n.originalException}),e)}captureException(e,n={}){if(!this.isInitialized){je.error("Sentry not initialized, logging error locally",{error:e,context:n});return}Vt(r=>{Object.keys(n).forEach(s=>{r.setContext(s,n[s])}),da(e)})}captureMessage(e,n="info",r={}){if(!this.isInitialized){je.info(`Sentry message: ${e}`,r);return}Vt(s=>{Object.keys(r).forEach(i=>{s.setContext(i,r[i])}),s.setLevel(n),Fd(e)})}setUser(e){this.isInitialized&&Ii({id:e.id,email:e.email,username:e.username||e.name})}clearUser(){this.isInitialized&&Ii(null)}addBreadcrumb(e,n="custom",r="info",s={}){this.isInitialized&&Le({message:e,category:n,level:r,data:s,timestamp:Date.now()/1e3})}setTag(e,n){this.isInitialized&&Ud(e,n)}setContext(e,n){this.isInitialized&&fa(e,n)}startTransaction(e,n="navigation"){return this.isInitialized?(void 0)({name:e,op:n}):null}measure(e,n){if(!this.isInitialized)return n();const r=this.startTransaction(e,"function");try{const s=n();return s&&typeof s.then=="function"?s.finally(()=>{r==null||r.finish()}):(r==null||r.finish(),s)}catch(s){throw r==null||r.setStatus("internal_error"),r==null||r.finish(),s}}captureApiCall(e,n,r,s){var o;if(!this.isInitialized)return;this.addBreadcrumb(`${n} ${e} - ${r}`,"http",r>=400?"error":"info",{url:e,method:n,status:r,duration:s});const i=(o=(void 0)().getScope())==null?void 0:o.getSpan();if(i){const a=i.startChild({op:"http.client",description:`${n} ${e}`});a.setData("http.method",n),a.setData("http.url",e),a.setData("http.status_code",r),a.setData("duration",s),a.finish()}}showReportDialog(e={}){this.isInitialized&&Jm({title:"Report a Problem",subtitle:"Help us improve the application",subtitle2:"Your feedback is valuable to us.",labelName:"Name",labelEmail:"Email",labelComments:"What happened?",labelClose:"Close",labelSubmit:"Submit",...e})}isAvailable(){return this.isInitialized}}const Rr=new T_;class b_ extends es.Component{constructor(n){super(n);ut(this,"handleReportError",()=>{var n,r,s;if(Rr.isAvailable())Rr.showReportDialog({eventId:this.state.eventId});else{const i=encodeURIComponent("Application Error Report"),o=encodeURIComponent(`
Error: ${((n=this.state.error)==null?void 0:n.message)||"Unknown error"}
Stack: ${((r=this.state.error)==null?void 0:r.stack)||"Not available"}
Component Stack: ${((s=this.state.errorInfo)==null?void 0:s.componentStack)||"Not available"}
      `);window.location.href=`mailto:support@flagfitpro.com?subject=${i}&body=${o}`}});ut(this,"handleReload",()=>{window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null,eventId:null}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(n,r){je.logError(n,"React Error Boundary");const s=Rr.captureException(n,{errorBoundary:{componentStack:r.componentStack,errorBoundaryStack:r.errorBoundaryStack||"Not available"},react:{componentStack:r.componentStack}});this.setState({error:n,errorInfo:r,eventId:s})}render(){return this.state.hasError?S.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:S.jsx("div",{className:"max-w-md w-full mx-4",children:S.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-6 border-l-4 border-red-500",children:[S.jsxs("div",{className:"flex items-center mb-4",children:[S.jsx("div",{className:"flex-shrink-0",children:S.jsx("svg",{className:"h-8 w-8 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),S.jsx("div",{className:"ml-3",children:S.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Something went wrong"})})]}),S.jsxs("div",{className:"mb-4",children:[S.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"We're sorry for the inconvenience. An unexpected error occurred while loading this page."}),this.state.error&&S.jsx("div",{className:"bg-gray-50 p-3 rounded text-xs text-gray-700 font-mono",children:this.state.error.message})]}),S.jsxs("div",{className:"flex space-x-3",children:[S.jsx("button",{onClick:this.handleReload,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Reload Page"}),S.jsx("button",{onClick:this.handleReportError,className:"flex-1 bg-gray-100 text-gray-700 px-4 py-2 rounded-md text-sm font-medium hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",children:"Report Error"})]}),S.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:S.jsxs("p",{className:"text-xs text-gray-500",children:["Error ID: ",this.state.eventId||"Not available"]})})]})})}):this.props.children}}const I_=A.lazy(()=>$e(()=>import("./LoginView-a2a94d79.js"),["assets/LoginView-a2a94d79.js","assets/query-73861c9c.js","assets/vendor-2fbe36df.js","assets/router-241b6e81.js","assets/state-acab8a68.js","assets/ui-300eb2b0.js"])),v_=A.lazy(()=>$e(()=>import("./RegisterView-1d6c3cba.js"),["assets/RegisterView-1d6c3cba.js","assets/query-73861c9c.js","assets/vendor-2fbe36df.js","assets/router-241b6e81.js","assets/state-acab8a68.js","assets/ui-300eb2b0.js"])),R_=A.lazy(()=>$e(()=>import("./DashboardView-f01383cc.js"),["assets/DashboardView-f01383cc.js","assets/query-73861c9c.js","assets/vendor-2fbe36df.js","assets/router-241b6e81.js","assets/state-acab8a68.js","assets/ui-300eb2b0.js"])),w_=A.lazy(()=>$e(()=>import("./TrainingView-6b106106.js"),["assets/TrainingView-6b106106.js","assets/query-73861c9c.js","assets/vendor-2fbe36df.js","assets/router-241b6e81.js","assets/state-acab8a68.js","assets/ui-300eb2b0.js"])),C_=A.lazy(()=>$e(()=>import("./ProfileView-98922ca6.js"),["assets/ProfileView-98922ca6.js","assets/query-73861c9c.js","assets/vendor-2fbe36df.js"])),A_=A.lazy(()=>$e(()=>import("./OnboardingView-a53ea133.js"),["assets/OnboardingView-a53ea133.js","assets/query-73861c9c.js","assets/vendor-2fbe36df.js","assets/router-241b6e81.js","assets/state-acab8a68.js","assets/ui-300eb2b0.js"])),O_=A.lazy(()=>$e(()=>import("./TournamentsView-d1f62a94.js"),["assets/TournamentsView-d1f62a94.js","assets/query-73861c9c.js","assets/vendor-2fbe36df.js","assets/router-241b6e81.js"])),N_=A.lazy(()=>$e(()=>import("./CommunityView-24dd812f.js"),["assets/CommunityView-24dd812f.js","assets/query-73861c9c.js","assets/vendor-2fbe36df.js","assets/router-241b6e81.js"])),lt=({children:t})=>{const{isAuthenticated:e,isLoading:n}=Vn();return n?S.jsx(Gn,{}):e?t:S.jsx(ts,{to:"/login",replace:!0})},go=({children:t})=>{const{isAuthenticated:e,isLoading:n}=Vn();return n?S.jsx(Gn,{}):e?S.jsx(ts,{to:"/dashboard",replace:!0}):t},k_=()=>S.jsx($c,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:S.jsx(A.Suspense,{fallback:S.jsx("div",{className:"min-h-screen flex items-center justify-center",children:S.jsx(Gn,{size:"lg"})}),children:S.jsxs(Dc,{children:[S.jsx(ue,{path:"/login",element:S.jsx(go,{children:S.jsx(I_,{})})}),S.jsx(ue,{path:"/register",element:S.jsx(go,{children:S.jsx(v_,{})})}),S.jsx(ue,{path:"/dashboard",element:S.jsx(lt,{children:S.jsx(R_,{})})}),S.jsx(ue,{path:"/training",element:S.jsx(lt,{children:S.jsx(w_,{})})}),S.jsx(ue,{path:"/profile",element:S.jsx(lt,{children:S.jsx(C_,{})})}),S.jsx(ue,{path:"/onboarding",element:S.jsx(lt,{children:S.jsx(A_,{})})}),S.jsx(ue,{path:"/tournaments",element:S.jsx(lt,{children:S.jsx(O_,{})})}),S.jsx(ue,{path:"/community",element:S.jsx(lt,{children:S.jsx(N_,{})})}),S.jsx(ue,{path:"/",element:S.jsx(ts,{to:"/dashboard",replace:!0})}),S.jsx(ue,{path:"*",element:S.jsx("div",{children:"Page not found"})})]})})}),P_=()=>{const{isOnline:t}=Tu(),{isDarkMode:e}=Nu();return S.jsx(Uc,{theme:{algorithm:e?Hs.darkAlgorithm:Hs.defaultAlgorithm,token:{colorPrimary:"#3B82F6",colorSuccess:"#10B981",colorWarning:"#F59E0B",colorError:"#EF4444"}},children:S.jsxs("div",{className:"app",children:[!t&&S.jsx(ku,{}),S.jsx(fu,{children:S.jsx(_u,{children:S.jsx(k_,{})})})]})})},L_=()=>S.jsx(b_,{children:S.jsx(yu,{children:S.jsx(iu,{children:S.jsx(P_,{})})})});je.info("Application starting",{timestamp:new Date().toISOString(),userAgent:navigator.userAgent,viewport:{width:window.innerWidth,height:window.innerHeight}});const x_=wr.createRoot(document.getElementById("root"));x_.render(S.jsx(es.StrictMode,{children:S.jsx(L_,{})}));export{Gn as L,B_ as a,q_ as b,Vn as u};
//# sourceMappingURL=index-935f4bd1.js.map
