var kc=Object.defineProperty;var Pc=(t,e,n)=>e in t?kc(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ut=(t,e,n)=>(Pc(t,typeof e!="symbol"?e+"":e,n),n);import{j as _,Q as $c,a as Dc}from"./query-73861c9c.js";import{c as xc,r as k,R as fe}from"./vendor-2fbe36df.js";import{B as Fc,R as Uc,a as ve,N as rs}from"./router-241b6e81.js";import{c as Mc}from"./state-acab8a68.js";import{C as Hc,t as qs}from"./ui-300eb2b0.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Or={},Gs=xc;Or.createRoot=Gs.createRoot,Or.hydrateRoot=Gs.hydrateRoot;const jc="modulepreload",Bc=function(t){return"/"+t},Vs={},bt=function(e,n,r){if(!n||n.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(n.map(i=>{if(i=Bc(i),i in Vs)return;Vs[i]=!0;const o=i.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let l=s.length-1;l>=0;l--){const d=s[l];if(d.href===i&&(!o||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":jc,o||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),o)return new Promise((l,d)=>{u.addEventListener("load",l),u.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},qc=(t,e,n=null)=>{const s=((c,u)=>(l,d)=>d.type.endsWith("_START")?{...l,isLoading:!0,error:null}:d.type.endsWith("_SUCCESS")?{...l,isLoading:!1,error:null,...d.payload}:d.type.endsWith("_FAILURE")?{...l,isLoading:!1,error:d.payload}:d.type==="CLEAR_ERROR"?{...l,error:null}:d.type==="SET_LOADING"?{...l,isLoading:d.payload}:u?u(l,d):l)(e,n),[i,o]=k.useReducer(s,t),a=k.useMemo(()=>{const c={};return Object.values(e).forEach(u=>{const l=u.toLowerCase().split("_"),d=l[0]+l.slice(1).map(p=>p.charAt(0).toUpperCase()+p.slice(1)).join("");c[d]=p=>o({type:u,payload:p})}),c.clearError=()=>o({type:"CLEAR_ERROR"}),c.setLoading=u=>o({type:"SET_LOADING",payload:u}),c},[o]);return[i,o,a]};class Q extends Error{constructor(e){var n,r,s,i;super("ClientResponseError"),this.url="",this.status=0,this.response={},this.isAbort=!1,this.originalError=null,Object.setPrototypeOf(this,Q.prototype),e!==null&&typeof e=="object"&&(this.url=typeof e.url=="string"?e.url:"",this.status=typeof e.status=="number"?e.status:0,this.isAbort=!!e.isAbort,this.originalError=e.originalError,e.response!==null&&typeof e.response=="object"?this.response=e.response:e.data!==null&&typeof e.data=="object"?this.response=e.data:this.response={}),this.originalError||e instanceof Q||(this.originalError=e),typeof DOMException<"u"&&e instanceof DOMException&&(this.isAbort=!0),this.name="ClientResponseError "+this.status,this.message=(n=this.response)==null?void 0:n.message,this.message||(this.isAbort?this.message="The request was autocancelled. You can find more info in https://github.com/pocketbase/js-sdk#auto-cancellation.":(i=(s=(r=this.originalError)==null?void 0:r.cause)==null?void 0:s.message)!=null&&i.includes("ECONNREFUSED ::1")?this.message="Failed to connect to the PocketBase server. Try changing the SDK URL from localhost to 127.0.0.1 (https://github.com/pocketbase/js-sdk/issues/21).":this.message="Something went wrong."),this.cause=this.originalError}get data(){return this.response}toJSON(){return{...this}}}const dn=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function Gc(t,e){const n={};if(typeof t!="string")return n;const r=Object.assign({},e||{}).decode||Vc;let s=0;for(;s<t.length;){const i=t.indexOf("=",s);if(i===-1)break;let o=t.indexOf(";",s);if(o===-1)o=t.length;else if(o<i){s=t.lastIndexOf(";",i-1)+1;continue}const a=t.slice(s,i).trim();if(n[a]===void 0){let c=t.slice(i+1,o).trim();c.charCodeAt(0)===34&&(c=c.slice(1,-1));try{n[a]=r(c)}catch{n[a]=c}}s=o+1}return n}function zs(t,e,n){const r=Object.assign({},n||{}),s=r.encode||zc;if(!dn.test(t))throw new TypeError("argument name is invalid");const i=s(e);if(i&&!dn.test(i))throw new TypeError("argument val is invalid");let o=t+"="+i;if(r.maxAge!=null){const a=r.maxAge-0;if(isNaN(a)||!isFinite(a))throw new TypeError("option maxAge is invalid");o+="; Max-Age="+Math.floor(a)}if(r.domain){if(!dn.test(r.domain))throw new TypeError("option domain is invalid");o+="; Domain="+r.domain}if(r.path){if(!dn.test(r.path))throw new TypeError("option path is invalid");o+="; Path="+r.path}if(r.expires){if(!function(c){return Object.prototype.toString.call(c)==="[object Date]"||c instanceof Date}(r.expires)||isNaN(r.expires.valueOf()))throw new TypeError("option expires is invalid");o+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(o+="; HttpOnly"),r.secure&&(o+="; Secure"),r.priority)switch(typeof r.priority=="string"?r.priority.toLowerCase():r.priority){case"low":o+="; Priority=Low";break;case"medium":o+="; Priority=Medium";break;case"high":o+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return o}function Vc(t){return t.indexOf("%")!==-1?decodeURIComponent(t):t}function zc(t){return encodeURIComponent(t)}const Wc=typeof navigator<"u"&&navigator.product==="ReactNative"||typeof global<"u"&&global.HermesInternal;let So;function ft(t){if(t)try{const e=decodeURIComponent(So(t.split(".")[1]).split("").map(function(n){return"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)||{}}catch{}return{}}function Eo(t,e=0){let n=ft(t);return!(Object.keys(n).length>0&&(!n.exp||n.exp-e>Date.now()/1e3))}So=typeof atob!="function"||Wc?t=>{let e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,r,s=0,i=0,o="";r=e.charAt(i++);~r&&(n=s%4?64*n+r:r,s++%4)?o+=String.fromCharCode(255&n>>(-2*s&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return o}:atob;const Ws="pb_auth";class ss{constructor(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}get token(){return this.baseToken}get record(){return this.baseModel}get model(){return this.baseModel}get isValid(){return!Eo(this.token)}get isSuperuser(){var n,r;let e=ft(this.token);return e.type=="auth"&&(((n=this.record)==null?void 0:n.collectionName)=="_superusers"||!((r=this.record)!=null&&r.collectionName)&&e.collectionId=="pbc_3142635823")}get isAdmin(){return console.warn("Please replace pb.authStore.isAdmin with pb.authStore.isSuperuser OR simply check the value of pb.authStore.record?.collectionName"),this.isSuperuser}get isAuthRecord(){return console.warn("Please replace pb.authStore.isAuthRecord with !pb.authStore.isSuperuser OR simply check the value of pb.authStore.record?.collectionName"),ft(this.token).type=="auth"&&!this.isSuperuser}save(e,n){this.baseToken=e||"",this.baseModel=n||null,this.triggerChange()}clear(){this.baseToken="",this.baseModel=null,this.triggerChange()}loadFromCookie(e,n=Ws){const r=Gc(e||"")[n]||"";let s={};try{s=JSON.parse(r),(typeof s===null||typeof s!="object"||Array.isArray(s))&&(s={})}catch{}this.save(s.token||"",s.record||s.model||null)}exportToCookie(e,n=Ws){var c,u;const r={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},s=ft(this.token);r.expires=s!=null&&s.exp?new Date(1e3*s.exp):new Date("1970-01-01"),e=Object.assign({},r,e);const i={token:this.token,record:this.record?JSON.parse(JSON.stringify(this.record)):null};let o=zs(n,JSON.stringify(i),e);const a=typeof Blob<"u"?new Blob([o]).size:o.length;if(i.record&&a>4096){i.record={id:(c=i.record)==null?void 0:c.id,email:(u=i.record)==null?void 0:u.email};const l=["collectionId","collectionName","verified"];for(const d in this.record)l.includes(d)&&(i.record[d]=this.record[d]);o=zs(n,JSON.stringify(i),e)}return o}onChange(e,n=!1){return this._onChangeCallbacks.push(e),n&&e(this.token,this.record),()=>{for(let r=this._onChangeCallbacks.length-1;r>=0;r--)if(this._onChangeCallbacks[r]==e)return delete this._onChangeCallbacks[r],void this._onChangeCallbacks.splice(r,1)}}triggerChange(){for(const e of this._onChangeCallbacks)e&&e(this.token,this.record)}}class Kc extends ss{constructor(e="pocketbase_auth"){super(),this.storageFallback={},this.storageKey=e,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get record(){const e=this._storageGet(this.storageKey)||{};return e.record||e.model||null}get model(){return this.record}save(e,n){this._storageSet(this.storageKey,{token:e,record:n}),super.save(e,n)}clear(){this._storageRemove(this.storageKey),super.clear()}_storageGet(e){if(typeof window<"u"&&(window!=null&&window.localStorage)){const n=window.localStorage.getItem(e)||"";try{return JSON.parse(n)}catch{return n}}return this.storageFallback[e]}_storageSet(e,n){if(typeof window<"u"&&(window!=null&&window.localStorage)){let r=n;typeof n!="string"&&(r=JSON.stringify(n)),window.localStorage.setItem(e,r)}else this.storageFallback[e]=n}_storageRemove(e){var n;typeof window<"u"&&(window!=null&&window.localStorage)&&((n=window.localStorage)==null||n.removeItem(e)),delete this.storageFallback[e]}_bindStorageEvent(){typeof window<"u"&&(window!=null&&window.localStorage)&&window.addEventListener&&window.addEventListener("storage",e=>{if(e.key!=this.storageKey)return;const n=this._storageGet(this.storageKey)||{};super.save(n.token||"",n.record||n.model||null)})}}class Ee{constructor(e){this.client=e}}class Jc extends Ee{async getAll(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/settings",e)}async update(e,n){return n=Object.assign({method:"PATCH",body:e},n),this.client.send("/api/settings",n)}async testS3(e="storage",n){return n=Object.assign({method:"POST",body:{filesystem:e}},n),this.client.send("/api/settings/test/s3",n).then(()=>!0)}async testEmail(e,n,r,s){return s=Object.assign({method:"POST",body:{email:n,template:r,collection:e}},s),this.client.send("/api/settings/test/email",s).then(()=>!0)}async generateAppleClientSecret(e,n,r,s,i,o){return o=Object.assign({method:"POST",body:{clientId:e,teamId:n,keyId:r,privateKey:s,duration:i}},o),this.client.send("/api/settings/apple/generate-client-secret",o)}}const Yc=["requestKey","$cancelKey","$autoCancel","fetch","headers","body","query","params","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];function is(t){if(t){t.query=t.query||{};for(let e in t)Yc.includes(e)||(t.query[e]=t[e],delete t[e])}}function yo(t){const e=[];for(const n in t){const r=encodeURIComponent(n),s=Array.isArray(t[n])?t[n]:[t[n]];for(let i of s)i=Xc(i),i!==null&&e.push(r+"="+i)}return e.join("&")}function Xc(t){return t==null?null:t instanceof Date?encodeURIComponent(t.toISOString().replace("T"," ")):encodeURIComponent(typeof t=="object"?JSON.stringify(t):t)}class To extends Ee{constructor(){super(...arguments),this.clientId="",this.eventSource=null,this.subscriptions={},this.lastSentSubscriptions=[],this.maxConnectTimeout=15e3,this.reconnectAttempts=0,this.maxReconnectAttempts=1/0,this.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],this.pendingConnects=[]}get isConnected(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length}async subscribe(e,n,r){var o;if(!e)throw new Error("topic must be set.");let s=e;if(r){is(r=Object.assign({},r));const a="options="+encodeURIComponent(JSON.stringify({query:r.query,headers:r.headers}));s+=(s.includes("?")?"&":"?")+a}const i=function(a){const c=a;let u;try{u=JSON.parse(c==null?void 0:c.data)}catch{}n(u||{})};return this.subscriptions[s]||(this.subscriptions[s]=[]),this.subscriptions[s].push(i),this.isConnected?this.subscriptions[s].length===1?await this.submitSubscriptions():(o=this.eventSource)==null||o.addEventListener(s,i):await this.connect(),async()=>this.unsubscribeByTopicAndListener(e,i)}async unsubscribe(e){var r;let n=!1;if(e){const s=this.getSubscriptionsByTopic(e);for(let i in s)if(this.hasSubscriptionListeners(i)){for(let o of this.subscriptions[i])(r=this.eventSource)==null||r.removeEventListener(i,o);delete this.subscriptions[i],n||(n=!0)}}else this.subscriptions={};this.hasSubscriptionListeners()?n&&await this.submitSubscriptions():this.disconnect()}async unsubscribeByPrefix(e){var r;let n=!1;for(let s in this.subscriptions)if((s+"?").startsWith(e)){n=!0;for(let i of this.subscriptions[s])(r=this.eventSource)==null||r.removeEventListener(s,i);delete this.subscriptions[s]}n&&(this.hasSubscriptionListeners()?await this.submitSubscriptions():this.disconnect())}async unsubscribeByTopicAndListener(e,n){var i;let r=!1;const s=this.getSubscriptionsByTopic(e);for(let o in s){if(!Array.isArray(this.subscriptions[o])||!this.subscriptions[o].length)continue;let a=!1;for(let c=this.subscriptions[o].length-1;c>=0;c--)this.subscriptions[o][c]===n&&(a=!0,delete this.subscriptions[o][c],this.subscriptions[o].splice(c,1),(i=this.eventSource)==null||i.removeEventListener(o,n));a&&(this.subscriptions[o].length||delete this.subscriptions[o],r||this.hasSubscriptionListeners(o)||(r=!0))}this.hasSubscriptionListeners()?r&&await this.submitSubscriptions():this.disconnect()}hasSubscriptionListeners(e){var n,r;if(this.subscriptions=this.subscriptions||{},e)return!!((n=this.subscriptions[e])!=null&&n.length);for(let s in this.subscriptions)if((r=this.subscriptions[s])!=null&&r.length)return!0;return!1}async submitSubscriptions(){if(this.clientId)return this.addAllSubscriptionListeners(),this.lastSentSubscriptions=this.getNonEmptySubscriptionKeys(),this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentSubscriptions},requestKey:this.getSubscriptionsCancelKey()}).catch(e=>{if(!(e!=null&&e.isAbort))throw e})}getSubscriptionsCancelKey(){return"realtime_"+this.clientId}getSubscriptionsByTopic(e){const n={};e=e.includes("?")?e:e+"?";for(let r in this.subscriptions)(r+"?").startsWith(e)&&(n[r]=this.subscriptions[r]);return n}getNonEmptySubscriptionKeys(){const e=[];for(let n in this.subscriptions)this.subscriptions[n].length&&e.push(n);return e}addAllSubscriptionListeners(){if(this.eventSource){this.removeAllSubscriptionListeners();for(let e in this.subscriptions)for(let n of this.subscriptions[e])this.eventSource.addEventListener(e,n)}}removeAllSubscriptionListeners(){if(this.eventSource)for(let e in this.subscriptions)for(let n of this.subscriptions[e])this.eventSource.removeEventListener(e,n)}async connect(){if(!(this.reconnectAttempts>0))return new Promise((e,n)=>{this.pendingConnects.push({resolve:e,reject:n}),this.pendingConnects.length>1||this.initConnect()})}initConnect(){this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{this.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildURL("/api/realtime")),this.eventSource.onerror=e=>{this.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",e=>{const n=e;this.clientId=n==null?void 0:n.lastEventId,this.submitSubscriptions().then(async()=>{let r=3;for(;this.hasUnsentSubscriptions()&&r>0;)r--,await this.submitSubscriptions()}).then(()=>{for(let s of this.pendingConnects)s.resolve();this.pendingConnects=[],this.reconnectAttempts=0,clearTimeout(this.reconnectTimeoutId),clearTimeout(this.connectTimeoutId);const r=this.getSubscriptionsByTopic("PB_CONNECT");for(let s in r)for(let i of r[s])i(e)}).catch(r=>{this.clientId="",this.connectErrorHandler(r)})})}hasUnsentSubscriptions(){const e=this.getNonEmptySubscriptionKeys();if(e.length!=this.lastSentSubscriptions.length)return!0;for(const n of e)if(!this.lastSentSubscriptions.includes(n))return!0;return!1}connectErrorHandler(e){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(let r of this.pendingConnects)r.reject(new Q(e));return this.pendingConnects=[],void this.disconnect()}this.disconnect(!0);const n=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(()=>{this.initConnect()},n)}disconnect(e=!1){var n;if(this.clientId&&this.onDisconnect&&this.onDisconnect(Object.keys(this.subscriptions)),clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),this.client.cancelRequest(this.getSubscriptionsCancelKey()),(n=this.eventSource)==null||n.close(),this.eventSource=null,this.clientId="",!e){this.reconnectAttempts=0;for(let r of this.pendingConnects)r.resolve();this.pendingConnects=[]}}}class bo extends Ee{decode(e){return e}async getFullList(e,n){if(typeof e=="number")return this._getFullList(e,n);let r=500;return(n=Object.assign({},e,n)).batch&&(r=n.batch,delete n.batch),this._getFullList(r,n)}async getList(e=1,n=30,r){return(r=Object.assign({method:"GET"},r)).query=Object.assign({page:e,perPage:n},r.query),this.client.send(this.baseCrudPath,r).then(s=>{var i;return s.items=((i=s.items)==null?void 0:i.map(o=>this.decode(o)))||[],s})}async getFirstListItem(e,n){return(n=Object.assign({requestKey:"one_by_filter_"+this.baseCrudPath+"_"+e},n)).query=Object.assign({filter:e,skipTotal:1},n.query),this.getList(1,1,n).then(r=>{var s;if(!((s=r==null?void 0:r.items)!=null&&s.length))throw new Q({status:404,response:{code:404,message:"The requested resource wasn't found.",data:{}}});return r.items[0]})}async getOne(e,n){if(!e)throw new Q({url:this.client.buildURL(this.baseCrudPath+"/"),status:404,response:{code:404,message:"Missing required record id.",data:{}}});return n=Object.assign({method:"GET"},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),n).then(r=>this.decode(r))}async create(e,n){return n=Object.assign({method:"POST",body:e},n),this.client.send(this.baseCrudPath,n).then(r=>this.decode(r))}async update(e,n,r){return r=Object.assign({method:"PATCH",body:n},r),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),r).then(s=>this.decode(s))}async delete(e,n){return n=Object.assign({method:"DELETE"},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),n).then(()=>!0)}_getFullList(e=500,n){(n=n||{}).query=Object.assign({skipTotal:1},n.query);let r=[],s=async i=>this.getList(i,e||500,n).then(o=>{const a=o.items;return r=r.concat(a),a.length==o.perPage?s(i+1):r});return s(1)}}function Re(t,e,n,r){const s=r!==void 0;return s||n!==void 0?s?(console.warn(t),e.body=Object.assign({},e.body,n),e.query=Object.assign({},e.query,r),e):Object.assign(e,n):e}function cr(t){var e;(e=t._resetAutoRefresh)==null||e.call(t)}class Qc extends bo{constructor(e,n){super(e),this.collectionIdOrName=n}get baseCrudPath(){return this.baseCollectionPath+"/records"}get baseCollectionPath(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)}get isSuperusers(){return this.collectionIdOrName=="_superusers"||this.collectionIdOrName=="_pbc_2773867675"}async subscribe(e,n,r){if(!e)throw new Error("Missing topic.");if(!n)throw new Error("Missing subscription callback.");return this.client.realtime.subscribe(this.collectionIdOrName+"/"+e,n,r)}async unsubscribe(e){return e?this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+e):this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)}async getFullList(e,n){if(typeof e=="number")return super.getFullList(e,n);const r=Object.assign({},e,n);return super.getFullList(r)}async getList(e=1,n=30,r){return super.getList(e,n,r)}async getFirstListItem(e,n){return super.getFirstListItem(e,n)}async getOne(e,n){return super.getOne(e,n)}async create(e,n){return super.create(e,n)}async update(e,n,r){return super.update(e,n,r).then(s=>{var i,o,a;if(((i=this.client.authStore.record)==null?void 0:i.id)===(s==null?void 0:s.id)&&(((o=this.client.authStore.record)==null?void 0:o.collectionId)===this.collectionIdOrName||((a=this.client.authStore.record)==null?void 0:a.collectionName)===this.collectionIdOrName)){let c=Object.assign({},this.client.authStore.record.expand),u=Object.assign({},this.client.authStore.record,s);c&&(u.expand=Object.assign(c,s.expand)),this.client.authStore.save(this.client.authStore.token,u)}return s})}async delete(e,n){return super.delete(e,n).then(r=>{var s,i,o;return!r||((s=this.client.authStore.record)==null?void 0:s.id)!==e||((i=this.client.authStore.record)==null?void 0:i.collectionId)!==this.collectionIdOrName&&((o=this.client.authStore.record)==null?void 0:o.collectionName)!==this.collectionIdOrName||this.client.authStore.clear(),r})}authResponse(e){const n=this.decode((e==null?void 0:e.record)||{});return this.client.authStore.save(e==null?void 0:e.token,n),Object.assign({},e,{token:(e==null?void 0:e.token)||"",record:n})}async listAuthMethods(e){return e=Object.assign({method:"GET",fields:"mfa,otp,password,oauth2"},e),this.client.send(this.baseCollectionPath+"/auth-methods",e)}async authWithPassword(e,n,r){let s;r=Object.assign({method:"POST",body:{identity:e,password:n}},r),this.isSuperusers&&(s=r.autoRefreshThreshold,delete r.autoRefreshThreshold,r.autoRefresh||cr(this.client));let i=await this.client.send(this.baseCollectionPath+"/auth-with-password",r);return i=this.authResponse(i),s&&this.isSuperusers&&function(a,c,u,l){cr(a);const d=a.beforeSend,p=a.authStore.record,f=a.authStore.onChange((m,h)=>{(!m||(h==null?void 0:h.id)!=(p==null?void 0:p.id)||(h!=null&&h.collectionId||p!=null&&p.collectionId)&&(h==null?void 0:h.collectionId)!=(p==null?void 0:p.collectionId))&&cr(a)});a._resetAutoRefresh=function(){f(),a.beforeSend=d,delete a._resetAutoRefresh},a.beforeSend=async(m,h)=>{var C;const T=a.authStore.token;if((C=h.query)!=null&&C.autoRefresh)return d?d(m,h):{url:m,sendOptions:h};let I=a.authStore.isValid;if(I&&Eo(a.authStore.token,c))try{await u()}catch{I=!1}I||await l();const R=h.headers||{};for(let S in R)if(S.toLowerCase()=="authorization"&&T==R[S]&&a.authStore.token){R[S]=a.authStore.token;break}return h.headers=R,d?d(m,h):{url:m,sendOptions:h}}}(this.client,s,()=>this.authRefresh({autoRefresh:!0}),()=>this.authWithPassword(e,n,Object.assign({autoRefresh:!0},r))),i}async authWithOAuth2Code(e,n,r,s,i,o,a){let c={method:"POST",body:{provider:e,code:n,codeVerifier:r,redirectURL:s,createData:i}};return c=Re("This form of authWithOAuth2Code(provider, code, codeVerifier, redirectURL, createData?, body?, query?) is deprecated. Consider replacing it with authWithOAuth2Code(provider, code, codeVerifier, redirectURL, createData?, options?).",c,o,a),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",c).then(u=>this.authResponse(u))}authWithOAuth2(...e){if(e.length>1||typeof(e==null?void 0:e[0])=="string")return console.warn("PocketBase: This form of authWithOAuth2() is deprecated and may get removed in the future. Please replace with authWithOAuth2Code() OR use the authWithOAuth2() realtime form as shown in https://pocketbase.io/docs/authentication/#oauth2-integration."),this.authWithOAuth2Code((e==null?void 0:e[0])||"",(e==null?void 0:e[1])||"",(e==null?void 0:e[2])||"",(e==null?void 0:e[3])||"",(e==null?void 0:e[4])||{},(e==null?void 0:e[5])||{},(e==null?void 0:e[6])||{});const n=(e==null?void 0:e[0])||{};let r=null;n.urlCallback||(r=Ks(void 0));const s=new To(this.client);function i(){r==null||r.close(),s.unsubscribe()}const o={},a=n.requestKey;return a&&(o.requestKey=a),this.listAuthMethods(o).then(c=>{var p;const u=c.oauth2.providers.find(f=>f.name===n.provider);if(!u)throw new Q(new Error(`Missing or invalid provider "${n.provider}".`));const l=this.client.buildURL("/api/oauth2-redirect"),d=a?(p=this.client.cancelControllers)==null?void 0:p[a]:void 0;return d&&(d.signal.onabort=()=>{i()}),new Promise(async(f,m)=>{var h;try{await s.subscribe("@oauth2",async C=>{var g;const S=s.clientId;try{if(!C.state||S!==C.state)throw new Error("State parameters don't match.");if(C.error||!C.code)throw new Error("OAuth2 redirect error or missing code: "+C.error);const w=Object.assign({},n);delete w.provider,delete w.scopes,delete w.createData,delete w.urlCallback,(g=d==null?void 0:d.signal)!=null&&g.onabort&&(d.signal.onabort=null);const q=await this.authWithOAuth2Code(u.name,C.code,u.codeVerifier,l,n.createData,w);f(q)}catch(w){m(new Q(w))}i()});const T={state:s.clientId};(h=n.scopes)!=null&&h.length&&(T.scope=n.scopes.join(" "));const I=this._replaceQueryParams(u.authURL+l,T);await(n.urlCallback||function(C){r?r.location.href=C:r=Ks(C)})(I)}catch(T){i(),m(new Q(T))}})}).catch(c=>{throw i(),c})}async authRefresh(e,n){let r={method:"POST"};return r=Re("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",r,e,n),this.client.send(this.baseCollectionPath+"/auth-refresh",r).then(s=>this.authResponse(s))}async requestPasswordReset(e,n,r){let s={method:"POST",body:{email:e}};return s=Re("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",s,n,r),this.client.send(this.baseCollectionPath+"/request-password-reset",s).then(()=>!0)}async confirmPasswordReset(e,n,r,s,i){let o={method:"POST",body:{token:e,password:n,passwordConfirm:r}};return o=Re("This form of confirmPasswordReset(token, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(token, password, passwordConfirm, options?).",o,s,i),this.client.send(this.baseCollectionPath+"/confirm-password-reset",o).then(()=>!0)}async requestVerification(e,n,r){let s={method:"POST",body:{email:e}};return s=Re("This form of requestVerification(email, body?, query?) is deprecated. Consider replacing it with requestVerification(email, options?).",s,n,r),this.client.send(this.baseCollectionPath+"/request-verification",s).then(()=>!0)}async confirmVerification(e,n,r){let s={method:"POST",body:{token:e}};return s=Re("This form of confirmVerification(token, body?, query?) is deprecated. Consider replacing it with confirmVerification(token, options?).",s,n,r),this.client.send(this.baseCollectionPath+"/confirm-verification",s).then(()=>{const i=ft(e),o=this.client.authStore.record;return o&&!o.verified&&o.id===i.id&&o.collectionId===i.collectionId&&(o.verified=!0,this.client.authStore.save(this.client.authStore.token,o)),!0})}async requestEmailChange(e,n,r){let s={method:"POST",body:{newEmail:e}};return s=Re("This form of requestEmailChange(newEmail, body?, query?) is deprecated. Consider replacing it with requestEmailChange(newEmail, options?).",s,n,r),this.client.send(this.baseCollectionPath+"/request-email-change",s).then(()=>!0)}async confirmEmailChange(e,n,r,s){let i={method:"POST",body:{token:e,password:n}};return i=Re("This form of confirmEmailChange(token, password, body?, query?) is deprecated. Consider replacing it with confirmEmailChange(token, password, options?).",i,r,s),this.client.send(this.baseCollectionPath+"/confirm-email-change",i).then(()=>{const o=ft(e),a=this.client.authStore.record;return a&&a.id===o.id&&a.collectionId===o.collectionId&&this.client.authStore.clear(),!0})}async listExternalAuths(e,n){return this.client.collection("_externalAuths").getFullList(Object.assign({},n,{filter:this.client.filter("recordRef = {:id}",{id:e})}))}async unlinkExternalAuth(e,n,r){const s=await this.client.collection("_externalAuths").getFirstListItem(this.client.filter("recordRef = {:recordId} && provider = {:provider}",{recordId:e,provider:n}));return this.client.collection("_externalAuths").delete(s.id,r).then(()=>!0)}async requestOTP(e,n){return n=Object.assign({method:"POST",body:{email:e}},n),this.client.send(this.baseCollectionPath+"/request-otp",n)}async authWithOTP(e,n,r){return r=Object.assign({method:"POST",body:{otpId:e,password:n}},r),this.client.send(this.baseCollectionPath+"/auth-with-otp",r).then(s=>this.authResponse(s))}async impersonate(e,n,r){(r=Object.assign({method:"POST",body:{duration:n}},r)).headers=r.headers||{},r.headers.Authorization||(r.headers.Authorization=this.client.authStore.token);const s=new Io(this.client.baseURL,new ss,this.client.lang),i=await s.send(this.baseCollectionPath+"/impersonate/"+encodeURIComponent(e),r);return s.authStore.save(i==null?void 0:i.token,this.decode((i==null?void 0:i.record)||{})),s}_replaceQueryParams(e,n={}){let r=e,s="";e.indexOf("?")>=0&&(r=e.substring(0,e.indexOf("?")),s=e.substring(e.indexOf("?")+1));const i={},o=s.split("&");for(const a of o){if(a=="")continue;const c=a.split("=");i[decodeURIComponent(c[0].replace(/\+/g," "))]=decodeURIComponent((c[1]||"").replace(/\+/g," "))}for(let a in n)n.hasOwnProperty(a)&&(n[a]==null?delete i[a]:i[a]=n[a]);s="";for(let a in i)i.hasOwnProperty(a)&&(s!=""&&(s+="&"),s+=encodeURIComponent(a.replace(/%20/g,"+"))+"="+encodeURIComponent(i[a].replace(/%20/g,"+")));return s!=""?r+"?"+s:r}}function Ks(t){if(typeof window>"u"||!(window!=null&&window.open))throw new Q(new Error("Not in a browser context - please pass a custom urlCallback function."));let e=1024,n=768,r=window.innerWidth,s=window.innerHeight;e=e>r?r:e,n=n>s?s:n;let i=r/2-e/2,o=s/2-n/2;return window.open(t,"popup_window","width="+e+",height="+n+",top="+o+",left="+i+",resizable,menubar=no")}class Zc extends bo{get baseCrudPath(){return"/api/collections"}async import(e,n=!1,r){return r=Object.assign({method:"PUT",body:{collections:e,deleteMissing:n}},r),this.client.send(this.baseCrudPath+"/import",r).then(()=>!0)}async getScaffolds(e){return e=Object.assign({method:"GET"},e),this.client.send(this.baseCrudPath+"/meta/scaffolds",e)}async truncate(e,n){return n=Object.assign({method:"DELETE"},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/truncate",n).then(()=>!0)}}class eu extends Ee{async getList(e=1,n=30,r){return(r=Object.assign({method:"GET"},r)).query=Object.assign({page:e,perPage:n},r.query),this.client.send("/api/logs",r)}async getOne(e,n){if(!e)throw new Q({url:this.client.buildURL("/api/logs/"),status:404,response:{code:404,message:"Missing required log id.",data:{}}});return n=Object.assign({method:"GET"},n),this.client.send("/api/logs/"+encodeURIComponent(e),n)}async getStats(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/logs/stats",e)}}class tu extends Ee{async check(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/health",e)}}class nu extends Ee{getUrl(e,n,r={}){return console.warn("Please replace pb.files.getUrl() with pb.files.getURL()"),this.getURL(e,n,r)}getURL(e,n,r={}){if(!n||!(e!=null&&e.id)||!(e!=null&&e.collectionId)&&!(e!=null&&e.collectionName))return"";const s=[];s.push("api"),s.push("files"),s.push(encodeURIComponent(e.collectionId||e.collectionName)),s.push(encodeURIComponent(e.id)),s.push(encodeURIComponent(n));let i=this.client.buildURL(s.join("/"));if(Object.keys(r).length){r.download===!1&&delete r.download;const o=new URLSearchParams(r);i+=(i.includes("?")?"&":"?")+o}return i}async getToken(e){return e=Object.assign({method:"POST"},e),this.client.send("/api/files/token",e).then(n=>(n==null?void 0:n.token)||"")}}class ru extends Ee{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/backups",e)}async create(e,n){return n=Object.assign({method:"POST",body:{name:e}},n),this.client.send("/api/backups",n).then(()=>!0)}async upload(e,n){return n=Object.assign({method:"POST",body:e},n),this.client.send("/api/backups/upload",n).then(()=>!0)}async delete(e,n){return n=Object.assign({method:"DELETE"},n),this.client.send(`/api/backups/${encodeURIComponent(e)}`,n).then(()=>!0)}async restore(e,n){return n=Object.assign({method:"POST"},n),this.client.send(`/api/backups/${encodeURIComponent(e)}/restore`,n).then(()=>!0)}getDownloadUrl(e,n){return console.warn("Please replace pb.backups.getDownloadUrl() with pb.backups.getDownloadURL()"),this.getDownloadURL(e,n)}getDownloadURL(e,n){return this.client.buildURL(`/api/backups/${encodeURIComponent(n)}?token=${encodeURIComponent(e)}`)}}class su extends Ee{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/crons",e)}async run(e,n){return n=Object.assign({method:"POST"},n),this.client.send(`/api/crons/${encodeURIComponent(e)}`,n).then(()=>!0)}}function Nr(t){return typeof Blob<"u"&&t instanceof Blob||typeof File<"u"&&t instanceof File||t!==null&&typeof t=="object"&&t.uri&&(typeof navigator<"u"&&navigator.product==="ReactNative"||typeof global<"u"&&global.HermesInternal)}function Lr(t){return t&&(t.constructor.name==="FormData"||typeof FormData<"u"&&t instanceof FormData)}function Js(t){for(const e in t){const n=Array.isArray(t[e])?t[e]:[t[e]];for(const r of n)if(Nr(r))return!0}return!1}const iu=/^[\-\.\d]+$/;function Ys(t){if(typeof t!="string")return t;if(t=="true")return!0;if(t=="false")return!1;if((t[0]==="-"||t[0]>="0"&&t[0]<="9")&&iu.test(t)){let e=+t;if(""+e===t)return e}return t}class ou extends Ee{constructor(){super(...arguments),this.requests=[],this.subs={}}collection(e){return this.subs[e]||(this.subs[e]=new au(this.requests,e)),this.subs[e]}async send(e){const n=new FormData,r=[];for(let s=0;s<this.requests.length;s++){const i=this.requests[s];if(r.push({method:i.method,url:i.url,headers:i.headers,body:i.json}),i.files)for(let o in i.files){const a=i.files[o]||[];for(let c of a)n.append("requests."+s+"."+o,c)}}return n.append("@jsonPayload",JSON.stringify({requests:r})),e=Object.assign({method:"POST",body:n},e),this.client.send("/api/batch",e)}}class au{constructor(e,n){this.requests=[],this.requests=e,this.collectionIdOrName=n}upsert(e,n){n=Object.assign({body:e||{}},n);const r={method:"PUT",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records"};this.prepareRequest(r,n),this.requests.push(r)}create(e,n){n=Object.assign({body:e||{}},n);const r={method:"POST",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records"};this.prepareRequest(r,n),this.requests.push(r)}update(e,n,r){r=Object.assign({body:n||{}},r);const s={method:"PATCH",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records/"+encodeURIComponent(e)};this.prepareRequest(s,r),this.requests.push(s)}delete(e,n){n=Object.assign({},n);const r={method:"DELETE",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records/"+encodeURIComponent(e)};this.prepareRequest(r,n),this.requests.push(r)}prepareRequest(e,n){if(is(n),e.headers=n.headers,e.json={},e.files={},n.query!==void 0){const s=yo(n.query);s&&(e.url+=(e.url.includes("?")?"&":"?")+s)}let r=n.body;Lr(r)&&(r=function(i){let o={};return i.forEach((a,c)=>{if(c==="@jsonPayload"&&typeof a=="string")try{let u=JSON.parse(a);Object.assign(o,u)}catch(u){console.warn("@jsonPayload error:",u)}else o[c]!==void 0?(Array.isArray(o[c])||(o[c]=[o[c]]),o[c].push(Ys(a))):o[c]=Ys(a)}),o}(r));for(const s in r){const i=r[s];if(Nr(i))e.files[s]=e.files[s]||[],e.files[s].push(i);else if(Array.isArray(i)){const o=[],a=[];for(const c of i)Nr(c)?o.push(c):a.push(c);if(o.length>0&&o.length==i.length){e.files[s]=e.files[s]||[];for(let c of o)e.files[s].push(c)}else if(e.json[s]=a,o.length>0){let c=s;s.startsWith("+")||s.endsWith("+")||(c+="+"),e.files[c]=e.files[c]||[];for(let u of o)e.files[c].push(u)}}else e.json[s]=i}}}let Io=class{get baseUrl(){return this.baseURL}set baseUrl(e){this.baseURL=e}constructor(e="/",n,r="en-US"){this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseURL=e,this.lang=r,n?this.authStore=n:typeof window<"u"&&window.Deno?this.authStore=new ss:this.authStore=new Kc,this.collections=new Zc(this),this.files=new nu(this),this.logs=new eu(this),this.settings=new Jc(this),this.realtime=new To(this),this.health=new tu(this),this.backups=new ru(this),this.crons=new su(this)}get admins(){return this.collection("_superusers")}createBatch(){return new ou(this)}collection(e){return this.recordServices[e]||(this.recordServices[e]=new Qc(this,e)),this.recordServices[e]}autoCancellation(e){return this.enableAutoCancellation=!!e,this}cancelRequest(e){return this.cancelControllers[e]&&(this.cancelControllers[e].abort(),delete this.cancelControllers[e]),this}cancelAllRequests(){for(let e in this.cancelControllers)this.cancelControllers[e].abort();return this.cancelControllers={},this}filter(e,n){if(!n)return e;for(let r in n){let s=n[r];switch(typeof s){case"boolean":case"number":s=""+s;break;case"string":s="'"+s.replace(/'/g,"\\'")+"'";break;default:s=s===null?"null":s instanceof Date?"'"+s.toISOString().replace("T"," ")+"'":"'"+JSON.stringify(s).replace(/'/g,"\\'")+"'"}e=e.replaceAll("{:"+r+"}",s)}return e}getFileUrl(e,n,r={}){return console.warn("Please replace pb.getFileUrl() with pb.files.getURL()"),this.files.getURL(e,n,r)}buildUrl(e){return console.warn("Please replace pb.buildUrl() with pb.buildURL()"),this.buildURL(e)}buildURL(e){var r;let n=this.baseURL;return typeof window>"u"||!window.location||n.startsWith("https://")||n.startsWith("http://")||(n=(r=window.location.origin)!=null&&r.endsWith("/")?window.location.origin.substring(0,window.location.origin.length-1):window.location.origin||"",this.baseURL.startsWith("/")||(n+=window.location.pathname||"/",n+=n.endsWith("/")?"":"/"),n+=this.baseURL),e&&(n+=n.endsWith("/")?"":"/",n+=e.startsWith("/")?e.substring(1):e),n}async send(e,n){n=this.initSendOptions(e,n);let r=this.buildURL(e);if(this.beforeSend){const s=Object.assign({},await this.beforeSend(r,n));s.url!==void 0||s.options!==void 0?(r=s.url||r,n=s.options||n):Object.keys(s).length&&(n=s,console!=null&&console.warn&&console.warn("Deprecated format of beforeSend return: please use `return { url, options }`, instead of `return options`."))}if(n.query!==void 0){const s=yo(n.query);s&&(r+=(r.includes("?")?"&":"?")+s),delete n.query}return this.getHeader(n.headers,"Content-Type")=="application/json"&&n.body&&typeof n.body!="string"&&(n.body=JSON.stringify(n.body)),(n.fetch||fetch)(r,n).then(async s=>{let i={};try{i=await s.json()}catch{}if(this.afterSend&&(i=await this.afterSend(s,i,n)),s.status>=400)throw new Q({url:s.url,status:s.status,data:i});return i}).catch(s=>{throw new Q(s)})}initSendOptions(e,n){if((n=Object.assign({method:"GET"},n)).body=function(s){if(typeof FormData>"u"||s===void 0||typeof s!="object"||s===null||Lr(s)||!Js(s))return s;const i=new FormData;for(const o in s){const a=s[o];if(a!==void 0)if(typeof a!="object"||Js({data:a})){const c=Array.isArray(a)?a:[a];for(let u of c)i.append(o,u)}else{let c={};c[o]=a,i.append("@jsonPayload",JSON.stringify(c))}}return i}(n.body),is(n),n.query=Object.assign({},n.params,n.query),n.requestKey===void 0&&(n.$autoCancel===!1||n.query.$autoCancel===!1?n.requestKey=null:(n.$cancelKey||n.query.$cancelKey)&&(n.requestKey=n.$cancelKey||n.query.$cancelKey)),delete n.$autoCancel,delete n.query.$autoCancel,delete n.$cancelKey,delete n.query.$cancelKey,this.getHeader(n.headers,"Content-Type")!==null||Lr(n.body)||(n.headers=Object.assign({},n.headers,{"Content-Type":"application/json"})),this.getHeader(n.headers,"Accept-Language")===null&&(n.headers=Object.assign({},n.headers,{"Accept-Language":this.lang})),this.authStore.token&&this.getHeader(n.headers,"Authorization")===null&&(n.headers=Object.assign({},n.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&n.requestKey!==null){const r=n.requestKey||(n.method||"GET")+e;delete n.requestKey,this.cancelRequest(r);const s=new AbortController;this.cancelControllers[r]=s,n.signal=s.signal}return n}getHeader(e,n){e=e||{},n=n.toLowerCase();for(let r in e)if(r.toLowerCase()==n)return e[r];return null}};class cu{constructor(){this.pb=new Io("http://127.0.0.1:8090"),this.authStore=this.pb.authStore,this.pendingRequests=new Map}async signUp(e){try{const n={email:e.email,password:e.password,passwordConfirm:e.password};(e.firstName||e.lastName)&&(n.name=`${e.firstName||""} ${e.lastName||""}`.trim()),console.log("Creating user with minimal data:",{email:e.email,hasPassword:!!e.password,hasName:!!n.name});const r=await this.pb.collection("users").create(n);return console.log("User created successfully:",r.email),console.log("Registration successful, skipping auto-login for now"),{user:r,token:null,requiresLogin:!0}}catch(n){if(console.error("SignUp error details:",{message:n.message,status:n.status,data:n.data,response:n.response}),n.data&&n.data.email)throw n.data.email.code==="validation_invalid_email"?new Error("This email address is already registered. Please use a different email or try logging in."):new Error(`Email error: ${n.data.email.message}`);if(n.data&&n.data.password)throw new Error(`Password error: ${n.data.password.message}`);if(n.status===400){if(n.message.includes("create record"))throw new Error("Registration failed. The email might already be in use. Please try a different email.");if(n.message.includes("invalid formatting"))throw new Error("Registration data format error. Please check all fields and try again.")}const r=this.handleConnectionError(n);throw new Error(r)}}async signIn(e,n){const r=`auth:${e}`;if(this.pendingRequests.has(r))return console.log("Login request already pending for:",e),this.pendingRequests.get(r);const s=this._performLogin(e,n);this.pendingRequests.set(r,s);try{return await s}finally{this.pendingRequests.delete(r)}}async _performLogin(e,n){var r;try{console.log("Attempting login with:",{email:e,password:`${n.substring(0,3)}***`}),this.clearPendingRequests();const s=await this.pb.collection("users").authWithPassword(e,n);return console.log("Login successful:",{user:(r=s.record)==null?void 0:r.email,hasToken:!!s.token}),{user:s.record,token:s.token}}catch(s){if(console.error("PocketBase signIn error:",{message:s.message,status:s.status,data:s.data}),s.status===400)throw new Error("Invalid email or password. Please check your credentials.");const i=this.handleConnectionError(s);throw new Error(`Login failed: ${i}`)}}async signOut(){this.pb.authStore.clear(),this.clearPendingRequests()}clearPendingRequests(){console.log("Clearing all pending requests"),this.pendingRequests.clear()}async getCurrentUser(){return this.authStore.isValid?this.authStore.model:null}async updateProfile(e){try{return{user:await this.pb.collection("users").update(this.authStore.model.id,e)}}catch(n){throw new Error(n.message)}}async create(e,n){try{return{data:await this.pb.collection(e).create(n),error:null}}catch(r){return{data:null,error:this.handleConnectionError(r)}}}async getList(e,n={}){var u;const{page:r=1,perPage:s=50,sort:i="-created",filter:o=""}=n,a=`getList:${e}:${r}:${s}:${i}:${o}:${((u=this.authStore.model)==null?void 0:u.id)||"anonymous"}`;if(this.pendingRequests.has(a)){const l=this.pendingRequests.get(a);return console.log(`Reusing pending ${e} request`),l}const c=this._performGetList(e,{page:r,perPage:s,sort:i,filter:o});this.pendingRequests.set(a,c);try{return await c}finally{setTimeout(()=>{this.pendingRequests.delete(a)},100)}}async _performGetList(e,{page:n,perPage:r,sort:s,filter:i}){try{console.log(`Fetching ${e} with filter: ${i}`);const o=await this.pb.collection(e).getList(n,r,{sort:s,filter:i});return console.log(`Successfully fetched ${o.items.length} ${e} records`),{data:o.items,count:o.totalItems,error:null}}catch(o){console.error(`PocketBase error fetching ${e}:`,{message:o.message,status:o.status,collection:e,filter:i});const a=this.handleConnectionError(o);return{data:[],count:0,error:a}}}async getOne(e,n){try{return{data:await this.pb.collection(e).getOne(n),error:null}}catch(r){return{data:null,error:this.handleConnectionError(r)}}}async update(e,n,r){try{return{data:await this.pb.collection(e).update(n,r),error:null}}catch(s){return{data:null,error:this.handleConnectionError(s)}}}async delete(e,n){try{return await this.pb.collection(e).delete(n),{data:{success:!0},error:null}}catch(r){return{data:null,error:this.handleConnectionError(r)}}}subscribe(e,n){return this.pb.collection(e).subscribe("*",n)}subscribeToRecord(e,n,r){return this.pb.collection(e).subscribe(n,r)}async uploadFile(e){try{const n=new FormData;return n.append("file",e),{data:await this.pb.collection("files").create(n),error:null}}catch(n){return{data:null,error:n.message}}}getFileUrl(e,n,r){return this.pb.files.getUrl(e,n,r)}isAuthenticated(){return this.authStore.isValid}getToken(){return this.authStore.token}setToken(e){this.authStore.save(e,this.authStore.model)}handleConnectionError(e){var n,r;return(n=e.message)!=null&&n.includes("fetch")||(r=e.message)!=null&&r.includes("Failed to fetch")?"Unable to connect to server. Please check your connection and try again.":e.status===404?"Collection not found. This feature may not be configured yet.":e.status===401?"Authentication required. Please log in again.":e.status===403?"Access denied. You do not have permission for this action.":e.message||"An unexpected error occurred."}}const os=new cu;class uu{constructor(){this.memoryCache=new Map,this.ttl=new Map,this.maxSize=1e3,this.defaultTTL=5*60*1e3,this.hitCount=0,this.missCount=0,setInterval(()=>this.cleanup(),60*1e3)}set(e,n,r=this.defaultTTL){this.memoryCache.size>=this.maxSize&&this.evictOldest(),this.memoryCache.set(e,n),this.ttl.set(e,Date.now()+r)}get(e){const n=this.ttl.get(e);return!n||Date.now()>n?(this.delete(e),this.missCount++,null):(this.hitCount++,this.memoryCache.get(e))}delete(e){this.memoryCache.delete(e),this.ttl.delete(e)}clear(){this.memoryCache.clear(),this.ttl.clear(),this.hitCount=0,this.missCount=0}has(e){return this.get(e)!==null}size(){return this.memoryCache.size}getStats(){return{size:this.memoryCache.size,maxSize:this.maxSize,hitRate:this.calculateHitRate(),hits:this.hitCount,misses:this.missCount}}evictOldest(){const e=Array.from(this.ttl.entries());e.sort((r,s)=>r[1]-s[1]);const n=Math.ceil(this.maxSize*.2);e.slice(0,n).forEach(([r])=>{this.delete(r)})}cleanup(){const e=Date.now();for(const[n,r]of this.ttl.entries())e>r&&this.delete(n)}calculateHitRate(){const e=this.hitCount+this.missCount;return e>0?this.hitCount/e*100:0}async cache(e,n,r=this.defaultTTL){const s=this.get(e);if(s)return s;const i=await n();return this.set(e,i,r),i}invalidatePattern(e){const n=new RegExp(e);for(const r of this.memoryCache.keys())n.test(r)&&this.delete(r)}invalidate(e){this.delete(e)}}const N=new uu;class lu{constructor(){this.pocketbase=null,this.config=null}_getPocketbase(){return this.pocketbase||(this.pocketbase=os),this.pocketbase}_getConfig(){return this.config||(this.config={pocketbaseUrl:"http://127.0.0.1:8090",apiTimeout:3e4,cacheTTL:5*60*1e3,maxRetries:3}),this.config}async register(e){const n=`auth:register:${e.email}`,r=N.get(n);if(r)return r;try{const s=await this._getPocketbase().signUp(e);return N.set(n,s,5*60*1e3),s}catch(s){throw new Error(`Registration failed: ${s.message}`)}}async login(e){try{console.log("AuthService: Attempting login for:",e.email),N.invalidatePattern("auth:");const n=await this._getPocketbase().signIn(e.email,e.password);console.log("AuthService: Login successful for:",e.email);const r=`auth:login:${e.email}`;return N.set(r,n,2*60*1e3),n}catch(n){throw console.error("AuthService: Login failed:",n.message),new Error(`Failed to authenticate: ${n.message}`)}}async logout(){try{await this._getPocketbase().signOut(),N.invalidatePattern("auth:")}catch(e){console.error("Logout error:",e)}}async getCurrentUser(){const e="auth:currentUser",n=N.get(e);if(n)return n;try{const r=await this._getPocketbase().getCurrentUser();return r&&N.set(e,r,2*60*1e3),r}catch(r){return console.error("Get current user error:",r),null}}async updateProfile(e){try{const n=await this._getPocketbase().updateProfile(e);return N.invalidatePattern("auth:currentUser"),n}catch(n){throw new Error(`Profile update failed: ${n.message}`)}}async changePassword(e){try{return await this._getPocketbase().updateProfile({password:e.newPassword,passwordConfirm:e.newPassword})}catch(n){throw new Error(`Password change failed: ${n.message}`)}}async forgotPassword(e){try{return await this._getPocketbase().pb.collection("users").requestPasswordReset(e),{success:!0}}catch(n){throw new Error(`Password reset request failed: ${n.message}`)}}async resetPassword(e){try{return await this._getPocketbase().pb.collection("users").confirmPasswordReset(e.token,e.newPassword,e.newPassword),{success:!0}}catch(n){throw new Error(`Password reset failed: ${n.message}`)}}async verifyEmail(e){try{return await this._getPocketbase().pb.collection("users").confirmVerification(e),{success:!0}}catch(n){throw new Error(`Email verification failed: ${n.message}`)}}isAuthenticated(){return this._getPocketbase().isAuthenticated()}getToken(){return this._getPocketbase().getToken()}setToken(e){this._getPocketbase().setToken(e)}async refreshToken(){try{const e=await this._getPocketbase().pb.collection("users").authRefresh();return{user:e.record,token:e.token}}catch(e){throw new Error(`Token refresh failed: ${e.message}`)}}}const Ft=new lu,lt={LOGIN_START:"LOGIN_START",LOGIN_SUCCESS:"LOGIN_SUCCESS",LOGIN_FAILURE:"LOGIN_FAILURE",REGISTER_START:"REGISTER_START",REGISTER_SUCCESS:"REGISTER_SUCCESS",REGISTER_FAILURE:"REGISTER_FAILURE",LOGOUT:"LOGOUT",CHECK_AUTH_START:"CHECK_AUTH_START",CHECK_AUTH_SUCCESS:"CHECK_AUTH_SUCCESS",CHECK_AUTH_FAILURE:"CHECK_AUTH_FAILURE",UPDATE_PROFILE_START:"UPDATE_PROFILE_START",UPDATE_PROFILE_SUCCESS:"UPDATE_PROFILE_SUCCESS",UPDATE_PROFILE_FAILURE:"UPDATE_PROFILE_FAILURE"},du={user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null},pu=(t,e)=>{switch(e.type){case lt.LOGIN_SUCCESS:case lt.REGISTER_SUCCESS:return{...t,user:e.payload.user,token:e.payload.token,isAuthenticated:!0,isLoading:!1,error:null};case lt.LOGOUT:return{...t,user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null};case lt.CHECK_AUTH_SUCCESS:return{...t,user:e.payload.user,isAuthenticated:!0,isLoading:!1,error:null};case lt.UPDATE_PROFILE_SUCCESS:return{...t,user:e.payload.user,isLoading:!1,error:null};default:return t}},vo=k.createContext(),fu=({children:t})=>{const[e,,n]=qc(du,lt,pu);k.useEffect(()=>{(async()=>{try{n.checkAuthStart();const l=await Ft.getCurrentUser();l?n.checkAuthSuccess({user:l}):n.checkAuthFailure("No authenticated user found")}catch(l){n.checkAuthFailure(l.message)}})()},[]);const r=fe.useCallback(async u=>{var l;try{console.log("AuthContext: Starting login process"),n.loginStart();const d=await Ft.login(u);return console.log("AuthContext: Login service returned result, calling loginSuccess"),n.loginSuccess(d),console.log("AuthContext: LoginSuccess called, new auth state should be:",{isAuthenticated:!0,user:(l=d.user)==null?void 0:l.email}),d}catch(d){throw console.error("AuthContext: Login failed:",d.message),n.loginFailure(d.message),d}},[n]),s=fe.useCallback(async u=>{try{n.registerStart();const l=await Ft.register(u);return n.registerSuccess(l),l}catch(l){throw n.registerFailure(l.message),l}},[n]),i=fe.useCallback(async()=>{try{await Ft.logout(),n.logout()}catch(u){console.error("Logout error:",u),n.logout()}},[]),o=fe.useCallback(async u=>{try{n.updateProfileStart();const l=await Ft.updateProfile(u);return n.updateProfileSuccess(l),l}catch(l){throw n.updateProfileFailure(l.message),l}},[]),a=fe.useCallback(()=>{n.clearError()},[]),c=fe.useMemo(()=>{var u;return console.log("AuthContext: Current state update:",{isAuthenticated:e.isAuthenticated,isLoading:e.isLoading,hasUser:!!e.user,userEmail:(u=e.user)==null?void 0:u.email,error:e.error}),{...e,login:r,register:s,logout:i,updateProfile:o,clearError:a}},[e,r,s,i,o,a]);return _.jsx(vo.Provider,{value:c,children:t})},Wn=()=>{const t=k.useContext(vo);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},hu=t=>{const e=new Date;switch(t){case"1d":return new Date(e.getTime()-24*60*60*1e3);case"7d":return new Date(e.getTime()-7*24*60*60*1e3);case"30d":return new Date(e.getTime()-30*24*60*60*1e3);case"90d":return new Date(e.getTime()-90*24*60*60*1e3);case"all":return null;default:return new Date(e.getTime()-7*24*60*60*1e3)}},gu=t=>{if(!t||t.length===0)return 0;const e=t.map(s=>new Date(s.session_date)).sort((s,i)=>i-s);let n=0,r=new Date;r.setHours(0,0,0,0);for(let s=0;s<e.length;s++){const i=new Date(e[s]);i.setHours(0,0,0,0);const o=r-i;if(Math.ceil(o/(1e3*60*60*24))<=1)n++,r=i;else break}return n},Xs=t=>{if(!t||t<1)return"0m";const e=Math.floor(t/60),n=t%60;return e===0?`${n}m`:n===0?`${e}h`:`${e}h ${n}m`};class mu{constructor(){this.pocketbase=null,this.config=null}_getPocketbase(){return this.pocketbase||(this.pocketbase=os),this.pocketbase}_getConfig(){return this.config||(this.config={pocketbaseUrl:"http://127.0.0.1:8090",apiTimeout:3e4,cacheTTL:5*60*1e3,maxRetries:3}),this.config}async getSessions(e={}){return this.getTrainingSessions(e)}async getStats(e="7d"){return this.getTrainingStats(e)}async getGoals(e={}){return this.getTrainingGoals(e)}async getTrainingSessions(e={}){const n=`training:sessions:${JSON.stringify(e)}`,r=N.get(n);if(r)return r;try{const s=this._getPocketbase();if(!s.isAuthenticated())return console.log("User not authenticated, returning empty training sessions"),[];const i={page:e.page||1,perPage:e.perPage||50,sort:e.sort||"-created",filter:this.buildFilterString(e)},o=await s.getList("training_sessions",i);if(o.error)throw console.error("PocketBase error fetching training sessions:",o.error),new Error(`Failed to fetch training sessions: ${o.error}`);return N.set(n,o.data,2*60*1e3),o.data}catch(s){if(console.error("Training sessions service error:",s.message),s.message.includes("User not authenticated")||s.message.includes("401"))return[];throw s}}async createTrainingSession(e){var n;try{const r=this._getPocketbase(),s=await r.create("training_sessions",{...e,user_id:(n=r.authStore.model)==null?void 0:n.id,created:new Date().toISOString()});if(s.error)throw new Error(s.error);return N.invalidatePattern("training:sessions"),N.invalidatePattern("training:stats"),s.data}catch(r){throw console.error("Failed to create training session:",r),r}}async updateTrainingSession(e,n){try{const r=await this._getPocketbase().update("training_sessions",e,{...n,updated:new Date().toISOString()});if(r.error)throw new Error(r.error);return N.invalidatePattern("training:sessions"),N.invalidatePattern("training:stats"),r.data}catch(r){throw console.error("Failed to update training session:",r),r}}async deleteTrainingSession(e){try{const n=await this._getPocketbase().delete("training_sessions",e);if(n.error)throw new Error(n.error);return N.invalidatePattern("training:sessions"),N.invalidatePattern("training:stats"),n.data}catch(n){throw console.error("Failed to delete training session:",n),n}}async getTrainingStats(e="7d"){const n=`training:stats:${e}`,r=N.get(n);if(r)return r;try{if(!this._getPocketbase().isAuthenticated())return console.log("User not authenticated, returning empty training stats"),{totalSessions:0,totalDuration:0,averageDuration:0,streakDays:0,formattedTotalDuration:"0m",formattedAverageDuration:"0m"};const i=hu(e),o=i?`created >= "${i.toISOString()}"`:"",a=await this.getTrainingSessions({filter:o}),c={totalSessions:a.length,totalDuration:a.reduce((u,l)=>u+(l.duration||0),0),averageDuration:a.length>0?Math.round(a.reduce((u,l)=>u+(l.duration||0),0)/a.length):0,streakDays:gu(a),formattedTotalDuration:Xs(a.reduce((u,l)=>u+(l.duration||0),0)),formattedAverageDuration:Xs(a.length>0?Math.round(a.reduce((u,l)=>u+(l.duration||0),0)/a.length):0)};return N.set(n,c,5*60*1e3),c}catch(s){if(console.error("Training stats service error:",s.message),s.message.includes("User not authenticated")||s.message.includes("401"))return{totalSessions:0,totalDuration:0,averageDuration:0,streakDays:0,formattedTotalDuration:"0m",formattedAverageDuration:"0m"};throw s}}async getTrainingGoals(e={}){const n=`training:goals:${JSON.stringify(e)}`,r=N.get(n);if(r)return r;try{const s=this._getPocketbase();if(!s.isAuthenticated())return console.log("User not authenticated, returning empty training goals"),[];const i={page:e.page||1,perPage:e.perPage||50,sort:e.sort||"-created",filter:this.buildFilterString(e)},o=await s.getList("training_goals",i);if(o.error)throw console.error("PocketBase error fetching training goals:",o.error),new Error(`Failed to fetch training goals: ${o.error}`);return N.set(n,o.data,5*60*1e3),o.data}catch(s){if(console.error("Training goals service error:",s.message),s.message.includes("User not authenticated")||s.message.includes("401"))return[];throw s}}async createTrainingGoal(e){var n;try{const r=this._getPocketbase(),s=await r.create("training_goals",{...e,user_id:(n=r.authStore.model)==null?void 0:n.id,created:new Date().toISOString()});if(s.error)throw new Error(s.error);return N.invalidatePattern("training:goals"),s.data}catch(r){throw console.error("Failed to create training goal:",r),r}}async updateTrainingGoal(e,n){try{const r=await this._getPocketbase().update("training_goals",e,{...n,updated:new Date().toISOString()});if(r.error)throw new Error(r.error);return N.invalidatePattern("training:goals"),r.data}catch(r){throw console.error("Failed to update training goal:",r),r}}async deleteTrainingGoal(e){try{const n=await this._getPocketbase().delete("training_goals",e);if(n.error)throw new Error(n.error);return N.invalidatePattern("training:goals"),n.data}catch(n){throw console.error("Failed to delete training goal:",n),n}}buildFilterString(e){var i;const n=[],r=this._getPocketbase(),s=e.userId||((i=r.authStore.model)==null?void 0:i.id);return s&&n.push(`user_id = "${s}"`),e.dateFrom&&n.push(`created >= "${e.dateFrom}"`),e.dateTo&&n.push(`created <= "${e.dateTo}"`),e.type&&n.push(`type = "${e.type}"`),e.status&&n.push(`status = "${e.status}"`),e.filter&&n.push(e.filter),n.join(" && ")}subscribeToTrainingSessions(e){return this._getPocketbase().subscribe("training_sessions",e)}subscribeToTrainingGoals(e){return this._getPocketbase().subscribe("training_goals",e)}getMockTrainingSessions(){return[{id:"mock-1",session_type:"Agility Training",duration:45,exercises:[{name:"Cone Drills",sets:3,reps:10},{name:"Sprint Intervals",sets:4,reps:5}],notes:"Focus on quick direction changes",created:new Date(Date.now()-24*60*60*1e3).toISOString(),user_id:"mock-user"},{id:"mock-2",session_type:"Strength Training",duration:60,exercises:[{name:"Squats",sets:3,reps:12},{name:"Push-ups",sets:3,reps:15}],notes:"Great progress on form",created:new Date(Date.now()-2*24*60*60*1e3).toISOString(),user_id:"mock-user"}]}getMockTrainingGoals(){return[{id:"goal-1",title:"Improve Sprint Speed",description:"Reduce 40-yard dash time by 0.5 seconds",target_date:new Date(Date.now()+30*24*60*60*1e3).toISOString(),completed:!1,progress:25,created:new Date(Date.now()-7*24*60*60*1e3).toISOString(),user_id:"mock-user"},{id:"goal-2",title:"Increase Endurance",description:"Run 2 miles without stopping",target_date:new Date(Date.now()+45*24*60*60*1e3).toISOString(),completed:!1,progress:60,created:new Date(Date.now()-14*24*60*60*1e3).toISOString(),user_id:"mock-user"}]}getMockTrainingStats(){return{totalSessions:5,totalDuration:270,averageDuration:54,streakDays:3,formattedTotalDuration:"4h 30m",formattedAverageDuration:"54m"}}}const re=new mu,_u={sessions:[],currentSession:null,isLoading:!1,error:null,stats:{totalSessions:0,totalDuration:0,averageScore:0,streakDays:0},goals:[],progress:{}},b={FETCH_SESSIONS_START:"FETCH_SESSIONS_START",FETCH_SESSIONS_SUCCESS:"FETCH_SESSIONS_SUCCESS",FETCH_SESSIONS_FAILURE:"FETCH_SESSIONS_FAILURE",CREATE_SESSION_START:"CREATE_SESSION_START",CREATE_SESSION_SUCCESS:"CREATE_SESSION_SUCCESS",CREATE_SESSION_FAILURE:"CREATE_SESSION_FAILURE",UPDATE_SESSION_START:"UPDATE_SESSION_START",UPDATE_SESSION_SUCCESS:"UPDATE_SESSION_SUCCESS",UPDATE_SESSION_FAILURE:"UPDATE_SESSION_FAILURE",DELETE_SESSION_START:"DELETE_SESSION_START",DELETE_SESSION_SUCCESS:"DELETE_SESSION_SUCCESS",DELETE_SESSION_FAILURE:"DELETE_SESSION_FAILURE",SET_CURRENT_SESSION:"SET_CURRENT_SESSION",CLEAR_CURRENT_SESSION:"CLEAR_CURRENT_SESSION",FETCH_STATS_START:"FETCH_STATS_START",FETCH_STATS_SUCCESS:"FETCH_STATS_SUCCESS",FETCH_STATS_FAILURE:"FETCH_STATS_FAILURE",FETCH_GOALS_START:"FETCH_GOALS_START",FETCH_GOALS_SUCCESS:"FETCH_GOALS_SUCCESS",FETCH_GOALS_FAILURE:"FETCH_GOALS_FAILURE",UPDATE_GOAL_START:"UPDATE_GOAL_START",UPDATE_GOAL_SUCCESS:"UPDATE_GOAL_SUCCESS",UPDATE_GOAL_FAILURE:"UPDATE_GOAL_FAILURE",CLEAR_ERROR:"CLEAR_ERROR"},Su=(t,e)=>{var n,r;switch(e.type){case b.FETCH_SESSIONS_START:case b.CREATE_SESSION_START:case b.UPDATE_SESSION_START:case b.DELETE_SESSION_START:case b.FETCH_STATS_START:case b.FETCH_GOALS_START:case b.UPDATE_GOAL_START:return{...t,isLoading:!0,error:null};case b.FETCH_SESSIONS_SUCCESS:return{...t,sessions:e.payload,isLoading:!1,error:null};case b.CREATE_SESSION_SUCCESS:return{...t,sessions:[e.payload,...t.sessions],isLoading:!1,error:null};case b.UPDATE_SESSION_SUCCESS:return{...t,sessions:t.sessions.map(s=>s.id===e.payload.id?e.payload:s),currentSession:((n=t.currentSession)==null?void 0:n.id)===e.payload.id?e.payload:t.currentSession,isLoading:!1,error:null};case b.DELETE_SESSION_SUCCESS:return{...t,sessions:t.sessions.filter(s=>s.id!==e.payload),currentSession:((r=t.currentSession)==null?void 0:r.id)===e.payload?null:t.currentSession,isLoading:!1,error:null};case b.SET_CURRENT_SESSION:return{...t,currentSession:e.payload};case b.CLEAR_CURRENT_SESSION:return{...t,currentSession:null};case b.FETCH_STATS_SUCCESS:return{...t,stats:e.payload,isLoading:!1,error:null};case b.FETCH_GOALS_SUCCESS:return{...t,goals:e.payload,isLoading:!1,error:null};case b.UPDATE_GOAL_SUCCESS:return{...t,goals:t.goals.map(s=>s.id===e.payload.id?e.payload:s),isLoading:!1,error:null};case b.FETCH_SESSIONS_FAILURE:case b.CREATE_SESSION_FAILURE:case b.UPDATE_SESSION_FAILURE:case b.DELETE_SESSION_FAILURE:case b.FETCH_STATS_FAILURE:case b.FETCH_GOALS_FAILURE:case b.UPDATE_GOAL_FAILURE:return{...t,isLoading:!1,error:e.payload};case b.CLEAR_ERROR:return{...t,error:null};default:return t}},Ro=k.createContext(),Eu=({children:t})=>{const[e,n]=k.useReducer(Su,_u),r=k.useCallback(async(S={})=>{try{n({type:b.FETCH_SESSIONS_START});const g=await re.getSessions(S);return n({type:b.FETCH_SESSIONS_SUCCESS,payload:g}),g}catch(g){return n({type:b.FETCH_SESSIONS_FAILURE,payload:g.message}),console.error("Failed to fetch sessions:",g),[]}},[]),s=k.useCallback(async(S="all")=>{try{n({type:b.FETCH_STATS_START});const g=await re.getStats(S);return n({type:b.FETCH_STATS_SUCCESS,payload:g}),g}catch(g){return n({type:b.FETCH_STATS_FAILURE,payload:g.message}),console.error("Failed to fetch stats:",g),{totalSessions:0,totalDuration:0,averageScore:0,streakDays:0}}},[]),i=k.useCallback(async()=>{try{n({type:b.FETCH_GOALS_START});const S=await re.getGoals();return n({type:b.FETCH_GOALS_SUCCESS,payload:S}),S}catch(S){return n({type:b.FETCH_GOALS_FAILURE,payload:S.message}),console.error("Failed to fetch goals:",S),[]}},[]),{isAuthenticated:o,isLoading:a}=Wn();k.useEffect(()=>{!a&&o?(console.log("Initializing training data for authenticated user..."),(async()=>{try{await Promise.all([r(),s(),i()]),console.log("Training data initialization completed")}catch(g){console.error("Failed to initialize training data:",g)}})()):console.log("Skipping training data initialization - auth not ready:",{authLoading:a,isAuthenticated:o})},[o,a]);const C={...e,fetchSessions:r,createSession:async S=>{n({type:b.CREATE_SESSION_START});const g=await re.createSession(S);return n({type:b.CREATE_SESSION_SUCCESS,payload:g}),g},updateSession:async(S,g)=>{n({type:b.UPDATE_SESSION_START});const w=await re.updateSession(S,g);return n({type:b.UPDATE_SESSION_SUCCESS,payload:w}),w},deleteSession:async S=>{n({type:b.DELETE_SESSION_START}),await re.deleteSession(S),n({type:b.DELETE_SESSION_SUCCESS,payload:S})},setCurrentSession:S=>{n({type:b.SET_CURRENT_SESSION,payload:S})},clearCurrentSession:()=>{n({type:b.CLEAR_CURRENT_SESSION})},fetchStats:s,fetchGoals:i,updateGoal:async(S,g)=>{n({type:b.UPDATE_GOAL_START});const w=await re.updateGoal(S,g);return n({type:b.UPDATE_GOAL_SUCCESS,payload:w}),w},createGoal:async S=>{n({type:b.UPDATE_GOAL_START});const g=await re.createGoal(S);return n({type:b.UPDATE_GOAL_SUCCESS,payload:g}),g},deleteGoal:async S=>{n({type:b.UPDATE_GOAL_START}),await re.deleteGoal(S),await i()},getSessionById:async S=>await re.getSessionById(S),getRecommendedDrills:async(S={})=>await re.getRecommendedDrills(S),clearError:()=>{n({type:b.CLEAR_ERROR})}};return _.jsx(Ro.Provider,{value:C,children:t})},z_=()=>{const t=k.useContext(Ro);if(!t)throw new Error("useTraining must be used within a TrainingProvider");return t};class yu{constructor(){this.pocketbase=null,this.config=null}_getPocketbase(){return this.pocketbase||(this.pocketbase=os),this.pocketbase}_getConfig(){return this.config||(this.config={pocketbaseUrl:"http://127.0.0.1:8090",apiTimeout:3e4,cacheTTL:5*60*1e3,maxRetries:3}),this.config}async trackEvent(e){var n;try{const r=await this._getPocketbase().create("analytics_events",{event_type:e.type,event_data:e,user_id:(n=this._getPocketbase().authStore.model)==null?void 0:n.id,session_id:e.sessionId,timestamp:e.timestamp||new Date().toISOString(),page_url:e.pageUrl,user_agent:e.userAgent});if(r.error)throw new Error(r.error);return r.data}catch(r){throw new Error(`Failed to track event: ${r.message}`)}}async getEvents(e={}){const n=`analytics:events:${JSON.stringify(e)}`,r=N.get(n);if(r)return r;try{const s=this._getPocketbase();if(!s.isAuthenticated())return console.log("User not authenticated, returning empty analytics events"),[];const i={page:e.page||1,perPage:e.perPage||50,sort:e.sort||"-timestamp",filter:this.buildEventFilterString(e)},o=await s.getList("analytics_events",i);if(o.error)throw console.error("PocketBase error fetching analytics events:",o.error),new Error(`Failed to fetch analytics events: ${o.error}`);return N.set(n,o.data,2*60*1e3),o.data}catch(s){if(console.error("Analytics events service error:",s.message),s.message.includes("User not authenticated")||s.message.includes("401"))return[];throw s}}async getMetrics(e="7d"){const n=`analytics:metrics:${e}`,r=N.get(n);if(r)return r;try{const s=this.getStartDateForTimeframe(e),i=s?`timestamp >= "${s.toISOString()}"`:"",o=await this.getEvents({filter:i}),a={pageViews:o.filter(c=>c.event_type==="page_view").length,uniqueUsers:new Set(o.map(c=>c.user_id).filter(Boolean)).size,sessionDuration:this.calculateAverageSessionDuration(o),conversionRate:this.calculateConversionRate(o)};return N.set(n,a,5*60*1e3),a}catch(s){throw new Error(`Failed to fetch metrics: ${s.message}`)}}calculateAverageSessionDuration(e){const n={};e.forEach(s=>{n[s.session_id]||(n[s.session_id]={start:null,end:null});const i=new Date(s.timestamp);(!n[s.session_id].start||i<n[s.session_id].start)&&(n[s.session_id].start=i),(!n[s.session_id].end||i>n[s.session_id].end)&&(n[s.session_id].end=i)});const r=Object.values(n).filter(s=>s.start&&s.end).map(s=>s.end-s.start);return r.length>0?r.reduce((s,i)=>s+i,0)/r.length:0}calculateConversionRate(e){const n=new Set(e.map(s=>s.user_id).filter(Boolean)).size,r=new Set(e.filter(s=>s.event_type==="conversion").map(s=>s.user_id).filter(Boolean)).size;return n>0?r/n*100:0}async getUserBehavior(e={}){const n=`analytics:behavior:${JSON.stringify(e)}`,r=N.get(n);if(r)return r;try{const s=await this.getEvents({...e,eventType:"page_view"}),i={mostVisitedPages:this.getMostVisitedPages(s),userJourney:this.getUserJourney(s),dropoffPoints:this.getDropoffPoints(s)};return N.set(n,i,10*60*1e3),i}catch(s){throw new Error(`Failed to fetch user behavior: ${s.message}`)}}getMostVisitedPages(e){const n={};return e.forEach(r=>{var i;const s=((i=r.event_data)==null?void 0:i.pageUrl)||"unknown";n[s]=(n[s]||0)+1}),Object.entries(n).map(([r,s])=>({page:r,count:s})).sort((r,s)=>s.count-r.count).slice(0,10)}getUserJourney(e){const n={};return e.forEach(r=>{var i;const s=r.user_id;n[s]||(n[s]=[]),n[s].push({page:((i=r.event_data)==null?void 0:i.pageUrl)||"unknown",timestamp:r.timestamp})}),Object.values(n).filter(r=>r.length>1).slice(0,50)}getDropoffPoints(e){const n={},r={},s={};return e.forEach(i=>{var u;const o=i.session_id,a=i.user_id,c=((u=i.event_data)==null?void 0:u.pageUrl)||"unknown";s[o]||(s[o]=[]),s[o].push({page:c,timestamp:i.timestamp,userId:a}),r[c]=(r[c]||0)+1}),Object.values(s).forEach(i=>{var o;i.sort((a,c)=>new Date(a.timestamp)-new Date(c.timestamp));for(let a=0;a<i.length;a++){const c=i[a].page;((o=i[a+1])==null?void 0:o.page)||(n[c]=(n[c]||0)+1)}}),Object.entries(r).map(([i,o])=>{const a=n[i]||0,c=o>0?a/o*100:0;return{page:i,entrances:o,exits:a,dropoffRate:Math.round(c*100)/100}}).sort((i,o)=>o.dropoffRate-i.dropoffRate).slice(0,10)}async getPerformance(e="7d"){const n=`analytics:performance:${e}`,r=N.get(n);if(r)return r;try{const s=await this.getEvents({eventType:"performance",timeframe:e}),i={loadTimes:s.map(o=>{var a;return((a=o.event_data)==null?void 0:a.loadTime)||0}),errorRates:this.calculateErrorRates(s),apiResponseTimes:s.map(o=>{var a;return((a=o.event_data)==null?void 0:a.apiResponseTime)||0})};return N.set(n,i,5*60*1e3),i}catch(s){throw new Error(`Failed to fetch performance: ${s.message}`)}}calculateErrorRates(e){const n=e.length,r=e.filter(s=>{var i;return(i=s.event_data)==null?void 0:i.hasError}).length;return n>0?r/n*100:0}async getConversionFunnel(e){const n=`analytics:funnel:${e}`,r=N.get(n);if(r)return r;try{const s=await this._getPocketbase().getOne("conversion_funnels",e);if(s.error)throw new Error(s.error);return N.set(n,s.data,15*60*1e3),s.data}catch(s){throw new Error(`Failed to fetch conversion funnel: ${s.message}`)}}async getABTestResults(e){const n=`analytics:ab_test:${e}`,r=N.get(n);if(r)return r;try{const s=await this._getPocketbase().getList("ab_test_results",{filter:`test_id = "${e}"`});if(s.error)throw new Error(s.error);return N.set(n,s.data,10*60*1e3),s.data}catch(s){throw new Error(`Failed to fetch A/B test results: ${s.message}`)}}async exportData(e="csv",n={}){try{const r=await this.getEvents(n);return e==="csv"?[["timestamp","event_type","user_id","page_url","event_data"].join(","),...r.map(o=>[o.timestamp,o.event_type,o.user_id,o.page_url,JSON.stringify(o.event_data)].join(","))].join(`
`):r}catch(r){throw new Error(`Failed to export data: ${r.message}`)}}buildEventFilterString(e){var i;const n=[],r=this._getPocketbase(),s=e.userId||((i=r.authStore.model)==null?void 0:i.id);return s&&n.push(`user_id = "${s}"`),e.eventType&&e.eventType!=="all"&&n.push(`event_type = "${e.eventType}"`),e.dateFrom&&n.push(`timestamp >= "${e.dateFrom}"`),e.dateTo&&n.push(`timestamp <= "${e.dateTo}"`),e.filter&&n.push(e.filter),n.join(" && ")}getStartDateForTimeframe(e){const n=new Date;switch(e){case"1d":return new Date(n.getTime()-24*60*60*1e3);case"7d":return new Date(n.getTime()-7*24*60*60*1e3);case"30d":return new Date(n.getTime()-30*24*60*60*1e3);case"90d":return new Date(n.getTime()-90*24*60*60*1e3);case"all":return null;default:return new Date(n.getTime()-7*24*60*60*1e3)}}getMockAnalyticsEvents(){return[{id:"event-1",event_type:"performance",event_data:{metric:"sprint_time",value:4.2,unit:"seconds"},timestamp:new Date(Date.now()-2*60*60*1e3).toISOString(),user_id:"mock-user"},{id:"event-2",event_type:"training_session",event_data:{session_type:"agility",duration:45,exercises_completed:8},timestamp:new Date(Date.now()-24*60*60*1e3).toISOString(),user_id:"mock-user"}]}}const we=new yu,Tu={events:[],metrics:{pageViews:0,uniqueUsers:0,sessionDuration:0,conversionRate:0},userBehavior:{mostVisitedPages:[],userJourney:[],dropoffPoints:[]},performance:{loadTimes:[],errorRates:[],apiResponseTimes:[]},isLoading:!1,error:null,filters:{dateRange:"7d",eventType:"all",userId:null}},O={FETCH_EVENTS_START:"FETCH_EVENTS_START",FETCH_EVENTS_SUCCESS:"FETCH_EVENTS_SUCCESS",FETCH_EVENTS_FAILURE:"FETCH_EVENTS_FAILURE",TRACK_EVENT_START:"TRACK_EVENT_START",TRACK_EVENT_SUCCESS:"TRACK_EVENT_SUCCESS",TRACK_EVENT_FAILURE:"TRACK_EVENT_FAILURE",FETCH_METRICS_START:"FETCH_METRICS_START",FETCH_METRICS_SUCCESS:"FETCH_METRICS_SUCCESS",FETCH_METRICS_FAILURE:"FETCH_METRICS_FAILURE",FETCH_USER_BEHAVIOR_START:"FETCH_USER_BEHAVIOR_START",FETCH_USER_BEHAVIOR_SUCCESS:"FETCH_USER_BEHAVIOR_SUCCESS",FETCH_USER_BEHAVIOR_FAILURE:"FETCH_USER_BEHAVIOR_FAILURE",FETCH_PERFORMANCE_START:"FETCH_PERFORMANCE_START",FETCH_PERFORMANCE_SUCCESS:"FETCH_PERFORMANCE_SUCCESS",FETCH_PERFORMANCE_FAILURE:"FETCH_PERFORMANCE_FAILURE",SET_FILTERS:"SET_FILTERS",CLEAR_FILTERS:"CLEAR_FILTERS",CLEAR_ERROR:"CLEAR_ERROR"},bu=(t,e)=>{switch(e.type){case O.FETCH_EVENTS_START:case O.TRACK_EVENT_START:case O.FETCH_METRICS_START:case O.FETCH_USER_BEHAVIOR_START:case O.FETCH_PERFORMANCE_START:return{...t,isLoading:!0,error:null};case O.FETCH_EVENTS_SUCCESS:return{...t,events:e.payload,isLoading:!1,error:null};case O.TRACK_EVENT_SUCCESS:return{...t,events:[e.payload,...t.events],isLoading:!1,error:null};case O.FETCH_METRICS_SUCCESS:return{...t,metrics:e.payload,isLoading:!1,error:null};case O.FETCH_USER_BEHAVIOR_SUCCESS:return{...t,userBehavior:e.payload,isLoading:!1,error:null};case O.FETCH_PERFORMANCE_SUCCESS:return{...t,performance:e.payload,isLoading:!1,error:null};case O.SET_FILTERS:return{...t,filters:{...t.filters,...e.payload}};case O.CLEAR_FILTERS:return{...t,filters:{dateRange:"7d",eventType:"all",userId:null}};case O.FETCH_EVENTS_FAILURE:case O.TRACK_EVENT_FAILURE:case O.FETCH_METRICS_FAILURE:case O.FETCH_USER_BEHAVIOR_FAILURE:case O.FETCH_PERFORMANCE_FAILURE:return{...t,isLoading:!1,error:e.payload};case O.CLEAR_ERROR:return{...t,error:null};default:return t}},wo=k.createContext(),Iu=({children:t})=>{const[e,n]=k.useReducer(bu,Tu),{isAuthenticated:r,isLoading:s}=Wn();k.useEffect(()=>{!s&&r?(console.log("Initializing analytics data for authenticated user..."),(async()=>{try{await Promise.all([a(),c(),u()]),console.log("Analytics data initialization completed")}catch(g){console.error("Failed to initialize analytics data:",g)}})()):console.log("Skipping analytics data initialization - auth not ready:",{authLoading:s,isAuthenticated:r})},[r,s]);const i=async(S={})=>{try{n({type:O.FETCH_EVENTS_START});const g=await we.getEvents(S);return n({type:O.FETCH_EVENTS_SUCCESS,payload:g}),g}catch(g){throw n({type:O.FETCH_EVENTS_FAILURE,payload:g.message}),g}},o=async S=>{try{n({type:O.TRACK_EVENT_START});const g=await we.trackEvent(S);return n({type:O.TRACK_EVENT_SUCCESS,payload:g}),g}catch(g){throw n({type:O.TRACK_EVENT_FAILURE,payload:g.message}),g}},a=async(S="7d")=>{try{n({type:O.FETCH_METRICS_START});const g=await we.getMetrics(S);return n({type:O.FETCH_METRICS_SUCCESS,payload:g}),g}catch(g){throw n({type:O.FETCH_METRICS_FAILURE,payload:g.message}),g}},c=async(S={})=>{try{n({type:O.FETCH_USER_BEHAVIOR_START});const g=await we.getUserBehavior(S);return n({type:O.FETCH_USER_BEHAVIOR_SUCCESS,payload:g}),g}catch(g){throw n({type:O.FETCH_USER_BEHAVIOR_FAILURE,payload:g.message}),g}},u=async(S="7d")=>{try{n({type:O.FETCH_PERFORMANCE_START});const g=await we.getPerformance(S);return n({type:O.FETCH_PERFORMANCE_SUCCESS,payload:g}),g}catch(g){throw n({type:O.FETCH_PERFORMANCE_FAILURE,payload:g.message}),g}},C={...e,fetchEvents:i,trackEvent:o,fetchMetrics:a,fetchUserBehavior:c,fetchPerformance:u,setFilters:S=>{n({type:O.SET_FILTERS,payload:S})},clearFilters:()=>{n({type:O.CLEAR_FILTERS})},trackPageView:async S=>{try{const g={type:"page_view",timestamp:new Date().toISOString(),...S};await o(g)}catch(g){console.error("Failed to track page view:",g)}},trackInteraction:async S=>{try{const g={type:"user_interaction",timestamp:new Date().toISOString(),...S};await o(g)}catch(g){console.error("Failed to track interaction:",g)}},trackPerformance:async S=>{try{const g={type:"performance",timestamp:new Date().toISOString(),...S};await o(g)}catch(g){console.error("Failed to track performance:",g)}},getConversionFunnel:async S=>we.getConversionFunnel(S),getABTestResults:async S=>we.getABTestResults(S),exportData:async(S="csv",g={})=>we.exportData(S,g),clearError:()=>{n({type:O.CLEAR_ERROR})}};return _.jsx(wo.Provider,{value:C,children:t})},W_=()=>{const t=k.useContext(wo);if(!t)throw new Error("useAnalytics must be used within an AnalyticsProvider");return t};var vu=function(){return null};const Ru=new $c({defaultOptions:{queries:{staleTime:5*60*1e3,gcTime:10*60*1e3,retry:(t,e)=>(e==null?void 0:e.status)===404?!1:t<3,refetchOnWindowFocus:!1},mutations:{retry:!1}}}),wu=({children:t})=>_.jsxs(Dc,{client:Ru,children:[t,_.jsx(vu,{initialIsOpen:!1})]}),Cu=()=>{const[t,e]=k.useState(navigator.onLine),[n,r]=k.useState("unknown"),[s,i]=k.useState(null);return k.useEffect(()=>{const o=()=>{e(navigator.onLine)},a=()=>{if("connection"in navigator){const c=navigator.connection;switch(i({effectiveType:c.effectiveType,downlink:c.downlink,rtt:c.rtt,saveData:c.saveData}),c.effectiveType){case"4g":r("excellent");break;case"3g":r("good");break;case"2g":r("poor");break;case"slow-2g":r("very-poor");break;default:r("unknown")}}};return a(),window.addEventListener("online",o),window.addEventListener("offline",o),"connection"in navigator&&navigator.connection.addEventListener("change",a),()=>{window.removeEventListener("online",o),window.removeEventListener("offline",o),"connection"in navigator&&navigator.connection.removeEventListener("change",a)}},[]),{isOnline:t,networkQuality:n,connectionInfo:s}},Bt=new Map,pn=t=>{const e=Bt.get(t);return e?Object.fromEntries(Object.entries(e.stores).map(([n,r])=>[n,r.getState()])):{}},Au=(t,e,n)=>{if(t===void 0)return{type:"untracked",connection:e.connect(n)};const r=Bt.get(n.name);if(r)return{type:"tracked",store:t,...r};const s={connection:e.connect(n),stores:{}};return Bt.set(n.name,s),{type:"tracked",store:t,...s}},Ou=(t,e)=>{if(e===void 0)return;const n=Bt.get(t);n&&(delete n.stores[e],Object.keys(n.stores).length===0&&Bt.delete(t))},Nu=t=>{var e,n;if(!t)return;const r=t.split(`
`),s=r.findIndex(o=>o.includes("api.setState"));if(s<0)return;const i=((e=r[s+1])==null?void 0:e.trim())||"";return(n=/.+ (.+) .+/.exec(i))==null?void 0:n[1]},Lu=(t,e={})=>(n,r,s)=>{const{enabled:i,anonymousActionType:o,store:a,...c}=e;let u;try{u=(i??!1)&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!u)return t(n,r,s);const{connection:l,...d}=Au(a,u,c);let p=!0;s.setState=(h,T,I)=>{const R=n(h,T);if(!p)return R;const C=I===void 0?{type:o||Nu(new Error().stack)||"anonymous"}:typeof I=="string"?{type:I}:I;return a===void 0?(l==null||l.send(C,r()),R):(l==null||l.send({...C,type:`${a}/${C.type}`},{...pn(c.name),[a]:s.getState()}),R)},s.devtools={cleanup:()=>{l&&typeof l.unsubscribe=="function"&&l.unsubscribe(),Ou(c.name,a)}};const f=(...h)=>{const T=p;p=!1,n(...h),p=T},m=t(s.setState,r,s);if(d.type==="untracked"?l==null||l.init(m):(d.stores[d.store]=s,l==null||l.init(Object.fromEntries(Object.entries(d.stores).map(([h,T])=>[h,h===d.store?m:T.getState()])))),s.dispatchFromDevtools&&typeof s.dispatch=="function"){let h=!1;const T=s.dispatch;s.dispatch=(...I)=>{T(...I)}}return l.subscribe(h=>{var T;switch(h.type){case"ACTION":if(typeof h.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return ur(h.payload,I=>{if(I.type==="__setState"){if(a===void 0){f(I.state);return}Object.keys(I.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const R=I.state[a];if(R==null)return;JSON.stringify(s.getState())!==JSON.stringify(R)&&f(R);return}s.dispatchFromDevtools&&typeof s.dispatch=="function"&&s.dispatch(I)});case"DISPATCH":switch(h.payload.type){case"RESET":return f(m),a===void 0?l==null?void 0:l.init(s.getState()):l==null?void 0:l.init(pn(c.name));case"COMMIT":if(a===void 0){l==null||l.init(s.getState());return}return l==null?void 0:l.init(pn(c.name));case"ROLLBACK":return ur(h.state,I=>{if(a===void 0){f(I),l==null||l.init(s.getState());return}f(I[a]),l==null||l.init(pn(c.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return ur(h.state,I=>{if(a===void 0){f(I);return}JSON.stringify(s.getState())!==JSON.stringify(I[a])&&f(I[a])});case"IMPORT_STATE":{const{nextLiftedState:I}=h.payload,R=(T=I.computedStates.slice(-1)[0])==null?void 0:T.state;if(!R)return;f(a===void 0?R:R[a]),l==null||l.send(null,I);return}case"PAUSE_RECORDING":return p=!p}return}}),m},ku=Lu,ur=(t,e)=>{let n;try{n=JSON.parse(t)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}n!==void 0&&e(n)};function Pu(t,e){let n;try{n=t()}catch{return}return{getItem:s=>{var i;const o=c=>c===null?null:JSON.parse(c,e==null?void 0:e.reviver),a=(i=n.getItem(s))!=null?i:null;return a instanceof Promise?a.then(o):o(a)},setItem:(s,i)=>n.setItem(s,JSON.stringify(i,e==null?void 0:e.replacer)),removeItem:s=>n.removeItem(s)}}const kr=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return kr(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return kr(r)(n)}}}},$u=(t,e)=>(n,r,s)=>{let i={storage:Pu(()=>localStorage),partialize:h=>h,version:0,merge:(h,T)=>({...T,...h}),...e},o=!1;const a=new Set,c=new Set;let u=i.storage;if(!u)return t((...h)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...h)},r,s);const l=()=>{const h=i.partialize({...r()});return u.setItem(i.name,{state:h,version:i.version})},d=s.setState;s.setState=(h,T)=>{d(h,T),l()};const p=t((...h)=>{n(...h),l()},r,s);s.getInitialState=()=>p;let f;const m=()=>{var h,T;if(!u)return;o=!1,a.forEach(R=>{var C;return R((C=r())!=null?C:p)});const I=((T=i.onRehydrateStorage)==null?void 0:T.call(i,(h=r())!=null?h:p))||void 0;return kr(u.getItem.bind(u))(i.name).then(R=>{if(R)if(typeof R.version=="number"&&R.version!==i.version){if(i.migrate){const C=i.migrate(R.state,R.version);return C instanceof Promise?C.then(S=>[!0,S]):[!0,C]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,R.state];return[!1,void 0]}).then(R=>{var C;const[S,g]=R;if(f=i.merge(g,(C=r())!=null?C:p),n(f,!0),S)return l()}).then(()=>{I==null||I(f,void 0),f=r(),o=!0,c.forEach(R=>R(f))}).catch(R=>{I==null||I(void 0,R)})};return s.persist={setOptions:h=>{i={...i,...h},h.storage&&(u=h.storage)},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>m(),hasHydrated:()=>o,onHydrate:h=>(a.add(h),()=>{a.delete(h)}),onFinishHydration:h=>(c.add(h),()=>{c.delete(h)})},i.skipHydration||m(),f||p},Du=$u,xu=Mc()(ku(Du((t,e)=>({user:null,isAuthenticated:!1,theme:"light",currentProgram:null,sessions:[],loading:!1,errors:[],setUser:n=>t({user:n,isAuthenticated:!!n}),clearUser:()=>t({user:null,isAuthenticated:!1}),setTheme:n=>t({theme:n}),toggleTheme:()=>t(n=>({theme:n.theme==="light"?"dark":"light"})),setCurrentProgram:n=>t({currentProgram:n}),setSessions:n=>t({sessions:n}),addSession:n=>t(r=>({sessions:[...r.sessions,n]})),updateSession:(n,r)=>t(s=>({sessions:s.sessions.map(i=>i.id===n?{...i,...r}:i)})),removeSession:n=>t(r=>({sessions:r.sessions.filter(s=>s.id!==n)})),setLoading:n=>t({loading:n}),addError:n=>t(r=>({errors:[...r.errors,{id:Date.now(),message:n}]})),removeError:n=>t(r=>({errors:r.errors.filter(s=>s.id!==n)})),clearErrors:()=>t({errors:[]}),get isLoading(){return e().loading},get hasErrors(){return e().errors.length>0},get isDarkMode(){return e().theme==="dark"}}),{name:"flagfit-app-store",partialize:t=>({theme:t.theme,user:t.user,isAuthenticated:t.isAuthenticated,currentProgram:t.currentProgram})}),{name:"flagfit-app-store"})),Kn=fe.memo(({size:t="md",className:e=""})=>{const n={sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12",xl:"w-16 h-16"};return _.jsx("div",{className:`flex justify-center items-center ${e}`,children:_.jsx("div",{className:`${n[t]} border-4 border-gray-200 border-t-green-600 rounded-full animate-spin`,role:"status","aria-label":"Loading",children:_.jsx("span",{className:"sr-only",children:"Loading..."})})})});Kn.displayName="LoadingSpinner";const Fu=()=>_.jsx("div",{className:"bg-yellow-500 text-white px-4 py-2 text-center text-sm font-medium",children:_.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[_.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),_.jsx("span",{children:"You are currently offline. Some features may be limited."})]})});class Uu{constructor(){this.config=this.loadConfig(),this.validateConfig()}loadConfig(){return{app:{name:"FlagFit Pro",version:"1.0.0",environment:"development"},api:{pocketbaseUrl:"http://127.0.0.1:8090",timeout:parseInt("30000")||3e4,cacheTTL:parseInt("300000")||3e5,baseUrl:"http://localhost:3001",aiServiceUrl:"http://localhost:8080"},features:{analytics:!0,pushNotifications:!0,wearableSync:!1},dev:{devMode:!0,debugLogging:!1},sentry:{dsn:null,environment:{}.VITE_SENTRY_ENVIRONMENT||"development"}}}validateConfig(){const e=[];this.isValidUrl(this.config.api.pocketbaseUrl)||e.push("VITE_POCKETBASE_URL must be a valid URL"),this.config.api.timeout<1e3&&e.push("VITE_API_TIMEOUT must be at least 1000ms"),this.config.api.cacheTTL<6e4&&e.push("VITE_CACHE_TTL must be at least 60000ms (1 minute)");const n=["development","staging","production"];if(n.includes(this.config.app.environment)||e.push(`VITE_APP_ENVIRONMENT must be one of: ${n.join(", ")}`),e.length>0&&(console.error("Environment configuration errors:",e),this.config.app.environment==="production"))throw new Error(`Invalid environment configuration: ${e.join(", ")}`)}isValidUrl(e){try{return new URL(e),!0}catch{return!1}}isValidSentryDsn(e){return/^https:\/\/[a-f0-9]+@[a-z0-9.-]+\/\d+$/.test(e)}get isProduction(){return this.config.app.environment==="production"}get isDevelopment(){return this.config.app.environment==="development"}get isStaging(){return this.config.app.environment==="staging"}get debugMode(){return this.config.dev.devMode&&this.config.dev.debugLogging}getConfig(){return this.config}getSection(e){return this.config[e]}}const le=new Uu,Me={ERROR:0,WARN:1,INFO:2,DEBUG:3};class Mu{constructor(){ut(this,"consoleTransport",e=>{const{level:n,message:r,meta:s}=e,i=this.getConsoleStyle(n);console.groupCollapsed(`%c[${n}] ${r}`,i),console.log("Timestamp:",e.timestamp),console.log("Meta:",s),console.groupEnd()});ut(this,"localStorageTransport",e=>{try{const n=JSON.parse(localStorage.getItem("app_logs")||"[]");n.push(e),n.length>100&&n.splice(0,n.length-100),localStorage.setItem("app_logs",JSON.stringify(n))}catch(n){console.warn("Failed to save log to localStorage:",n)}});ut(this,"remoteTransport",async e=>{try{await fetch("/api/logs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(n){console.warn("Failed to send log to remote endpoint:",n)}});this.logLevel=le.debugMode?Me.DEBUG:Me.INFO,this.transports=new Set,this.setupDefaultTransports()}setupDefaultTransports(){(le.isDevelopment||le.debugMode)&&this.addTransport("console",this.consoleTransport),le.isProduction&&this.addTransport("remote",this.remoteTransport),this.addTransport("localStorage",this.localStorageTransport)}addTransport(e,n){this.transports.add({name:e,transport:n})}removeTransport(e){this.transports=new Set([...this.transports].filter(n=>n.name!==e))}log(e,n,r={}){if(e>this.logLevel)return;const s={timestamp:new Date().toISOString(),level:Object.keys(Me)[e],message:n,meta:{...r,userAgent:navigator.userAgent,url:window.location.href,userId:this.getCurrentUserId(),sessionId:this.getSessionId(),buildVersion:le.getConfig().app.version}};this.transports.forEach(({transport:i})=>{try{i(s)}catch(o){console.error("Logging transport failed:",o),this.consoleTransport(s)}})}error(e,n={}){this.log(Me.ERROR,e,n)}warn(e,n={}){this.log(Me.WARN,e,n)}info(e,n={}){this.log(Me.INFO,e,n)}debug(e,n={}){this.log(Me.DEBUG,e,n)}getConsoleStyle(e){const n={ERROR:"color: #ff6b6b; font-weight: bold;",WARN:"color: #feca57; font-weight: bold;",INFO:"color: #48dbfb; font-weight: bold;",DEBUG:"color: #ff9ff3; font-weight: bold;"};return n[e]||n.INFO}getCurrentUserId(){var e;try{return((e=JSON.parse(localStorage.getItem("pocketbase_auth")||"{}").model)==null?void 0:e.id)||"anonymous"}catch{return"anonymous"}}getSessionId(){return sessionStorage.getItem("session_id")||sessionStorage.setItem("session_id",this.generateSessionId()),sessionStorage.getItem("session_id")}generateSessionId(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}startTimer(e){const n=performance.now();return{end:()=>{const r=performance.now()-n;return this.debug(`Timer [${e}]`,{duration:`${r.toFixed(2)}ms`}),r}}}logRequest(e,n,r,s){const i={url:e,method:n,status:r,duration:s};r>=400?this.error(`HTTP ${r} - ${n} ${e}`,i):r>=300?this.warn(`HTTP ${r} - ${n} ${e}`,i):this.debug(`HTTP ${r} - ${n} ${e}`,i)}logUserAction(e,n,r={}){this.info(`User Action: ${e}`,{action:e,target:n,...r})}logError(e,n=""){this.error(`${n?`${n}: `:""}${e.message}`,{stack:e.stack,name:e.name,context:n})}getStoredLogs(){try{return JSON.parse(localStorage.getItem("app_logs")||"[]")}catch{return[]}}clearStoredLogs(){localStorage.removeItem("app_logs")}}const He=new Mu,y=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,L=globalThis,Be="9.38.0";function tt(){return Jn(L),L}function Jn(t){const e=t.__SENTRY__=t.__SENTRY__||{};return e.version=e.version||Be,e[Be]=e[Be]||{}}function Yn(t,e,n=L){const r=n.__SENTRY__=n.__SENTRY__||{},s=r[Be]=r[Be]||{};return s[t]||(s[t]=e())}const Hu=["debug","info","warn","error","log","assert","trace"],ju="Sentry Logger ",Ln={};function It(t){if(!("console"in L))return t();const e=L.console,n={},r=Object.keys(Ln);r.forEach(s=>{const i=Ln[s];n[s]=e[s],e[s]=i});try{return t()}finally{r.forEach(s=>{e[s]=n[s]})}}function Co(){cs().enabled=!0}function Ao(){cs().enabled=!1}function as(){return cs().enabled}function Oo(...t){nt("log",...t)}function Bu(...t){nt("info",...t)}function No(...t){nt("warn",...t)}function Lo(...t){nt("error",...t)}function qu(...t){nt("debug",...t)}function Gu(...t){nt("assert",...t)}function Vu(...t){nt("trace",...t)}function nt(t,...e){y&&as()&&It(()=>{L.console[t](`${ju}[${t}]:`,...e)})}function cs(){return y?Yn("loggerSettings",()=>({enabled:!1})):{enabled:!1}}const ee={enable:Co,disable:Ao,isEnabled:as,log:Oo,info:Bu,warn:No,error:Lo,debug:qu,assert:Gu,trace:Vu},E={enable:Co,disable:Ao,isEnabled:as,log:Oo,warn:No,error:Lo},ko=50,Ke="?",Qs=/\(error: (.*)\)/,Zs=/captureMessage|captureException/;function Po(...t){const e=t.sort((n,r)=>n[0]-r[0]).map(n=>n[1]);return(n,r=0,s=0)=>{const i=[],o=n.split(`
`);for(let a=r;a<o.length;a++){const c=o[a];if(c.length>1024)continue;const u=Qs.test(c)?c.replace(Qs,"$1"):c;if(!u.match(/\S*Error: /)){for(const l of e){const d=l(u);if(d){i.push(d);break}}if(i.length>=ko+s)break}}return Wu(i.slice(s))}}function zu(t){return Array.isArray(t)?Po(...t):t}function Wu(t){if(!t.length)return[];const e=Array.from(t);return/sentryWrapped/.test(fn(e).function||"")&&e.pop(),e.reverse(),Zs.test(fn(e).function||"")&&(e.pop(),Zs.test(fn(e).function||"")&&e.pop()),e.slice(0,ko).map(n=>({...n,filename:n.filename||fn(e).filename,function:n.function||Ke}))}function fn(t){return t[t.length-1]||{}}const lr="<anonymous>";function Oe(t){try{return!t||typeof t!="function"?lr:t.name||lr}catch{return lr}}function ei(t){const e=t.exception;if(e){const n=[];try{return e.values.forEach(r=>{r.stacktrace.frames&&n.push(...r.stacktrace.frames)}),n}catch{return}}}const In={},ti={};function Qt(t,e){In[t]=In[t]||[],In[t].push(e)}function Zt(t,e){if(!ti[t]){ti[t]=!0;try{e()}catch(n){y&&E.error(`Error while instrumenting ${t}`,n)}}}function qe(t,e){const n=t&&In[t];if(n)for(const r of n)try{r(e)}catch(s){y&&E.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${Oe(r)}
Error:`,s)}}let dr=null;function $o(t){const e="error";Qt(e,t),Zt(e,Ku)}function Ku(){dr=L.onerror,L.onerror=function(t,e,n,r,s){return qe("error",{column:r,error:s,line:n,msg:t,url:e}),dr?dr.apply(this,arguments):!1},L.onerror.__SENTRY_INSTRUMENTED__=!0}let pr=null;function Do(t){const e="unhandledrejection";Qt(e,t),Zt(e,Ju)}function Ju(){pr=L.onunhandledrejection,L.onunhandledrejection=function(t){return qe("unhandledrejection",t),pr?pr.apply(this,arguments):!0},L.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const xo=Object.prototype.toString;function us(t){switch(xo.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return me(t,Error)}}function vt(t,e){return xo.call(t)===`[object ${e}]`}function Fo(t){return vt(t,"ErrorEvent")}function ni(t){return vt(t,"DOMError")}function Yu(t){return vt(t,"DOMException")}function qt(t){return vt(t,"String")}function ls(t){return typeof t=="object"&&t!==null&&"__sentry_template_string__"in t&&"__sentry_template_values__"in t}function ds(t){return t===null||ls(t)||typeof t!="object"&&typeof t!="function"}function Gt(t){return vt(t,"Object")}function Xn(t){return typeof Event<"u"&&me(t,Event)}function Xu(t){return typeof Element<"u"&&me(t,Element)}function Qu(t){return vt(t,"RegExp")}function Qn(t){return!!(t!=null&&t.then&&typeof t.then=="function")}function Zu(t){return Gt(t)&&"nativeEvent"in t&&"preventDefault"in t&&"stopPropagation"in t}function me(t,e){try{return t instanceof e}catch{return!1}}function Uo(t){return!!(typeof t=="object"&&t!==null&&(t.__isVue||t._isVue))}function Mo(t){return typeof Request<"u"&&me(t,Request)}const ps=L,el=80;function Ho(t,e={}){if(!t)return"<unknown>";try{let n=t;const r=5,s=[];let i=0,o=0;const a=" > ",c=a.length;let u;const l=Array.isArray(e)?e:e.keyAttrs,d=!Array.isArray(e)&&e.maxStringLength||el;for(;n&&i++<r&&(u=tl(n,l),!(u==="html"||i>1&&o+s.length*c+u.length>=d));)s.push(u),o+=u.length,n=n.parentNode;return s.reverse().join(a)}catch{return"<unknown>"}}function tl(t,e){const n=t,r=[];if(!(n!=null&&n.tagName))return"";if(ps.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const s=e!=null&&e.length?e.filter(o=>n.getAttribute(o)).map(o=>[o,n.getAttribute(o)]):null;if(s!=null&&s.length)s.forEach(o=>{r.push(`[${o[0]}="${o[1]}"]`)});else{n.id&&r.push(`#${n.id}`);const o=n.className;if(o&&qt(o)){const a=o.split(/\s+/);for(const c of a)r.push(`.${c}`)}}const i=["aria-label","type","name","title","alt"];for(const o of i){const a=n.getAttribute(o);a&&r.push(`[${o}="${a}"]`)}return r.join("")}function en(){try{return ps.document.location.href}catch{return""}}function nl(t){if(!ps.HTMLElement)return null;let e=t;const n=5;for(let r=0;r<n;r++){if(!e)return null;if(e instanceof HTMLElement){if(e.dataset.sentryComponent)return e.dataset.sentryComponent;if(e.dataset.sentryElement)return e.dataset.sentryElement}e=e.parentNode}return null}function kn(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:`${t.slice(0,e)}...`}function ri(t,e){if(!Array.isArray(t))return"";const n=[];for(let r=0;r<t.length;r++){const s=t[r];try{Uo(s)?n.push("[VueViewModel]"):n.push(String(s))}catch{n.push("[value cannot be serialized]")}}return n.join(e)}function rl(t,e,n=!1){return qt(t)?Qu(e)?e.test(t):qt(e)?n?t===e:t.includes(e):!1:!1}function Ge(t,e=[],n=!1){return e.some(r=>rl(t,r,n))}function he(t,e,n){if(!(e in t))return;const r=t[e];if(typeof r!="function")return;const s=n(r);typeof s=="function"&&jo(s,r);try{t[e]=s}catch{y&&E.log(`Failed to replace method "${e}" in object`,t)}}function oe(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch{y&&E.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function jo(t,e){try{const n=e.prototype||{};t.prototype=e.prototype=n,oe(t,"__sentry_original__",e)}catch{}}function fs(t){return t.__sentry_original__}function Bo(t){if(us(t))return{message:t.message,name:t.name,stack:t.stack,...ii(t)};if(Xn(t)){const e={type:t.type,target:si(t.target),currentTarget:si(t.currentTarget),...ii(t)};return typeof CustomEvent<"u"&&me(t,CustomEvent)&&(e.detail=t.detail),e}else return t}function si(t){try{return Xu(t)?Ho(t):Object.prototype.toString.call(t)}catch{return"<unknown>"}}function ii(t){if(typeof t=="object"&&t!==null){const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}else return{}}function sl(t,e=40){const n=Object.keys(Bo(t));n.sort();const r=n[0];if(!r)return"[object has no keys]";if(r.length>=e)return kn(r,e);for(let s=n.length;s>0;s--){const i=n.slice(0,s).join(", ");if(!(i.length>e))return s===n.length?i:kn(i,e)}return""}function il(){const t=L;return t.crypto||t.msCrypto}function se(t=il()){let e=()=>Math.random()*16;try{if(t!=null&&t.randomUUID)return t.randomUUID().replace(/-/g,"");t!=null&&t.getRandomValues&&(e=()=>{const n=new Uint8Array(1);return t.getRandomValues(n),n[0]})}catch{}return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,n=>(n^(e()&15)>>n/4).toString(16))}function qo(t){var e,n;return(n=(e=t.exception)==null?void 0:e.values)==null?void 0:n[0]}function je(t){const{message:e,event_id:n}=t;if(e)return e;const r=qo(t);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function Pr(t,e,n){const r=t.exception=t.exception||{},s=r.values=r.values||[],i=s[0]=s[0]||{};i.value||(i.value=e||""),i.type||(i.type=n||"Error")}function mt(t,e){const n=qo(t);if(!n)return;const r={type:"generic",handled:!0},s=n.mechanism;if(n.mechanism={...r,...s,...e},e&&"data"in e){const i={...s==null?void 0:s.data,...e.data};n.mechanism.data=i}}function oi(t){if(ol(t))return!0;try{oe(t,"__sentry_captured__",!0)}catch{}return!1}function ol(t){try{return t.__sentry_captured__}catch{}}const Go=1e3;function rt(){return Date.now()/Go}function al(){const{performance:t}=L;if(!(t!=null&&t.now)||!t.timeOrigin)return rt;const e=t.timeOrigin;return()=>(e+t.now())/Go}let ai;function Z(){return(ai??(ai=al()))()}let fr;function cl(){var l;const{performance:t}=L;if(!(t!=null&&t.now))return[void 0,"none"];const e=3600*1e3,n=t.now(),r=Date.now(),s=t.timeOrigin?Math.abs(t.timeOrigin+n-r):e,i=s<e,o=(l=t.timing)==null?void 0:l.navigationStart,c=typeof o=="number"?Math.abs(o+n-r):e,u=c<e;return i||u?s<=c?[t.timeOrigin,"timeOrigin"]:[o,"navigationStart"]:[r,"dateNow"]}function hs(){return fr||(fr=cl()),fr[0]}function ul(t){const e=Z(),n={sid:se(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>dl(n)};return t&&_t(n,t),n}function _t(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),!t.did&&!e.did&&(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||Z(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:se()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const n=t.timestamp-t.started;t.duration=n>=0?n:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function ll(t,e){let n={};e?n={status:e}:t.status==="ok"&&(n={status:"exited"}),_t(t,n)}function dl(t){return{sid:`${t.sid}`,init:t.init,started:new Date(t.started*1e3).toISOString(),timestamp:new Date(t.timestamp*1e3).toISOString(),status:t.status,errors:t.errors,did:typeof t.did=="number"||typeof t.did=="string"?`${t.did}`:void 0,duration:t.duration,abnormal_mechanism:t.abnormal_mechanism,attrs:{release:t.release,environment:t.environment,ip_address:t.ipAddress,user_agent:t.userAgent}}}function tn(t,e,n=2){if(!e||typeof e!="object"||n<=0)return e;if(t&&Object.keys(e).length===0)return t;const r={...t};for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=tn(r[s],e[s],n-1));return r}function Ne(){return se()}function nn(){return se().substring(16)}const $r="_sentrySpan";function Vt(t,e){e?oe(t,$r,e):delete t[$r]}function Pn(t){return t[$r]}const pl=100;let Je=class Dr{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:Ne(),sampleRand:Math.random()}}clone(){const e=new Dr;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,Vt(e,Pn(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&_t(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,n){return this._tags={...this._tags,[e]:n},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,n){return this._extra={...this._extra,[e]:n},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,n){return n===null?delete this._contexts[e]:this._contexts[e]=n,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const n=typeof e=="function"?e(this):e,r=n instanceof Dr?n.getScopeData():Gt(n)?e:void 0,{tags:s,extra:i,user:o,contexts:a,level:c,fingerprint:u=[],propagationContext:l}=r||{};return this._tags={...this._tags,...s},this._extra={...this._extra,...i},this._contexts={...this._contexts,...a},o&&Object.keys(o).length&&(this._user=o),c&&(this._level=c),u.length&&(this._fingerprint=u),l&&(this._propagationContext=l),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,Vt(this,void 0),this._attachments=[],this.setPropagationContext({traceId:Ne(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(e,n){var i;const r=typeof n=="number"?n:pl;if(r<=0)return this;const s={timestamp:rt(),...e,message:e.message?kn(e.message,2048):e.message};return this._breadcrumbs.push(s),this._breadcrumbs.length>r&&(this._breadcrumbs=this._breadcrumbs.slice(-r),(i=this._client)==null||i.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:Pn(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=tn(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,n){const r=(n==null?void 0:n.event_id)||se();if(!this._client)return y&&E.warn("No client configured on scope - will not capture exception!"),r;const s=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:s,...n,event_id:r},this),r}captureMessage(e,n,r){const s=(r==null?void 0:r.event_id)||se();if(!this._client)return y&&E.warn("No client configured on scope - will not capture message!"),s;const i=new Error(e);return this._client.captureMessage(e,n,{originalException:e,syntheticException:i,...r,event_id:s},this),s}captureEvent(e,n){const r=(n==null?void 0:n.event_id)||se();return this._client?(this._client.captureEvent(e,{...n,event_id:r},this),r):(y&&E.warn("No client configured on scope - will not capture event!"),r)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}};function fl(){return Yn("defaultCurrentScope",()=>new Je)}function hl(){return Yn("defaultIsolationScope",()=>new Je)}let gl=class{constructor(e,n){let r;e?r=e:r=new Je;let s;n?s=n:s=new Je,this._stack=[{scope:r}],this._isolationScope=s}withScope(e){const n=this._pushScope();let r;try{r=e(n)}catch(s){throw this._popScope(),s}return Qn(r)?r.then(s=>(this._popScope(),s),s=>{throw this._popScope(),s}):(this._popScope(),r)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}};function St(){const t=tt(),e=Jn(t);return e.stack=e.stack||new gl(fl(),hl())}function ml(t){return St().withScope(t)}function _l(t,e){const n=St();return n.withScope(()=>(n.getStackTop().scope=t,e(t)))}function ci(t){return St().withScope(()=>t(St().getIsolationScope()))}function Sl(){return{withIsolationScope:ci,withScope:ml,withSetScope:_l,withSetIsolationScope:(t,e)=>ci(e),getCurrentScope:()=>St().getScope(),getIsolationScope:()=>St().getIsolationScope()}}function Rt(t){const e=Jn(t);return e.acs?e.acs:Sl()}function U(){const t=tt();return Rt(t).getCurrentScope()}function ae(){const t=tt();return Rt(t).getIsolationScope()}function El(){return Yn("globalScope",()=>new Je)}function zt(...t){const e=tt(),n=Rt(e);if(t.length===2){const[r,s]=t;return r?n.withSetScope(r,s):n.withScope(s)}return n.withScope(t[0])}function P(){return U().getClient()}function yl(t){const e=t.getPropagationContext(),{traceId:n,parentSpanId:r,propagationSpanId:s}=e,i={trace_id:n,span_id:s||nn()};return r&&(i.parent_span_id=r),i}const ge="sentry.source",gs="sentry.sample_rate",Vo="sentry.previous_trace_sample_rate",Wt="sentry.op",Ye="sentry.origin",$n="sentry.idle_span_finish_reason",Tl="sentry.measurement_unit",bl="sentry.measurement_value",ui="sentry.custom_span_name",ms="sentry.profile_id",_s="sentry.exclusive_time",Il="sentry.link.type",vl=0,zo=1,V=2;function Rl(t){if(t<400&&t>=100)return{code:zo};if(t>=400&&t<500)switch(t){case 401:return{code:V,message:"unauthenticated"};case 403:return{code:V,message:"permission_denied"};case 404:return{code:V,message:"not_found"};case 409:return{code:V,message:"already_exists"};case 413:return{code:V,message:"failed_precondition"};case 429:return{code:V,message:"resource_exhausted"};case 499:return{code:V,message:"cancelled"};default:return{code:V,message:"invalid_argument"}}if(t>=500&&t<600)switch(t){case 501:return{code:V,message:"unimplemented"};case 503:return{code:V,message:"unavailable"};case 504:return{code:V,message:"deadline_exceeded"};default:return{code:V,message:"internal_error"}}return{code:V,message:"unknown_error"}}function Wo(t,e){t.setAttribute("http.response.status_code",e);const n=Rl(e);n.message!=="unknown_error"&&t.setStatus(n)}const Ko="_sentryScope",Jo="_sentryIsolationScope";function wl(t,e,n){t&&(oe(t,Jo,n),oe(t,Ko,e))}function Dn(t){return{scope:t[Ko],isolationScope:t[Jo]}}const Ss="sentry-",Cl=/^sentry-/,Al=8192;function Yo(t){const e=Nl(t);if(!e)return;const n=Object.entries(e).reduce((r,[s,i])=>{if(s.match(Cl)){const o=s.slice(Ss.length);r[o]=i}return r},{});if(Object.keys(n).length>0)return n}function Ol(t){if(!t)return;const e=Object.entries(t).reduce((n,[r,s])=>(s&&(n[`${Ss}${r}`]=s),n),{});return Ll(e)}function Nl(t){if(!(!t||!qt(t)&&!Array.isArray(t)))return Array.isArray(t)?t.reduce((e,n)=>{const r=li(n);return Object.entries(r).forEach(([s,i])=>{e[s]=i}),e},{}):li(t)}function li(t){return t.split(",").map(e=>e.split("=").map(n=>{try{return decodeURIComponent(n.trim())}catch{return}})).reduce((e,[n,r])=>(n&&r&&(e[n]=r),e),{})}function Ll(t){if(Object.keys(t).length!==0)return Object.entries(t).reduce((e,[n,r],s)=>{const i=`${encodeURIComponent(n)}=${encodeURIComponent(r)}`,o=s===0?i:`${e},${i}`;return o.length>Al?(y&&E.warn(`Not adding key: ${n} with val: ${r} to baggage header due to exceeding baggage size limits.`),e):o},"")}function Kt(t){if(typeof t=="boolean")return Number(t);const e=typeof t=="string"?parseFloat(t):t;if(!(typeof e!="number"||isNaN(e)||e<0||e>1))return e}const Xo=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function kl(t){if(!t)return;const e=t.match(Xo);if(!e)return;let n;return e[3]==="1"?n=!0:e[3]==="0"&&(n=!1),{traceId:e[1],parentSampled:n,parentSpanId:e[2]}}function Pl(t,e){const n=kl(t),r=Yo(e);if(!(n!=null&&n.traceId))return{traceId:Ne(),sampleRand:Math.random()};const s=$l(n,r);r&&(r.sample_rand=s.toString());const{traceId:i,parentSpanId:o,parentSampled:a}=n;return{traceId:i,parentSpanId:o,sampled:a,dsc:r||{},sampleRand:s}}function Qo(t=Ne(),e=nn(),n){let r="";return n!==void 0&&(r=n?"-1":"-0"),`${t}-${e}${r}`}function $l(t,e){const n=Kt(e==null?void 0:e.sample_rand);if(n!==void 0)return n;const r=Kt(e==null?void 0:e.sample_rate);return r&&(t==null?void 0:t.parentSampled)!==void 0?t.parentSampled?Math.random()*r:r+Math.random()*(1-r):Math.random()}const Zo=0,Es=1;let di=!1;function Dl(t){const{spanId:e,traceId:n}=t.spanContext(),{data:r,op:s,parent_span_id:i,status:o,origin:a,links:c}=F(t);return{parent_span_id:i,span_id:e,trace_id:n,data:r,op:s,status:o,origin:a,links:c}}function xl(t){const{spanId:e,traceId:n,isRemote:r}=t.spanContext(),s=r?e:F(t).parent_span_id,i=Dn(t).scope,o=r?(i==null?void 0:i.getPropagationContext().propagationSpanId)||nn():e;return{parent_span_id:s,span_id:o,trace_id:n}}function Fl(t){const{traceId:e,spanId:n}=t.spanContext(),r=st(t);return Qo(e,n,r)}function ea(t){if(t&&t.length>0)return t.map(({context:{spanId:e,traceId:n,traceFlags:r,...s},attributes:i})=>({span_id:e,trace_id:n,sampled:r===Es,attributes:i,...s}))}function Ve(t){return typeof t=="number"?pi(t):Array.isArray(t)?t[0]+t[1]/1e9:t instanceof Date?pi(t.getTime()):Z()}function pi(t){return t>9999999999?t/1e3:t}function F(t){var r;if(Ml(t))return t.getSpanJSON();const{spanId:e,traceId:n}=t.spanContext();if(Ul(t)){const{attributes:s,startTime:i,name:o,endTime:a,status:c,links:u}=t,l="parentSpanId"in t?t.parentSpanId:"parentSpanContext"in t?(r=t.parentSpanContext)==null?void 0:r.spanId:void 0;return{span_id:e,trace_id:n,data:s,description:o,parent_span_id:l,start_timestamp:Ve(i),timestamp:Ve(a)||void 0,status:ta(c),op:s[Wt],origin:s[Ye],links:ea(u)}}return{span_id:e,trace_id:n,start_timestamp:0,data:{}}}function Ul(t){const e=t;return!!e.attributes&&!!e.startTime&&!!e.name&&!!e.endTime&&!!e.status}function Ml(t){return typeof t.getSpanJSON=="function"}function st(t){const{traceFlags:e}=t.spanContext();return e===Es}function ta(t){if(!(!t||t.code===vl))return t.code===zo?"ok":t.message||"unknown_error"}const ze="_sentryChildSpans",xr="_sentryRootSpan";function na(t,e){const n=t[xr]||t;oe(e,xr,n),t[ze]?t[ze].add(e):oe(t,ze,new Set([e]))}function Hl(t,e){t[ze]&&t[ze].delete(e)}function vn(t){const e=new Set;function n(r){if(!e.has(r)&&st(r)){e.add(r);const s=r[ze]?Array.from(r[ze]):[];for(const i of s)n(i)}}return n(t),Array.from(e)}function ie(t){return t[xr]||t}function wt(){const t=tt(),e=Rt(t);return e.getActiveSpan?e.getActiveSpan():Pn(U())}function Fr(){di||(It(()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly.")}),di=!0)}let fi=!1;function jl(){fi||(fi=!0,$o(Ur),Do(Ur))}function Ur(){const t=wt(),e=t&&ie(t);if(e){const n="internal_error";y&&E.log(`[Tracing] Root span: ${n} -> Global error occurred`),e.setStatus({code:V,message:n})}}Ur.tag="sentry_tracingErrorCallback";function Le(t){var n;if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const e=t||((n=P())==null?void 0:n.getOptions());return!!e&&(e.tracesSampleRate!=null||!!e.tracesSampler)}const ys="production",Bl=/^o(\d+)\./,ql=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function Gl(t){return t==="http"||t==="https"}function Ct(t,e=!1){const{host:n,path:r,pass:s,port:i,projectId:o,protocol:a,publicKey:c}=t;return`${a}://${c}${e&&s?`:${s}`:""}@${n}${i?`:${i}`:""}/${r&&`${r}/`}${o}`}function Vl(t){const e=ql.exec(t);if(!e){It(()=>{console.error(`Invalid Sentry Dsn: ${t}`)});return}const[n,r,s="",i="",o="",a=""]=e.slice(1);let c="",u=a;const l=u.split("/");if(l.length>1&&(c=l.slice(0,-1).join("/"),u=l.pop()),u){const d=u.match(/^\d+/);d&&(u=d[0])}return ra({host:i,pass:s,path:c,projectId:u,port:o,protocol:n,publicKey:r})}function ra(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function zl(t){if(!y)return!0;const{port:e,projectId:n,protocol:r}=t;return["protocol","publicKey","host","projectId"].find(o=>t[o]?!1:(E.error(`Invalid Sentry Dsn: ${o} missing`),!0))?!1:n.match(/^\d+$/)?Gl(r)?e&&isNaN(parseInt(e,10))?(E.error(`Invalid Sentry Dsn: Invalid port ${e}`),!1):!0:(E.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),!1):(E.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1)}function Wl(t){const e=t.match(Bl);return e==null?void 0:e[1]}function sa(t){const e=typeof t=="string"?Vl(t):ra(t);if(!(!e||!zl(e)))return e}const ia="_frozenDsc";function Rn(t,e){oe(t,ia,e)}function oa(t,e){const n=e.getOptions(),{publicKey:r,host:s}=e.getDsn()||{};let i;n.orgId?i=String(n.orgId):s&&(i=Wl(s));const o={environment:n.environment||ys,release:n.release,public_key:r,trace_id:t,org_id:i};return e.emit("createDsc",o),o}function aa(t,e){const n=e.getPropagationContext();return n.dsc||oa(n.traceId,t)}function ke(t){var m;const e=P();if(!e)return{};const n=ie(t),r=F(n),s=r.data,i=n.spanContext().traceState,o=(i==null?void 0:i.get("sentry.sample_rate"))??s[gs]??s[Vo];function a(h){return(typeof o=="number"||typeof o=="string")&&(h.sample_rate=`${o}`),h}const c=n[ia];if(c)return a(c);const u=i==null?void 0:i.get("sentry.dsc"),l=u&&Yo(u);if(l)return a(l);const d=oa(t.spanContext().traceId,e),p=s[ge],f=r.description;return p!=="url"&&f&&(d.transaction=f),Le()&&(d.sampled=String(st(n)),d.sample_rand=(i==null?void 0:i.get("sentry.sample_rand"))??((m=Dn(n).scope)==null?void 0:m.getPropagationContext().sampleRand.toString())),a(d),e.emit("createDsc",d,n),d}let Xe=class{constructor(e={}){this._traceId=e.traceId||Ne(),this._spanId=e.spanId||nn()}spanContext(){return{spanId:this._spanId,traceId:this._traceId,traceFlags:Zo}}end(e){}setAttribute(e,n){return this}setAttributes(e){return this}setStatus(e){return this}updateName(e){return this}isRecording(){return!1}addEvent(e,n,r){return this}addLink(e){return this}addLinks(e){return this}recordException(e,n){}};function Kl(t){if(!y)return;const{description:e="< unknown name >",op:n="< unknown op >",parent_span_id:r}=F(t),{spanId:s}=t.spanContext(),i=st(t),o=ie(t),a=o===t,c=`[Tracing] Starting ${i?"sampled":"unsampled"} ${a?"root ":""}span`,u=[`op: ${n}`,`name: ${e}`,`ID: ${s}`];if(r&&u.push(`parent ID: ${r}`),!a){const{op:l,description:d}=F(o);u.push(`root ID: ${o.spanContext().spanId}`),l&&u.push(`root op: ${l}`),d&&u.push(`root description: ${d}`)}E.log(`${c}
  ${u.join(`
  `)}`)}function Jl(t){if(!y)return;const{description:e="< unknown name >",op:n="< unknown op >"}=F(t),{spanId:r}=t.spanContext(),i=ie(t)===t,o=`[Tracing] Finishing "${n}" ${i?"root ":""}span "${e}" with ID ${r}`;E.log(o)}function Yl(t,e,n){if(!Le(t))return[!1];let r,s;typeof t.tracesSampler=="function"?(s=t.tracesSampler({...e,inheritOrSampleWith:a=>typeof e.parentSampleRate=="number"?e.parentSampleRate:typeof e.parentSampled=="boolean"?Number(e.parentSampled):a}),r=!0):e.parentSampled!==void 0?s=e.parentSampled:typeof t.tracesSampleRate<"u"&&(s=t.tracesSampleRate,r=!0);const i=Kt(s);if(i===void 0)return y&&E.warn(`[Tracing] Discarding root span because of invalid sample rate. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(s)} of type ${JSON.stringify(typeof s)}.`),[!1];if(!i)return y&&E.log(`[Tracing] Discarding transaction because ${typeof t.tracesSampler=="function"?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`),[!1,i,r];const o=n<i;return o||y&&E.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(s)})`),[o,i,r]}function pe(t,e=100,n=1/0){try{return Mr("",t,e,n)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function ca(t,e=3,n=100*1024){const r=pe(t,e);return ed(r)>n?ca(t,e-1,n):r}function Mr(t,e,n=1/0,r=1/0,s=td()){const[i,o]=s;if(e==null||["boolean","string"].includes(typeof e)||typeof e=="number"&&Number.isFinite(e))return e;const a=Xl(t,e);if(!a.startsWith("[object "))return a;if(e.__sentry_skip_normalization__)return e;const c=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:n;if(c===0)return a.replace("object ","");if(i(e))return"[Circular ~]";const u=e;if(u&&typeof u.toJSON=="function")try{const f=u.toJSON();return Mr("",f,c-1,r,s)}catch{}const l=Array.isArray(e)?[]:{};let d=0;const p=Bo(e);for(const f in p){if(!Object.prototype.hasOwnProperty.call(p,f))continue;if(d>=r){l[f]="[MaxProperties ~]";break}const m=p[f];l[f]=Mr(f,m,c-1,r,s),d++}return o(e),l}function Xl(t,e){try{if(t==="domain"&&e&&typeof e=="object"&&e._events)return"[Domain]";if(t==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&e===global)return"[Global]";if(typeof window<"u"&&e===window)return"[Window]";if(typeof document<"u"&&e===document)return"[Document]";if(Uo(e))return"[VueViewModel]";if(Zu(e))return"[SyntheticEvent]";if(typeof e=="number"&&!Number.isFinite(e))return`[${e}]`;if(typeof e=="function")return`[Function: ${Oe(e)}]`;if(typeof e=="symbol")return`[${String(e)}]`;if(typeof e=="bigint")return`[BigInt: ${String(e)}]`;const n=Ql(e);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(n){return`**non-serializable** (${n})`}}function Ql(t){const e=Object.getPrototypeOf(t);return e!=null&&e.constructor?e.constructor.name:"null prototype"}function Zl(t){return~-encodeURI(t).split(/%..|./).length}function ed(t){return Zl(JSON.stringify(t))}function td(){const t=new WeakSet;function e(r){return t.has(r)?!0:(t.add(r),!1)}function n(r){t.delete(r)}return[e,n]}function At(t,e=[]){return[t,e]}function nd(t,e){const[n,r]=t;return[n,[...r,e]]}function hi(t,e){const n=t[1];for(const r of n){const s=r[0].type;if(e(r,s))return!0}return!1}function Hr(t){const e=Jn(L);return e.encodePolyfill?e.encodePolyfill(t):new TextEncoder().encode(t)}function rd(t){const[e,n]=t;let r=JSON.stringify(e);function s(i){typeof r=="string"?r=typeof i=="string"?r+i:[Hr(r),i]:r.push(typeof i=="string"?Hr(i):i)}for(const i of n){const[o,a]=i;if(s(`
${JSON.stringify(o)}
`),typeof a=="string"||a instanceof Uint8Array)s(a);else{let c;try{c=JSON.stringify(a)}catch{c=JSON.stringify(pe(a))}s(c)}}return typeof r=="string"?r:sd(r)}function sd(t){const e=t.reduce((s,i)=>s+i.length,0),n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}function id(t){return[{type:"span"},t]}function od(t){const e=typeof t.data=="string"?Hr(t.data):t.data;return[{type:"attachment",length:e.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType},e]}const ad={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",raw_security:"security",log:"log_item"};function gi(t){return ad[t]}function ua(t){if(!(t!=null&&t.sdk))return;const{name:e,version:n}=t.sdk;return{name:e,version:n}}function cd(t,e,n,r){var i;const s=(i=t.sdkProcessingMetadata)==null?void 0:i.dynamicSamplingContext;return{event_id:t.event_id,sent_at:new Date().toISOString(),...e&&{sdk:e},...!!n&&r&&{dsn:Ct(r)},...s&&{trace:s}}}function ud(t,e){return e&&(t.sdk=t.sdk||{},t.sdk.name=t.sdk.name||e.name,t.sdk.version=t.sdk.version||e.version,t.sdk.integrations=[...t.sdk.integrations||[],...e.integrations||[]],t.sdk.packages=[...t.sdk.packages||[],...e.packages||[]]),t}function ld(t,e,n,r){const s=ua(n),i={sent_at:new Date().toISOString(),...s&&{sdk:s},...!!r&&e&&{dsn:Ct(e)}},o="aggregates"in t?[{type:"sessions"},t]:[{type:"session"},t.toJSON()];return At(i,[o])}function dd(t,e,n,r){const s=ua(n),i=t.type&&t.type!=="replay_event"?t.type:"event";ud(t,n==null?void 0:n.sdk);const o=cd(t,s,r,e);return delete t.sdkProcessingMetadata,At(o,[[{type:i},t]])}function pd(t,e){function n(l){return!!l.trace_id&&!!l.public_key}const r=ke(t[0]),s=e==null?void 0:e.getDsn(),i=e==null?void 0:e.getOptions().tunnel,o={sent_at:new Date().toISOString(),...n(r)&&{trace:r},...!!i&&s&&{dsn:Ct(s)}},a=e==null?void 0:e.getOptions().beforeSendSpan,c=a?l=>{const d=F(l),p=a(d);return p||(Fr(),d)}:F,u=[];for(const l of t){const d=c(l);d&&u.push(id(d))}return At(o,u)}function mi(t){if(!t||t.length===0)return;const e={};return t.forEach(n=>{const r=n.attributes||{},s=r[Tl],i=r[bl];typeof s=="string"&&typeof i=="number"&&(e[n.name]={value:i,unit:s})}),e}const _i=1e3;let Ts=class{constructor(e={}){this._traceId=e.traceId||Ne(),this._spanId=e.spanId||nn(),this._startTime=e.startTimestamp||Z(),this._links=e.links,this._attributes={},this.setAttributes({[Ye]:"manual",[Wt]:e.op,...e.attributes}),this._name=e.name,e.parentSpanId&&(this._parentSpanId=e.parentSpanId),"sampled"in e&&(this._sampled=e.sampled),e.endTimestamp&&(this._endTime=e.endTimestamp),this._events=[],this._isStandaloneSpan=e.isStandalone,this._endTime&&this._onSpanEnded()}addLink(e){return this._links?this._links.push(e):this._links=[e],this}addLinks(e){return this._links?this._links.push(...e):this._links=e,this}recordException(e,n){}spanContext(){const{_spanId:e,_traceId:n,_sampled:r}=this;return{spanId:e,traceId:n,traceFlags:r?Es:Zo}}setAttribute(e,n){return n===void 0?delete this._attributes[e]:this._attributes[e]=n,this}setAttributes(e){return Object.keys(e).forEach(n=>this.setAttribute(n,e[n])),this}updateStartTime(e){this._startTime=Ve(e)}setStatus(e){return this._status=e,this}updateName(e){return this._name=e,this.setAttribute(ge,"custom"),this}end(e){this._endTime||(this._endTime=Ve(e),Jl(this),this._onSpanEnded())}getSpanJSON(){return{data:this._attributes,description:this._name,op:this._attributes[Wt],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:ta(this._status),timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes[Ye],profile_id:this._attributes[ms],exclusive_time:this._attributes[_s],measurements:mi(this._events),is_segment:this._isStandaloneSpan&&ie(this)===this||void 0,segment_id:this._isStandaloneSpan?ie(this).spanContext().spanId:void 0,links:ea(this._links)}}isRecording(){return!this._endTime&&!!this._sampled}addEvent(e,n,r){y&&E.log("[Tracing] Adding an event to span:",e);const s=Si(n)?n:r||Z(),i=Si(n)?{}:n||{},o={name:e,time:Ve(s),attributes:i};return this._events.push(o),this}isStandaloneSpan(){return!!this._isStandaloneSpan}_onSpanEnded(){const e=P();if(e&&e.emit("spanEnd",this),!(this._isStandaloneSpan||this===ie(this)))return;if(this._isStandaloneSpan){this._sampled?hd(pd([this],e)):(y&&E.log("[Tracing] Discarding standalone span because its trace was not chosen to be sampled."),e&&e.recordDroppedEvent("sample_rate","span"));return}const r=this._convertSpanToTransaction();r&&(Dn(this).scope||U()).captureEvent(r)}_convertSpanToTransaction(){var l;if(!Ei(F(this)))return;this._name||(y&&E.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>");const{scope:e,isolationScope:n}=Dn(this),r=(l=e==null?void 0:e.getScopeData().sdkProcessingMetadata)==null?void 0:l.normalizedRequest;if(this._sampled!==!0)return;const i=vn(this).filter(d=>d!==this&&!fd(d)).map(d=>F(d)).filter(Ei),o=this._attributes[ge];delete this._attributes[ui],i.forEach(d=>{delete d.data[ui]});const a={contexts:{trace:Dl(this)},spans:i.length>_i?i.sort((d,p)=>d.start_timestamp-p.start_timestamp).slice(0,_i):i,start_timestamp:this._startTime,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{capturedSpanScope:e,capturedSpanIsolationScope:n,dynamicSamplingContext:ke(this)},request:r,...o&&{transaction_info:{source:o}}},c=mi(this._events);return c&&Object.keys(c).length&&(y&&E.log("[Measurements] Adding measurements to transaction event",JSON.stringify(c,void 0,2)),a.measurements=c),a}};function Si(t){return t&&typeof t=="number"||t instanceof Date||Array.isArray(t)}function Ei(t){return!!t.start_timestamp&&!!t.timestamp&&!!t.span_id&&!!t.trace_id}function fd(t){return t instanceof Ts&&t.isStandaloneSpan()}function hd(t){const e=P();if(!e)return;const n=t[1];if(!n||n.length===0){e.recordDroppedEvent("before_send","span");return}e.sendEnvelope(t)}const la="__SENTRY_SUPPRESS_TRACING__";function Zn(t){const e=da();if(e.startInactiveSpan)return e.startInactiveSpan(t);const n=_d(t),{forceTransaction:r,parentSpan:s}=t;return(t.scope?o=>zt(t.scope,o):s!==void 0?o=>gd(s,o):o=>o())(()=>{const o=U(),a=Ed(o,s);return t.onlyIfParent&&!a?new Xe:md({parentSpan:a,spanArguments:n,forceTransaction:r,scope:o})})}function gd(t,e){const n=da();return n.withActiveSpan?n.withActiveSpan(t,e):zt(r=>(Vt(r,t||void 0),e(r)))}function md({parentSpan:t,spanArguments:e,forceTransaction:n,scope:r}){if(!Le()){const o=new Xe;if(n||!t){const a={sampled:"false",sample_rate:"0",transaction:e.name,...ke(o)};Rn(o,a)}return o}const s=ae();let i;if(t&&!n)i=Sd(t,r,e),na(t,i);else if(t){const o=ke(t),{traceId:a,spanId:c}=t.spanContext(),u=st(t);i=yi({traceId:a,parentSpanId:c,...e},r,u),Rn(i,o)}else{const{traceId:o,dsc:a,parentSpanId:c,sampled:u}={...s.getPropagationContext(),...r.getPropagationContext()};i=yi({traceId:o,parentSpanId:c,...e},r,u),a&&Rn(i,a)}return Kl(i),wl(i,r,s),i}function _d(t){const n={isStandalone:(t.experimental||{}).standalone,...t};if(t.startTime){const r={...n};return r.startTimestamp=Ve(t.startTime),delete r.startTime,r}return n}function da(){const t=tt();return Rt(t)}function yi(t,e,n){var m;const r=P(),s=(r==null?void 0:r.getOptions())||{},{name:i=""}=t,o={spanAttributes:{...t.attributes},spanName:i,parentSampled:n};r==null||r.emit("beforeSampling",o,{decision:!1});const a=o.parentSampled??n,c=o.spanAttributes,u=e.getPropagationContext(),[l,d,p]=e.getScopeData().sdkProcessingMetadata[la]?[!1]:Yl(s,{name:i,parentSampled:a,attributes:c,parentSampleRate:Kt((m=u.dsc)==null?void 0:m.sample_rate)},u.sampleRand),f=new Ts({...t,attributes:{[ge]:"custom",[gs]:d!==void 0&&p?d:void 0,...c},sampled:l});return!l&&r&&(y&&E.log("[Tracing] Discarding root span because its trace was not chosen to be sampled."),r.recordDroppedEvent("sample_rate","transaction")),r&&r.emit("spanStart",f),f}function Sd(t,e,n){const{spanId:r,traceId:s}=t.spanContext(),i=e.getScopeData().sdkProcessingMetadata[la]?!1:st(t),o=i?new Ts({...n,parentSpanId:r,traceId:s,sampled:i}):new Xe({traceId:s});na(t,o);const a=P();return a&&(a.emit("spanStart",o),n.endTimestamp&&a.emit("spanEnd",o)),o}function Ed(t,e){if(e)return e;if(e===null)return;const n=Pn(t);if(!n)return;const r=P();return(r?r.getOptions():{}).parentSpanIsAlwaysRootSpan?ie(n):n}const wn={idleTimeout:1e3,finalTimeout:3e4,childSpanTimeout:15e3},yd="heartbeatFailed",Td="idleTimeout",bd="finalTimeout",Id="externalFinish";function pa(t,e={}){const n=new Map;let r=!1,s,i=Id,o=!e.disableAutoFinish;const a=[],{idleTimeout:c=wn.idleTimeout,finalTimeout:u=wn.finalTimeout,childSpanTimeout:l=wn.childSpanTimeout,beforeSpanEnd:d}=e,p=P();if(!p||!Le()){const w=new Xe,q={sample_rate:"0",sampled:"false",...ke(w)};return Rn(w,q),w}const f=U(),m=wt(),h=vd(t);h.end=new Proxy(h.end,{apply(w,q,at){if(d&&d(h),q instanceof Xe)return;const[$t,...ct]=at,Fe=$t||Z(),M=Ve(Fe),Ue=vn(h).filter(j=>j!==h);if(!Ue.length)return g(M),Reflect.apply(w,q,[M,...ct]);const Te=Ue.map(j=>F(j).timestamp).filter(j=>!!j),D=Te.length?Math.max(...Te):void 0,H=F(h).start_timestamp,$=Math.min(H?H+u/1e3:1/0,Math.max(H||-1/0,Math.min(M,D||1/0)));return g($),Reflect.apply(w,q,[$,...ct])}});function T(){s&&(clearTimeout(s),s=void 0)}function I(w){T(),s=setTimeout(()=>{!r&&n.size===0&&o&&(i=Td,h.end(w))},c)}function R(w){s=setTimeout(()=>{!r&&o&&(i=yd,h.end(w))},l)}function C(w){T(),n.set(w,!0);const q=Z();R(q+l/1e3)}function S(w){if(n.has(w)&&n.delete(w),n.size===0){const q=Z();I(q+c/1e3)}}function g(w){r=!0,n.clear(),a.forEach(M=>M()),Vt(f,m);const q=F(h),{start_timestamp:at}=q;if(!at)return;q.data[$n]||h.setAttribute($n,i),E.log(`[Tracing] Idle span "${q.op}" finished`);const ct=vn(h).filter(M=>M!==h);let Fe=0;ct.forEach(M=>{M.isRecording()&&(M.setStatus({code:V,message:"cancelled"}),M.end(w),y&&E.log("[Tracing] Cancelling span since span ended early",JSON.stringify(M,void 0,2)));const Ue=F(M),{timestamp:Te=0,start_timestamp:D=0}=Ue,H=D<=w,$=(u+c)/1e3,j=Te-D<=$;if(y){const G=JSON.stringify(M,void 0,2);H?j||E.log("[Tracing] Discarding span since it finished after idle span final timeout",G):E.log("[Tracing] Discarding span since it happened after idle span was finished",G)}(!j||!H)&&(Hl(h,M),Fe++)}),Fe>0&&h.setAttribute("sentry.idle_span_discarded_spans",Fe)}return a.push(p.on("spanStart",w=>{if(r||w===h||F(w).timestamp)return;vn(h).includes(w)&&C(w.spanContext().spanId)})),a.push(p.on("spanEnd",w=>{r||S(w.spanContext().spanId)})),a.push(p.on("idleSpanEnableAutoFinish",w=>{w===h&&(o=!0,I(),n.size&&R())})),e.disableAutoFinish||I(),setTimeout(()=>{r||(h.setStatus({code:V,message:"deadline_exceeded"}),i=bd,h.end())},u),h}function vd(t){const e=Zn(t);return Vt(U(),e),y&&E.log("[Tracing] Started span is an idle span"),e}const hr=0,Ti=1,bi=2;function Qe(t){return new Pe(e=>{e(t)})}function xn(t){return new Pe((e,n)=>{n(t)})}class Pe{constructor(e){this._state=hr,this._handlers=[],this._runExecutor(e)}then(e,n){return new Pe((r,s)=>{this._handlers.push([!1,i=>{if(!e)r(i);else try{r(e(i))}catch(o){s(o)}},i=>{if(!n)s(i);else try{r(n(i))}catch(o){s(o)}}]),this._executeHandlers()})}catch(e){return this.then(n=>n,e)}finally(e){return new Pe((n,r)=>{let s,i;return this.then(o=>{i=!1,s=o,e&&e()},o=>{i=!0,s=o,e&&e()}).then(()=>{if(i){r(s);return}n(s)})})}_executeHandlers(){if(this._state===hr)return;const e=this._handlers.slice();this._handlers=[],e.forEach(n=>{n[0]||(this._state===Ti&&n[1](this._value),this._state===bi&&n[2](this._value),n[0]=!0)})}_runExecutor(e){const n=(i,o)=>{if(this._state===hr){if(Qn(o)){o.then(r,s);return}this._state=i,this._value=o,this._executeHandlers()}},r=i=>{n(Ti,i)},s=i=>{n(bi,i)};try{e(r,s)}catch(i){s(i)}}}function jr(t,e,n,r=0){return new Pe((s,i)=>{const o=t[r];if(e===null||typeof o!="function")s(e);else{const a=o({...e},n);y&&o.id&&a===null&&E.log(`Event processor "${o.id}" dropped event`),Qn(a)?a.then(c=>jr(t,c,n,r+1).then(s)).then(null,i):jr(t,a,n,r+1).then(s).then(null,i)}})}function Rd(t,e){const{fingerprint:n,span:r,breadcrumbs:s,sdkProcessingMetadata:i}=e;wd(t,e),r&&Od(t,r),Nd(t,n),Cd(t,s),Ad(t,i)}function Ii(t,e){const{extra:n,tags:r,user:s,contexts:i,level:o,sdkProcessingMetadata:a,breadcrumbs:c,fingerprint:u,eventProcessors:l,attachments:d,propagationContext:p,transactionName:f,span:m}=e;hn(t,"extra",n),hn(t,"tags",r),hn(t,"user",s),hn(t,"contexts",i),t.sdkProcessingMetadata=tn(t.sdkProcessingMetadata,a,2),o&&(t.level=o),f&&(t.transactionName=f),m&&(t.span=m),c.length&&(t.breadcrumbs=[...t.breadcrumbs,...c]),u.length&&(t.fingerprint=[...t.fingerprint,...u]),l.length&&(t.eventProcessors=[...t.eventProcessors,...l]),d.length&&(t.attachments=[...t.attachments,...d]),t.propagationContext={...t.propagationContext,...p}}function hn(t,e,n){t[e]=tn(t[e],n,1)}function wd(t,e){const{extra:n,tags:r,user:s,contexts:i,level:o,transactionName:a}=e;Object.keys(n).length&&(t.extra={...n,...t.extra}),Object.keys(r).length&&(t.tags={...r,...t.tags}),Object.keys(s).length&&(t.user={...s,...t.user}),Object.keys(i).length&&(t.contexts={...i,...t.contexts}),o&&(t.level=o),a&&t.type!=="transaction"&&(t.transaction=a)}function Cd(t,e){const n=[...t.breadcrumbs||[],...e];t.breadcrumbs=n.length?n:void 0}function Ad(t,e){t.sdkProcessingMetadata={...t.sdkProcessingMetadata,...e}}function Od(t,e){t.contexts={trace:xl(e),...t.contexts},t.sdkProcessingMetadata={dynamicSamplingContext:ke(e),...t.sdkProcessingMetadata};const n=ie(e),r=F(n).description;r&&!t.transaction&&t.type==="transaction"&&(t.transaction=r)}function Nd(t,e){t.fingerprint=t.fingerprint?Array.isArray(t.fingerprint)?t.fingerprint:[t.fingerprint]:[],e&&(t.fingerprint=t.fingerprint.concat(e)),t.fingerprint.length||delete t.fingerprint}let gn,vi,mn;function Ld(t){const e=L._sentryDebugIds;if(!e)return{};const n=Object.keys(e);return mn&&n.length===vi||(vi=n.length,mn=n.reduce((r,s)=>{gn||(gn={});const i=gn[s];if(i)r[i[0]]=i[1];else{const o=t(s);for(let a=o.length-1;a>=0;a--){const c=o[a],u=c==null?void 0:c.filename,l=e[s];if(u&&l){r[u]=l,gn[s]=[u,l];break}}}return r},{})),mn}function kd(t,e,n,r,s,i){const{normalizeDepth:o=3,normalizeMaxBreadth:a=1e3}=t,c={...e,event_id:e.event_id||n.event_id||se(),timestamp:e.timestamp||rt()},u=n.integrations||t.integrations.map(T=>T.name);Pd(c,t),xd(c,u),s&&s.emit("applyFrameMetadata",e),e.type===void 0&&$d(c,t.stackParser);const l=Ud(r,n.captureContext);n.mechanism&&mt(c,n.mechanism);const d=s?s.getEventProcessors():[],p=El().getScopeData();if(i){const T=i.getScopeData();Ii(p,T)}if(l){const T=l.getScopeData();Ii(p,T)}const f=[...n.attachments||[],...p.attachments];f.length&&(n.attachments=f),Rd(c,p);const m=[...d,...p.eventProcessors];return jr(m,c,n).then(T=>(T&&Dd(T),typeof o=="number"&&o>0?Fd(T,o,a):T))}function Pd(t,e){const{environment:n,release:r,dist:s,maxValueLength:i=250}=e;t.environment=t.environment||n||ys,!t.release&&r&&(t.release=r),!t.dist&&s&&(t.dist=s);const o=t.request;o!=null&&o.url&&(o.url=kn(o.url,i))}function $d(t,e){var r,s;const n=Ld(e);(s=(r=t.exception)==null?void 0:r.values)==null||s.forEach(i=>{var o,a;(a=(o=i.stacktrace)==null?void 0:o.frames)==null||a.forEach(c=>{c.filename&&(c.debug_id=n[c.filename])})})}function Dd(t){var r,s;const e={};if((s=(r=t.exception)==null?void 0:r.values)==null||s.forEach(i=>{var o,a;(a=(o=i.stacktrace)==null?void 0:o.frames)==null||a.forEach(c=>{c.debug_id&&(c.abs_path?e[c.abs_path]=c.debug_id:c.filename&&(e[c.filename]=c.debug_id),delete c.debug_id)})}),Object.keys(e).length===0)return;t.debug_meta=t.debug_meta||{},t.debug_meta.images=t.debug_meta.images||[];const n=t.debug_meta.images;Object.entries(e).forEach(([i,o])=>{n.push({type:"sourcemap",code_file:i,debug_id:o})})}function xd(t,e){e.length>0&&(t.sdk=t.sdk||{},t.sdk.integrations=[...t.sdk.integrations||[],...e])}function Fd(t,e,n){var s,i;if(!t)return null;const r={...t,...t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map(o=>({...o,...o.data&&{data:pe(o.data,e,n)}}))},...t.user&&{user:pe(t.user,e,n)},...t.contexts&&{contexts:pe(t.contexts,e,n)},...t.extra&&{extra:pe(t.extra,e,n)}};return(s=t.contexts)!=null&&s.trace&&r.contexts&&(r.contexts.trace=t.contexts.trace,t.contexts.trace.data&&(r.contexts.trace.data=pe(t.contexts.trace.data,e,n))),t.spans&&(r.spans=t.spans.map(o=>({...o,...o.data&&{data:pe(o.data,e,n)}}))),(i=t.contexts)!=null&&i.flags&&r.contexts&&(r.contexts.flags=pe(t.contexts.flags,3,n)),r}function Ud(t,e){if(!e)return t;const n=t?t.clone():new Je;return n.update(e),n}function Md(t){if(t)return Hd(t)?{captureContext:t}:Bd(t)?{captureContext:t}:t}function Hd(t){return t instanceof Je||typeof t=="function"}const jd=["user","level","extra","contexts","tags","fingerprint","propagationContext"];function Bd(t){return Object.keys(t).some(e=>jd.includes(e))}function fa(t,e){return U().captureException(t,Md(e))}function qd(t,e){const n=typeof e=="string"?e:void 0,r=typeof e!="string"?{captureContext:e}:void 0;return U().captureMessage(t,n,r)}function ha(t,e){return U().captureEvent(t,e)}function ga(t,e){ae().setContext(t,e)}function Gd(t,e){ae().setTag(t,e)}function Ri(t){ae().setUser(t)}function Vd(){return ae().lastEventId()}function zd(){const t=P();return(t==null?void 0:t.getOptions().enabled)!==!1&&!!(t!=null&&t.getTransport())}function wi(t){const e=ae(),n=U(),{userAgent:r}=L.navigator||{},s=ul({user:n.getUser()||e.getUser(),...r&&{userAgent:r},...t}),i=e.getSession();return(i==null?void 0:i.status)==="ok"&&_t(i,{status:"exited"}),ma(),e.setSession(s),s}function ma(){const t=ae(),n=U().getSession()||t.getSession();n&&ll(n),_a(),t.setSession()}function _a(){const t=ae(),e=P(),n=t.getSession();n&&e&&e.captureSession(n)}function Ci(t=!1){if(t){ma();return}_a()}const Wd="7";function Sa(t){const e=t.protocol?`${t.protocol}:`:"",n=t.port?`:${t.port}`:"";return`${e}//${t.host}${n}${t.path?`/${t.path}`:""}/api/`}function Kd(t){return`${Sa(t)}${t.projectId}/envelope/`}function Jd(t,e){const n={sentry_version:Wd};return t.publicKey&&(n.sentry_key=t.publicKey),e&&(n.sentry_client=`${e.name}/${e.version}`),new URLSearchParams(n).toString()}function Yd(t,e,n){return e||`${Kd(t)}?${Jd(t,n)}`}function Xd(t,e){const n=sa(t);if(!n)return"";const r=`${Sa(n)}embed/error-page/`;let s=`dsn=${Ct(n)}`;for(const i in e)if(i!=="dsn"&&i!=="onClose")if(i==="user"){const o=e.user;if(!o)continue;o.name&&(s+=`&name=${encodeURIComponent(o.name)}`),o.email&&(s+=`&email=${encodeURIComponent(o.email)}`)}else s+=`&${encodeURIComponent(i)}=${encodeURIComponent(e[i])}`;return`${r}?${s}`}const Ai=[];function Qd(t){const e={};return t.forEach(n=>{const{name:r}=n,s=e[r];s&&!s.isDefaultInstance&&n.isDefaultInstance||(e[r]=n)}),Object.values(e)}function Zd(t){const e=t.defaultIntegrations||[],n=t.integrations;e.forEach(s=>{s.isDefaultInstance=!0});let r;if(Array.isArray(n))r=[...e,...n];else if(typeof n=="function"){const s=n(e);r=Array.isArray(s)?s:[s]}else r=e;return Qd(r)}function ep(t,e){const n={};return e.forEach(r=>{r&&Ea(t,r,n)}),n}function Oi(t,e){for(const n of e)n!=null&&n.afterAllSetup&&n.afterAllSetup(t)}function Ea(t,e,n){if(n[e.name]){y&&E.log(`Integration skipped because it was already installed: ${e.name}`);return}if(n[e.name]=e,Ai.indexOf(e.name)===-1&&typeof e.setupOnce=="function"&&(e.setupOnce(),Ai.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(t),typeof e.preprocessEvent=="function"){const r=e.preprocessEvent.bind(e);t.on("preprocessEvent",(s,i)=>r(s,i,t))}if(typeof e.processEvent=="function"){const r=e.processEvent.bind(e),s=Object.assign((i,o)=>r(i,o,t),{id:e.name});t.addEventProcessor(s)}y&&E.log(`Integration installed: ${e.name}`)}function tp(t,e,n){const r=[{type:"client_report"},{timestamp:n||rt(),discarded_events:t}];return At(e?{dsn:e}:{},[r])}function ya(t){const e=[];t.message&&e.push(t.message);try{const n=t.exception.values[t.exception.values.length-1];n!=null&&n.value&&(e.push(n.value),n.type&&e.push(`${n.type}: ${n.value}`))}catch{}return e}function np(t){var c;const{trace_id:e,parent_span_id:n,span_id:r,status:s,origin:i,data:o,op:a}=((c=t.contexts)==null?void 0:c.trace)??{};return{data:o??{},description:t.transaction,op:a,parent_span_id:n,span_id:r??"",start_timestamp:t.start_timestamp??0,status:s,timestamp:t.timestamp,trace_id:e??"",origin:i,profile_id:o==null?void 0:o[ms],exclusive_time:o==null?void 0:o[_s],measurements:t.measurements,is_segment:!0}}function rp(t){return{type:"transaction",timestamp:t.timestamp,start_timestamp:t.start_timestamp,transaction:t.description,contexts:{trace:{trace_id:t.trace_id,span_id:t.span_id,parent_span_id:t.parent_span_id,op:t.op,status:t.status,origin:t.origin,data:{...t.data,...t.profile_id&&{[ms]:t.profile_id},...t.exclusive_time&&{[_s]:t.exclusive_time}}}},measurements:t.measurements}}const Ni="Not capturing exception because it's already been captured.",Li="Discarded session because of missing or non-string release",Ta=Symbol.for("SentryInternalError"),ba=Symbol.for("SentryDoNotSendEventError");function Cn(t){return{message:t,[Ta]:!0}}function gr(t){return{message:t,[ba]:!0}}function ki(t){return!!t&&typeof t=="object"&&Ta in t}function Pi(t){return!!t&&typeof t=="object"&&ba in t}class sp{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=sa(e.dsn):y&&E.warn("No DSN provided, client will not send events."),this._dsn){const n=Yd(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:n})}}captureException(e,n,r){const s=se();if(oi(e))return y&&E.log(Ni),s;const i={event_id:s,...n};return this._process(this.eventFromException(e,i).then(o=>this._captureEvent(o,i,r))),i.event_id}captureMessage(e,n,r,s){const i={event_id:se(),...r},o=ls(e)?e:String(e),a=ds(e)?this.eventFromMessage(o,n,i):this.eventFromException(e,i);return this._process(a.then(c=>this._captureEvent(c,i,s))),i.event_id}captureEvent(e,n,r){const s=se();if(n!=null&&n.originalException&&oi(n.originalException))return y&&E.log(Ni),s;const i={event_id:s,...n},o=e.sdkProcessingMetadata||{},a=o.capturedSpanScope,c=o.capturedSpanIsolationScope;return this._process(this._captureEvent(e,i,a||r,c)),i.event_id}captureSession(e){this.sendSession(e),_t(e,{init:!1})}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const n=this._transport;return n?(this.emit("flush"),this._isClientDoneProcessing(e).then(r=>n.flush(e).then(s=>r&&s))):Qe(!0)}close(e){return this.flush(e).then(n=>(this.getOptions().enabled=!1,this.emit("close"),n))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some(({name:e})=>e.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const n=this._integrations[e.name];Ea(this,e,this._integrations),n||Oi(this,[e])}sendEvent(e,n={}){this.emit("beforeSendEvent",e,n);let r=dd(e,this._dsn,this._options._metadata,this._options.tunnel);for(const i of n.attachments||[])r=nd(r,od(i));const s=this.sendEnvelope(r);s&&s.then(i=>this.emit("afterSendEvent",e,i),null)}sendSession(e){const{release:n,environment:r=ys}=this._options;if("aggregates"in e){const i=e.attrs||{};if(!i.release&&!n){y&&E.warn(Li);return}i.release=i.release||n,i.environment=i.environment||r,e.attrs=i}else{if(!e.release&&!n){y&&E.warn(Li);return}e.release=e.release||n,e.environment=e.environment||r}this.emit("beforeSendSession",e);const s=ld(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(s)}recordDroppedEvent(e,n,r=1){if(this._options.sendClientReports){const s=`${e}:${n}`;y&&E.log(`Recording outcome: "${s}"${r>1?` (${r} times)`:""}`),this._outcomes[s]=(this._outcomes[s]||0)+r}}on(e,n){const r=this._hooks[e]=this._hooks[e]||[];return r.push(n),()=>{const s=r.indexOf(n);s>-1&&r.splice(s,1)}}emit(e,...n){const r=this._hooks[e];r&&r.forEach(s=>s(...n))}sendEnvelope(e){return this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport?this._transport.send(e).then(null,n=>(y&&E.error("Error while sending envelope:",n),n)):(y&&E.error("Transport disabled"),Qe({}))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=ep(this,e),Oi(this,e)}_updateSessionFromEvent(e,n){var c;let r=n.level==="fatal",s=!1;const i=(c=n.exception)==null?void 0:c.values;if(i){s=!0;for(const u of i){const l=u.mechanism;if((l==null?void 0:l.handled)===!1){r=!0;break}}}const o=e.status==="ok";(o&&e.errors===0||o&&r)&&(_t(e,{...r&&{status:"crashed"},errors:e.errors||Number(s||r)}),this.captureSession(e))}_isClientDoneProcessing(e){return new Pe(n=>{let r=0;const s=1,i=setInterval(()=>{this._numProcessing==0?(clearInterval(i),n(!0)):(r+=s,e&&r>=e&&(clearInterval(i),n(!1)))},s)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,n,r,s){const i=this.getOptions(),o=Object.keys(this._integrations);return!n.integrations&&(o!=null&&o.length)&&(n.integrations=o),this.emit("preprocessEvent",e,n),e.type||s.setLastEventId(e.event_id||n.event_id),kd(i,e,n,r,this,s).then(a=>{if(a===null)return a;this.emit("postprocessEvent",a,n),a.contexts={trace:yl(r),...a.contexts};const c=aa(this,r);return a.sdkProcessingMetadata={dynamicSamplingContext:c,...a.sdkProcessingMetadata},a})}_captureEvent(e,n={},r=U(),s=ae()){return y&&Br(e)&&E.log(`Captured error event \`${ya(e)[0]||"<unknown>"}\``),this._processEvent(e,n,r,s).then(i=>i.event_id,i=>{y&&(Pi(i)?E.log(i.message):ki(i)?E.warn(i.message):E.warn(i))})}_processEvent(e,n,r,s){const i=this.getOptions(),{sampleRate:o}=i,a=Ia(e),c=Br(e),u=e.type||"error",l=`before send for type \`${u}\``,d=typeof o>"u"?void 0:Kt(o);if(c&&typeof d=="number"&&Math.random()>d)return this.recordDroppedEvent("sample_rate","error"),xn(gr(`Discarding event because it's not included in the random sample (sampling rate = ${o})`));const p=u==="replay_event"?"replay":u;return this._prepareEvent(e,n,r,s).then(f=>{if(f===null)throw this.recordDroppedEvent("event_processor",p),gr("An event processor returned `null`, will not send event.");if(n.data&&n.data.__sentry__===!0)return f;const h=op(this,i,f,n);return ip(h,l)}).then(f=>{var T;if(f===null){if(this.recordDroppedEvent("before_send",p),a){const R=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",R)}throw gr(`${l} returned \`null\`, will not send event.`)}const m=r.getSession()||s.getSession();if(c&&m&&this._updateSessionFromEvent(m,f),a){const I=((T=f.sdkProcessingMetadata)==null?void 0:T.spanCountBeforeProcessing)||0,R=f.spans?f.spans.length:0,C=I-R;C>0&&this.recordDroppedEvent("before_send","span",C)}const h=f.transaction_info;if(a&&h&&f.transaction!==e.transaction){const I="custom";f.transaction_info={...h,source:I}}return this.sendEvent(f,n),f}).then(null,f=>{throw Pi(f)||ki(f)?f:(this.captureException(f,{data:{__sentry__:!0},originalException:f}),Cn(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${f}`))})}_process(e){this._numProcessing++,e.then(n=>(this._numProcessing--,n),n=>(this._numProcessing--,n))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map(([n,r])=>{const[s,i]=n.split(":");return{reason:s,category:i,quantity:r}})}_flushOutcomes(){y&&E.log("Flushing outcomes...");const e=this._clearOutcomes();if(e.length===0){y&&E.log("No outcomes to send");return}if(!this._dsn){y&&E.log("No dsn provided, will not send outcomes");return}y&&E.log("Sending outcomes:",e);const n=tp(e,this._options.tunnel&&Ct(this._dsn));this.sendEnvelope(n)}}function ip(t,e){const n=`${e} must return \`null\` or a valid event.`;if(Qn(t))return t.then(r=>{if(!Gt(r)&&r!==null)throw Cn(n);return r},r=>{throw Cn(`${e} rejected with ${r}`)});if(!Gt(t)&&t!==null)throw Cn(n);return t}function op(t,e,n,r){const{beforeSend:s,beforeSendTransaction:i,beforeSendSpan:o}=e;let a=n;if(Br(a)&&s)return s(a,r);if(Ia(a)){if(o){const c=o(np(a));if(c?a=tn(n,rp(c)):Fr(),a.spans){const u=[];for(const l of a.spans){const d=o(l);d?u.push(d):(Fr(),u.push(l))}a.spans=u}}if(i){if(a.spans){const c=a.spans.length;a.sdkProcessingMetadata={...n.sdkProcessingMetadata,spanCountBeforeProcessing:c}}return i(a,r)}}return a}function Br(t){return t.type===void 0}function Ia(t){return t.type==="transaction"}function ap(t){return[{type:"log",item_count:t.length,content_type:"application/vnd.sentry.items.log+json"},{items:t}]}function cp(t,e,n,r){const s={};return e!=null&&e.sdk&&(s.sdk={name:e.sdk.name,version:e.sdk.version}),n&&r&&(s.dsn=Ct(r)),At(s,[ap(t)])}L._sentryClientToLogBufferMap=new WeakMap;function mr(t,e){var i;const n=e??up(t)??[];if(n.length===0)return;const r=t.getOptions(),s=cp(n,r._metadata,r.tunnel,t.getDsn());(i=L._sentryClientToLogBufferMap)==null||i.set(t,[]),t.emit("flushLogs"),t.sendEnvelope(s)}function up(t){var e;return(e=L._sentryClientToLogBufferMap)==null?void 0:e.get(t)}function lp(t,e){e.debug===!0&&(y?E.enable():It(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})),U().update(e.initialScope);const r=new t(e);return dp(r),r.init(),r}function dp(t){U().setClient(t)}const va=Symbol.for("SentryBufferFullError");function pp(t){const e=[];function n(){return t===void 0||e.length<t}function r(o){return e.splice(e.indexOf(o),1)[0]||Promise.resolve(void 0)}function s(o){if(!n())return xn(va);const a=o();return e.indexOf(a)===-1&&e.push(a),a.then(()=>r(a)).then(null,()=>r(a).then(null,()=>{})),a}function i(o){return new Pe((a,c)=>{let u=e.length;if(!u)return a(!0);const l=setTimeout(()=>{o&&o>0&&a(!1)},o);e.forEach(d=>{Qe(d).then(()=>{--u||(clearTimeout(l),a(!0))},c)})})}return{$:e,add:s,drain:i}}const fp=60*1e3;function hp(t,e=Date.now()){const n=parseInt(`${t}`,10);if(!isNaN(n))return n*1e3;const r=Date.parse(`${t}`);return isNaN(r)?fp:r-e}function gp(t,e){return t[e]||t.all||0}function mp(t,e,n=Date.now()){return gp(t,e)>n}function _p(t,{statusCode:e,headers:n},r=Date.now()){const s={...t},i=n==null?void 0:n["x-sentry-rate-limits"],o=n==null?void 0:n["retry-after"];if(i)for(const a of i.trim().split(",")){const[c,u,,,l]=a.split(":",5),d=parseInt(c,10),p=(isNaN(d)?60:d)*1e3;if(!u)s.all=r+p;else for(const f of u.split(";"))f==="metric_bucket"?(!l||l.split(";").includes("custom"))&&(s[f]=r+p):s[f]=r+p}else o?s.all=r+hp(o,r):e===429&&(s.all=r+60*1e3);return s}const Sp=64;function Ep(t,e,n=pp(t.bufferSize||Sp)){let r={};const s=o=>n.drain(o);function i(o){const a=[];if(hi(o,(d,p)=>{const f=gi(p);mp(r,f)?t.recordDroppedEvent("ratelimit_backoff",f):a.push(d)}),a.length===0)return Qe({});const c=At(o[0],a),u=d=>{hi(c,(p,f)=>{t.recordDroppedEvent(d,gi(f))})},l=()=>e({body:rd(c)}).then(d=>(d.statusCode!==void 0&&(d.statusCode<200||d.statusCode>=300)&&y&&E.warn(`Sentry responded with status code ${d.statusCode} to sent event.`),r=_p(r,d),d),d=>{throw u("network_error"),y&&E.error("Encountered error running transport request:",d),d});return n.add(l).then(d=>d,d=>{if(d===va)return y&&E.error("Skipped sending event because buffer is full."),u("queue_overflow"),Qe({});throw d})}return{send:i,flush:s}}function yp(t){var e;((e=t.user)==null?void 0:e.ip_address)===void 0&&(t.user={...t.user,ip_address:"{{auto}}"})}function Tp(t){var e;"aggregates"in t?((e=t.attrs)==null?void 0:e.ip_address)===void 0&&(t.attrs={...t.attrs,ip_address:"{{auto}}"}):t.ipAddress===void 0&&(t.ipAddress="{{auto}}")}function bp(t,e,n=[e],r="npm"){const s=t._metadata||{};s.sdk||(s.sdk={name:`sentry.javascript.${e}`,packages:n.map(i=>({name:`${r}:@sentry/${i}`,version:Be})),version:Be}),t._metadata=s}function Ra(t={}){const e=t.client||P();if(!zd()||!e)return{};const n=tt(),r=Rt(n);if(r.getTraceData)return r.getTraceData(t);const s=t.scope||U(),i=t.span||wt(),o=i?Fl(i):Ip(s),a=i?ke(i):aa(e,s),c=Ol(a);return Xo.test(o)?{"sentry-trace":o,baggage:c}:(E.warn("Invalid sentry-trace data. Cannot generate trace data"),{})}function Ip(t){const{traceId:e,sampled:n,propagationSpanId:r}=t.getPropagationContext();return Qo(e,r,n)}const vp=100;function $e(t,e){const n=P(),r=ae();if(!n)return;const{beforeBreadcrumb:s=null,maxBreadcrumbs:i=vp}=n.getOptions();if(i<=0)return;const a={timestamp:rt(),...t},c=s?It(()=>s(a,e)):a;c!==null&&(n.emit&&n.emit("beforeAddBreadcrumb",c,e),r.addBreadcrumb(c,i))}let $i;const Rp="FunctionToString",Di=new WeakMap,wp=()=>({name:Rp,setupOnce(){$i=Function.prototype.toString;try{Function.prototype.toString=function(...t){const e=fs(this),n=Di.has(P())&&e!==void 0?e:this;return $i.apply(n,t)}}catch{}},setup(t){Di.set(t,!0)}}),Cp=wp,Ap=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,/^Can't find variable: gmo$/,/^undefined is not an object \(evaluating 'a\.[A-Z]'\)$/,`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/,/^Java exception was raised during method invocation$/],Op="EventFilters",Np=(t={})=>{let e;return{name:Op,setup(n){const r=n.getOptions();e=xi(t,r)},processEvent(n,r,s){if(!e){const i=s.getOptions();e=xi(t,i)}return kp(n,e)?null:n}}},Lp=(t={})=>({...Np(t),name:"InboundFilters"});function xi(t={},e={}){return{allowUrls:[...t.allowUrls||[],...e.allowUrls||[]],denyUrls:[...t.denyUrls||[],...e.denyUrls||[]],ignoreErrors:[...t.ignoreErrors||[],...e.ignoreErrors||[],...t.disableErrorDefaults?[]:Ap],ignoreTransactions:[...t.ignoreTransactions||[],...e.ignoreTransactions||[]]}}function kp(t,e){if(t.type){if(t.type==="transaction"&&$p(t,e.ignoreTransactions))return y&&E.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${je(t)}`),!0}else{if(Pp(t,e.ignoreErrors))return y&&E.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${je(t)}`),!0;if(Up(t))return y&&E.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${je(t)}`),!0;if(Dp(t,e.denyUrls))return y&&E.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${je(t)}.
Url: ${Fn(t)}`),!0;if(!xp(t,e.allowUrls))return y&&E.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${je(t)}.
Url: ${Fn(t)}`),!0}return!1}function Pp(t,e){return e!=null&&e.length?ya(t).some(n=>Ge(n,e)):!1}function $p(t,e){if(!(e!=null&&e.length))return!1;const n=t.transaction;return n?Ge(n,e):!1}function Dp(t,e){if(!(e!=null&&e.length))return!1;const n=Fn(t);return n?Ge(n,e):!1}function xp(t,e){if(!(e!=null&&e.length))return!0;const n=Fn(t);return n?Ge(n,e):!0}function Fp(t=[]){for(let e=t.length-1;e>=0;e--){const n=t[e];if(n&&n.filename!=="<anonymous>"&&n.filename!=="[native code]")return n.filename||null}return null}function Fn(t){var e,n;try{const r=[...((e=t.exception)==null?void 0:e.values)??[]].reverse().find(i=>{var o,a,c;return((o=i.mechanism)==null?void 0:o.parent_id)===void 0&&((c=(a=i.stacktrace)==null?void 0:a.frames)==null?void 0:c.length)}),s=(n=r==null?void 0:r.stacktrace)==null?void 0:n.frames;return s?Fp(s):null}catch{return y&&E.error(`Cannot extract url for event ${je(t)}`),null}}function Up(t){var e,n;return(n=(e=t.exception)==null?void 0:e.values)!=null&&n.length?!t.message&&!t.exception.values.some(r=>r.stacktrace||r.type&&r.type!=="Error"||r.value):!1}function Mp(t,e,n,r,s,i){var a;if(!((a=s.exception)!=null&&a.values)||!i||!me(i.originalException,Error))return;const o=s.exception.values.length>0?s.exception.values[s.exception.values.length-1]:void 0;o&&(s.exception.values=qr(t,e,r,i.originalException,n,s.exception.values,o,0))}function qr(t,e,n,r,s,i,o,a){if(i.length>=n+1)return i;let c=[...i];if(me(r[s],Error)){Fi(o,a);const u=t(e,r[s]),l=c.length;Ui(u,s,l,a),c=qr(t,e,n,r[s],s,[u,...c],u,l)}return Array.isArray(r.errors)&&r.errors.forEach((u,l)=>{if(me(u,Error)){Fi(o,a);const d=t(e,u),p=c.length;Ui(d,`errors[${l}]`,p,a),c=qr(t,e,n,u,s,[d,...c],d,p)}}),c}function Fi(t,e){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,...t.type==="AggregateError"&&{is_exception_group:!0},exception_id:e}}function Ui(t,e,n,r){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,type:"chained",source:e,exception_id:n,parent_id:r}}function Hp(t){const e="console";Qt(e,t),Zt(e,jp)}function jp(){"console"in L&&Hu.forEach(function(t){t in L.console&&he(L.console,t,function(e){return Ln[t]=e,function(...n){qe("console",{args:n,level:t});const s=Ln[t];s==null||s.apply(L.console,n)}})})}function Bp(t){return t==="warn"?"warning":["fatal","error","warning","log","info","debug"].includes(t)?t:"log"}const qp="Dedupe",Gp=()=>{let t;return{name:qp,processEvent(e){if(e.type)return e;try{if(zp(e,t))return y&&E.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return t=e}}},Vp=Gp;function zp(t,e){return e?!!(Wp(t,e)||Kp(t,e)):!1}function Wp(t,e){const n=t.message,r=e.message;return!(!n&&!r||n&&!r||!n&&r||n!==r||!Ca(t,e)||!wa(t,e))}function Kp(t,e){const n=Mi(e),r=Mi(t);return!(!n||!r||n.type!==r.type||n.value!==r.value||!Ca(t,e)||!wa(t,e))}function wa(t,e){let n=ei(t),r=ei(e);if(!n&&!r)return!0;if(n&&!r||!n&&r||(n=n,r=r,r.length!==n.length))return!1;for(let s=0;s<r.length;s++){const i=r[s],o=n[s];if(i.filename!==o.filename||i.lineno!==o.lineno||i.colno!==o.colno||i.function!==o.function)return!1}return!0}function Ca(t,e){let n=t.fingerprint,r=e.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;n=n,r=r;try{return n.join("")===r.join("")}catch{return!1}}function Mi(t){var e;return((e=t.exception)==null?void 0:e.values)&&t.exception.values[0]}const Jp="thismessage:/";function Aa(t){return"isRelative"in t}function Oa(t,e){const n=t.indexOf("://")<=0&&t.indexOf("//")!==0,r=e??(n?Jp:void 0);try{if("canParse"in URL&&!URL.canParse(t,r))return;const s=new URL(t,r);return n?{isRelative:n,pathname:s.pathname,search:s.search,hash:s.hash}:s}catch{}}function Yp(t){if(Aa(t))return t.pathname;const e=new URL(t);return e.search="",e.hash="",["80","443"].includes(e.port)&&(e.port=""),e.password&&(e.password="%filtered%"),e.username&&(e.username="%filtered%"),e.toString()}function ht(t){if(!t)return{};const e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const n=e[6]||"",r=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:n,hash:r,relative:e[5]+n+r}}function Xp(t){return t.split(/[?#]/,1)[0]}function Qp(t,e,n,r,s="auto.http.browser"){if(!t.fetchData)return;const{method:i,url:o}=t.fetchData,a=Le()&&e(o);if(t.endTimestamp&&a){const d=t.fetchData.__span;if(!d)return;const p=r[d];p&&(ef(p,t),delete r[d]);return}const c=!!wt(),u=a&&c?Zn(nf(o,i,s)):new Xe;if(t.fetchData.__span=u.spanContext().spanId,r[u.spanContext().spanId]=u,n(t.fetchData.url)){const d=t.args[0],p=t.args[1]||{},f=Zp(d,p,Le()&&c?u:void 0);f&&(t.args[1]=p,p.headers=f)}const l=P();if(l){const d={input:t.args,response:t.response,startTimestamp:t.startTimestamp,endTimestamp:t.endTimestamp};l.emit("beforeOutgoingRequestSpan",u,d)}return u}function Zp(t,e,n){const r=Ra({span:n}),s=r["sentry-trace"],i=r.baggage;if(!s)return;const o=e.headers||(Mo(t)?t.headers:void 0);if(o)if(tf(o)){const a=new Headers(o);if(a.get("sentry-trace")||a.set("sentry-trace",s),i){const c=a.get("baggage");c?_n(c)||a.set("baggage",`${c},${i}`):a.set("baggage",i)}return a}else if(Array.isArray(o)){const a=[...o];o.find(u=>u[0]==="sentry-trace")||a.push(["sentry-trace",s]);const c=o.find(u=>u[0]==="baggage"&&_n(u[1]));return i&&!c&&a.push(["baggage",i]),a}else{const a="sentry-trace"in o?o["sentry-trace"]:void 0,c="baggage"in o?o.baggage:void 0,u=c?Array.isArray(c)?[...c]:[c]:[],l=c&&(Array.isArray(c)?c.find(d=>_n(d)):_n(c));return i&&!l&&u.push(i),{...o,"sentry-trace":a??s,baggage:u.length>0?u.join(","):void 0}}else return{...r}}function ef(t,e){var n;if(e.response){Wo(t,e.response.status);const r=((n=e.response)==null?void 0:n.headers)&&e.response.headers.get("content-length");if(r){const s=parseInt(r);s>0&&t.setAttribute("http.response_content_length",s)}}else e.error&&t.setStatus({code:V,message:"internal_error"});t.end()}function _n(t){return t.split(",").some(e=>e.trim().startsWith(Ss))}function tf(t){return typeof Headers<"u"&&me(t,Headers)}function nf(t,e,n){const r=Oa(t);return{name:r?`${e} ${Yp(r)}`:e,attributes:rf(t,r,e,n)}}function rf(t,e,n,r){const s={url:t,type:"fetch","http.method":n,[Ye]:r,[Wt]:"http.client"};return e&&(Aa(e)||(s["http.url"]=e.href,s["server.address"]=e.host),e.search&&(s["http.query"]=e.search),e.hash&&(s["http.fragment"]=e.hash)),s}function Na(t){if(t!==void 0)return t>=400&&t<500?"warning":t>=500?"error":void 0}const Gr=L;function sf(){if(!("fetch"in Gr))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function Hi(t){return t&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}function of(){var n;if(typeof EdgeRuntime=="string")return!0;if(!sf())return!1;if(Hi(Gr.fetch))return!0;let t=!1;const e=Gr.document;if(e&&typeof e.createElement=="function")try{const r=e.createElement("iframe");r.hidden=!0,e.head.appendChild(r),(n=r.contentWindow)!=null&&n.fetch&&(t=Hi(r.contentWindow.fetch)),e.head.removeChild(r)}catch(r){y&&E.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",r)}return t}function La(t,e){const n="fetch";Qt(n,t),Zt(n,()=>ka(void 0,e))}function af(t){const e="fetch-body-resolved";Qt(e,t),Zt(e,()=>ka(uf))}function ka(t,e=!1){e&&!of()||he(L,"fetch",function(n){return function(...r){const s=new Error,{method:i,url:o}=lf(r),a={args:r,fetchData:{method:i,url:o},startTimestamp:Z()*1e3,virtualError:s,headers:df(r)};return t||qe("fetch",{...a}),n.apply(L,r).then(async c=>(t?t(c):qe("fetch",{...a,endTimestamp:Z()*1e3,response:c}),c),c=>{if(qe("fetch",{...a,endTimestamp:Z()*1e3,error:c}),us(c)&&c.stack===void 0&&(c.stack=s.stack,oe(c,"framesToPop",1)),c instanceof TypeError&&(c.message==="Failed to fetch"||c.message==="Load failed"||c.message==="NetworkError when attempting to fetch resource."))try{const u=new URL(a.fetchData.url);c.message=`${c.message} (${u.host})`}catch{}throw c})}})}async function cf(t,e){if(t!=null&&t.body){const n=t.body,r=n.getReader(),s=setTimeout(()=>{n.cancel().then(null,()=>{})},90*1e3);let i=!0;for(;i;){let o;try{o=setTimeout(()=>{n.cancel().then(null,()=>{})},5e3);const{done:a}=await r.read();clearTimeout(o),a&&(e(),i=!1)}catch{i=!1}finally{clearTimeout(o)}}clearTimeout(s),r.releaseLock(),n.cancel().then(null,()=>{})}}function uf(t){let e;try{e=t.clone()}catch{return}cf(e,()=>{qe("fetch-body-resolved",{endTimestamp:Z()*1e3,response:t})})}function Vr(t,e){return!!t&&typeof t=="object"&&!!t[e]}function ji(t){return typeof t=="string"?t:t?Vr(t,"url")?t.url:t.toString?t.toString():"":""}function lf(t){if(t.length===0)return{method:"GET",url:""};if(t.length===2){const[n,r]=t;return{url:ji(n),method:Vr(r,"method")?String(r.method).toUpperCase():"GET"}}const e=t[0];return{url:ji(e),method:Vr(e,"method")?String(e.method).toUpperCase():"GET"}}function df(t){const[e,n]=t;try{if(typeof n=="object"&&n!==null&&"headers"in n&&n.headers)return new Headers(n.headers);if(Mo(e))return new Headers(e.headers)}catch{}}function pf(){return"npm"}const A=L;let zr=0;function Pa(){return zr>0}function ff(){zr++,setTimeout(()=>{zr--})}function Et(t,e={}){function n(s){return typeof s=="function"}if(!n(t))return t;try{const s=t.__sentry_wrapped__;if(s)return typeof s=="function"?s:t;if(fs(t))return t}catch{return t}const r=function(...s){try{const i=s.map(o=>Et(o,e));return t.apply(this,i)}catch(i){throw ff(),zt(o=>{o.addEventProcessor(a=>(e.mechanism&&(Pr(a,void 0,void 0),mt(a,e.mechanism)),a.extra={...a.extra,arguments:s},a)),fa(i)}),i}};try{for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=t[s])}catch{}jo(r,t),oe(t,"__sentry_wrapped__",r);try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get(){return t.name}})}catch{}return r}function bs(){const t=en(),{referrer:e}=A.document||{},{userAgent:n}=A.navigator||{},r={...e&&{Referer:e},...n&&{"User-Agent":n}};return{url:t,headers:r}}function Is(t,e){const n=vs(t,e),r={type:Sf(e),value:Ef(e)};return n.length&&(r.stacktrace={frames:n}),r.type===void 0&&r.value===""&&(r.value="Unrecoverable error caught"),r}function hf(t,e,n,r){const s=P(),i=s==null?void 0:s.getOptions().normalizeDepth,o=vf(e),a={__serialized__:ca(e,i)};if(o)return{exception:{values:[Is(t,o)]},extra:a};const c={exception:{values:[{type:Xn(e)?e.constructor.name:r?"UnhandledRejection":"Error",value:bf(e,{isUnhandledRejection:r})}]},extra:a};if(n){const u=vs(t,n);u.length&&(c.exception.values[0].stacktrace={frames:u})}return c}function _r(t,e){return{exception:{values:[Is(t,e)]}}}function vs(t,e){const n=e.stacktrace||e.stack||"",r=mf(e),s=_f(e);try{return t(n,r,s)}catch{}return[]}const gf=/Minified React error #\d+;/i;function mf(t){return t&&gf.test(t.message)?1:0}function _f(t){return typeof t.framesToPop=="number"?t.framesToPop:0}function $a(t){return typeof WebAssembly<"u"&&typeof WebAssembly.Exception<"u"?t instanceof WebAssembly.Exception:!1}function Sf(t){const e=t==null?void 0:t.name;return!e&&$a(t)?t.message&&Array.isArray(t.message)&&t.message.length==2?t.message[0]:"WebAssembly.Exception":e}function Ef(t){const e=t==null?void 0:t.message;return $a(t)?Array.isArray(t.message)&&t.message.length==2?t.message[1]:"wasm exception":e?e.error&&typeof e.error.message=="string"?e.error.message:e:"No error message"}function yf(t,e,n,r){const s=(n==null?void 0:n.syntheticException)||void 0,i=Rs(t,e,s,r);return mt(i),i.level="error",n!=null&&n.event_id&&(i.event_id=n.event_id),Qe(i)}function Tf(t,e,n="info",r,s){const i=(r==null?void 0:r.syntheticException)||void 0,o=Wr(t,e,i,s);return o.level=n,r!=null&&r.event_id&&(o.event_id=r.event_id),Qe(o)}function Rs(t,e,n,r,s){let i;if(Fo(e)&&e.error)return _r(t,e.error);if(ni(e)||Yu(e)){const o=e;if("stack"in e)i=_r(t,e);else{const a=o.name||(ni(o)?"DOMError":"DOMException"),c=o.message?`${a}: ${o.message}`:a;i=Wr(t,c,n,r),Pr(i,c)}return"code"in o&&(i.tags={...i.tags,"DOMException.code":`${o.code}`}),i}return us(e)?_r(t,e):Gt(e)||Xn(e)?(i=hf(t,e,n,s),mt(i,{synthetic:!0}),i):(i=Wr(t,e,n,r),Pr(i,`${e}`,void 0),mt(i,{synthetic:!0}),i)}function Wr(t,e,n,r){const s={};if(r&&n){const i=vs(t,n);i.length&&(s.exception={values:[{value:e,stacktrace:{frames:i}}]}),mt(s,{synthetic:!0})}if(ls(e)){const{__sentry_template_string__:i,__sentry_template_values__:o}=e;return s.logentry={message:i,params:o},s}return s.message=e,s}function bf(t,{isUnhandledRejection:e}){const n=sl(t),r=e?"promise rejection":"exception";return Fo(t)?`Event \`ErrorEvent\` captured as ${r} with message \`${t.message}\``:Xn(t)?`Event \`${If(t)}\` (type=${t.type}) captured as ${r}`:`Object captured as ${r} with keys: ${n}`}function If(t){try{const e=Object.getPrototypeOf(t);return e?e.constructor.name:void 0}catch{}}function vf(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const n=t[e];if(n instanceof Error)return n}}const Rf=5e3;class wf extends sp{constructor(e){const n=Cf(e),r=A.SENTRY_SDK_SOURCE||pf();bp(n,"browser",["browser"],r),super(n);const{sendDefaultPii:s,sendClientReports:i,_experiments:o}=this._options,a=o==null?void 0:o.enableLogs;A.document&&(i||a)&&A.document.addEventListener("visibilitychange",()=>{A.document.visibilityState==="hidden"&&(i&&this._flushOutcomes(),a&&mr(this))}),a&&(this.on("flush",()=>{mr(this)}),this.on("afterCaptureLog",()=>{this._logFlushIdleTimeout&&clearTimeout(this._logFlushIdleTimeout),this._logFlushIdleTimeout=setTimeout(()=>{mr(this)},Rf)})),s&&(this.on("postprocessEvent",yp),this.on("beforeSendSession",Tp))}eventFromException(e,n){return yf(this._options.stackParser,e,n,this._options.attachStacktrace)}eventFromMessage(e,n="info",r){return Tf(this._options.stackParser,e,n,r,this._options.attachStacktrace)}_prepareEvent(e,n,r,s){return e.platform=e.platform||"javascript",super._prepareEvent(e,n,r,s)}}function Cf(t){var e;return{release:typeof __SENTRY_RELEASE__=="string"?__SENTRY_RELEASE__:(e=A.SENTRY_RELEASE)==null?void 0:e.id,sendClientReports:!0,parentSpanIsAlwaysRootSpan:!0,...t}}const B=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,ne=globalThis,Ut="9.38.0";function Ot(){return ws(ne),ne}function ws(t){const e=t.__SENTRY__=t.__SENTRY__||{};return e.version=e.version||Ut,e[Ut]=e[Ut]||{}}function Cs(t,e,n=ne){const r=n.__SENTRY__=n.__SENTRY__||{},s=r[Ut]=r[Ut]||{};return s[t]||(s[t]=e())}const Af="Sentry Logger ",Bi={};function Da(t){if(!("console"in ne))return t();const e=ne.console,n={},r=Object.keys(Bi);r.forEach(s=>{const i=Bi[s];n[s]=e[s],e[s]=i});try{return t()}finally{r.forEach(s=>{e[s]=n[s]})}}function xa(){Os().enabled=!0}function Fa(){Os().enabled=!1}function As(){return Os().enabled}function Ua(...t){it("log",...t)}function Of(...t){it("info",...t)}function Ma(...t){it("warn",...t)}function Ha(...t){it("error",...t)}function Nf(...t){it("debug",...t)}function Lf(...t){it("assert",...t)}function kf(...t){it("trace",...t)}function it(t,...e){B&&As()&&Da(()=>{ne.console[t](`${Af}[${t}]:`,...e)})}function Os(){return B?Cs("loggerSettings",()=>({enabled:!1})):{enabled:!1}}const er={enable:xa,disable:Fa,isEnabled:As,log:Ua,info:Of,warn:Ma,error:Ha,debug:Nf,assert:Lf,trace:kf},W={enable:xa,disable:Fa,isEnabled:As,log:Ua,warn:Ma,error:Ha},Sr="<anonymous>";function ja(t){try{return!t||typeof t!="function"?Sr:t.name||Sr}catch{return Sr}}const An={},qi={};function Ns(t,e){An[t]=An[t]||[],An[t].push(e)}function Ls(t,e){if(!qi[t]){qi[t]=!0;try{e()}catch(n){B&&W.error(`Error while instrumenting ${t}`,n)}}}function Jt(t,e){const n=t&&An[t];if(n)for(const r of n)try{r(e)}catch(s){B&&W.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${ja(r)}
Error:`,s)}}const Pf=Object.prototype.toString;function ks(t,e){return Pf.call(t)===`[object ${e}]`}function Ce(t){return ks(t,"String")}function $f(t){return typeof t=="object"&&t!==null&&"__sentry_template_string__"in t&&"__sentry_template_values__"in t}function Gi(t){return t===null||$f(t)||typeof t!="object"&&typeof t!="function"}function Df(t){return ks(t,"Object")}function xf(t){return ks(t,"RegExp")}function Ba(t){return!!(t!=null&&t.then&&typeof t.then=="function")}const qa=ne,Ff=80;function De(t,e={}){if(!t)return"<unknown>";try{let n=t;const r=5,s=[];let i=0,o=0;const a=" > ",c=a.length;let u;const l=Array.isArray(e)?e:e.keyAttrs,d=!Array.isArray(e)&&e.maxStringLength||Ff;for(;n&&i++<r&&(u=Uf(n,l),!(u==="html"||i>1&&o+s.length*c+u.length>=d));)s.push(u),o+=u.length,n=n.parentNode;return s.reverse().join(a)}catch{return"<unknown>"}}function Uf(t,e){const n=t,r=[];if(!(n!=null&&n.tagName))return"";if(qa.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const s=e!=null&&e.length?e.filter(o=>n.getAttribute(o)).map(o=>[o,n.getAttribute(o)]):null;if(s!=null&&s.length)s.forEach(o=>{r.push(`[${o[0]}="${o[1]}"]`)});else{n.id&&r.push(`#${n.id}`);const o=n.className;if(o&&Ce(o)){const a=o.split(/\s+/);for(const c of a)r.push(`.${c}`)}}const i=["aria-label","type","name","title","alt"];for(const o of i){const a=n.getAttribute(o);a&&r.push(`[${o}="${a}"]`)}return r.join("")}function Mf(t){if(!qa.HTMLElement)return null;let e=t;const n=5;for(let r=0;r<n;r++){if(!e)return null;if(e instanceof HTMLElement){if(e.dataset.sentryComponent)return e.dataset.sentryComponent;if(e.dataset.sentryElement)return e.dataset.sentryElement}e=e.parentNode}return null}function Hf(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:`${t.slice(0,e)}...`}function jf(t,e,n=!1){return Ce(t)?xf(e)?e.test(t):Ce(e)?n?t===e:t.includes(e):!1:!1}function Bf(t,e=[],n=!1){return e.some(r=>jf(t,r,n))}function Un(t,e,n){if(!(e in t))return;const r=t[e];if(typeof r!="function")return;const s=n(r);typeof s=="function"&&qf(s,r);try{t[e]=s}catch{B&&W.log(`Failed to replace method "${e}" in object`,t)}}function _e(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch{B&&W.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function qf(t,e){try{const n=e.prototype||{};t.prototype=e.prototype=n,_e(t,"__sentry_original__",e)}catch{}}function Gf(){const t=ne;return t.crypto||t.msCrypto}function We(t=Gf()){let e=()=>Math.random()*16;try{if(t!=null&&t.randomUUID)return t.randomUUID().replace(/-/g,"");t!=null&&t.getRandomValues&&(e=()=>{const n=new Uint8Array(1);return t.getRandomValues(n),n[0]})}catch{}return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,n=>(n^(e()&15)>>n/4).toString(16))}const Ga=1e3;function Va(){return Date.now()/Ga}function Vf(){const{performance:t}=ne;if(!(t!=null&&t.now)||!t.timeOrigin)return Va;const e=t.timeOrigin;return()=>(e+t.now())/Ga}let Vi;function Ae(){return(Vi??(Vi=Vf()))()}let Er;function zf(){var l;const{performance:t}=ne;if(!(t!=null&&t.now))return[void 0,"none"];const e=3600*1e3,n=t.now(),r=Date.now(),s=t.timeOrigin?Math.abs(t.timeOrigin+n-r):e,i=s<e,o=(l=t.timing)==null?void 0:l.navigationStart,c=typeof o=="number"?Math.abs(o+n-r):e,u=c<e;return i||u?s<=c?[t.timeOrigin,"timeOrigin"]:[o,"navigationStart"]:[r,"dateNow"]}function ce(){return Er||(Er=zf()),Er[0]}function Wf(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),!t.did&&!e.did&&(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||Ae(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:We()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const n=t.timestamp-t.started;t.duration=n>=0?n:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function za(t,e,n=2){if(!e||typeof e!="object"||n<=0)return e;if(t&&Object.keys(e).length===0)return t;const r={...t};for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=za(r[s],e[s],n-1));return r}function Mn(){return We()}function Wa(){return We().substring(16)}const Kr="_sentrySpan";function Hn(t,e){e?_e(t,Kr,e):delete t[Kr]}function jn(t){return t[Kr]}const Kf=100;class Ze{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:Mn(),sampleRand:Math.random()}}clone(){const e=new Ze;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,Hn(e,jn(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&Wf(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,n){return this._tags={...this._tags,[e]:n},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,n){return this._extra={...this._extra,[e]:n},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,n){return n===null?delete this._contexts[e]:this._contexts[e]=n,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const n=typeof e=="function"?e(this):e,r=n instanceof Ze?n.getScopeData():Df(n)?e:void 0,{tags:s,extra:i,user:o,contexts:a,level:c,fingerprint:u=[],propagationContext:l}=r||{};return this._tags={...this._tags,...s},this._extra={...this._extra,...i},this._contexts={...this._contexts,...a},o&&Object.keys(o).length&&(this._user=o),c&&(this._level=c),u.length&&(this._fingerprint=u),l&&(this._propagationContext=l),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,Hn(this,void 0),this._attachments=[],this.setPropagationContext({traceId:Mn(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(e,n){var i;const r=typeof n=="number"?n:Kf;if(r<=0)return this;const s={timestamp:Va(),...e,message:e.message?Hf(e.message,2048):e.message};return this._breadcrumbs.push(s),this._breadcrumbs.length>r&&(this._breadcrumbs=this._breadcrumbs.slice(-r),(i=this._client)==null||i.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:jn(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=za(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,n){const r=(n==null?void 0:n.event_id)||We();if(!this._client)return B&&W.warn("No client configured on scope - will not capture exception!"),r;const s=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:s,...n,event_id:r},this),r}captureMessage(e,n,r){const s=(r==null?void 0:r.event_id)||We();if(!this._client)return B&&W.warn("No client configured on scope - will not capture message!"),s;const i=new Error(e);return this._client.captureMessage(e,n,{originalException:e,syntheticException:i,...r,event_id:s},this),s}captureEvent(e,n){const r=(n==null?void 0:n.event_id)||We();return this._client?(this._client.captureEvent(e,{...n,event_id:r},this),r):(B&&W.warn("No client configured on scope - will not capture event!"),r)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}function Jf(){return Cs("defaultCurrentScope",()=>new Ze)}function Yf(){return Cs("defaultIsolationScope",()=>new Ze)}class Xf{constructor(e,n){let r;e?r=e:r=new Ze;let s;n?s=n:s=new Ze,this._stack=[{scope:r}],this._isolationScope=s}withScope(e){const n=this._pushScope();let r;try{r=e(n)}catch(s){throw this._popScope(),s}return Ba(r)?r.then(s=>(this._popScope(),s),s=>{throw this._popScope(),s}):(this._popScope(),r)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}}function yt(){const t=Ot(),e=ws(t);return e.stack=e.stack||new Xf(Jf(),Yf())}function Qf(t){return yt().withScope(t)}function Zf(t,e){const n=yt();return n.withScope(()=>(n.getStackTop().scope=t,e(t)))}function zi(t){return yt().withScope(()=>t(yt().getIsolationScope()))}function eh(){return{withIsolationScope:zi,withScope:Qf,withSetScope:Zf,withSetIsolationScope:(t,e)=>zi(e),getCurrentScope:()=>yt().getScope(),getIsolationScope:()=>yt().getIsolationScope()}}function rn(t){const e=ws(t);return e.acs?e.acs:eh()}function de(){const t=Ot();return rn(t).getCurrentScope()}function th(){const t=Ot();return rn(t).getIsolationScope()}function Ps(...t){const e=Ot(),n=rn(e);if(t.length===2){const[r,s]=t;return r?n.withSetScope(r,s):n.withScope(s)}return n.withScope(t[0])}function ye(){return de().getClient()}const Yt="sentry.source",Ka="sentry.sample_rate",nh="sentry.previous_trace_sample_rate",et="sentry.op",J="sentry.origin",sn="sentry.measurement_unit",on="sentry.measurement_value",Wi="sentry.custom_span_name",rh="sentry.profile_id",tr="sentry.exclusive_time",sh=0,ih=1,oh=2,Ja="_sentryScope",Ya="_sentryIsolationScope";function ah(t,e,n){t&&(_e(t,Ya,n),_e(t,Ja,e))}function Jr(t){return{scope:t[Ja],isolationScope:t[Ya]}}const ch="sentry-",uh=/^sentry-/;function lh(t){const e=dh(t);if(!e)return;const n=Object.entries(e).reduce((r,[s,i])=>{if(s.match(uh)){const o=s.slice(ch.length);r[o]=i}return r},{});if(Object.keys(n).length>0)return n}function dh(t){if(!(!t||!Ce(t)&&!Array.isArray(t)))return Array.isArray(t)?t.reduce((e,n)=>{const r=Ki(n);return Object.entries(r).forEach(([s,i])=>{e[s]=i}),e},{}):Ki(t)}function Ki(t){return t.split(",").map(e=>e.split("=").map(n=>{try{return decodeURIComponent(n.trim())}catch{return}})).reduce((e,[n,r])=>(n&&r&&(e[n]=r),e),{})}function Xa(t){if(typeof t=="boolean")return Number(t);const e=typeof t=="string"?parseFloat(t):t;if(!(typeof e!="number"||isNaN(e)||e<0||e>1))return e}const Qa=0,$s=1;let Ji=!1;function ph(t){const{spanId:e,traceId:n}=t.spanContext(),{data:r,op:s,parent_span_id:i,status:o,origin:a,links:c}=K(t);return{parent_span_id:i,span_id:e,trace_id:n,data:r,op:s,status:o,origin:a,links:c}}function Za(t){if(t&&t.length>0)return t.map(({context:{spanId:e,traceId:n,traceFlags:r,...s},attributes:i})=>({span_id:e,trace_id:n,sampled:r===$s,attributes:i,...s}))}function gt(t){return typeof t=="number"?Yi(t):Array.isArray(t)?t[0]+t[1]/1e9:t instanceof Date?Yi(t.getTime()):Ae()}function Yi(t){return t>9999999999?t/1e3:t}function K(t){var r;if(hh(t))return t.getSpanJSON();const{spanId:e,traceId:n}=t.spanContext();if(fh(t)){const{attributes:s,startTime:i,name:o,endTime:a,status:c,links:u}=t,l="parentSpanId"in t?t.parentSpanId:"parentSpanContext"in t?(r=t.parentSpanContext)==null?void 0:r.spanId:void 0;return{span_id:e,trace_id:n,data:s,description:o,parent_span_id:l,start_timestamp:gt(i),timestamp:gt(a)||void 0,status:ec(c),op:s[et],origin:s[J],links:Za(u)}}return{span_id:e,trace_id:n,start_timestamp:0,data:{}}}function fh(t){const e=t;return!!e.attributes&&!!e.startTime&&!!e.name&&!!e.endTime&&!!e.status}function hh(t){return typeof t.getSpanJSON=="function"}function an(t){const{traceFlags:e}=t.spanContext();return e===$s}function ec(t){if(!(!t||t.code===sh))return t.code===ih?"ok":t.message||"unknown_error"}const Mt="_sentryChildSpans",Yr="_sentryRootSpan";function tc(t,e){const n=t[Yr]||t;_e(e,Yr,n),t[Mt]?t[Mt].add(e):_e(t,Mt,new Set([e]))}function gh(t){const e=new Set;function n(r){if(!e.has(r)&&an(r)){e.add(r);const s=r[Mt]?Array.from(r[Mt]):[];for(const i of s)n(i)}}return n(t),Array.from(e)}function te(t){return t[Yr]||t}function xe(){const t=Ot(),e=rn(t);return e.getActiveSpan?e.getActiveSpan():jn(de())}function mh(){Ji||(Da(()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly.")}),Ji=!0)}function Ds(t){var n;if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const e=t||((n=ye())==null?void 0:n.getOptions());return!!e&&(e.tracesSampleRate!=null||!!e.tracesSampler)}const _h="production",Sh=/^o(\d+)\./;function Eh(t,e=!1){const{host:n,path:r,pass:s,port:i,projectId:o,protocol:a,publicKey:c}=t;return`${a}://${c}${e&&s?`:${s}`:""}@${n}${i?`:${i}`:""}/${r&&`${r}/`}${o}`}function yh(t){const e=t.match(Sh);return e==null?void 0:e[1]}const nc="_frozenDsc";function yr(t,e){_e(t,nc,e)}function Th(t,e){const n=e.getOptions(),{publicKey:r,host:s}=e.getDsn()||{};let i;n.orgId?i=String(n.orgId):s&&(i=yh(s));const o={environment:n.environment||_h,release:n.release,public_key:r,trace_id:t,org_id:i};return e.emit("createDsc",o),o}function Bn(t){var m;const e=ye();if(!e)return{};const n=te(t),r=K(n),s=r.data,i=n.spanContext().traceState,o=(i==null?void 0:i.get("sentry.sample_rate"))??s[Ka]??s[nh];function a(h){return(typeof o=="number"||typeof o=="string")&&(h.sample_rate=`${o}`),h}const c=n[nc];if(c)return a(c);const u=i==null?void 0:i.get("sentry.dsc"),l=u&&lh(u);if(l)return a(l);const d=Th(t.spanContext().traceId,e),p=s[Yt],f=r.description;return p!=="url"&&f&&(d.transaction=f),Ds()&&(d.sampled=String(an(n)),d.sample_rand=(i==null?void 0:i.get("sentry.sample_rand"))??((m=Jr(n).scope)==null?void 0:m.getPropagationContext().sampleRand.toString())),a(d),e.emit("createDsc",d,n),d}class nr{constructor(e={}){this._traceId=e.traceId||Mn(),this._spanId=e.spanId||Wa()}spanContext(){return{spanId:this._spanId,traceId:this._traceId,traceFlags:Qa}}end(e){}setAttribute(e,n){return this}setAttributes(e){return this}setStatus(e){return this}updateName(e){return this}isRecording(){return!1}addEvent(e,n,r){return this}addLink(e){return this}addLinks(e){return this}recordException(e,n){}}function bh(t,e,n=()=>{}){let r;try{r=t()}catch(s){throw e(s),n(),s}return Ih(r,e,n)}function Ih(t,e,n){return Ba(t)?t.then(r=>(n(),r),r=>{throw e(r),n(),r}):(n(),t)}function vh(t){if(!B)return;const{description:e="< unknown name >",op:n="< unknown op >",parent_span_id:r}=K(t),{spanId:s}=t.spanContext(),i=an(t),o=te(t),a=o===t,c=`[Tracing] Starting ${i?"sampled":"unsampled"} ${a?"root ":""}span`,u=[`op: ${n}`,`name: ${e}`,`ID: ${s}`];if(r&&u.push(`parent ID: ${r}`),!a){const{op:l,description:d}=K(o);u.push(`root ID: ${o.spanContext().spanId}`),l&&u.push(`root op: ${l}`),d&&u.push(`root description: ${d}`)}W.log(`${c}
  ${u.join(`
  `)}`)}function Rh(t){if(!B)return;const{description:e="< unknown name >",op:n="< unknown op >"}=K(t),{spanId:r}=t.spanContext(),i=te(t)===t,o=`[Tracing] Finishing "${n}" ${i?"root ":""}span "${e}" with ID ${r}`;W.log(o)}function wh(t,e,n){if(!Ds(t))return[!1];let r,s;typeof t.tracesSampler=="function"?(s=t.tracesSampler({...e,inheritOrSampleWith:a=>typeof e.parentSampleRate=="number"?e.parentSampleRate:typeof e.parentSampled=="boolean"?Number(e.parentSampled):a}),r=!0):e.parentSampled!==void 0?s=e.parentSampled:typeof t.tracesSampleRate<"u"&&(s=t.tracesSampleRate,r=!0);const i=Xa(s);if(i===void 0)return B&&W.warn(`[Tracing] Discarding root span because of invalid sample rate. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(s)} of type ${JSON.stringify(typeof s)}.`),[!1];if(!i)return B&&W.log(`[Tracing] Discarding transaction because ${typeof t.tracesSampler=="function"?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`),[!1,i,r];const o=n<i;return o||B&&W.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(s)})`),[o,i,r]}function Ch(t,e=[]){return[t,e]}function Ah(t){return[{type:"span"},t]}function Oh(t,e){function n(l){return!!l.trace_id&&!!l.public_key}const r=Bn(t[0]),s=e==null?void 0:e.getDsn(),i=e==null?void 0:e.getOptions().tunnel,o={sent_at:new Date().toISOString(),...n(r)&&{trace:r},...!!i&&s&&{dsn:Eh(s)}},a=e==null?void 0:e.getOptions().beforeSendSpan,c=a?l=>{const d=K(l),p=a(d);return p||(mh(),d)}:K,u=[];for(const l of t){const d=c(l);d&&u.push(Ah(d))}return Ch(o,u)}function Nh(t,e,n,r=xe()){const s=r&&te(r);s&&(B&&W.log(`[Measurement] Setting measurement on root span: ${t} = ${e} ${n}`),s.addEvent(t,{[on]:e,[sn]:n}))}function Xi(t){if(!t||t.length===0)return;const e={};return t.forEach(n=>{const r=n.attributes||{},s=r[sn],i=r[on];typeof s=="string"&&typeof i=="number"&&(e[n.name]={value:i,unit:s})}),e}const Qi=1e3;class xs{constructor(e={}){this._traceId=e.traceId||Mn(),this._spanId=e.spanId||Wa(),this._startTime=e.startTimestamp||Ae(),this._links=e.links,this._attributes={},this.setAttributes({[J]:"manual",[et]:e.op,...e.attributes}),this._name=e.name,e.parentSpanId&&(this._parentSpanId=e.parentSpanId),"sampled"in e&&(this._sampled=e.sampled),e.endTimestamp&&(this._endTime=e.endTimestamp),this._events=[],this._isStandaloneSpan=e.isStandalone,this._endTime&&this._onSpanEnded()}addLink(e){return this._links?this._links.push(e):this._links=[e],this}addLinks(e){return this._links?this._links.push(...e):this._links=e,this}recordException(e,n){}spanContext(){const{_spanId:e,_traceId:n,_sampled:r}=this;return{spanId:e,traceId:n,traceFlags:r?$s:Qa}}setAttribute(e,n){return n===void 0?delete this._attributes[e]:this._attributes[e]=n,this}setAttributes(e){return Object.keys(e).forEach(n=>this.setAttribute(n,e[n])),this}updateStartTime(e){this._startTime=gt(e)}setStatus(e){return this._status=e,this}updateName(e){return this._name=e,this.setAttribute(Yt,"custom"),this}end(e){this._endTime||(this._endTime=gt(e),Rh(this),this._onSpanEnded())}getSpanJSON(){return{data:this._attributes,description:this._name,op:this._attributes[et],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:ec(this._status),timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes[J],profile_id:this._attributes[rh],exclusive_time:this._attributes[tr],measurements:Xi(this._events),is_segment:this._isStandaloneSpan&&te(this)===this||void 0,segment_id:this._isStandaloneSpan?te(this).spanContext().spanId:void 0,links:Za(this._links)}}isRecording(){return!this._endTime&&!!this._sampled}addEvent(e,n,r){B&&W.log("[Tracing] Adding an event to span:",e);const s=Zi(n)?n:r||Ae(),i=Zi(n)?{}:n||{},o={name:e,time:gt(s),attributes:i};return this._events.push(o),this}isStandaloneSpan(){return!!this._isStandaloneSpan}_onSpanEnded(){const e=ye();if(e&&e.emit("spanEnd",this),!(this._isStandaloneSpan||this===te(this)))return;if(this._isStandaloneSpan){this._sampled?kh(Oh([this],e)):(B&&W.log("[Tracing] Discarding standalone span because its trace was not chosen to be sampled."),e&&e.recordDroppedEvent("sample_rate","span"));return}const r=this._convertSpanToTransaction();r&&(Jr(this).scope||de()).captureEvent(r)}_convertSpanToTransaction(){var l;if(!eo(K(this)))return;this._name||(B&&W.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>");const{scope:e,isolationScope:n}=Jr(this),r=(l=e==null?void 0:e.getScopeData().sdkProcessingMetadata)==null?void 0:l.normalizedRequest;if(this._sampled!==!0)return;const i=gh(this).filter(d=>d!==this&&!Lh(d)).map(d=>K(d)).filter(eo),o=this._attributes[Yt];delete this._attributes[Wi],i.forEach(d=>{delete d.data[Wi]});const a={contexts:{trace:ph(this)},spans:i.length>Qi?i.sort((d,p)=>d.start_timestamp-p.start_timestamp).slice(0,Qi):i,start_timestamp:this._startTime,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{capturedSpanScope:e,capturedSpanIsolationScope:n,dynamicSamplingContext:Bn(this)},request:r,...o&&{transaction_info:{source:o}}},c=Xi(this._events);return c&&Object.keys(c).length&&(B&&W.log("[Measurements] Adding measurements to transaction event",JSON.stringify(c,void 0,2)),a.measurements=c),a}}function Zi(t){return t&&typeof t=="number"||t instanceof Date||Array.isArray(t)}function eo(t){return!!t.start_timestamp&&!!t.timestamp&&!!t.span_id&&!!t.trace_id}function Lh(t){return t instanceof xs&&t.isStandaloneSpan()}function kh(t){const e=ye();if(!e)return;const n=t[1];if(!n||n.length===0){e.recordDroppedEvent("before_send","span");return}e.sendEnvelope(t)}const rc="__SENTRY_SUPPRESS_TRACING__";function Ph(t,e){const n=Us();if(n.startSpan)return n.startSpan(t,e);const r=oc(t),{forceTransaction:s,parentSpan:i,scope:o}=t,a=o==null?void 0:o.clone();return Ps(a,()=>Dh(i)(()=>{const u=de(),l=ac(u,i),p=t.onlyIfParent&&!l?new nr:ic({parentSpan:l,spanArguments:r,forceTransaction:s,scope:u});return Hn(u,p),bh(()=>e(p),()=>{const{status:f}=K(p);p.isRecording()&&(!f||f==="ok")&&p.setStatus({code:oh,message:"internal_error"})},()=>{p.end()})}))}function sc(t){const e=Us();if(e.startInactiveSpan)return e.startInactiveSpan(t);const n=oc(t),{forceTransaction:r,parentSpan:s}=t;return(t.scope?o=>Ps(t.scope,o):s!==void 0?o=>Fs(s,o):o=>o())(()=>{const o=de(),a=ac(o,s);return t.onlyIfParent&&!a?new nr:ic({parentSpan:a,spanArguments:n,forceTransaction:r,scope:o})})}function Fs(t,e){const n=Us();return n.withActiveSpan?n.withActiveSpan(t,e):Ps(r=>(Hn(r,t||void 0),e(r)))}function ic({parentSpan:t,spanArguments:e,forceTransaction:n,scope:r}){if(!Ds()){const o=new nr;if(n||!t){const a={sampled:"false",sample_rate:"0",transaction:e.name,...Bn(o)};yr(o,a)}return o}const s=th();let i;if(t&&!n)i=$h(t,r,e),tc(t,i);else if(t){const o=Bn(t),{traceId:a,spanId:c}=t.spanContext(),u=an(t);i=to({traceId:a,parentSpanId:c,...e},r,u),yr(i,o)}else{const{traceId:o,dsc:a,parentSpanId:c,sampled:u}={...s.getPropagationContext(),...r.getPropagationContext()};i=to({traceId:o,parentSpanId:c,...e},r,u),a&&yr(i,a)}return vh(i),ah(i,r,s),i}function oc(t){const n={isStandalone:(t.experimental||{}).standalone,...t};if(t.startTime){const r={...n};return r.startTimestamp=gt(t.startTime),delete r.startTime,r}return n}function Us(){const t=Ot();return rn(t)}function to(t,e,n){var m;const r=ye(),s=(r==null?void 0:r.getOptions())||{},{name:i=""}=t,o={spanAttributes:{...t.attributes},spanName:i,parentSampled:n};r==null||r.emit("beforeSampling",o,{decision:!1});const a=o.parentSampled??n,c=o.spanAttributes,u=e.getPropagationContext(),[l,d,p]=e.getScopeData().sdkProcessingMetadata[rc]?[!1]:wh(s,{name:i,parentSampled:a,attributes:c,parentSampleRate:Xa((m=u.dsc)==null?void 0:m.sample_rate)},u.sampleRand),f=new xs({...t,attributes:{[Yt]:"custom",[Ka]:d!==void 0&&p?d:void 0,...c},sampled:l});return!l&&r&&(B&&W.log("[Tracing] Discarding root span because its trace was not chosen to be sampled."),r.recordDroppedEvent("sample_rate","transaction")),r&&r.emit("spanStart",f),f}function $h(t,e,n){const{spanId:r,traceId:s}=t.spanContext(),i=e.getScopeData().sdkProcessingMetadata[rc]?!1:an(t),o=i?new xs({...n,parentSpanId:r,traceId:s,sampled:i}):new nr({traceId:s});tc(t,o);const a=ye();return a&&(a.emit("spanStart",o),n.endTimestamp&&a.emit("spanEnd",o)),o}function ac(t,e){if(e)return e;if(e===null)return;const n=jn(t);if(!n)return;const r=ye();return(r?r.getOptions():{}).parentSpanIsAlwaysRootSpan?te(n):n}function Dh(t){return t!==void 0?e=>Fs(t,e):e=>e()}function xh(t){if(!t)return{};const e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const n=e[6]||"",r=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:n,hash:r,relative:e[5]+n+r}}const no=ne;function Fh(){return"history"in no&&!!no.history}function Uh(t){return t&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}const rr=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,v=ne,Mh=(t,e)=>t>e[1]?"poor":t>e[0]?"needs-improvement":"good",Nt=(t,e,n,r)=>{let s,i;return o=>{e.value>=0&&(o||r)&&(i=e.value-(s??0),(i||s===void 0)&&(s=e.value,e.delta=i,e.rating=Mh(e.value,n),t(e)))}},Hh=()=>`v5-${Date.now()}-${Math.floor(Math.random()*(9e12-1))+1e12}`,cn=(t=!0)=>{var n,r;const e=(r=(n=v.performance)==null?void 0:n.getEntriesByType)==null?void 0:r.call(n,"navigation")[0];if(!t||e&&e.responseStart>0&&e.responseStart<performance.now())return e},Lt=()=>{const t=cn();return(t==null?void 0:t.activationStart)??0},kt=(t,e=-1)=>{var i,o;const n=cn();let r="navigate";return n&&((i=v.document)!=null&&i.prerendering||Lt()>0?r="prerender":(o=v.document)!=null&&o.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-"))),{name:t,value:e,rating:"good",delta:0,entries:[],id:Hh(),navigationType:r}},Tr=new WeakMap;function Ms(t,e){return Tr.get(t)||Tr.set(t,new e),Tr.get(t)}class qn{constructor(){qn.prototype.__init.call(this),qn.prototype.__init2.call(this)}__init(){this._sessionValue=0}__init2(){this._sessionEntries=[]}_processEntry(e){var s;if(e.hadRecentInput)return;const n=this._sessionEntries[0],r=this._sessionEntries[this._sessionEntries.length-1];this._sessionValue&&n&&r&&e.startTime-r.startTime<1e3&&e.startTime-n.startTime<5e3?(this._sessionValue+=e.value,this._sessionEntries.push(e)):(this._sessionValue=e.value,this._sessionEntries=[e]),(s=this._onAfterProcessingUnexpectedShift)==null||s.call(this,e)}}const ot=(t,e,n={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){const r=new PerformanceObserver(s=>{Promise.resolve().then(()=>{e(s.getEntries())})});return r.observe({type:t,buffered:!0,...n}),r}}catch{}},sr=t=>{let e=!1;return()=>{e||(t(),e=!0)}};let Ht=-1;const jh=()=>{var t,e;return((t=v.document)==null?void 0:t.visibilityState)==="hidden"&&!((e=v.document)!=null&&e.prerendering)?0:1/0},Gn=t=>{v.document.visibilityState==="hidden"&&Ht>-1&&(Ht=t.type==="visibilitychange"?t.timeStamp:0,qh())},Bh=()=>{addEventListener("visibilitychange",Gn,!0),addEventListener("prerenderingchange",Gn,!0)},qh=()=>{removeEventListener("visibilitychange",Gn,!0),removeEventListener("prerenderingchange",Gn,!0)},ir=()=>{var t;if(v.document&&Ht<0){const e=Lt();Ht=(v.document.prerendering||(t=globalThis.performance.getEntriesByType("visibility-state").filter(r=>r.name==="hidden"&&r.startTime>e)[0])==null?void 0:t.startTime)??jh(),Bh()}return{get firstHiddenTime(){return Ht}}},un=t=>{var e;(e=v.document)!=null&&e.prerendering?addEventListener("prerenderingchange",()=>t(),!0):t()},Gh=[1800,3e3],Vh=(t,e={})=>{un(()=>{const n=ir(),r=kt("FCP");let s;const o=ot("paint",a=>{for(const c of a)c.name==="first-contentful-paint"&&(o.disconnect(),c.startTime<n.firstHiddenTime&&(r.value=Math.max(c.startTime-Lt(),0),r.entries.push(c),s(!0)))});o&&(s=Nt(t,r,Gh,e.reportAllChanges))})},zh=[.1,.25],Wh=(t,e={})=>{Vh(sr(()=>{var a,c;const n=kt("CLS",0);let r;const s=Ms(e,qn),i=u=>{for(const l of u)s._processEntry(l);s._sessionValue>n.value&&(n.value=s._sessionValue,n.entries=s._sessionEntries,r())},o=ot("layout-shift",i);o&&(r=Nt(t,n,zh,e.reportAllChanges),(a=v.document)==null||a.addEventListener("visibilitychange",()=>{var u;((u=v.document)==null?void 0:u.visibilityState)==="hidden"&&(i(o.takeRecords()),r(!0))}),(c=v==null?void 0:v.setTimeout)==null||c.call(v,r))}))},or=t=>{const e=n=>{var r;(n.type==="pagehide"||((r=v.document)==null?void 0:r.visibilityState)==="hidden")&&t(n)};v.document&&(addEventListener("visibilitychange",e,!0),addEventListener("pagehide",e,!0))},Kh=[100,300],Jh=(t,e={})=>{un(()=>{const n=ir(),r=kt("FID");let s;const i=c=>{c.startTime<n.firstHiddenTime&&(r.value=c.processingStart-c.startTime,r.entries.push(c),s(!0))},o=c=>{c.forEach(i)},a=ot("first-input",o);s=Nt(t,r,Kh,e.reportAllChanges),a&&or(sr(()=>{o(a.takeRecords()),a.disconnect()}))})};let cc=0,br=1/0,Sn=0;const Yh=t=>{t.forEach(e=>{e.interactionId&&(br=Math.min(br,e.interactionId),Sn=Math.max(Sn,e.interactionId),cc=Sn?(Sn-br)/7+1:0)})};let Xr;const uc=()=>Xr?cc:performance.interactionCount||0,Xh=()=>{"interactionCount"in performance||Xr||(Xr=ot("event",Yh,{type:"event",buffered:!0,durationThreshold:0}))},Ir=10;let lc=0;const Qh=()=>uc()-lc;class Vn{constructor(){Vn.prototype.__init.call(this),Vn.prototype.__init2.call(this)}__init(){this._longestInteractionList=[]}__init2(){this._longestInteractionMap=new Map}_resetInteractions(){lc=uc(),this._longestInteractionList.length=0,this._longestInteractionMap.clear()}_estimateP98LongestInteraction(){const e=Math.min(this._longestInteractionList.length-1,Math.floor(Qh()/50));return this._longestInteractionList[e]}_processEntry(e){var s,i;if((s=this._onBeforeProcessingEntry)==null||s.call(this,e),!(e.interactionId||e.entryType==="first-input"))return;const n=this._longestInteractionList.at(-1);let r=this._longestInteractionMap.get(e.interactionId);if(r||this._longestInteractionList.length<Ir||e.duration>n._latency){if(r?e.duration>r._latency?(r.entries=[e],r._latency=e.duration):e.duration===r._latency&&e.startTime===r.entries[0].startTime&&r.entries.push(e):(r={id:e.interactionId,entries:[e],_latency:e.duration},this._longestInteractionMap.set(r.id,r),this._longestInteractionList.push(r)),this._longestInteractionList.sort((o,a)=>a._latency-o._latency),this._longestInteractionList.length>Ir){const o=this._longestInteractionList.splice(Ir);for(const a of o)this._longestInteractionMap.delete(a.id)}(i=this._onAfterProcessingINPCandidate)==null||i.call(this,r)}}}const dc=t=>{var n;const e=v.requestIdleCallback||v.setTimeout;((n=v.document)==null?void 0:n.visibilityState)==="hidden"?t():(t=sr(t),e(t),or(t))},Zh=[200,500],eg=40,tg=(t,e={})=>{globalThis.PerformanceEventTiming&&"interactionId"in PerformanceEventTiming.prototype&&un(()=>{Xh();const n=kt("INP");let r;const s=Ms(e,Vn),i=a=>{dc(()=>{for(const u of a)s._processEntry(u);const c=s._estimateP98LongestInteraction();c&&c._latency!==n.value&&(n.value=c._latency,n.entries=c.entries,r())})},o=ot("event",i,{durationThreshold:e.durationThreshold??eg});r=Nt(t,n,Zh,e.reportAllChanges),o&&(o.observe({type:"first-input",buffered:!0}),or(()=>{i(o.takeRecords()),r(!0)}))})};class ng{_processEntry(e){var n;(n=this._onBeforeProcessingEntry)==null||n.call(this,e)}}const rg=[2500,4e3],sg=(t,e={})=>{un(()=>{const n=ir(),r=kt("LCP");let s;const i=Ms(e,ng),o=c=>{e.reportAllChanges||(c=c.slice(-1));for(const u of c)i._processEntry(u),u.startTime<n.firstHiddenTime&&(r.value=Math.max(u.startTime-Lt(),0),r.entries=[u],s())},a=ot("largest-contentful-paint",o);if(a){s=Nt(t,r,rg,e.reportAllChanges);const c=sr(()=>{o(a.takeRecords()),a.disconnect(),s(!0)});for(const u of["keydown","click","visibilitychange"])v.document&&addEventListener(u,()=>dc(c),{capture:!0,once:!0})}})},ig=[800,1800],Qr=t=>{var e,n;(e=v.document)!=null&&e.prerendering?un(()=>Qr(t)):((n=v.document)==null?void 0:n.readyState)!=="complete"?addEventListener("load",()=>Qr(t),!0):setTimeout(t)},og=(t,e={})=>{const n=kt("TTFB"),r=Nt(t,n,ig,e.reportAllChanges);Qr(()=>{const s=cn();s&&(n.value=Math.max(s.responseStart-Lt(),0),n.entries=[s],r(!0))})},jt={},zn={};let pc,fc,hc,gc,mc;function _c(t,e=!1){return ln("cls",t,lg,pc,e)}function Sc(t,e=!1){return ln("lcp",t,pg,hc,e)}function ag(t){return ln("fid",t,dg,fc)}function cg(t){return ln("ttfb",t,fg,gc)}function ug(t){return ln("inp",t,hg,mc)}function Tt(t,e){return Ec(t,e),zn[t]||(gg(t),zn[t]=!0),yc(t,e)}function Pt(t,e){const n=jt[t];if(n!=null&&n.length)for(const r of n)try{r(e)}catch(s){rr&&er.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${ja(r)}
Error:`,s)}}function lg(){return Wh(t=>{Pt("cls",{metric:t}),pc=t},{reportAllChanges:!0})}function dg(){return Jh(t=>{Pt("fid",{metric:t}),fc=t})}function pg(){return sg(t=>{Pt("lcp",{metric:t}),hc=t},{reportAllChanges:!0})}function fg(){return og(t=>{Pt("ttfb",{metric:t}),gc=t})}function hg(){return tg(t=>{Pt("inp",{metric:t}),mc=t})}function ln(t,e,n,r,s=!1){Ec(t,e);let i;return zn[t]||(i=n(),zn[t]=!0),r&&e({metric:r}),yc(t,e,s?i:void 0)}function gg(t){const e={};t==="event"&&(e.durationThreshold=0),ot(t,n=>{Pt(t,{entries:n})},e)}function Ec(t,e){jt[t]=jt[t]||[],jt[t].push(e)}function yc(t,e,n){return()=>{n&&n();const r=jt[t];if(!r)return;const s=r.indexOf(e);s!==-1&&r.splice(s,1)}}function mg(t){return"duration"in t}function vr(t){return typeof t=="number"&&isFinite(t)}function Se(t,e,n,{...r}){const s=K(t).start_timestamp;return s&&s>e&&typeof t.updateStartTime=="function"&&t.updateStartTime(e),Fs(t,()=>{const i=sc({startTime:e,...r});return i&&i.end(n),i})}function Hs(t){var T;const e=ye();if(!e)return;const{name:n,transaction:r,attributes:s,startTime:i}=t,{release:o,environment:a,sendDefaultPii:c}=e.getOptions(),u=e.getIntegrationByName("Replay"),l=u==null?void 0:u.getReplayId(),d=de(),p=d.getUser(),f=p!==void 0?p.email||p.id||p.ip_address:void 0;let m;try{m=d.getScopeData().contexts.profile.profile_id}catch{}const h={release:o,environment:a,user:f||void 0,profile_id:m||void 0,replay_id:l||void 0,transaction:r,"user_agent.original":(T=v.navigator)==null?void 0:T.userAgent,"client.address":c?"{{auto}}":void 0,...s};return sc({name:n,attributes:h,startTime:i,experimental:{standalone:!0}})}function ar(){return v.addEventListener&&v.performance}function x(t){return t/1e3}function Tc(t){let e="unknown",n="unknown",r="";for(const s of t){if(s==="/"){[e,n]=t.split("/");break}if(!isNaN(Number(s))){e=r==="h"?"http":r,n=t.split(r)[1];break}r+=s}return r===t&&(e=r),{name:e,version:n}}function bc(t){try{return PerformanceObserver.supportedEntryTypes.includes(t)}catch{return!1}}function Ic(t){let e,n=!1;function r(s){!n&&e&&t(s,e),n=!0}or(()=>{n||r("pagehide")}),setTimeout(()=>{const s=ye();if(!s)return;const i=s.on("beforeStartNavigationSpan",(a,c)=>{c!=null&&c.isRedirect||(r("navigation"),i==null||i())}),o=xe();if(o){const a=te(o);K(a).op==="pageload"&&(e=a.spanContext().spanId)}},0)}function _g(){let t=0,e;if(!bc("layout-shift"))return;const n=_c(({metric:r})=>{const s=r.entries[r.entries.length-1];s&&(t=r.value,e=s)},!0);Ic((r,s)=>{Sg(t,e,s,r),n()})}function Sg(t,e,n,r){var u;rr&&er.log(`Sending CLS span (${t})`);const s=x((ce()||0)+((e==null?void 0:e.startTime)||0)),i=de().getScopeData().transactionName,o=e?De((u=e.sources[0])==null?void 0:u.node):"Layout shift",a={[J]:"auto.http.browser.cls",[et]:"ui.webvital.cls",[tr]:(e==null?void 0:e.duration)||0,"sentry.pageload.span_id":n,"sentry.report_event":r};e!=null&&e.sources&&e.sources.forEach((l,d)=>{a[`cls.source.${d+1}`]=De(l.node)});const c=Hs({name:o,transaction:i,attributes:a,startTime:s});c&&(c.addEvent("cls",{[sn]:"",[on]:t}),c.end(s))}function Eg(){let t=0,e;if(!bc("largest-contentful-paint"))return;const n=Sc(({metric:r})=>{const s=r.entries[r.entries.length-1];s&&(t=r.value,e=s)},!0);Ic((r,s)=>{yg(t,e,s,r),n()})}function yg(t,e,n,r){rr&&er.log(`Sending LCP span (${t})`);const s=x((ce()||0)+((e==null?void 0:e.startTime)||0)),i=de().getScopeData().transactionName,o=e?De(e.element):"Largest contentful paint",a={[J]:"auto.http.browser.lcp",[et]:"ui.webvital.lcp",[tr]:0,"sentry.pageload.span_id":n,"sentry.report_event":r};e&&(e.element&&(a["lcp.element"]=De(e.element)),e.id&&(a["lcp.id"]=e.id),e.url&&(a["lcp.url"]=e.url.trim().slice(0,200)),e.loadTime!=null&&(a["lcp.loadTime"]=e.loadTime),e.renderTime!=null&&(a["lcp.renderTime"]=e.renderTime),e.size!=null&&(a["lcp.size"]=e.size));const c=Hs({name:o,transaction:i,attributes:a,startTime:s});c&&(c.addEvent("lcp",{[sn]:"millisecond",[on]:t}),c.end(s))}const Tg=2147483647;let ro=0,z={},Y,dt;function bg({recordClsStandaloneSpans:t,recordLcpStandaloneSpans:e}){const n=ar();if(n&&ce()){n.mark&&v.performance.mark("sentry-tracing-init");const r=Ag(),s=e?Eg():Cg(),i=Og(),o=t?_g():wg();return()=>{r(),s==null||s(),i(),o==null||o()}}return()=>{}}function Ig(){Tt("longtask",({entries:t})=>{const e=xe();if(!e)return;const{op:n,start_timestamp:r}=K(e);for(const s of t){const i=x(ce()+s.startTime),o=x(s.duration);n==="navigation"&&r&&i<r||Se(e,i,i+o,{name:"Main UI thread blocked",op:"ui.long-task",attributes:{[J]:"auto.ui.browser.metrics"}})}})}function vg(){new PerformanceObserver(e=>{const n=xe();if(n)for(const r of e.getEntries()){if(!r.scripts[0])continue;const s=x(ce()+r.startTime),{start_timestamp:i,op:o}=K(n);if(o==="navigation"&&i&&s<i)continue;const a=x(r.duration),c={[J]:"auto.ui.browser.metrics"},u=r.scripts[0],{invoker:l,invokerType:d,sourceURL:p,sourceFunctionName:f,sourceCharPosition:m}=u;c["browser.script.invoker"]=l,c["browser.script.invoker_type"]=d,p&&(c["code.filepath"]=p),f&&(c["code.function"]=f),m!==-1&&(c["browser.script.source_char_position"]=m),Se(n,s,s+a,{name:"Main UI thread blocked",op:"ui.long-animation-frame",attributes:c})}}).observe({type:"long-animation-frame",buffered:!0})}function Rg(){Tt("event",({entries:t})=>{const e=xe();if(e){for(const n of t)if(n.name==="click"){const r=x(ce()+n.startTime),s=x(n.duration),i={name:De(n.target),op:`ui.interaction.${n.name}`,startTime:r,attributes:{[J]:"auto.ui.browser.metrics"}},o=Mf(n.target);o&&(i.attributes["ui.component_name"]=o),Se(e,r,r+s,i)}}})}function wg(){return _c(({metric:t})=>{const e=t.entries[t.entries.length-1];e&&(z.cls={value:t.value,unit:""},dt=e)},!0)}function Cg(){return Sc(({metric:t})=>{const e=t.entries[t.entries.length-1];e&&(z.lcp={value:t.value,unit:"millisecond"},Y=e)},!0)}function Ag(){return ag(({metric:t})=>{const e=t.entries[t.entries.length-1];if(!e)return;const n=x(ce()),r=x(e.startTime);z.fid={value:t.value,unit:"millisecond"},z["mark.fid"]={value:n+r,unit:"second"}})}function Og(){return cg(({metric:t})=>{t.entries[t.entries.length-1]&&(z.ttfb={value:t.value,unit:"millisecond"})})}function Ng(t,e){const n=ar(),r=ce();if(!(n!=null&&n.getEntries)||!r)return;const s=x(r),i=n.getEntries(),{op:o,start_timestamp:a}=K(t);if(i.slice(ro).forEach(c=>{const u=x(c.startTime),l=x(Math.max(0,c.duration));if(!(o==="navigation"&&a&&s+u<a))switch(c.entryType){case"navigation":{Pg(t,c,s);break}case"mark":case"paint":case"measure":{Lg(t,c,u,l,s,e.ignorePerformanceApiSpans);const d=ir(),p=c.startTime<d.firstHiddenTime;c.name==="first-paint"&&p&&(z.fp={value:c.startTime,unit:"millisecond"}),c.name==="first-contentful-paint"&&p&&(z.fcp={value:c.startTime,unit:"millisecond"});break}case"resource":{xg(t,c,c.name,u,l,s,e.ignoreResourceSpans);break}}}),ro=Math.max(i.length-1,0),Fg(t),o==="pageload"){Mg(z);const c=z["mark.fid"];c&&z.fid&&(Se(t,c.value,c.value+x(z.fid.value),{name:"first input delay",op:"ui.action",attributes:{[J]:"auto.ui.browser.metrics"}}),delete z["mark.fid"]),(!("fcp"in z)||!e.recordClsOnPageloadSpan)&&delete z.cls,e.recordLcpOnPageloadSpan||delete z.lcp,Object.entries(z).forEach(([u,l])=>{Nh(u,l.value,l.unit)}),t.setAttribute("performance.timeOrigin",s),t.setAttribute("performance.activationStart",Lt()),Ug(t,e)}Y=void 0,dt=void 0,z={}}function Lg(t,e,n,r,s,i){if(["mark","measure"].includes(e.entryType)&&Bf(e.name,i))return;const o=cn(!1),a=x(o?o.requestStart:0),c=s+Math.max(n,a),u=s+n,l=u+r,d={[J]:"auto.resource.browser.metrics"};c!==u&&(d["sentry.browser.measure_happened_before_request"]=!0,d["sentry.browser.measure_start_time"]=c),kg(d,e),c<=l&&Se(t,c,l,{name:e.name,op:e.entryType,attributes:d})}function kg(t,e){try{const n=e.detail;if(!n)return;if(typeof n=="object"){for(const[r,s]of Object.entries(n))if(s&&Gi(s))t[`sentry.browser.measure.detail.${r}`]=s;else if(s!==void 0)try{t[`sentry.browser.measure.detail.${r}`]=JSON.stringify(s)}catch{}return}if(Gi(n)){t["sentry.browser.measure.detail"]=n;return}try{t["sentry.browser.measure.detail"]=JSON.stringify(n)}catch{}}catch{}}function Pg(t,e,n){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach(r=>{En(t,e,r,n)}),En(t,e,"secureConnection",n,"TLS/SSL"),En(t,e,"fetch",n,"cache"),En(t,e,"domainLookup",n,"DNS"),Dg(t,e,n)}function En(t,e,n,r,s=n){const i=$g(n),o=e[i],a=e[`${n}Start`];!a||!o||Se(t,r+x(a),r+x(o),{op:`browser.${s}`,name:e.name,attributes:{[J]:"auto.ui.browser.metrics",...n==="redirect"&&e.redirectCount!=null?{"http.redirect_count":e.redirectCount}:{}}})}function $g(t){return t==="secureConnection"?"connectEnd":t==="fetch"?"domainLookupStart":`${t}End`}function Dg(t,e,n){const r=n+x(e.requestStart),s=n+x(e.responseEnd),i=n+x(e.responseStart);e.responseEnd&&(Se(t,r,s,{op:"browser.request",name:e.name,attributes:{[J]:"auto.ui.browser.metrics"}}),Se(t,i,s,{op:"browser.response",name:e.name,attributes:{[J]:"auto.ui.browser.metrics"}}))}function xg(t,e,n,r,s,i,o){if(e.initiatorType==="xmlhttprequest"||e.initiatorType==="fetch")return;const a=e.initiatorType?`resource.${e.initiatorType}`:"resource.other";if(o!=null&&o.includes(a))return;const c=xh(n),u={[J]:"auto.resource.browser.metrics"};Rr(u,e,"transferSize","http.response_transfer_size"),Rr(u,e,"encodedBodySize","http.response_content_length"),Rr(u,e,"decodedBodySize","http.decoded_response_content_length");const l=e.deliveryType;l!=null&&(u["http.response_delivery_type"]=l);const d=e.renderBlockingStatus;if(d&&(u["resource.render_blocking_status"]=d),c.protocol&&(u["url.scheme"]=c.protocol.split(":").pop()),c.host&&(u["server.address"]=c.host),u["url.same_origin"]=n.includes(v.location.origin),e.nextHopProtocol!=null){const{name:m,version:h}=Tc(e.nextHopProtocol);u["network.protocol.name"]=m,u["network.protocol.version"]=h}const p=i+r,f=p+s;Se(t,p,f,{name:n.replace(v.location.origin,""),op:a,attributes:u})}function Fg(t){const e=v.navigator;if(!e)return;const n=e.connection;n&&(n.effectiveType&&t.setAttribute("effectiveConnectionType",n.effectiveType),n.type&&t.setAttribute("connectionType",n.type),vr(n.rtt)&&(z["connection.rtt"]={value:n.rtt,unit:"millisecond"})),vr(e.deviceMemory)&&t.setAttribute("deviceMemory",`${e.deviceMemory} GB`),vr(e.hardwareConcurrency)&&t.setAttribute("hardwareConcurrency",String(e.hardwareConcurrency))}function Ug(t,e){Y&&e.recordLcpOnPageloadSpan&&(Y.element&&t.setAttribute("lcp.element",De(Y.element)),Y.id&&t.setAttribute("lcp.id",Y.id),Y.url&&t.setAttribute("lcp.url",Y.url.trim().slice(0,200)),Y.loadTime!=null&&t.setAttribute("lcp.loadTime",Y.loadTime),Y.renderTime!=null&&t.setAttribute("lcp.renderTime",Y.renderTime),t.setAttribute("lcp.size",Y.size)),dt!=null&&dt.sources&&e.recordClsOnPageloadSpan&&dt.sources.forEach((n,r)=>t.setAttribute(`cls.source.${r+1}`,De(n.node)))}function Rr(t,e,n,r){const s=e[n];s!=null&&s<Tg&&(t[r]=s)}function Mg(t){const e=cn(!1);if(!e)return;const{responseStart:n,requestStart:r}=e;r<=n&&(t["ttfb.requestTime"]={value:n-r,unit:"millisecond"})}function Hg(){return ar()&&ce()?Tt("element",jg):()=>{}}const jg=({entries:t})=>{const e=xe(),n=e?te(e):void 0,r=n?K(n).description:de().getScopeData().transactionName;t.forEach(s=>{var f,m;const i=s;if(!i.identifier)return;const o=i.name,a=i.renderTime,c=i.loadTime,[u,l]=c?[x(c),"load-time"]:a?[x(a),"render-time"]:[Ae(),"entry-emission"],d=o==="image-paint"?x(Math.max(0,(a??0)-(c??0))):0,p={[J]:"auto.ui.browser.elementtiming",[et]:"ui.elementtiming",[Yt]:"component","sentry.span_start_time_source":l,"sentry.transaction_name":r,"element.id":i.id,"element.type":((m=(f=i.element)==null?void 0:f.tagName)==null?void 0:m.toLowerCase())||"unknown","element.size":i.naturalWidth&&i.naturalHeight?`${i.naturalWidth}x${i.naturalHeight}`:void 0,"element.render_time":a,"element.load_time":c,"element.url":i.url||void 0,"element.identifier":i.identifier,"element.paint_type":o};Ph({name:`element[${i.identifier}]`,attributes:p,startTime:u,onlyIfParent:!0},h=>{h.end(u+d)})})},Bg=1e3;let so,Zr,es;function qg(t){const e="dom";Ns(e,t),Ls(e,Gg)}function Gg(){if(!v.document)return;const t=Jt.bind(null,"dom"),e=io(t,!0);v.document.addEventListener("click",e,!1),v.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(n=>{var i,o;const s=(i=v[n])==null?void 0:i.prototype;(o=s==null?void 0:s.hasOwnProperty)!=null&&o.call(s,"addEventListener")&&(Un(s,"addEventListener",function(a){return function(c,u,l){if(c==="click"||c=="keypress")try{const d=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},p=d[c]=d[c]||{refCount:0};if(!p.handler){const f=io(t);p.handler=f,a.call(this,c,f,l)}p.refCount++}catch{}return a.call(this,c,u,l)}}),Un(s,"removeEventListener",function(a){return function(c,u,l){if(c==="click"||c=="keypress")try{const d=this.__sentry_instrumentation_handlers__||{},p=d[c];p&&(p.refCount--,p.refCount<=0&&(a.call(this,c,p.handler,l),p.handler=void 0,delete d[c]),Object.keys(d).length===0&&delete this.__sentry_instrumentation_handlers__)}catch{}return a.call(this,c,u,l)}}))})}function Vg(t){if(t.type!==Zr)return!1;try{if(!t.target||t.target._sentryId!==es)return!1}catch{}return!0}function zg(t,e){return t!=="keypress"?!1:e!=null&&e.tagName?!(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable):!0}function io(t,e=!1){return n=>{if(!n||n._sentryCaptured)return;const r=Wg(n);if(zg(n.type,r))return;_e(n,"_sentryCaptured",!0),r&&!r._sentryId&&_e(r,"_sentryId",We());const s=n.type==="keypress"?"input":n.type;Vg(n)||(t({event:n,name:s,global:e}),Zr=n.type,es=r?r._sentryId:void 0),clearTimeout(so),so=v.setTimeout(()=>{es=void 0,Zr=void 0},Bg)}}function Wg(t){try{return t.target}catch{return null}}let yn;function js(t){const e="history";Ns(e,t),Ls(e,Kg)}function Kg(){if(v.addEventListener("popstate",()=>{const e=v.location.href,n=yn;if(yn=e,n===e)return;Jt("history",{from:n,to:e})}),!Fh())return;function t(e){return function(...n){const r=n.length>2?n[2]:void 0;if(r){const s=yn,i=Jg(String(r));if(yn=i,s===i)return e.apply(this,n);Jt("history",{from:s,to:i})}return e.apply(this,n)}}Un(v.history,"pushState",t),Un(v.history,"replaceState",t)}function Jg(t){try{return new URL(t,v.location.origin).toString()}catch{return t}}const On={};function Yg(t){const e=On[t];if(e)return e;let n=v[t];if(Uh(n))return On[t]=n.bind(v);const r=v.document;if(r&&typeof r.createElement=="function")try{const s=r.createElement("iframe");s.hidden=!0,r.head.appendChild(s);const i=s.contentWindow;i!=null&&i[t]&&(n=i[t]),r.head.removeChild(s)}catch(s){rr&&er.warn(`Could not create sandbox iframe for ${t} check, bailing to window.${t}: `,s)}return n&&(On[t]=n.bind(v))}function oo(t){On[t]=void 0}const pt="__sentry_xhr_v3__";function vc(t){const e="xhr";Ns(e,t),Ls(e,Xg)}function Xg(){if(!v.XMLHttpRequest)return;const t=XMLHttpRequest.prototype;t.open=new Proxy(t.open,{apply(e,n,r){const s=new Error,i=Ae()*1e3,o=Ce(r[0])?r[0].toUpperCase():void 0,a=Qg(r[1]);if(!o||!a)return e.apply(n,r);n[pt]={method:o,url:a,request_headers:{}},o==="POST"&&a.match(/sentry_key/)&&(n.__sentry_own_request__=!0);const c=()=>{const u=n[pt];if(u&&n.readyState===4){try{u.status_code=n.status}catch{}const l={endTimestamp:Ae()*1e3,startTimestamp:i,xhr:n,virtualError:s};Jt("xhr",l)}};return"onreadystatechange"in n&&typeof n.onreadystatechange=="function"?n.onreadystatechange=new Proxy(n.onreadystatechange,{apply(u,l,d){return c(),u.apply(l,d)}}):n.addEventListener("readystatechange",c),n.setRequestHeader=new Proxy(n.setRequestHeader,{apply(u,l,d){const[p,f]=d,m=l[pt];return m&&Ce(p)&&Ce(f)&&(m.request_headers[p.toLowerCase()]=f),u.apply(l,d)}}),e.apply(n,r)}}),t.send=new Proxy(t.send,{apply(e,n,r){const s=n[pt];if(!s)return e.apply(n,r);r[0]!==void 0&&(s.body=r[0]);const i={startTimestamp:Ae()*1e3,xhr:n};return Jt("xhr",i),e.apply(n,r)}})}function Qg(t){if(Ce(t))return t;try{return t.toString()}catch{}}const wr=[],Nn=new Map,Zg=60;function em(){if(ar()&&ce()){const e=tm();return()=>{e()}}return()=>{}}const ao={click:"click",pointerdown:"click",pointerup:"click",mousedown:"click",mouseup:"click",touchstart:"click",touchend:"click",mouseover:"hover",mouseout:"hover",mouseenter:"hover",mouseleave:"hover",pointerover:"hover",pointerout:"hover",pointerenter:"hover",pointerleave:"hover",dragstart:"drag",dragend:"drag",drag:"drag",dragenter:"drag",dragleave:"drag",dragover:"drag",drop:"drag",keydown:"press",keyup:"press",keypress:"press",input:"press"};function tm(){return ug(nm)}const nm=({metric:t})=>{if(t.value==null)return;const e=x(t.value);if(e>Zg)return;const n=t.entries.find(m=>m.duration===t.value&&ao[m.name]);if(!n)return;const{interactionId:r}=n,s=ao[n.name],i=x(ce()+n.startTime),o=xe(),a=o?te(o):void 0,u=(r!=null?Nn.get(r):void 0)||a,l=u?K(u).description:de().getScopeData().transactionName,d=De(n.target),p={[J]:"auto.http.browser.inp",[et]:`ui.interaction.${s}`,[tr]:n.duration},f=Hs({name:d,transaction:l,attributes:p,startTime:i});f&&(f.addEvent("inp",{[sn]:"millisecond",[on]:t.value}),f.end(i+e))};function rm(){const t=({entries:e})=>{const n=xe(),r=n&&te(n);e.forEach(s=>{if(!mg(s)||!r)return;const i=s.interactionId;if(i!=null&&!Nn.has(i)){if(wr.length>10){const o=wr.shift();Nn.delete(o)}wr.push(i),Nn.set(i,r)}})};Tt("event",t),Tt("first-input",t)}function sm(t,e=Yg("fetch")){let n=0,r=0;function s(i){const o=i.body.length;n+=o,r++;const a={body:i.body,method:"POST",referrerPolicy:"strict-origin",headers:t.headers,keepalive:n<=6e4&&r<15,...t.fetchOptions};if(!e)return oo("fetch"),xn("No fetch implementation available");try{return e(t.url,a).then(c=>(n-=o,r--,{statusCode:c.status,headers:{"x-sentry-rate-limits":c.headers.get("X-Sentry-Rate-Limits"),"retry-after":c.headers.get("Retry-After")}}))}catch(c){return oo("fetch"),n-=o,r--,xn(c)}}return Ep(t,s)}const im=30,om=50;function ts(t,e,n,r){const s={filename:t,function:e==="<anonymous>"?Ke:e,in_app:!0};return n!==void 0&&(s.lineno=n),r!==void 0&&(s.colno=r),s}const am=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,cm=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,um=/\((\S*)(?::(\d+))(?::(\d+))\)/,lm=t=>{const e=am.exec(t);if(e){const[,r,s,i]=e;return ts(r,Ke,+s,+i)}const n=cm.exec(t);if(n){if(n[2]&&n[2].indexOf("eval")===0){const o=um.exec(n[2]);o&&(n[2]=o[1],n[3]=o[2],n[4]=o[3])}const[s,i]=Rc(n[1]||Ke,n[2]);return ts(i,s,n[3]?+n[3]:void 0,n[4]?+n[4]:void 0)}},dm=[im,lm],pm=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,fm=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,hm=t=>{const e=pm.exec(t);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const i=fm.exec(e[3]);i&&(e[1]=e[1]||"eval",e[3]=i[1],e[4]=i[2],e[5]="")}let r=e[3],s=e[1]||Ke;return[s,r]=Rc(s,r),ts(r,s,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}},gm=[om,hm],mm=[dm,gm],_m=Po(...mm),Rc=(t,e)=>{const n=t.indexOf("safari-extension")!==-1,r=t.indexOf("safari-web-extension")!==-1;return n||r?[t.indexOf("@")!==-1?t.split("@")[0]:Ke,n?`safari-extension:${e}`:`safari-web-extension:${e}`]:[t,e]},X=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Tn=1024,Sm="Breadcrumbs",Em=(t={})=>{const e={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...t};return{name:Sm,setup(n){e.console&&Hp(Im(n)),e.dom&&qg(bm(n,e.dom)),e.xhr&&vc(vm(n)),e.fetch&&La(Rm(n)),e.history&&js(wm(n)),e.sentry&&n.on("beforeSendEvent",Tm(n))}}},ym=Em;function Tm(t){return function(n){P()===t&&$e({category:`sentry.${n.type==="transaction"?"transaction":"event"}`,event_id:n.event_id,level:n.level,message:je(n)},{event:n})}}function bm(t,e){return function(r){if(P()!==t)return;let s,i,o=typeof e=="object"?e.serializeAttribute:void 0,a=typeof e=="object"&&typeof e.maxStringLength=="number"?e.maxStringLength:void 0;a&&a>Tn&&(X&&ee.warn(`\`dom.maxStringLength\` cannot exceed ${Tn}, but a value of ${a} was configured. Sentry will use ${Tn} instead.`),a=Tn),typeof o=="string"&&(o=[o]);try{const u=r.event,l=Cm(u)?u.target:u;s=Ho(l,{keyAttrs:o,maxStringLength:a}),i=nl(l)}catch{s="<unknown>"}if(s.length===0)return;const c={category:`ui.${r.name}`,message:s};i&&(c.data={"ui.component_name":i}),$e(c,{event:r.event,name:r.name,global:r.global})}}function Im(t){return function(n){if(P()!==t)return;const r={category:"console",data:{arguments:n.args,logger:"console"},level:Bp(n.level),message:ri(n.args," ")};if(n.level==="assert")if(n.args[0]===!1)r.message=`Assertion failed: ${ri(n.args.slice(1)," ")||"console.assert"}`,r.data.arguments=n.args.slice(1);else return;$e(r,{input:n.args,level:n.level})}}function vm(t){return function(n){if(P()!==t)return;const{startTimestamp:r,endTimestamp:s}=n,i=n.xhr[pt];if(!r||!s||!i)return;const{method:o,url:a,status_code:c,body:u}=i,l={method:o,url:a,status_code:c},d={xhr:n.xhr,input:u,startTimestamp:r,endTimestamp:s},p={category:"xhr",data:l,type:"http",level:Na(c)};t.emit("beforeOutgoingRequestBreadcrumb",p,d),$e(p,d)}}function Rm(t){return function(n){if(P()!==t)return;const{startTimestamp:r,endTimestamp:s}=n;if(s&&!(n.fetchData.url.match(/sentry_key/)&&n.fetchData.method==="POST"))if(n.fetchData.method,n.fetchData.url,n.error){const i=n.fetchData,o={data:n.error,input:n.args,startTimestamp:r,endTimestamp:s},a={category:"fetch",data:i,level:"error",type:"http"};t.emit("beforeOutgoingRequestBreadcrumb",a,o),$e(a,o)}else{const i=n.response,o={...n.fetchData,status_code:i==null?void 0:i.status};n.fetchData.request_body_size,n.fetchData.response_body_size,i==null||i.status;const a={input:n.args,response:i,startTimestamp:r,endTimestamp:s},c={category:"fetch",data:o,type:"http",level:Na(o.status_code)};t.emit("beforeOutgoingRequestBreadcrumb",c,a),$e(c,a)}}}function wm(t){return function(n){if(P()!==t)return;let r=n.from,s=n.to;const i=ht(A.location.href);let o=r?ht(r):void 0;const a=ht(s);o!=null&&o.path||(o=i),i.protocol===a.protocol&&i.host===a.host&&(s=a.relative),i.protocol===o.protocol&&i.host===o.host&&(r=o.relative),$e({category:"navigation",data:{from:r,to:s}})}}function Cm(t){return!!t&&!!t.target}const Am=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],Om="BrowserApiErrors",Nm=(t={})=>{const e={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,unregisterOriginalCallbacks:!1,...t};return{name:Om,setupOnce(){e.setTimeout&&he(A,"setTimeout",co),e.setInterval&&he(A,"setInterval",co),e.requestAnimationFrame&&he(A,"requestAnimationFrame",km),e.XMLHttpRequest&&"XMLHttpRequest"in A&&he(XMLHttpRequest.prototype,"send",Pm);const n=e.eventTarget;n&&(Array.isArray(n)?n:Am).forEach(s=>$m(s,e))}}},Lm=Nm;function co(t){return function(...e){const n=e[0];return e[0]=Et(n,{mechanism:{data:{function:Oe(t)},handled:!1,type:"instrument"}}),t.apply(this,e)}}function km(t){return function(e){return t.apply(this,[Et(e,{mechanism:{data:{function:"requestAnimationFrame",handler:Oe(t)},handled:!1,type:"instrument"}})])}}function Pm(t){return function(...e){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(s=>{s in n&&typeof n[s]=="function"&&he(n,s,function(i){const o={mechanism:{data:{function:s,handler:Oe(i)},handled:!1,type:"instrument"}},a=fs(i);return a&&(o.mechanism.data.handler=Oe(a)),Et(i,o)})}),t.apply(this,e)}}function $m(t,e){var s,i;const r=(s=A[t])==null?void 0:s.prototype;(i=r==null?void 0:r.hasOwnProperty)!=null&&i.call(r,"addEventListener")&&(he(r,"addEventListener",function(o){return function(a,c,u){try{Dm(c)&&(c.handleEvent=Et(c.handleEvent,{mechanism:{data:{function:"handleEvent",handler:Oe(c),target:t},handled:!1,type:"instrument"}}))}catch{}return e.unregisterOriginalCallbacks&&xm(this,a,c),o.apply(this,[a,Et(c,{mechanism:{data:{function:"addEventListener",handler:Oe(c),target:t},handled:!1,type:"instrument"}}),u])}}),he(r,"removeEventListener",function(o){return function(a,c,u){try{const l=c.__sentry_wrapped__;l&&o.call(this,a,l,u)}catch{}return o.call(this,a,c,u)}}))}function Dm(t){return typeof t.handleEvent=="function"}function xm(t,e,n){t&&typeof t=="object"&&"removeEventListener"in t&&typeof t.removeEventListener=="function"&&t.removeEventListener(e,n)}const Fm=()=>({name:"BrowserSession",setupOnce(){if(typeof A.document>"u"){X&&ee.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.");return}wi({ignoreDuration:!0}),Ci(),js(({from:t,to:e})=>{t!==void 0&&t!==e&&(wi({ignoreDuration:!0}),Ci())})}}),Um="GlobalHandlers",Mm=(t={})=>{const e={onerror:!0,onunhandledrejection:!0,...t};return{name:Um,setupOnce(){Error.stackTraceLimit=50},setup(n){e.onerror&&(jm(n),uo("onerror")),e.onunhandledrejection&&(Bm(n),uo("onunhandledrejection"))}}},Hm=Mm;function jm(t){$o(e=>{const{stackParser:n,attachStacktrace:r}=wc();if(P()!==t||Pa())return;const{msg:s,url:i,line:o,column:a,error:c}=e,u=Vm(Rs(n,c||s,void 0,r,!1),i,o,a);u.level="error",ha(u,{originalException:c,mechanism:{handled:!1,type:"onerror"}})})}function Bm(t){Do(e=>{const{stackParser:n,attachStacktrace:r}=wc();if(P()!==t||Pa())return;const s=qm(e),i=ds(s)?Gm(s):Rs(n,s,void 0,r,!0);i.level="error",ha(i,{originalException:s,mechanism:{handled:!1,type:"onunhandledrejection"}})})}function qm(t){if(ds(t))return t;try{if("reason"in t)return t.reason;if("detail"in t&&"reason"in t.detail)return t.detail.reason}catch{}return t}function Gm(t){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(t)}`}]}}}function Vm(t,e,n,r){const s=t.exception=t.exception||{},i=s.values=s.values||[],o=i[0]=i[0]||{},a=o.stacktrace=o.stacktrace||{},c=a.frames=a.frames||[],u=r,l=n,d=qt(e)&&e.length>0?e:en();return c.length===0&&c.push({colno:u,filename:d,function:Ke,in_app:!0,lineno:l}),t}function uo(t){X&&ee.log(`Global Handler attached: ${t}`)}function wc(){const t=P();return(t==null?void 0:t.getOptions())||{stackParser:()=>[],attachStacktrace:!1}}const zm=()=>({name:"HttpContext",preprocessEvent(t){var r;if(!A.navigator&&!A.location&&!A.document)return;const e=bs(),n={...e.headers,...(r=t.request)==null?void 0:r.headers};t.request={...e,...t.request,headers:n}}}),Wm="cause",Km=5,Jm="LinkedErrors",Ym=(t={})=>{const e=t.limit||Km,n=t.key||Wm;return{name:Jm,preprocessEvent(r,s,i){const o=i.getOptions();Mp(Is,o.stackParser,n,e,r,s)}}},Xm=Ym;function Qm(){return Zm()?(X&&It(()=>{console.error("[Sentry] You cannot use Sentry.init() in a browser extension, see: https://docs.sentry.io/platforms/javascript/best-practices/browser-extensions/")}),!0):!1}function Zm(){var i;if(typeof A.window>"u")return!1;const t=A;if(t.nw)return!1;const e=t.chrome||t.browser;if(!((i=e==null?void 0:e.runtime)!=null&&i.id))return!1;const n=en(),r=["chrome-extension","moz-extension","ms-browser-extension","safari-web-extension"];return!(A===A.top&&r.some(o=>n.startsWith(`${o}://`)))}function e_(t){return[Lp(),Cp(),Lm(),ym(),Hm(),Xm(),Vp(),zm(),Fm()]}function t_(t={}){const e=!t.skipBrowserExtensionCheck&&Qm(),n={...t,enabled:e?!1:t.enabled,stackParser:zu(t.stackParser||_m),integrations:Zd({integrations:t.integrations,defaultIntegrations:t.defaultIntegrations==null?e_():t.defaultIntegrations}),transport:t.transport||sm};return lp(wf,n)}function n_(t={}){const e=A.document,n=(e==null?void 0:e.head)||(e==null?void 0:e.body);if(!n){X&&ee.error("[showReportDialog] Global document not defined");return}const r=U(),s=P(),i=s==null?void 0:s.getDsn();if(!i){X&&ee.error("[showReportDialog] DSN not configured");return}const o={...t,user:{...r.getUser(),...t.user},eventId:t.eventId||Vd()},a=A.document.createElement("script");a.async=!0,a.crossOrigin="anonymous",a.src=Xd(i,o);const{onLoad:c,onClose:u}=o;if(c&&(a.onload=c),u){const l=d=>{if(d.data==="__sentry_reportdialog_closed__")try{u()}finally{A.removeEventListener("message",l)}};A.addEventListener("message",l)}n.appendChild(a)}function ue(t=0){return((hs()||performance.timeOrigin)+t)/1e3}function r_(t){const e=[];if(t.nextHopProtocol!=null){const{name:n,version:r}=Tc(t.nextHopProtocol);e.push(["network.protocol.version",r],["network.protocol.name",n])}return hs()?[...e,["http.request.redirect_start",ue(t.redirectStart)],["http.request.fetch_start",ue(t.fetchStart)],["http.request.domain_lookup_start",ue(t.domainLookupStart)],["http.request.domain_lookup_end",ue(t.domainLookupEnd)],["http.request.connect_start",ue(t.connectStart)],["http.request.secure_connection_start",ue(t.secureConnectionStart)],["http.request.connection_end",ue(t.connectEnd)],["http.request.request_start",ue(t.requestStart)],["http.request.response_start",ue(t.responseStart)],["http.request.response_end",ue(t.responseEnd)]]:e}const lo=new WeakMap,Cr=new Map,Cc={traceFetch:!0,traceXHR:!0,enableHTTPTimings:!0,trackFetchStreamPerformance:!1};function s_(t,e){const{traceFetch:n,traceXHR:r,trackFetchStreamPerformance:s,shouldCreateSpanForRequest:i,enableHTTPTimings:o,tracePropagationTargets:a,onRequestSpanStart:c}={...Cc,...e},u=typeof i=="function"?i:p=>!0,l=p=>o_(p,a),d={};n&&(t.addEventProcessor(p=>(p.type==="transaction"&&p.spans&&p.spans.forEach(f=>{if(f.op==="http.client"){const m=Cr.get(f.span_id);m&&(f.timestamp=m/1e3,Cr.delete(f.span_id))}}),p)),s&&af(p=>{if(p.response){const f=lo.get(p.response);f&&p.endTimestamp&&Cr.set(f,p.endTimestamp)}}),La(p=>{const f=Qp(p,u,l,d);if(p.response&&p.fetchData.__span&&lo.set(p.response,p.fetchData.__span),f){const m=Ac(p.fetchData.url),h=m?ht(m).host:void 0;f.setAttributes({"http.url":m,"server.address":h}),o&&po(f),c==null||c(f,{headers:p.headers})}})),r&&vc(p=>{var m;const f=a_(p,u,l,d);if(f){o&&po(f);let h;try{h=new Headers((m=p.xhr.__sentry_xhr_v3__)==null?void 0:m.request_headers)}catch{}c==null||c(f,{headers:h})}})}function i_(t){return t.entryType==="resource"&&"initiatorType"in t&&typeof t.nextHopProtocol=="string"&&(t.initiatorType==="fetch"||t.initiatorType==="xmlhttprequest")}function po(t){const{url:e}=F(t).data;if(!e||typeof e!="string")return;const n=Tt("resource",({entries:r})=>{r.forEach(s=>{i_(s)&&s.name.endsWith(e)&&(r_(s).forEach(o=>t.setAttribute(...o)),setTimeout(n))})})}function o_(t,e){const n=en();if(n){let r,s;try{r=new URL(t,n),s=new URL(n).origin}catch{return!1}const i=r.origin===s;return e?Ge(r.toString(),e)||i&&Ge(r.pathname,e):i}else{const r=!!t.match(/^\/(?!\/)/);return e?Ge(t,e):r}}function a_(t,e,n,r){const s=t.xhr,i=s==null?void 0:s[pt];if(!s||s.__sentry_own_request__||!i)return;const{url:o,method:a}=i,c=Le()&&e(o);if(t.endTimestamp&&c){const h=s.__sentry_xhr_span_id__;if(!h)return;const T=r[h];T&&i.status_code!==void 0&&(Wo(T,i.status_code),T.end(),delete r[h]);return}const u=Ac(o),l=ht(u||o),d=Xp(o),p=!!wt(),f=c&&p?Zn({name:`${a} ${d}`,attributes:{url:o,type:"xhr","http.method":a,"http.url":u,"server.address":l==null?void 0:l.host,[Ye]:"auto.http.browser",[Wt]:"http.client",...(l==null?void 0:l.search)&&{"http.query":l==null?void 0:l.search},...(l==null?void 0:l.hash)&&{"http.fragment":l==null?void 0:l.hash}}}):new Xe;s.__sentry_xhr_span_id__=f.spanContext().spanId,r[s.__sentry_xhr_span_id__]=f,n(o)&&c_(s,Le()&&p?f:void 0);const m=P();return m&&m.emit("beforeOutgoingRequestSpan",f,t),f}function c_(t,e){const{"sentry-trace":n,baggage:r}=Ra({span:e});n&&u_(t,n,r)}function u_(t,e,n){var s;const r=(s=t.__sentry_xhr_v3__)==null?void 0:s.request_headers;if(!(r!=null&&r["sentry-trace"]))try{if(t.setRequestHeader("sentry-trace",e),n){const i=r==null?void 0:r.baggage;(!i||!l_(i))&&t.setRequestHeader("baggage",n)}}catch{}}function l_(t){return t.split(",").some(e=>e.trim().startsWith("sentry-"))}function Ac(t){try{return new URL(t,A.location.origin).href}catch{return}}function d_(){A.document?A.document.addEventListener("visibilitychange",()=>{const t=wt();if(!t)return;const e=ie(t);if(A.document.hidden&&e){const n="cancelled",{op:r,status:s}=F(e);X&&ee.log(`[Tracing] Transaction: ${n} -> since tab moved to the background, op: ${r}`),s||e.setStatus({code:V,message:n}),e.setAttribute("sentry.cancellation_reason","document.hidden"),e.end()}}):X&&ee.warn("[Tracing] Could not set up background tab detection due to lack of global document")}const p_=3600,Oc="sentry_previous_trace",f_="sentry.previous_trace";function h_(t,{linkPreviousTrace:e,consistentTraceSampling:n}){const r=e==="session-storage";let s=r?__():void 0;t.on("spanStart",o=>{if(ie(o)!==o)return;const a=U().getPropagationContext();s=g_(s,o,a),r&&m_(s)});let i=!0;n&&t.on("beforeSampling",o=>{if(!s)return;const a=U(),c=a.getPropagationContext();if(i&&c.parentSpanId){i=!1;return}a.setPropagationContext({...c,dsc:{...c.dsc,sample_rate:String(s.sampleRate),sampled:String(ns(s.spanContext))},sampleRand:s.sampleRand}),o.parentSampled=ns(s.spanContext),o.parentSampleRate=s.sampleRate,o.spanAttributes={...o.spanAttributes,[Vo]:s.sampleRate}})}function g_(t,e,n){const r=F(e);function s(){var a,c;try{return Number((a=n.dsc)==null?void 0:a.sample_rate)??Number((c=r.data)==null?void 0:c[gs])}catch{return 0}}const i={spanContext:e.spanContext(),startTimestamp:r.start_timestamp,sampleRate:s(),sampleRand:n.sampleRand};if(!t)return i;const o=t.spanContext;return o.traceId===r.trace_id?t:(Date.now()/1e3-t.startTimestamp<=p_&&(X&&ee.info(`Adding previous_trace ${o} link to span ${{op:r.op,...e.spanContext()}}`),e.addLink({context:o,attributes:{[Il]:"previous_trace"}}),e.setAttribute(f_,`${o.traceId}-${o.spanId}-${ns(o)?1:0}`)),i)}function m_(t){try{A.sessionStorage.setItem(Oc,JSON.stringify(t))}catch(e){X&&ee.warn("Could not store previous trace in sessionStorage",e)}}function __(){var t;try{const e=(t=A.sessionStorage)==null?void 0:t.getItem(Oc);return JSON.parse(e)}catch{return}}function ns(t){return t.traceFlags===1}const S_="BrowserTracing",E_={...wn,instrumentNavigation:!0,instrumentPageLoad:!0,markBackgroundSpan:!0,enableLongTask:!0,enableLongAnimationFrame:!0,enableInp:!0,enableElementTiming:!0,ignoreResourceSpans:[],ignorePerformanceApiSpans:[],detectRedirects:!0,linkPreviousTrace:"in-memory",consistentTraceSampling:!1,_experiments:{},...Cc},y_=(t={})=>{const e={name:void 0,source:void 0},n=A.document,{enableInp:r,enableElementTiming:s,enableLongTask:i,enableLongAnimationFrame:o,_experiments:{enableInteractions:a,enableStandaloneClsSpans:c,enableStandaloneLcpSpans:u},beforeStartSpan:l,idleTimeout:d,finalTimeout:p,childSpanTimeout:f,markBackgroundSpan:m,traceFetch:h,traceXHR:T,trackFetchStreamPerformance:I,shouldCreateSpanForRequest:R,enableHTTPTimings:C,ignoreResourceSpans:S,ignorePerformanceApiSpans:g,instrumentPageLoad:w,instrumentNavigation:q,detectRedirects:at,linkPreviousTrace:$t,consistentTraceSampling:ct,onRequestSpanStart:Fe}={...E_,...t};let M,Ue;function Te(D,H,$=!0){const j=H.op==="pageload",G=l?l(H):H,be=G.attributes||{};if(H.name!==G.name&&(be[ge]="custom",G.attributes=be),!$){const xt=rt();Zn({...G,startTime:xt}).end(xt);return}e.name=G.name,e.source=be[ge];const Ie=pa(G,{idleTimeout:d,finalTimeout:p,childSpanTimeout:f,disableAutoFinish:j,beforeSpanEnd:xt=>{M==null||M(),Ng(xt,{recordClsOnPageloadSpan:!c,recordLcpOnPageloadSpan:!u,ignoreResourceSpans:S,ignorePerformanceApiSpans:g}),ho(D,void 0);const Bs=U(),Lc=Bs.getPropagationContext();Bs.setPropagationContext({...Lc,traceId:Ie.spanContext().traceId,sampled:st(Ie),dsc:ke(xt)})}});ho(D,Ie);function Dt(){n&&["interactive","complete"].includes(n.readyState)&&D.emit("idleSpanEnableAutoFinish",Ie)}j&&n&&(n.addEventListener("readystatechange",()=>{Dt()}),Dt())}return{name:S_,setup(D){if(jl(),M=bg({recordClsStandaloneSpans:c||!1,recordLcpStandaloneSpans:u||!1}),r&&em(),s&&Hg(),o&&L.PerformanceObserver&&PerformanceObserver.supportedEntryTypes&&PerformanceObserver.supportedEntryTypes.includes("long-animation-frame")?vg():i&&Ig(),a&&Rg(),at&&n){const $=()=>{Ue=Z()};addEventListener("click",$,{capture:!0}),addEventListener("keydown",$,{capture:!0,passive:!0})}function H(){const $=Xt(D);$&&!F($).timestamp&&(X&&ee.log(`[Tracing] Finishing current active span with op: ${F($).op}`),$.setAttribute($n,"cancelled"),$.end())}D.on("startNavigationSpan",($,j)=>{if(P()!==D)return;if(j!=null&&j.isRedirect){X&&ee.warn("[Tracing] Detected redirect, navigation span will not be the root span, but a child span."),Te(D,{op:"navigation.redirect",...$},!1);return}H(),ae().setPropagationContext({traceId:Ne(),sampleRand:Math.random()});const G=U();G.setPropagationContext({traceId:Ne(),sampleRand:Math.random()}),G.setSDKProcessingMetadata({normalizedRequest:void 0}),Te(D,{op:"navigation",...$})}),D.on("startPageLoadSpan",($,j={})=>{if(P()!==D)return;H();const G=j.sentryTrace||fo("sentry-trace"),be=j.baggage||fo("baggage"),Ie=Pl(G,be),Dt=U();Dt.setPropagationContext(Ie),Dt.setSDKProcessingMetadata({normalizedRequest:bs()}),Te(D,{op:"pageload",...$})})},afterAllSetup(D){let H=en();if($t!=="off"&&h_(D,{linkPreviousTrace:$t,consistentTraceSampling:ct}),A.location){if(w){const $=hs();T_(D,{name:A.location.pathname,startTime:$?$/1e3:void 0,attributes:{[ge]:"url",[Ye]:"auto.pageload.browser"}})}q&&js(({to:$,from:j})=>{if(j===void 0&&(H==null?void 0:H.indexOf($))!==-1){H=void 0;return}H=void 0;const G=Oa($),be=Xt(D),Ie=be&&at&&v_(be,Ue);b_(D,{name:(G==null?void 0:G.pathname)||A.location.pathname,attributes:{[ge]:"url",[Ye]:"auto.navigation.browser"}},{url:$,isRedirect:Ie})})}m&&d_(),a&&I_(D,d,p,f,e),r&&rm(),s_(D,{traceFetch:h,traceXHR:T,trackFetchStreamPerformance:I,tracePropagationTargets:D.getOptions().tracePropagationTargets,shouldCreateSpanForRequest:R,enableHTTPTimings:C,onRequestSpanStart:Fe})}}};function T_(t,e,n){return t.emit("startPageLoadSpan",e,n),U().setTransactionName(e.name),Xt(t)}function b_(t,e,n){const{url:r,isRedirect:s}=n||{};t.emit("beforeStartNavigationSpan",e,{isRedirect:s}),t.emit("startNavigationSpan",e,{isRedirect:s});const i=U();return i.setTransactionName(e.name),r&&!s&&i.setSDKProcessingMetadata({normalizedRequest:{...bs(),url:r}}),Xt(t)}function fo(t){const e=A.document,n=e==null?void 0:e.querySelector(`meta[name=${t}]`);return(n==null?void 0:n.getAttribute("content"))||void 0}function I_(t,e,n,r,s){const i=A.document;let o;const a=()=>{const c="ui.action.click",u=Xt(t);if(u){const l=F(u).op;if(["navigation","pageload"].includes(l)){X&&ee.warn(`[Tracing] Did not create ${c} span because a pageload or navigation span is in progress.`);return}}if(o&&(o.setAttribute($n,"interactionInterrupted"),o.end(),o=void 0),!s.name){X&&ee.warn(`[Tracing] Did not create ${c} transaction because _latestRouteName is missing.`);return}o=pa({name:s.name,op:c,attributes:{[ge]:s.source||"url"}},{idleTimeout:e,finalTimeout:n,childSpanTimeout:r})};i&&addEventListener("click",a,{capture:!0})}const Nc="_sentry_idleSpan";function Xt(t){return t[Nc]}function ho(t,e){oe(t,Nc,e)}const go=.3;function v_(t,e){const n=F(t),r=rt(),s=n.start_timestamp;return!(r-s>go||e&&r-e<=go)}const mo="9.38.0";function R_(t,e,n=[e],r="npm"){const s=t._metadata||{};s.sdk||(s.sdk={name:`sentry.javascript.${e}`,packages:n.map(i=>({name:`${r}:@sentry/${i}`,version:mo})),version:mo}),t._metadata=s}function w_(t){const e={...t};return R_(e,"react"),ga("react",{version:k.version}),t_(e)}class C_{constructor(){this.isInitialized=!1,console.log("Sentry explicitly disabled via VITE_ENABLE_SENTRY")}init(){const e=le.getConfig();if(!e.sentry.dsn){He.warn("Sentry DSN not provided, error tracking disabled");return}try{w_({dsn:e.sentry.dsn,environment:e.sentry.environment,debug:le.isDevelopment,integrations:[y_({tracePropagationTargets:[e.api.pocketbaseUrl,e.api.baseUrl,e.api.aiServiceUrl]})],tracesSampleRate:le.isProduction?.1:1,sampleRate:le.isProduction?.8:1,release:`${e.app.name}@${e.app.version}`,beforeSend:(n,r)=>this.beforeSendFilter(n,r),initialScope:{tags:{component:"react-app",version:e.app.version}}}),this.isInitialized=!0,He.info("Sentry initialized successfully")}catch(n){He.error("Failed to initialize Sentry",{error:n.message})}}beforeSendFilter(e,n){var r,s,i,o,a,c,u,l;return le.isDevelopment&&(o=(i=(s=(r=e.exception)==null?void 0:r.values)==null?void 0:s[0])==null?void 0:i.value)!=null&&o.includes("Loading chunk")||(l=(u=(c=(a=e.exception)==null?void 0:a.values)==null?void 0:c[0])==null?void 0:u.value)!=null&&l.includes("Extension context invalidated")?null:(n.originalException&&(e.extra={...e.extra,originalException:n.originalException}),e)}captureException(e,n={}){if(!this.isInitialized){He.error("Sentry not initialized, logging error locally",{error:e,context:n});return}zt(r=>{Object.keys(n).forEach(s=>{r.setContext(s,n[s])}),fa(e)})}captureMessage(e,n="info",r={}){if(!this.isInitialized){He.info(`Sentry message: ${e}`,r);return}zt(s=>{Object.keys(r).forEach(i=>{s.setContext(i,r[i])}),s.setLevel(n),qd(e)})}setUser(e){this.isInitialized&&Ri({id:e.id,email:e.email,username:e.username||e.name})}clearUser(){this.isInitialized&&Ri(null)}addBreadcrumb(e,n="custom",r="info",s={}){this.isInitialized&&$e({message:e,category:n,level:r,data:s,timestamp:Date.now()/1e3})}setTag(e,n){this.isInitialized&&Gd(e,n)}setContext(e,n){this.isInitialized&&ga(e,n)}startTransaction(e,n="navigation"){return this.isInitialized?(void 0)({name:e,op:n}):null}measure(e,n){if(!this.isInitialized)return n();const r=this.startTransaction(e,"function");try{const s=n();return s&&typeof s.then=="function"?s.finally(()=>{r==null||r.finish()}):(r==null||r.finish(),s)}catch(s){throw r==null||r.setStatus("internal_error"),r==null||r.finish(),s}}captureApiCall(e,n,r,s){var o;if(!this.isInitialized)return;this.addBreadcrumb(`${n} ${e} - ${r}`,"http",r>=400?"error":"info",{url:e,method:n,status:r,duration:s});const i=(o=(void 0)().getScope())==null?void 0:o.getSpan();if(i){const a=i.startChild({op:"http.client",description:`${n} ${e}`});a.setData("http.method",n),a.setData("http.url",e),a.setData("http.status_code",r),a.setData("duration",s),a.finish()}}showReportDialog(e={}){this.isInitialized&&n_({title:"Report a Problem",subtitle:"Help us improve the application",subtitle2:"Your feedback is valuable to us.",labelName:"Name",labelEmail:"Email",labelComments:"What happened?",labelClose:"Close",labelSubmit:"Submit",...e})}isAvailable(){return this.isInitialized}}const Ar=new C_;class A_ extends fe.Component{constructor(n){super(n);ut(this,"handleReportError",()=>{var n,r,s;if(Ar.isAvailable())Ar.showReportDialog({eventId:this.state.eventId});else{const i=encodeURIComponent("Application Error Report"),o=encodeURIComponent(`
Error: ${((n=this.state.error)==null?void 0:n.message)||"Unknown error"}
Stack: ${((r=this.state.error)==null?void 0:r.stack)||"Not available"}
Component Stack: ${((s=this.state.errorInfo)==null?void 0:s.componentStack)||"Not available"}
      `);window.location.href=`mailto:support@flagfitpro.com?subject=${i}&body=${o}`}});ut(this,"handleReload",()=>{window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null,eventId:null}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(n,r){He.logError(n,"React Error Boundary");const s=Ar.captureException(n,{errorBoundary:{componentStack:r.componentStack,errorBoundaryStack:r.errorBoundaryStack||"Not available"},react:{componentStack:r.componentStack}});this.setState({error:n,errorInfo:r,eventId:s})}render(){return this.state.hasError?_.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:_.jsx("div",{className:"max-w-md w-full mx-4",children:_.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-6 border-l-4 border-red-500",children:[_.jsxs("div",{className:"flex items-center mb-4",children:[_.jsx("div",{className:"flex-shrink-0",children:_.jsx("svg",{className:"h-8 w-8 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),_.jsx("div",{className:"ml-3",children:_.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Something went wrong"})})]}),_.jsxs("div",{className:"mb-4",children:[_.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"We're sorry for the inconvenience. An unexpected error occurred while loading this page."}),this.state.error&&_.jsx("div",{className:"bg-gray-50 p-3 rounded text-xs text-gray-700 font-mono",children:this.state.error.message})]}),_.jsxs("div",{className:"flex space-x-3",children:[_.jsx("button",{onClick:this.handleReload,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Reload Page"}),_.jsx("button",{onClick:this.handleReportError,className:"flex-1 bg-gray-100 text-gray-700 px-4 py-2 rounded-md text-sm font-medium hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",children:"Report Error"})]}),_.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:_.jsxs("p",{className:"text-xs text-gray-500",children:["Error ID: ",this.state.eventId||"Not available"]})})]})})}):this.props.children}}const O_=k.lazy(()=>bt(()=>import("./LoginView-309cd0e5.js"),["assets/LoginView-309cd0e5.js","assets/query-73861c9c.js","assets/vendor-2fbe36df.js","assets/router-241b6e81.js","assets/state-acab8a68.js","assets/ui-300eb2b0.js"])),N_=k.lazy(()=>bt(()=>import("./RegisterView-ef4d2cb0.js"),["assets/RegisterView-ef4d2cb0.js","assets/query-73861c9c.js","assets/vendor-2fbe36df.js","assets/router-241b6e81.js","assets/state-acab8a68.js","assets/ui-300eb2b0.js"])),L_=k.lazy(()=>bt(()=>import("./DashboardView-6ede2fcd.js"),["assets/DashboardView-6ede2fcd.js","assets/query-73861c9c.js","assets/vendor-2fbe36df.js","assets/router-241b6e81.js","assets/state-acab8a68.js","assets/ui-300eb2b0.js"])),k_=k.lazy(()=>bt(()=>import("./TrainingView-a028bf1f.js"),["assets/TrainingView-a028bf1f.js","assets/query-73861c9c.js","assets/vendor-2fbe36df.js"])),P_=k.lazy(()=>bt(()=>import("./ProfileView-98922ca6.js"),["assets/ProfileView-98922ca6.js","assets/query-73861c9c.js","assets/vendor-2fbe36df.js"])),$_=k.lazy(()=>bt(()=>import("./OnboardingView-ebfa7465.js"),["assets/OnboardingView-ebfa7465.js","assets/query-73861c9c.js","assets/vendor-2fbe36df.js","assets/router-241b6e81.js","assets/state-acab8a68.js","assets/ui-300eb2b0.js"])),bn=({children:t})=>{const{isAuthenticated:e,isLoading:n}=Wn();return n?_.jsx(Kn,{}):e?t:_.jsx(rs,{to:"/login",replace:!0})},_o=({children:t})=>{const{isAuthenticated:e,isLoading:n}=Wn();return n?_.jsx(Kn,{}):e?_.jsx(rs,{to:"/dashboard",replace:!0}):t},D_=()=>_.jsx(Fc,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:_.jsx(k.Suspense,{fallback:_.jsx("div",{className:"min-h-screen flex items-center justify-center",children:_.jsx(Kn,{size:"lg"})}),children:_.jsxs(Uc,{children:[_.jsx(ve,{path:"/login",element:_.jsx(_o,{children:_.jsx(O_,{})})}),_.jsx(ve,{path:"/register",element:_.jsx(_o,{children:_.jsx(N_,{})})}),_.jsx(ve,{path:"/dashboard",element:_.jsx(bn,{children:_.jsx(L_,{})})}),_.jsx(ve,{path:"/training",element:_.jsx(bn,{children:_.jsx(k_,{})})}),_.jsx(ve,{path:"/profile",element:_.jsx(bn,{children:_.jsx(P_,{})})}),_.jsx(ve,{path:"/onboarding",element:_.jsx(bn,{children:_.jsx($_,{})})}),_.jsx(ve,{path:"/",element:_.jsx(rs,{to:"/dashboard",replace:!0})}),_.jsx(ve,{path:"*",element:_.jsx("div",{children:"Page not found"})})]})})}),x_=()=>{const{isOnline:t}=Cu(),{isDarkMode:e}=xu();return _.jsx(Hc,{theme:{algorithm:e?qs.darkAlgorithm:qs.defaultAlgorithm,token:{colorPrimary:"#3B82F6",colorSuccess:"#10B981",colorWarning:"#F59E0B",colorError:"#EF4444"}},children:_.jsxs("div",{className:"app",children:[!t&&_.jsx(Fu,{}),_.jsx(Eu,{children:_.jsx(Iu,{children:_.jsx(D_,{})})})]})})},F_=()=>_.jsx(A_,{children:_.jsx(wu,{children:_.jsx(fu,{children:_.jsx(x_,{})})})});He.info("Application starting",{timestamp:new Date().toISOString(),userAgent:navigator.userAgent,viewport:{width:window.innerWidth,height:window.innerHeight}});const U_=Or.createRoot(document.getElementById("root"));U_.render(_.jsx(fe.StrictMode,{children:_.jsx(F_,{})}));export{Kn as L,z_ as a,W_ as b,Wn as u};
//# sourceMappingURL=index-48d8d68d.js.map
