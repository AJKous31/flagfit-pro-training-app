const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LoginView-BlYSjgJi.js","assets/query-cAGX0zlL.js","assets/vendor-Bn2wlHXR.js","assets/router-D9S1wy5P.js","assets/state-Dysd2Yie.js","assets/ui-C5g3hUfe.js","assets/RegisterView-DjOVWxmZ.js","assets/DashboardView-C6zp57Bm.js","assets/TrainingView-CyGNwCIP.js","assets/ProfileView-GtV9ClBi.js","assets/OnboardingView-ChZoCbxI.js","assets/TournamentsView-BIz4h_-F.js","assets/CommunityView-BOxvDMyr.js"])))=>i.map(i=>d[i]);
var yc=Object.defineProperty;var Ec=(t,e,n)=>e in t?yc(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var it=(t,e,n)=>Ec(t,typeof e!="symbol"?e+"":e,n);import{j as S,Q as Tc,a as bc}from"./query-cAGX0zlL.js";import{c as vc,r as A,R as Xr}from"./vendor-Bn2wlHXR.js";import{B as Ic,R as wc,a as ce,N as Rn}from"./router-D9S1wy5P.js";import{c as Rc}from"./state-Dysd2Yie.js";import{C as Cc,t as Ds}from"./ui-C5g3hUfe.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Ir={},Fs=vc;Ir.createRoot=Fs.createRoot,Ir.hydrateRoot=Fs.hydrateRoot;const Ac="modulepreload",Oc=function(t){return"/"+t},Us={},Le=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=Oc(c),c in Us)return;Us[c]=!0;const u=c.endsWith(".css"),l=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${l}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":Ac,u||(d.as="script"),d.crossOrigin="",d.href=c,a&&d.setAttribute("nonce",a),document.head.appendChild(d),u)return new Promise((p,f)=>{d.addEventListener("load",p),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};class Q extends Error{constructor(e){var n,r,s,i;super("ClientResponseError"),this.url="",this.status=0,this.response={},this.isAbort=!1,this.originalError=null,Object.setPrototypeOf(this,Q.prototype),e!==null&&typeof e=="object"&&(this.url=typeof e.url=="string"?e.url:"",this.status=typeof e.status=="number"?e.status:0,this.isAbort=!!e.isAbort,this.originalError=e.originalError,e.response!==null&&typeof e.response=="object"?this.response=e.response:e.data!==null&&typeof e.data=="object"?this.response=e.data:this.response={}),this.originalError||e instanceof Q||(this.originalError=e),typeof DOMException<"u"&&e instanceof DOMException&&(this.isAbort=!0),this.name="ClientResponseError "+this.status,this.message=(n=this.response)==null?void 0:n.message,this.message||(this.isAbort?this.message="The request was autocancelled. You can find more info in https://github.com/pocketbase/js-sdk#auto-cancellation.":(i=(s=(r=this.originalError)==null?void 0:r.cause)==null?void 0:s.message)!=null&&i.includes("ECONNREFUSED ::1")?this.message="Failed to connect to the PocketBase server. Try changing the SDK URL from localhost to 127.0.0.1 (https://github.com/pocketbase/js-sdk/issues/21).":this.message="Something went wrong."),this.cause=this.originalError}get data(){return this.response}toJSON(){return{...this}}}const an=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function kc(t,e){const n={};if(typeof t!="string")return n;const r=Object.assign({},{}).decode||Nc;let s=0;for(;s<t.length;){const i=t.indexOf("=",s);if(i===-1)break;let o=t.indexOf(";",s);if(o===-1)o=t.length;else if(o<i){s=t.lastIndexOf(";",i-1)+1;continue}const a=t.slice(s,i).trim();if(n[a]===void 0){let c=t.slice(i+1,o).trim();c.charCodeAt(0)===34&&(c=c.slice(1,-1));try{n[a]=r(c)}catch{n[a]=c}}s=o+1}return n}function Ms(t,e,n){const r=Object.assign({},n||{}),s=r.encode||Pc;if(!an.test(t))throw new TypeError("argument name is invalid");const i=s(e);if(i&&!an.test(i))throw new TypeError("argument val is invalid");let o=t+"="+i;if(r.maxAge!=null){const a=r.maxAge-0;if(isNaN(a)||!isFinite(a))throw new TypeError("option maxAge is invalid");o+="; Max-Age="+Math.floor(a)}if(r.domain){if(!an.test(r.domain))throw new TypeError("option domain is invalid");o+="; Domain="+r.domain}if(r.path){if(!an.test(r.path))throw new TypeError("option path is invalid");o+="; Path="+r.path}if(r.expires){if(!function(c){return Object.prototype.toString.call(c)==="[object Date]"||c instanceof Date}(r.expires)||isNaN(r.expires.valueOf()))throw new TypeError("option expires is invalid");o+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(o+="; HttpOnly"),r.secure&&(o+="; Secure"),r.priority)switch(typeof r.priority=="string"?r.priority.toLowerCase():r.priority){case"low":o+="; Priority=Low";break;case"medium":o+="; Priority=Medium";break;case"high":o+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return o}function Nc(t){return t.indexOf("%")!==-1?decodeURIComponent(t):t}function Pc(t){return encodeURIComponent(t)}const Lc=typeof navigator<"u"&&navigator.product==="ReactNative"||typeof global<"u"&&global.HermesInternal;let po;function ut(t){if(t)try{const e=decodeURIComponent(po(t.split(".")[1]).split("").map(function(n){return"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(e)||{}}catch{}return{}}function fo(t,e=0){let n=ut(t);return!(Object.keys(n).length>0&&(!n.exp||n.exp-e>Date.now()/1e3))}po=typeof atob!="function"||Lc?t=>{let e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,r,s=0,i=0,o="";r=e.charAt(i++);~r&&(n=s%4?64*n+r:r,s++%4)?o+=String.fromCharCode(255&n>>(-2*s&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return o}:atob;const js="pb_auth";class Qr{constructor(){this.baseToken="",this.baseModel=null,this._onChangeCallbacks=[]}get token(){return this.baseToken}get record(){return this.baseModel}get model(){return this.baseModel}get isValid(){return!fo(this.token)}get isSuperuser(){var n,r;let e=ut(this.token);return e.type=="auth"&&(((n=this.record)==null?void 0:n.collectionName)=="_superusers"||!((r=this.record)!=null&&r.collectionName)&&e.collectionId=="pbc_3142635823")}get isAdmin(){return console.warn("Please replace pb.authStore.isAdmin with pb.authStore.isSuperuser OR simply check the value of pb.authStore.record?.collectionName"),this.isSuperuser}get isAuthRecord(){return console.warn("Please replace pb.authStore.isAuthRecord with !pb.authStore.isSuperuser OR simply check the value of pb.authStore.record?.collectionName"),ut(this.token).type=="auth"&&!this.isSuperuser}save(e,n){this.baseToken=e||"",this.baseModel=n||null,this.triggerChange()}clear(){this.baseToken="",this.baseModel=null,this.triggerChange()}loadFromCookie(e,n=js){const r=kc(e||"")[n]||"";let s={};try{s=JSON.parse(r),(typeof s===null||typeof s!="object"||Array.isArray(s))&&(s={})}catch{}this.save(s.token||"",s.record||s.model||null)}exportToCookie(e,n=js){var c,u;const r={secure:!0,sameSite:!0,httpOnly:!0,path:"/"},s=ut(this.token);r.expires=s!=null&&s.exp?new Date(1e3*s.exp):new Date("1970-01-01"),e=Object.assign({},r,e);const i={token:this.token,record:this.record?JSON.parse(JSON.stringify(this.record)):null};let o=Ms(n,JSON.stringify(i),e);const a=typeof Blob<"u"?new Blob([o]).size:o.length;if(i.record&&a>4096){i.record={id:(c=i.record)==null?void 0:c.id,email:(u=i.record)==null?void 0:u.email};const l=["collectionId","collectionName","verified"];for(const d in this.record)l.includes(d)&&(i.record[d]=this.record[d]);o=Ms(n,JSON.stringify(i),e)}return o}onChange(e,n=!1){return this._onChangeCallbacks.push(e),n&&e(this.token,this.record),()=>{for(let r=this._onChangeCallbacks.length-1;r>=0;r--)if(this._onChangeCallbacks[r]==e)return delete this._onChangeCallbacks[r],void this._onChangeCallbacks.splice(r,1)}}triggerChange(){for(const e of this._onChangeCallbacks)e&&e(this.token,this.record)}}class xc extends Qr{constructor(e="pocketbase_auth"){super(),this.storageFallback={},this.storageKey=e,this._bindStorageEvent()}get token(){return(this._storageGet(this.storageKey)||{}).token||""}get record(){const e=this._storageGet(this.storageKey)||{};return e.record||e.model||null}get model(){return this.record}save(e,n){this._storageSet(this.storageKey,{token:e,record:n}),super.save(e,n)}clear(){this._storageRemove(this.storageKey),super.clear()}_storageGet(e){if(typeof window<"u"&&(window!=null&&window.localStorage)){const n=window.localStorage.getItem(e)||"";try{return JSON.parse(n)}catch{return n}}return this.storageFallback[e]}_storageSet(e,n){if(typeof window<"u"&&(window!=null&&window.localStorage)){let r=n;typeof n!="string"&&(r=JSON.stringify(n)),window.localStorage.setItem(e,r)}else this.storageFallback[e]=n}_storageRemove(e){var n;typeof window<"u"&&(window!=null&&window.localStorage)&&((n=window.localStorage)==null||n.removeItem(e)),delete this.storageFallback[e]}_bindStorageEvent(){typeof window<"u"&&(window!=null&&window.localStorage)&&window.addEventListener&&window.addEventListener("storage",e=>{if(e.key!=this.storageKey)return;const n=this._storageGet(this.storageKey)||{};super.save(n.token||"",n.record||n.model||null)})}}class Se{constructor(e){this.client=e}}class $c extends Se{async getAll(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/settings",e)}async update(e,n){return n=Object.assign({method:"PATCH",body:e},n),this.client.send("/api/settings",n)}async testS3(e="storage",n){return n=Object.assign({method:"POST",body:{filesystem:e}},n),this.client.send("/api/settings/test/s3",n).then(()=>!0)}async testEmail(e,n,r,s){return s=Object.assign({method:"POST",body:{email:n,template:r,collection:e}},s),this.client.send("/api/settings/test/email",s).then(()=>!0)}async generateAppleClientSecret(e,n,r,s,i,o){return o=Object.assign({method:"POST",body:{clientId:e,teamId:n,keyId:r,privateKey:s,duration:i}},o),this.client.send("/api/settings/apple/generate-client-secret",o)}}const Dc=["requestKey","$cancelKey","$autoCancel","fetch","headers","body","query","params","cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","signal","window"];function Zr(t){if(t){t.query=t.query||{};for(let e in t)Dc.includes(e)||(t.query[e]=t[e],delete t[e])}}function ho(t){const e=[];for(const n in t){const r=encodeURIComponent(n),s=Array.isArray(t[n])?t[n]:[t[n]];for(let i of s)i=Fc(i),i!==null&&e.push(r+"="+i)}return e.join("&")}function Fc(t){return t==null?null:t instanceof Date?encodeURIComponent(t.toISOString().replace("T"," ")):encodeURIComponent(typeof t=="object"?JSON.stringify(t):t)}class mo extends Se{constructor(){super(...arguments),this.clientId="",this.eventSource=null,this.subscriptions={},this.lastSentSubscriptions=[],this.maxConnectTimeout=15e3,this.reconnectAttempts=0,this.maxReconnectAttempts=1/0,this.predefinedReconnectIntervals=[200,300,500,1e3,1200,1500,2e3],this.pendingConnects=[]}get isConnected(){return!!this.eventSource&&!!this.clientId&&!this.pendingConnects.length}async subscribe(e,n,r){var o;if(!e)throw new Error("topic must be set.");let s=e;if(r){Zr(r=Object.assign({},r));const a="options="+encodeURIComponent(JSON.stringify({query:r.query,headers:r.headers}));s+=(s.includes("?")?"&":"?")+a}const i=function(a){const c=a;let u;try{u=JSON.parse(c==null?void 0:c.data)}catch{}n(u||{})};return this.subscriptions[s]||(this.subscriptions[s]=[]),this.subscriptions[s].push(i),this.isConnected?this.subscriptions[s].length===1?await this.submitSubscriptions():(o=this.eventSource)==null||o.addEventListener(s,i):await this.connect(),async()=>this.unsubscribeByTopicAndListener(e,i)}async unsubscribe(e){var r;let n=!1;if(e){const s=this.getSubscriptionsByTopic(e);for(let i in s)if(this.hasSubscriptionListeners(i)){for(let o of this.subscriptions[i])(r=this.eventSource)==null||r.removeEventListener(i,o);delete this.subscriptions[i],n||(n=!0)}}else this.subscriptions={};this.hasSubscriptionListeners()?n&&await this.submitSubscriptions():this.disconnect()}async unsubscribeByPrefix(e){var r;let n=!1;for(let s in this.subscriptions)if((s+"?").startsWith(e)){n=!0;for(let i of this.subscriptions[s])(r=this.eventSource)==null||r.removeEventListener(s,i);delete this.subscriptions[s]}n&&(this.hasSubscriptionListeners()?await this.submitSubscriptions():this.disconnect())}async unsubscribeByTopicAndListener(e,n){var i;let r=!1;const s=this.getSubscriptionsByTopic(e);for(let o in s){if(!Array.isArray(this.subscriptions[o])||!this.subscriptions[o].length)continue;let a=!1;for(let c=this.subscriptions[o].length-1;c>=0;c--)this.subscriptions[o][c]===n&&(a=!0,delete this.subscriptions[o][c],this.subscriptions[o].splice(c,1),(i=this.eventSource)==null||i.removeEventListener(o,n));a&&(this.subscriptions[o].length||delete this.subscriptions[o],r||this.hasSubscriptionListeners(o)||(r=!0))}this.hasSubscriptionListeners()?r&&await this.submitSubscriptions():this.disconnect()}hasSubscriptionListeners(e){var n,r;if(this.subscriptions=this.subscriptions||{},e)return!!((n=this.subscriptions[e])!=null&&n.length);for(let s in this.subscriptions)if((r=this.subscriptions[s])!=null&&r.length)return!0;return!1}async submitSubscriptions(){if(this.clientId)return this.addAllSubscriptionListeners(),this.lastSentSubscriptions=this.getNonEmptySubscriptionKeys(),this.client.send("/api/realtime",{method:"POST",body:{clientId:this.clientId,subscriptions:this.lastSentSubscriptions},requestKey:this.getSubscriptionsCancelKey()}).catch(e=>{if(!(e!=null&&e.isAbort))throw e})}getSubscriptionsCancelKey(){return"realtime_"+this.clientId}getSubscriptionsByTopic(e){const n={};e=e.includes("?")?e:e+"?";for(let r in this.subscriptions)(r+"?").startsWith(e)&&(n[r]=this.subscriptions[r]);return n}getNonEmptySubscriptionKeys(){const e=[];for(let n in this.subscriptions)this.subscriptions[n].length&&e.push(n);return e}addAllSubscriptionListeners(){if(this.eventSource){this.removeAllSubscriptionListeners();for(let e in this.subscriptions)for(let n of this.subscriptions[e])this.eventSource.addEventListener(e,n)}}removeAllSubscriptionListeners(){if(this.eventSource)for(let e in this.subscriptions)for(let n of this.subscriptions[e])this.eventSource.removeEventListener(e,n)}async connect(){if(!(this.reconnectAttempts>0))return new Promise((e,n)=>{this.pendingConnects.push({resolve:e,reject:n}),this.pendingConnects.length>1||this.initConnect()})}initConnect(){this.disconnect(!0),clearTimeout(this.connectTimeoutId),this.connectTimeoutId=setTimeout(()=>{this.connectErrorHandler(new Error("EventSource connect took too long."))},this.maxConnectTimeout),this.eventSource=new EventSource(this.client.buildURL("/api/realtime")),this.eventSource.onerror=e=>{this.connectErrorHandler(new Error("Failed to establish realtime connection."))},this.eventSource.addEventListener("PB_CONNECT",e=>{const n=e;this.clientId=n==null?void 0:n.lastEventId,this.submitSubscriptions().then(async()=>{let r=3;for(;this.hasUnsentSubscriptions()&&r>0;)r--,await this.submitSubscriptions()}).then(()=>{for(let s of this.pendingConnects)s.resolve();this.pendingConnects=[],this.reconnectAttempts=0,clearTimeout(this.reconnectTimeoutId),clearTimeout(this.connectTimeoutId);const r=this.getSubscriptionsByTopic("PB_CONNECT");for(let s in r)for(let i of r[s])i(e)}).catch(r=>{this.clientId="",this.connectErrorHandler(r)})})}hasUnsentSubscriptions(){const e=this.getNonEmptySubscriptionKeys();if(e.length!=this.lastSentSubscriptions.length)return!0;for(const n of e)if(!this.lastSentSubscriptions.includes(n))return!0;return!1}connectErrorHandler(e){if(clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),!this.clientId&&!this.reconnectAttempts||this.reconnectAttempts>this.maxReconnectAttempts){for(let r of this.pendingConnects)r.reject(new Q(e));return this.pendingConnects=[],void this.disconnect()}this.disconnect(!0);const n=this.predefinedReconnectIntervals[this.reconnectAttempts]||this.predefinedReconnectIntervals[this.predefinedReconnectIntervals.length-1];this.reconnectAttempts++,this.reconnectTimeoutId=setTimeout(()=>{this.initConnect()},n)}disconnect(e=!1){var n;if(this.clientId&&this.onDisconnect&&this.onDisconnect(Object.keys(this.subscriptions)),clearTimeout(this.connectTimeoutId),clearTimeout(this.reconnectTimeoutId),this.removeAllSubscriptionListeners(),this.client.cancelRequest(this.getSubscriptionsCancelKey()),(n=this.eventSource)==null||n.close(),this.eventSource=null,this.clientId="",!e){this.reconnectAttempts=0;for(let r of this.pendingConnects)r.resolve();this.pendingConnects=[]}}}class go extends Se{decode(e){return e}async getFullList(e,n){if(typeof e=="number")return this._getFullList(e,n);let r=500;return(n=Object.assign({},e,n)).batch&&(r=n.batch,delete n.batch),this._getFullList(r,n)}async getList(e=1,n=30,r){return(r=Object.assign({method:"GET"},r)).query=Object.assign({page:e,perPage:n},r.query),this.client.send(this.baseCrudPath,r).then(s=>{var i;return s.items=((i=s.items)==null?void 0:i.map(o=>this.decode(o)))||[],s})}async getFirstListItem(e,n){return(n=Object.assign({requestKey:"one_by_filter_"+this.baseCrudPath+"_"+e},n)).query=Object.assign({filter:e,skipTotal:1},n.query),this.getList(1,1,n).then(r=>{var s;if(!((s=r==null?void 0:r.items)!=null&&s.length))throw new Q({status:404,response:{code:404,message:"The requested resource wasn't found.",data:{}}});return r.items[0]})}async getOne(e,n){if(!e)throw new Q({url:this.client.buildURL(this.baseCrudPath+"/"),status:404,response:{code:404,message:"Missing required record id.",data:{}}});return n=Object.assign({method:"GET"},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),n).then(r=>this.decode(r))}async create(e,n){return n=Object.assign({method:"POST",body:e},n),this.client.send(this.baseCrudPath,n).then(r=>this.decode(r))}async update(e,n,r){return r=Object.assign({method:"PATCH",body:n},r),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),r).then(s=>this.decode(s))}async delete(e,n){return n=Object.assign({method:"DELETE"},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e),n).then(()=>!0)}_getFullList(e=500,n){(n=n||{}).query=Object.assign({skipTotal:1},n.query);let r=[],s=async i=>this.getList(i,e||500,n).then(o=>{const a=o.items;return r=r.concat(a),a.length==o.perPage?s(i+1):r});return s(1)}}function be(t,e,n,r){const s=r!==void 0;return s||n!==void 0?s?(console.warn(t),e.body=Object.assign({},e.body,n),e.query=Object.assign({},e.query,r),e):Object.assign(e,n):e}function rr(t){var e;(e=t._resetAutoRefresh)==null||e.call(t)}class Uc extends go{constructor(e,n){super(e),this.collectionIdOrName=n}get baseCrudPath(){return this.baseCollectionPath+"/records"}get baseCollectionPath(){return"/api/collections/"+encodeURIComponent(this.collectionIdOrName)}get isSuperusers(){return this.collectionIdOrName=="_superusers"||this.collectionIdOrName=="_pbc_2773867675"}async subscribe(e,n,r){if(!e)throw new Error("Missing topic.");if(!n)throw new Error("Missing subscription callback.");return this.client.realtime.subscribe(this.collectionIdOrName+"/"+e,n,r)}async unsubscribe(e){return e?this.client.realtime.unsubscribe(this.collectionIdOrName+"/"+e):this.client.realtime.unsubscribeByPrefix(this.collectionIdOrName)}async getFullList(e,n){if(typeof e=="number")return super.getFullList(e,n);const r=Object.assign({},e,n);return super.getFullList(r)}async getList(e=1,n=30,r){return super.getList(e,n,r)}async getFirstListItem(e,n){return super.getFirstListItem(e,n)}async getOne(e,n){return super.getOne(e,n)}async create(e,n){return super.create(e,n)}async update(e,n,r){return super.update(e,n,r).then(s=>{var i,o,a;if(((i=this.client.authStore.record)==null?void 0:i.id)===(s==null?void 0:s.id)&&(((o=this.client.authStore.record)==null?void 0:o.collectionId)===this.collectionIdOrName||((a=this.client.authStore.record)==null?void 0:a.collectionName)===this.collectionIdOrName)){let c=Object.assign({},this.client.authStore.record.expand),u=Object.assign({},this.client.authStore.record,s);c&&(u.expand=Object.assign(c,s.expand)),this.client.authStore.save(this.client.authStore.token,u)}return s})}async delete(e,n){return super.delete(e,n).then(r=>{var s,i,o;return!r||((s=this.client.authStore.record)==null?void 0:s.id)!==e||((i=this.client.authStore.record)==null?void 0:i.collectionId)!==this.collectionIdOrName&&((o=this.client.authStore.record)==null?void 0:o.collectionName)!==this.collectionIdOrName||this.client.authStore.clear(),r})}authResponse(e){const n=this.decode((e==null?void 0:e.record)||{});return this.client.authStore.save(e==null?void 0:e.token,n),Object.assign({},e,{token:(e==null?void 0:e.token)||"",record:n})}async listAuthMethods(e){return e=Object.assign({method:"GET",fields:"mfa,otp,password,oauth2"},e),this.client.send(this.baseCollectionPath+"/auth-methods",e)}async authWithPassword(e,n,r){let s;r=Object.assign({method:"POST",body:{identity:e,password:n}},r),this.isSuperusers&&(s=r.autoRefreshThreshold,delete r.autoRefreshThreshold,r.autoRefresh||rr(this.client));let i=await this.client.send(this.baseCollectionPath+"/auth-with-password",r);return i=this.authResponse(i),s&&this.isSuperusers&&function(a,c,u,l){rr(a);const d=a.beforeSend,p=a.authStore.record,f=a.authStore.onChange((_,h)=>{(!_||(h==null?void 0:h.id)!=(p==null?void 0:p.id)||(h!=null&&h.collectionId||p!=null&&p.collectionId)&&(h==null?void 0:h.collectionId)!=(p==null?void 0:p.collectionId))&&rr(a)});a._resetAutoRefresh=function(){f(),a.beforeSend=d,delete a._resetAutoRefresh},a.beforeSend=async(_,h)=>{var T;const b=a.authStore.token;if((T=h.query)!=null&&T.autoRefresh)return d?d(_,h):{url:_,sendOptions:h};let I=a.authStore.isValid;if(I&&fo(a.authStore.token,c))try{await u()}catch{I=!1}I||await l();const E=h.headers||{};for(let g in E)if(g.toLowerCase()=="authorization"&&b==E[g]&&a.authStore.token){E[g]=a.authStore.token;break}return h.headers=E,d?d(_,h):{url:_,sendOptions:h}}}(this.client,s,()=>this.authRefresh({autoRefresh:!0}),()=>this.authWithPassword(e,n,Object.assign({autoRefresh:!0},r))),i}async authWithOAuth2Code(e,n,r,s,i,o,a){let c={method:"POST",body:{provider:e,code:n,codeVerifier:r,redirectURL:s,createData:i}};return c=be("This form of authWithOAuth2Code(provider, code, codeVerifier, redirectURL, createData?, body?, query?) is deprecated. Consider replacing it with authWithOAuth2Code(provider, code, codeVerifier, redirectURL, createData?, options?).",c,o,a),this.client.send(this.baseCollectionPath+"/auth-with-oauth2",c).then(u=>this.authResponse(u))}authWithOAuth2(...e){if(e.length>1||typeof(e==null?void 0:e[0])=="string")return console.warn("PocketBase: This form of authWithOAuth2() is deprecated and may get removed in the future. Please replace with authWithOAuth2Code() OR use the authWithOAuth2() realtime form as shown in https://pocketbase.io/docs/authentication/#oauth2-integration."),this.authWithOAuth2Code((e==null?void 0:e[0])||"",(e==null?void 0:e[1])||"",(e==null?void 0:e[2])||"",(e==null?void 0:e[3])||"",(e==null?void 0:e[4])||{},(e==null?void 0:e[5])||{},(e==null?void 0:e[6])||{});const n=(e==null?void 0:e[0])||{};let r=null;n.urlCallback||(r=Hs(void 0));const s=new mo(this.client);function i(){r==null||r.close(),s.unsubscribe()}const o={},a=n.requestKey;return a&&(o.requestKey=a),this.listAuthMethods(o).then(c=>{var p;const u=c.oauth2.providers.find(f=>f.name===n.provider);if(!u)throw new Q(new Error(`Missing or invalid provider "${n.provider}".`));const l=this.client.buildURL("/api/oauth2-redirect"),d=a?(p=this.client.cancelControllers)==null?void 0:p[a]:void 0;return d&&(d.signal.onabort=()=>{i()}),new Promise(async(f,_)=>{var h;try{await s.subscribe("@oauth2",async T=>{var m;const g=s.clientId;try{if(!T.state||g!==T.state)throw new Error("State parameters don't match.");if(T.error||!T.code)throw new Error("OAuth2 redirect error or missing code: "+T.error);const w=Object.assign({},n);delete w.provider,delete w.scopes,delete w.createData,delete w.urlCallback,(m=d==null?void 0:d.signal)!=null&&m.onabort&&(d.signal.onabort=null);const V=await this.authWithOAuth2Code(u.name,T.code,u.codeVerifier,l,n.createData,w);f(V)}catch(w){_(new Q(w))}i()});const b={state:s.clientId};(h=n.scopes)!=null&&h.length&&(b.scope=n.scopes.join(" "));const I=this._replaceQueryParams(u.authURL+l,b);await(n.urlCallback||function(T){r?r.location.href=T:r=Hs(T)})(I)}catch(b){i(),_(new Q(b))}})}).catch(c=>{throw i(),c})}async authRefresh(e,n){let r={method:"POST"};return r=be("This form of authRefresh(body?, query?) is deprecated. Consider replacing it with authRefresh(options?).",r,e,n),this.client.send(this.baseCollectionPath+"/auth-refresh",r).then(s=>this.authResponse(s))}async requestPasswordReset(e,n,r){let s={method:"POST",body:{email:e}};return s=be("This form of requestPasswordReset(email, body?, query?) is deprecated. Consider replacing it with requestPasswordReset(email, options?).",s,n,r),this.client.send(this.baseCollectionPath+"/request-password-reset",s).then(()=>!0)}async confirmPasswordReset(e,n,r,s,i){let o={method:"POST",body:{token:e,password:n,passwordConfirm:r}};return o=be("This form of confirmPasswordReset(token, password, passwordConfirm, body?, query?) is deprecated. Consider replacing it with confirmPasswordReset(token, password, passwordConfirm, options?).",o,s,i),this.client.send(this.baseCollectionPath+"/confirm-password-reset",o).then(()=>!0)}async requestVerification(e,n,r){let s={method:"POST",body:{email:e}};return s=be("This form of requestVerification(email, body?, query?) is deprecated. Consider replacing it with requestVerification(email, options?).",s,n,r),this.client.send(this.baseCollectionPath+"/request-verification",s).then(()=>!0)}async confirmVerification(e,n,r){let s={method:"POST",body:{token:e}};return s=be("This form of confirmVerification(token, body?, query?) is deprecated. Consider replacing it with confirmVerification(token, options?).",s,n,r),this.client.send(this.baseCollectionPath+"/confirm-verification",s).then(()=>{const i=ut(e),o=this.client.authStore.record;return o&&!o.verified&&o.id===i.id&&o.collectionId===i.collectionId&&(o.verified=!0,this.client.authStore.save(this.client.authStore.token,o)),!0})}async requestEmailChange(e,n,r){let s={method:"POST",body:{newEmail:e}};return s=be("This form of requestEmailChange(newEmail, body?, query?) is deprecated. Consider replacing it with requestEmailChange(newEmail, options?).",s,n,r),this.client.send(this.baseCollectionPath+"/request-email-change",s).then(()=>!0)}async confirmEmailChange(e,n,r,s){let i={method:"POST",body:{token:e,password:n}};return i=be("This form of confirmEmailChange(token, password, body?, query?) is deprecated. Consider replacing it with confirmEmailChange(token, password, options?).",i,r,s),this.client.send(this.baseCollectionPath+"/confirm-email-change",i).then(()=>{const o=ut(e),a=this.client.authStore.record;return a&&a.id===o.id&&a.collectionId===o.collectionId&&this.client.authStore.clear(),!0})}async listExternalAuths(e,n){return this.client.collection("_externalAuths").getFullList(Object.assign({},n,{filter:this.client.filter("recordRef = {:id}",{id:e})}))}async unlinkExternalAuth(e,n,r){const s=await this.client.collection("_externalAuths").getFirstListItem(this.client.filter("recordRef = {:recordId} && provider = {:provider}",{recordId:e,provider:n}));return this.client.collection("_externalAuths").delete(s.id,r).then(()=>!0)}async requestOTP(e,n){return n=Object.assign({method:"POST",body:{email:e}},n),this.client.send(this.baseCollectionPath+"/request-otp",n)}async authWithOTP(e,n,r){return r=Object.assign({method:"POST",body:{otpId:e,password:n}},r),this.client.send(this.baseCollectionPath+"/auth-with-otp",r).then(s=>this.authResponse(s))}async impersonate(e,n,r){(r=Object.assign({method:"POST",body:{duration:n}},r)).headers=r.headers||{},r.headers.Authorization||(r.headers.Authorization=this.client.authStore.token);const s=new es(this.client.baseURL,new Qr,this.client.lang),i=await s.send(this.baseCollectionPath+"/impersonate/"+encodeURIComponent(e),r);return s.authStore.save(i==null?void 0:i.token,this.decode((i==null?void 0:i.record)||{})),s}_replaceQueryParams(e,n={}){let r=e,s="";e.indexOf("?")>=0&&(r=e.substring(0,e.indexOf("?")),s=e.substring(e.indexOf("?")+1));const i={},o=s.split("&");for(const a of o){if(a=="")continue;const c=a.split("=");i[decodeURIComponent(c[0].replace(/\+/g," "))]=decodeURIComponent((c[1]||"").replace(/\+/g," "))}for(let a in n)n.hasOwnProperty(a)&&(n[a]==null?delete i[a]:i[a]=n[a]);s="";for(let a in i)i.hasOwnProperty(a)&&(s!=""&&(s+="&"),s+=encodeURIComponent(a.replace(/%20/g,"+"))+"="+encodeURIComponent(i[a].replace(/%20/g,"+")));return s!=""?r+"?"+s:r}}function Hs(t){if(typeof window>"u"||!(window!=null&&window.open))throw new Q(new Error("Not in a browser context - please pass a custom urlCallback function."));let e=1024,n=768,r=window.innerWidth,s=window.innerHeight;e=e>r?r:e,n=n>s?s:n;let i=r/2-e/2,o=s/2-n/2;return window.open(t,"popup_window","width="+e+",height="+n+",top="+o+",left="+i+",resizable,menubar=no")}class Mc extends go{get baseCrudPath(){return"/api/collections"}async import(e,n=!1,r){return r=Object.assign({method:"PUT",body:{collections:e,deleteMissing:n}},r),this.client.send(this.baseCrudPath+"/import",r).then(()=>!0)}async getScaffolds(e){return e=Object.assign({method:"GET"},e),this.client.send(this.baseCrudPath+"/meta/scaffolds",e)}async truncate(e,n){return n=Object.assign({method:"DELETE"},n),this.client.send(this.baseCrudPath+"/"+encodeURIComponent(e)+"/truncate",n).then(()=>!0)}}class jc extends Se{async getList(e=1,n=30,r){return(r=Object.assign({method:"GET"},r)).query=Object.assign({page:e,perPage:n},r.query),this.client.send("/api/logs",r)}async getOne(e,n){if(!e)throw new Q({url:this.client.buildURL("/api/logs/"),status:404,response:{code:404,message:"Missing required log id.",data:{}}});return n=Object.assign({method:"GET"},n),this.client.send("/api/logs/"+encodeURIComponent(e),n)}async getStats(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/logs/stats",e)}}class Hc extends Se{async check(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/health",e)}}class Bc extends Se{getUrl(e,n,r={}){return console.warn("Please replace pb.files.getUrl() with pb.files.getURL()"),this.getURL(e,n,r)}getURL(e,n,r={}){if(!n||!(e!=null&&e.id)||!(e!=null&&e.collectionId)&&!(e!=null&&e.collectionName))return"";const s=[];s.push("api"),s.push("files"),s.push(encodeURIComponent(e.collectionId||e.collectionName)),s.push(encodeURIComponent(e.id)),s.push(encodeURIComponent(n));let i=this.client.buildURL(s.join("/"));if(Object.keys(r).length){r.download===!1&&delete r.download;const o=new URLSearchParams(r);i+=(i.includes("?")?"&":"?")+o}return i}async getToken(e){return e=Object.assign({method:"POST"},e),this.client.send("/api/files/token",e).then(n=>(n==null?void 0:n.token)||"")}}class qc extends Se{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/backups",e)}async create(e,n){return n=Object.assign({method:"POST",body:{name:e}},n),this.client.send("/api/backups",n).then(()=>!0)}async upload(e,n){return n=Object.assign({method:"POST",body:e},n),this.client.send("/api/backups/upload",n).then(()=>!0)}async delete(e,n){return n=Object.assign({method:"DELETE"},n),this.client.send(`/api/backups/${encodeURIComponent(e)}`,n).then(()=>!0)}async restore(e,n){return n=Object.assign({method:"POST"},n),this.client.send(`/api/backups/${encodeURIComponent(e)}/restore`,n).then(()=>!0)}getDownloadUrl(e,n){return console.warn("Please replace pb.backups.getDownloadUrl() with pb.backups.getDownloadURL()"),this.getDownloadURL(e,n)}getDownloadURL(e,n){return this.client.buildURL(`/api/backups/${encodeURIComponent(n)}?token=${encodeURIComponent(e)}`)}}class Vc extends Se{async getFullList(e){return e=Object.assign({method:"GET"},e),this.client.send("/api/crons",e)}async run(e,n){return n=Object.assign({method:"POST"},n),this.client.send(`/api/crons/${encodeURIComponent(e)}`,n).then(()=>!0)}}function wr(t){return typeof Blob<"u"&&t instanceof Blob||typeof File<"u"&&t instanceof File||t!==null&&typeof t=="object"&&t.uri&&(typeof navigator<"u"&&navigator.product==="ReactNative"||typeof global<"u"&&global.HermesInternal)}function Rr(t){return t&&(t.constructor.name==="FormData"||typeof FormData<"u"&&t instanceof FormData)}function Bs(t){for(const e in t){const n=Array.isArray(t[e])?t[e]:[t[e]];for(const r of n)if(wr(r))return!0}return!1}const Gc=/^[\-\.\d]+$/;function qs(t){if(typeof t!="string")return t;if(t=="true")return!0;if(t=="false")return!1;if((t[0]==="-"||t[0]>="0"&&t[0]<="9")&&Gc.test(t)){let e=+t;if(""+e===t)return e}return t}class zc extends Se{constructor(){super(...arguments),this.requests=[],this.subs={}}collection(e){return this.subs[e]||(this.subs[e]=new Wc(this.requests,e)),this.subs[e]}async send(e){const n=new FormData,r=[];for(let s=0;s<this.requests.length;s++){const i=this.requests[s];if(r.push({method:i.method,url:i.url,headers:i.headers,body:i.json}),i.files)for(let o in i.files){const a=i.files[o]||[];for(let c of a)n.append("requests."+s+"."+o,c)}}return n.append("@jsonPayload",JSON.stringify({requests:r})),e=Object.assign({method:"POST",body:n},e),this.client.send("/api/batch",e)}}class Wc{constructor(e,n){this.requests=[],this.requests=e,this.collectionIdOrName=n}upsert(e,n){n=Object.assign({body:e||{}},n);const r={method:"PUT",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records"};this.prepareRequest(r,n),this.requests.push(r)}create(e,n){n=Object.assign({body:e||{}},n);const r={method:"POST",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records"};this.prepareRequest(r,n),this.requests.push(r)}update(e,n,r){r=Object.assign({body:n||{}},r);const s={method:"PATCH",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records/"+encodeURIComponent(e)};this.prepareRequest(s,r),this.requests.push(s)}delete(e,n){n=Object.assign({},n);const r={method:"DELETE",url:"/api/collections/"+encodeURIComponent(this.collectionIdOrName)+"/records/"+encodeURIComponent(e)};this.prepareRequest(r,n),this.requests.push(r)}prepareRequest(e,n){if(Zr(n),e.headers=n.headers,e.json={},e.files={},n.query!==void 0){const s=ho(n.query);s&&(e.url+=(e.url.includes("?")?"&":"?")+s)}let r=n.body;Rr(r)&&(r=function(i){let o={};return i.forEach((a,c)=>{if(c==="@jsonPayload"&&typeof a=="string")try{let u=JSON.parse(a);Object.assign(o,u)}catch(u){console.warn("@jsonPayload error:",u)}else o[c]!==void 0?(Array.isArray(o[c])||(o[c]=[o[c]]),o[c].push(qs(a))):o[c]=qs(a)}),o}(r));for(const s in r){const i=r[s];if(wr(i))e.files[s]=e.files[s]||[],e.files[s].push(i);else if(Array.isArray(i)){const o=[],a=[];for(const c of i)wr(c)?o.push(c):a.push(c);if(o.length>0&&o.length==i.length){e.files[s]=e.files[s]||[];for(let c of o)e.files[s].push(c)}else if(e.json[s]=a,o.length>0){let c=s;s.startsWith("+")||s.endsWith("+")||(c+="+"),e.files[c]=e.files[c]||[];for(let u of o)e.files[c].push(u)}}else e.json[s]=i}}}let es=class{get baseUrl(){return this.baseURL}set baseUrl(e){this.baseURL=e}constructor(e="/",n,r="en-US"){this.cancelControllers={},this.recordServices={},this.enableAutoCancellation=!0,this.baseURL=e,this.lang=r,n?this.authStore=n:typeof window<"u"&&window.Deno?this.authStore=new Qr:this.authStore=new xc,this.collections=new Mc(this),this.files=new Bc(this),this.logs=new jc(this),this.settings=new $c(this),this.realtime=new mo(this),this.health=new Hc(this),this.backups=new qc(this),this.crons=new Vc(this)}get admins(){return this.collection("_superusers")}createBatch(){return new zc(this)}collection(e){return this.recordServices[e]||(this.recordServices[e]=new Uc(this,e)),this.recordServices[e]}autoCancellation(e){return this.enableAutoCancellation=!!e,this}cancelRequest(e){return this.cancelControllers[e]&&(this.cancelControllers[e].abort(),delete this.cancelControllers[e]),this}cancelAllRequests(){for(let e in this.cancelControllers)this.cancelControllers[e].abort();return this.cancelControllers={},this}filter(e,n){if(!n)return e;for(let r in n){let s=n[r];switch(typeof s){case"boolean":case"number":s=""+s;break;case"string":s="'"+s.replace(/'/g,"\\'")+"'";break;default:s=s===null?"null":s instanceof Date?"'"+s.toISOString().replace("T"," ")+"'":"'"+JSON.stringify(s).replace(/'/g,"\\'")+"'"}e=e.replaceAll("{:"+r+"}",s)}return e}getFileUrl(e,n,r={}){return console.warn("Please replace pb.getFileUrl() with pb.files.getURL()"),this.files.getURL(e,n,r)}buildUrl(e){return console.warn("Please replace pb.buildUrl() with pb.buildURL()"),this.buildURL(e)}buildURL(e){var r;let n=this.baseURL;return typeof window>"u"||!window.location||n.startsWith("https://")||n.startsWith("http://")||(n=(r=window.location.origin)!=null&&r.endsWith("/")?window.location.origin.substring(0,window.location.origin.length-1):window.location.origin||"",this.baseURL.startsWith("/")||(n+=window.location.pathname||"/",n+=n.endsWith("/")?"":"/"),n+=this.baseURL),e&&(n+=n.endsWith("/")?"":"/",n+=e.startsWith("/")?e.substring(1):e),n}async send(e,n){n=this.initSendOptions(e,n);let r=this.buildURL(e);if(this.beforeSend){const s=Object.assign({},await this.beforeSend(r,n));s.url!==void 0||s.options!==void 0?(r=s.url||r,n=s.options||n):Object.keys(s).length&&(n=s,console!=null&&console.warn&&console.warn("Deprecated format of beforeSend return: please use `return { url, options }`, instead of `return options`."))}if(n.query!==void 0){const s=ho(n.query);s&&(r+=(r.includes("?")?"&":"?")+s),delete n.query}return this.getHeader(n.headers,"Content-Type")=="application/json"&&n.body&&typeof n.body!="string"&&(n.body=JSON.stringify(n.body)),(n.fetch||fetch)(r,n).then(async s=>{let i={};try{i=await s.json()}catch{}if(this.afterSend&&(i=await this.afterSend(s,i,n)),s.status>=400)throw new Q({url:s.url,status:s.status,data:i});return i}).catch(s=>{throw new Q(s)})}initSendOptions(e,n){if((n=Object.assign({method:"GET"},n)).body=function(s){if(typeof FormData>"u"||s===void 0||typeof s!="object"||s===null||Rr(s)||!Bs(s))return s;const i=new FormData;for(const o in s){const a=s[o];if(a!==void 0)if(typeof a!="object"||Bs({data:a})){const c=Array.isArray(a)?a:[a];for(let u of c)i.append(o,u)}else{let c={};c[o]=a,i.append("@jsonPayload",JSON.stringify(c))}}return i}(n.body),Zr(n),n.query=Object.assign({},n.params,n.query),n.requestKey===void 0&&(n.$autoCancel===!1||n.query.$autoCancel===!1?n.requestKey=null:(n.$cancelKey||n.query.$cancelKey)&&(n.requestKey=n.$cancelKey||n.query.$cancelKey)),delete n.$autoCancel,delete n.query.$autoCancel,delete n.$cancelKey,delete n.query.$cancelKey,this.getHeader(n.headers,"Content-Type")!==null||Rr(n.body)||(n.headers=Object.assign({},n.headers,{"Content-Type":"application/json"})),this.getHeader(n.headers,"Accept-Language")===null&&(n.headers=Object.assign({},n.headers,{"Accept-Language":this.lang})),this.authStore.token&&this.getHeader(n.headers,"Authorization")===null&&(n.headers=Object.assign({},n.headers,{Authorization:this.authStore.token})),this.enableAutoCancellation&&n.requestKey!==null){const r=n.requestKey||(n.method||"GET")+e;delete n.requestKey,this.cancelRequest(r);const s=new AbortController;this.cancelControllers[r]=s,n.signal=s.signal}return n}getHeader(e,n){e=e||{},n=n.toLowerCase();for(let r in e)if(r.toLowerCase()==n)return e[r];return null}};const _o=A.createContext(null);function Kc({children:t}){const e=A.useMemo(()=>{const E="https://your-pocketbase-instance.fly.dev",T=new es(E),g=localStorage.getItem("pocketbase_auth");if(g)try{const m=JSON.parse(g);T.authStore.save(m.token,m.model)}catch(m){console.warn("Failed to load persisted auth:",m),localStorage.removeItem("pocketbase_auth")}return T},[]),[n,r]=A.useState(e.authStore.token),[s,i]=A.useState(e.authStore.model),[o,a]=A.useState(!1),[c,u]=A.useState(null),[l,d]=A.useState(!1);A.useEffect(()=>e.authStore.onChange((T,g)=>{console.log("PocketBase authStore changed:",{hasToken:!!T,userEmail:g==null?void 0:g.email}),r(T),i(g),T&&g?localStorage.setItem("pocketbase_auth",JSON.stringify({token:T,model:g})):localStorage.removeItem("pocketbase_auth")}),[e]),A.useEffect(()=>{(async()=>{a(!0);try{e.authStore.isValid&&(console.log("Validating existing auth token..."),await e.collection("_pb_users_auth_").authRefresh(),console.log("Auth token validated successfully"))}catch(T){console.warn("Auth validation failed, clearing invalid token:",T),e.authStore.clear()}finally{d(!0),a(!1)}})()},[e]),A.useEffect(()=>{const E=setInterval(async()=>{if(e.authStore.isValid)try{console.log("Auto-refreshing token..."),await e.collection("_pb_users_auth_").authRefresh()}catch(T){console.error("Token refresh failed:",T),e.authStore.clear()}},12e4);return()=>clearInterval(E)},[e]);const p=A.useCallback(async(E,T)=>{var g;a(!0),u(null);try{console.log("PocketContext: Attempting login for:",E);const m=await e.collection("_pb_users_auth_").authWithPassword(E,T);return console.log("PocketContext: Login successful:",{userEmail:(g=m.record)==null?void 0:g.email,hasToken:!!m.token}),m}catch(m){throw console.error("PocketContext: Login failed:",m),u(m.message||"Login failed"),m}finally{a(!1)}},[e]),f=A.useCallback(async E=>{a(!0),u(null);try{console.log("PocketContext: Attempting registration for:",E.email);const T={email:E.email,password:E.password,passwordConfirm:E.password};(E.firstName||E.lastName)&&(T.name=`${E.firstName||""} ${E.lastName||""}`.trim());const g=await e.collection("_pb_users_auth_").create(T);return console.log("PocketContext: Registration successful for:",g.email),{user:g,requiresLogin:!0}}catch(T){throw console.error("PocketContext: Registration failed:",T),u(T.message||"Registration failed"),T}finally{a(!1)}},[e]),_=A.useCallback(async(E=!1)=>{console.log("PocketContext: Logging out",{invalidateTokens:E});try{E&&e.authStore.isValid&&await e.collection("_pb_users_auth_").authRefresh({invalidate:!0})}catch(T){console.warn("Failed to invalidate tokens during logout:",T)}e.authStore.clear(),u(null)},[e]),h=A.useCallback(async E=>{a(!0),u(null);try{console.log("PocketContext: Updating profile");const T=E.password&&E.passwordConfirm,g=E.email&&E.email!==(s==null?void 0:s.email),m=await e.collection("_pb_users_auth_").update(e.authStore.model.id,E);if(T||g){console.log("Password/email changed, invalidating other sessions...");try{await e.collection("_pb_users_auth_").authRefresh({invalidate:!0})}catch(w){console.warn("Failed to invalidate other sessions:",w)}}return i(m),console.log("PocketContext: Profile updated successfully"),{user:m}}catch(T){throw console.error("PocketContext: Profile update failed:",T),u(T.message||"Profile update failed"),T}finally{a(!1)}},[e,s==null?void 0:s.email]),b=A.useCallback(()=>{u(null)},[]),I=A.useMemo(()=>({pb:e,token:n,user:s,isLoading:o,error:c,isInitialized:l,isAuthenticated:!!n&&e.authStore.isValid,login:p,register:f,logout:_,updateProfile:h,clearError:b}),[e,n,s,o,c,l,p,f,_,h,b]);return S.jsx(_o.Provider,{value:I,children:t})}const qn=()=>{const t=A.useContext(_o);if(!t)throw new Error("usePocket must be used within a PocketProvider");return t};class Jc{constructor(){this.pb=new es("https://your-pocketbase-instance.fly.dev"),this.authStore=this.pb.authStore,this.pendingRequests=new Map}async signUp(e){try{const n={email:e.email,password:e.password,passwordConfirm:e.password};(e.firstName||e.lastName)&&(n.name=`${e.firstName||""} ${e.lastName||""}`.trim()),console.log("Creating user with minimal data:",{email:e.email,hasPassword:!!e.password,hasName:!!n.name});const r=await this.pb.collection("_pb_users_auth_").create(n);return console.log("User created successfully:",r.email),console.log("Registration successful, skipping auto-login for now"),{user:r,token:null,requiresLogin:!0}}catch(n){if(console.error("SignUp error details:",{message:n.message,status:n.status,data:n.data,response:n.response}),n.data&&n.data.email)throw n.data.email.code==="validation_invalid_email"?new Error("This email address is already registered. Please use a different email or try logging in."):new Error(`Email error: ${n.data.email.message}`);if(n.data&&n.data.password)throw new Error(`Password error: ${n.data.password.message}`);if(n.status===400){if(n.message.includes("create record"))throw new Error("Registration failed. The email might already be in use. Please try a different email.");if(n.message.includes("invalid formatting"))throw new Error("Registration data format error. Please check all fields and try again.")}const r=this.handleConnectionError(n);throw new Error(r)}}async signIn(e,n){const r=`auth:${e}`;if(this.pendingRequests.has(r))return console.log("Login request already pending for:",e),this.pendingRequests.get(r);const s=this._performLogin(e,n);this.pendingRequests.set(r,s);try{return await s}finally{this.pendingRequests.delete(r)}}async _performLogin(e,n){var r;try{console.log("Attempting login with:",{email:e,password:`${n.substring(0,3)}***`}),this.clearPendingRequests();const s=await this.pb.collection("_pb_users_auth_").authWithPassword(e,n);return console.log("Login successful:",{user:(r=s.record)==null?void 0:r.email,hasToken:!!s.token}),{user:s.record,token:s.token}}catch(s){if(console.error("PocketBase signIn error:",{message:s.message,status:s.status,data:s.data}),s.status===400)throw new Error("Invalid email or password. Please check your credentials.");const i=this.handleConnectionError(s);throw new Error(`Login failed: ${i}`)}}async signOut(){this.pb.authStore.clear(),this.clearPendingRequests()}clearPendingRequests(){console.log("Clearing all pending requests"),this.pendingRequests.clear()}async getCurrentUser(){return this.authStore.isValid?this.authStore.model:null}async updateProfile(e){try{return{user:await this.pb.collection("_pb_users_auth_").update(this.authStore.model.id,e)}}catch(n){throw new Error(n.message)}}async create(e,n){try{return{data:await this.pb.collection(e).create(n),error:null}}catch(r){return{data:null,error:this.handleConnectionError(r)}}}async getList(e,n={}){var u;const{page:r=1,perPage:s=50,sort:i="-created",filter:o=""}=n,a=`getList:${e}:${r}:${s}:${i}:${o}:${((u=this.authStore.model)==null?void 0:u.id)||"anonymous"}`;if(this.pendingRequests.has(a)){const l=this.pendingRequests.get(a);return console.log(`Reusing pending ${e} request`),l}const c=this._performGetList(e,{page:r,perPage:s,sort:i,filter:o});this.pendingRequests.set(a,c);try{return await c}finally{setTimeout(()=>{this.pendingRequests.delete(a)},100)}}async _performGetList(e,{page:n,perPage:r,sort:s,filter:i}){try{console.log(`Fetching ${e} with filter: ${i}`);const o=await this.pb.collection(e).getList(n,r,{sort:s,filter:i});return console.log(`Successfully fetched ${o.items.length} ${e} records`),{data:o.items,count:o.totalItems,error:null}}catch(o){console.error(`PocketBase error fetching ${e}:`,{message:o.message,status:o.status,collection:e,filter:i});const a=this.handleConnectionError(o);return{data:[],count:0,error:a}}}async getOne(e,n){try{return{data:await this.pb.collection(e).getOne(n),error:null}}catch(r){return{data:null,error:this.handleConnectionError(r)}}}async update(e,n,r){try{return{data:await this.pb.collection(e).update(n,r),error:null}}catch(s){return{data:null,error:this.handleConnectionError(s)}}}async delete(e,n){try{return await this.pb.collection(e).delete(n),{data:{success:!0},error:null}}catch(r){return{data:null,error:this.handleConnectionError(r)}}}subscribe(e,n){return this.pb.collection(e).subscribe("*",n)}subscribeToRecord(e,n,r){return this.pb.collection(e).subscribe(n,r)}async uploadFile(e){try{const n=new FormData;return n.append("file",e),{data:await this.pb.collection("files").create(n),error:null}}catch(n){return{data:null,error:n.message}}}getFileUrl(e,n,r){return this.pb.files.getUrl(e,n,r)}isAuthenticated(){return this.authStore.isValid}getToken(){return this.authStore.token}setToken(e){this.authStore.save(e,this.authStore.model)}handleConnectionError(e){var n,r;return(n=e.message)!=null&&n.includes("fetch")||(r=e.message)!=null&&r.includes("Failed to fetch")?"Unable to connect to server. Please check your connection and try again.":e.status===404?"Collection not found. This feature may not be configured yet.":e.status===401?"Authentication required. Please log in again.":e.status===403?"Access denied. You do not have permission for this action.":e.message||"An unexpected error occurred."}}const So=new Jc;class Yc{constructor(){this.memoryCache=new Map,this.ttl=new Map,this.maxSize=1e3,this.defaultTTL=5*60*1e3,this.hitCount=0,this.missCount=0,setInterval(()=>this.cleanup(),60*1e3)}set(e,n,r=this.defaultTTL){this.memoryCache.size>=this.maxSize&&this.evictOldest(),this.memoryCache.set(e,n),this.ttl.set(e,Date.now()+r)}get(e){const n=this.ttl.get(e);return!n||Date.now()>n?(this.delete(e),this.missCount++,null):(this.hitCount++,this.memoryCache.get(e))}delete(e){this.memoryCache.delete(e),this.ttl.delete(e)}clear(){this.memoryCache.clear(),this.ttl.clear(),this.hitCount=0,this.missCount=0}has(e){return this.get(e)!==null}size(){return this.memoryCache.size}getStats(){return{size:this.memoryCache.size,maxSize:this.maxSize,hitRate:this.calculateHitRate(),hits:this.hitCount,misses:this.missCount}}evictOldest(){const e=Array.from(this.ttl.entries());e.sort((r,s)=>r[1]-s[1]);const n=Math.ceil(this.maxSize*.2);e.slice(0,n).forEach(([r])=>{this.delete(r)})}cleanup(){const e=Date.now();for(const[n,r]of this.ttl.entries())e>r&&this.delete(n)}calculateHitRate(){const e=this.hitCount+this.missCount;return e>0?this.hitCount/e*100:0}async cache(e,n,r=this.defaultTTL){const s=this.get(e);if(s)return s;const i=await n();return this.set(e,i,r),i}invalidatePattern(e){const n=new RegExp(e);for(const r of this.memoryCache.keys())n.test(r)&&this.delete(r)}invalidate(e){this.delete(e)}}const x=new Yc,Xc=t=>{const e=new Date;switch(t){case"1d":return new Date(e.getTime()-24*60*60*1e3);case"7d":return new Date(e.getTime()-7*24*60*60*1e3);case"30d":return new Date(e.getTime()-30*24*60*60*1e3);case"90d":return new Date(e.getTime()-90*24*60*60*1e3);case"all":return null;default:return new Date(e.getTime()-7*24*60*60*1e3)}},Qc=t=>{if(!t||t.length===0)return 0;const e=t.map(s=>new Date(s.session_date)).sort((s,i)=>i-s);let n=0,r=new Date;r.setHours(0,0,0,0);for(let s=0;s<e.length;s++){const i=new Date(e[s]);i.setHours(0,0,0,0);const o=r-i;if(Math.ceil(o/(1e3*60*60*24))<=1)n++,r=i;else break}return n},Vs=t=>{if(!t||t<1)return"0m";const e=Math.floor(t/60),n=t%60;return e===0?`${n}m`:n===0?`${e}h`:`${e}h ${n}m`};class Zc{constructor(){this.pocketbase=null,this.config=null}_getPocketbase(){return this.pocketbase||(this.pocketbase=So),this.pocketbase}_getConfig(){return this.config||(this.config={pocketbaseUrl:"https://your-pocketbase-instance.fly.dev",apiTimeout:3e4,cacheTTL:5*60*1e3,maxRetries:3}),this.config}async getSessions(e={}){return this.getTrainingSessions(e)}async getStats(e="7d"){return this.getTrainingStats(e)}async getGoals(e={}){return this.getTrainingGoals(e)}async getTrainingSessions(e={}){const n=`training:sessions:${JSON.stringify(e)}`,r=x.get(n);if(r)return r;try{const s=this._getPocketbase();if(!s.isAuthenticated())return console.log("User not authenticated, returning empty training sessions"),[];const i={page:e.page||1,perPage:e.perPage||50,sort:e.sort||"-created",filter:this.buildFilterString(e)},o=await s.getList("training_sessions",i);if(o.error)throw console.error("PocketBase error fetching training sessions:",o.error),new Error(`Failed to fetch training sessions: ${o.error}`);return x.set(n,o.data,2*60*1e3),o.data}catch(s){if(console.error("Training sessions service error:",s.message),s.message.includes("User not authenticated")||s.message.includes("401"))return[];throw s}}async createTrainingSession(e){var n;try{const r=this._getPocketbase(),s=await r.create("training_sessions",{...e,user_id:(n=r.authStore.model)==null?void 0:n.id,created:new Date().toISOString()});if(s.error)throw new Error(s.error);return x.invalidatePattern("training:sessions"),x.invalidatePattern("training:stats"),s.data}catch(r){throw console.error("Failed to create training session:",r),r}}async updateTrainingSession(e,n){try{const r=await this._getPocketbase().update("training_sessions",e,{...n,updated:new Date().toISOString()});if(r.error)throw new Error(r.error);return x.invalidatePattern("training:sessions"),x.invalidatePattern("training:stats"),r.data}catch(r){throw console.error("Failed to update training session:",r),r}}async deleteTrainingSession(e){try{const n=await this._getPocketbase().delete("training_sessions",e);if(n.error)throw new Error(n.error);return x.invalidatePattern("training:sessions"),x.invalidatePattern("training:stats"),n.data}catch(n){throw console.error("Failed to delete training session:",n),n}}async getTrainingStats(e="7d"){const n=`training:stats:${e}`,r=x.get(n);if(r)return r;try{if(!this._getPocketbase().isAuthenticated())return console.log("User not authenticated, returning empty training stats"),{totalSessions:0,totalDuration:0,averageDuration:0,streakDays:0,formattedTotalDuration:"0m",formattedAverageDuration:"0m"};const i=Xc(e),o=i?`created >= "${i.toISOString()}"`:"",a=await this.getTrainingSessions({filter:o}),c={totalSessions:a.length,totalDuration:a.reduce((u,l)=>u+(l.duration||0),0),averageDuration:a.length>0?Math.round(a.reduce((u,l)=>u+(l.duration||0),0)/a.length):0,streakDays:Qc(a),formattedTotalDuration:Vs(a.reduce((u,l)=>u+(l.duration||0),0)),formattedAverageDuration:Vs(a.length>0?Math.round(a.reduce((u,l)=>u+(l.duration||0),0)/a.length):0)};return x.set(n,c,5*60*1e3),c}catch(s){if(console.error("Training stats service error:",s.message),s.message.includes("User not authenticated")||s.message.includes("401"))return{totalSessions:0,totalDuration:0,averageDuration:0,streakDays:0,formattedTotalDuration:"0m",formattedAverageDuration:"0m"};throw s}}async getTrainingGoals(e={}){const n=`training:goals:${JSON.stringify(e)}`,r=x.get(n);if(r)return r;try{const s=this._getPocketbase();if(!s.isAuthenticated())return console.log("User not authenticated, returning empty training goals"),[];const i={page:e.page||1,perPage:e.perPage||50,sort:e.sort||"-created",filter:this.buildFilterString(e)},o=await s.getList("training_goals",i);if(o.error)throw console.error("PocketBase error fetching training goals:",o.error),new Error(`Failed to fetch training goals: ${o.error}`);return x.set(n,o.data,5*60*1e3),o.data}catch(s){if(console.error("Training goals service error:",s.message),s.message.includes("User not authenticated")||s.message.includes("401"))return[];throw s}}async createTrainingGoal(e){var n;try{const r=this._getPocketbase(),s=await r.create("training_goals",{...e,user_id:(n=r.authStore.model)==null?void 0:n.id,created:new Date().toISOString()});if(s.error)throw new Error(s.error);return x.invalidatePattern("training:goals"),s.data}catch(r){throw console.error("Failed to create training goal:",r),r}}async updateTrainingGoal(e,n){try{const r=await this._getPocketbase().update("training_goals",e,{...n,updated:new Date().toISOString()});if(r.error)throw new Error(r.error);return x.invalidatePattern("training:goals"),r.data}catch(r){throw console.error("Failed to update training goal:",r),r}}async deleteTrainingGoal(e){try{const n=await this._getPocketbase().delete("training_goals",e);if(n.error)throw new Error(n.error);return x.invalidatePattern("training:goals"),n.data}catch(n){throw console.error("Failed to delete training goal:",n),n}}buildFilterString(e){var i;const n=[],r=this._getPocketbase(),s=e.userId||((i=r.authStore.model)==null?void 0:i.id);return s&&n.push(`user_id = "${s}"`),e.dateFrom&&n.push(`created >= "${e.dateFrom}"`),e.dateTo&&n.push(`created <= "${e.dateTo}"`),e.type&&n.push(`type = "${e.type}"`),e.status&&n.push(`status = "${e.status}"`),e.filter&&n.push(e.filter),n.join(" && ")}subscribeToTrainingSessions(e){return this._getPocketbase().subscribe("training_sessions",e)}subscribeToTrainingGoals(e){return this._getPocketbase().subscribe("training_goals",e)}getMockTrainingSessions(){return[{id:"mock-1",session_type:"Agility Training",duration:45,exercises:[{name:"Cone Drills",sets:3,reps:10},{name:"Sprint Intervals",sets:4,reps:5}],notes:"Focus on quick direction changes",created:new Date(Date.now()-24*60*60*1e3).toISOString(),user_id:"mock-user"},{id:"mock-2",session_type:"Strength Training",duration:60,exercises:[{name:"Squats",sets:3,reps:12},{name:"Push-ups",sets:3,reps:15}],notes:"Great progress on form",created:new Date(Date.now()-2*24*60*60*1e3).toISOString(),user_id:"mock-user"}]}getMockTrainingGoals(){return[{id:"goal-1",title:"Improve Sprint Speed",description:"Reduce 40-yard dash time by 0.5 seconds",target_date:new Date(Date.now()+30*24*60*60*1e3).toISOString(),completed:!1,progress:25,created:new Date(Date.now()-7*24*60*60*1e3).toISOString(),user_id:"mock-user"},{id:"goal-2",title:"Increase Endurance",description:"Run 2 miles without stopping",target_date:new Date(Date.now()+45*24*60*60*1e3).toISOString(),completed:!1,progress:60,created:new Date(Date.now()-14*24*60*60*1e3).toISOString(),user_id:"mock-user"}]}getMockTrainingStats(){return{totalSessions:5,totalDuration:270,averageDuration:54,streakDays:3,formattedTotalDuration:"4h 30m",formattedAverageDuration:"54m"}}}const te=new Zc,eu={sessions:[],currentSession:null,isLoading:!1,error:null,stats:{totalSessions:0,totalDuration:0,averageScore:0,streakDays:0},goals:[],progress:{}},R={FETCH_SESSIONS_START:"FETCH_SESSIONS_START",FETCH_SESSIONS_SUCCESS:"FETCH_SESSIONS_SUCCESS",FETCH_SESSIONS_FAILURE:"FETCH_SESSIONS_FAILURE",CREATE_SESSION_START:"CREATE_SESSION_START",CREATE_SESSION_SUCCESS:"CREATE_SESSION_SUCCESS",CREATE_SESSION_FAILURE:"CREATE_SESSION_FAILURE",UPDATE_SESSION_START:"UPDATE_SESSION_START",UPDATE_SESSION_SUCCESS:"UPDATE_SESSION_SUCCESS",UPDATE_SESSION_FAILURE:"UPDATE_SESSION_FAILURE",DELETE_SESSION_START:"DELETE_SESSION_START",DELETE_SESSION_SUCCESS:"DELETE_SESSION_SUCCESS",DELETE_SESSION_FAILURE:"DELETE_SESSION_FAILURE",SET_CURRENT_SESSION:"SET_CURRENT_SESSION",CLEAR_CURRENT_SESSION:"CLEAR_CURRENT_SESSION",FETCH_STATS_START:"FETCH_STATS_START",FETCH_STATS_SUCCESS:"FETCH_STATS_SUCCESS",FETCH_STATS_FAILURE:"FETCH_STATS_FAILURE",FETCH_GOALS_START:"FETCH_GOALS_START",FETCH_GOALS_SUCCESS:"FETCH_GOALS_SUCCESS",FETCH_GOALS_FAILURE:"FETCH_GOALS_FAILURE",UPDATE_GOAL_START:"UPDATE_GOAL_START",UPDATE_GOAL_SUCCESS:"UPDATE_GOAL_SUCCESS",UPDATE_GOAL_FAILURE:"UPDATE_GOAL_FAILURE",CLEAR_ERROR:"CLEAR_ERROR"},tu=(t,e)=>{var n,r;switch(e.type){case R.FETCH_SESSIONS_START:case R.CREATE_SESSION_START:case R.UPDATE_SESSION_START:case R.DELETE_SESSION_START:case R.FETCH_STATS_START:case R.FETCH_GOALS_START:case R.UPDATE_GOAL_START:return{...t,isLoading:!0,error:null};case R.FETCH_SESSIONS_SUCCESS:return{...t,sessions:e.payload,isLoading:!1,error:null};case R.CREATE_SESSION_SUCCESS:return{...t,sessions:[e.payload,...t.sessions],isLoading:!1,error:null};case R.UPDATE_SESSION_SUCCESS:return{...t,sessions:t.sessions.map(s=>s.id===e.payload.id?e.payload:s),currentSession:((n=t.currentSession)==null?void 0:n.id)===e.payload.id?e.payload:t.currentSession,isLoading:!1,error:null};case R.DELETE_SESSION_SUCCESS:return{...t,sessions:t.sessions.filter(s=>s.id!==e.payload),currentSession:((r=t.currentSession)==null?void 0:r.id)===e.payload?null:t.currentSession,isLoading:!1,error:null};case R.SET_CURRENT_SESSION:return{...t,currentSession:e.payload};case R.CLEAR_CURRENT_SESSION:return{...t,currentSession:null};case R.FETCH_STATS_SUCCESS:return{...t,stats:e.payload,isLoading:!1,error:null};case R.FETCH_GOALS_SUCCESS:return{...t,goals:e.payload,isLoading:!1,error:null};case R.UPDATE_GOAL_SUCCESS:return{...t,goals:t.goals.map(s=>s.id===e.payload.id?e.payload:s),isLoading:!1,error:null};case R.FETCH_SESSIONS_FAILURE:case R.CREATE_SESSION_FAILURE:case R.UPDATE_SESSION_FAILURE:case R.DELETE_SESSION_FAILURE:case R.FETCH_STATS_FAILURE:case R.FETCH_GOALS_FAILURE:case R.UPDATE_GOAL_FAILURE:return{...t,isLoading:!1,error:e.payload};case R.CLEAR_ERROR:return{...t,error:null};default:return t}},yo=A.createContext(),nu=({children:t})=>{const[e,n]=A.useReducer(tu,eu),r=A.useCallback(async(g={})=>{try{n({type:R.FETCH_SESSIONS_START});const m=await te.getSessions(g);return n({type:R.FETCH_SESSIONS_SUCCESS,payload:m}),m}catch(m){return n({type:R.FETCH_SESSIONS_FAILURE,payload:m.message}),console.error("Failed to fetch sessions:",m),[]}},[]),s=A.useCallback(async(g="all")=>{try{n({type:R.FETCH_STATS_START});const m=await te.getStats(g);return n({type:R.FETCH_STATS_SUCCESS,payload:m}),m}catch(m){return n({type:R.FETCH_STATS_FAILURE,payload:m.message}),console.error("Failed to fetch stats:",m),{totalSessions:0,totalDuration:0,averageScore:0,streakDays:0}}},[]),i=A.useCallback(async()=>{try{n({type:R.FETCH_GOALS_START});const g=await te.getGoals();return n({type:R.FETCH_GOALS_SUCCESS,payload:g}),g}catch(g){return n({type:R.FETCH_GOALS_FAILURE,payload:g.message}),console.error("Failed to fetch goals:",g),[]}},[]),{isAuthenticated:o,isLoading:a}=qn();A.useEffect(()=>{!a&&o?(console.log("Initializing training data for authenticated user..."),(async()=>{try{await Promise.all([r(),s(),i()]),console.log("Training data initialization completed")}catch(m){console.error("Failed to initialize training data:",m)}})()):console.log("Skipping training data initialization - auth not ready:",{authLoading:a,isAuthenticated:o})},[o,a]);const T={...e,fetchSessions:r,createSession:async g=>{n({type:R.CREATE_SESSION_START});const m=await te.createSession(g);return n({type:R.CREATE_SESSION_SUCCESS,payload:m}),m},updateSession:async(g,m)=>{n({type:R.UPDATE_SESSION_START});const w=await te.updateSession(g,m);return n({type:R.UPDATE_SESSION_SUCCESS,payload:w}),w},deleteSession:async g=>{n({type:R.DELETE_SESSION_START}),await te.deleteSession(g),n({type:R.DELETE_SESSION_SUCCESS,payload:g})},setCurrentSession:g=>{n({type:R.SET_CURRENT_SESSION,payload:g})},clearCurrentSession:()=>{n({type:R.CLEAR_CURRENT_SESSION})},fetchStats:s,fetchGoals:i,updateGoal:async(g,m)=>{n({type:R.UPDATE_GOAL_START});const w=await te.updateGoal(g,m);return n({type:R.UPDATE_GOAL_SUCCESS,payload:w}),w},createGoal:async g=>{n({type:R.UPDATE_GOAL_START});const m=await te.createGoal(g);return n({type:R.UPDATE_GOAL_SUCCESS,payload:m}),m},deleteGoal:async g=>{n({type:R.UPDATE_GOAL_START}),await te.deleteGoal(g),await i()},getSessionById:async g=>await te.getSessionById(g),getRecommendedDrills:async(g={})=>await te.getRecommendedDrills(g),clearError:()=>{n({type:R.CLEAR_ERROR})}};return S.jsx(yo.Provider,{value:T,children:t})},O_=()=>{const t=A.useContext(yo);if(!t)throw new Error("useTraining must be used within a TrainingProvider");return t};class ru{constructor(){this.pocketbase=null,this.config=null}_getPocketbase(){return this.pocketbase||(this.pocketbase=So),this.pocketbase}_getConfig(){return this.config||(this.config={pocketbaseUrl:"https://your-pocketbase-instance.fly.dev",apiTimeout:3e4,cacheTTL:5*60*1e3,maxRetries:3}),this.config}async trackEvent(e){var n;try{const r=await this._getPocketbase().create("analytics_events",{event_type:e.type,event_data:e,user_id:(n=this._getPocketbase().authStore.model)==null?void 0:n.id,session_id:e.sessionId,timestamp:e.timestamp||new Date().toISOString(),page_url:e.pageUrl,user_agent:e.userAgent});if(r.error)throw new Error(r.error);return r.data}catch(r){throw new Error(`Failed to track event: ${r.message}`)}}async getEvents(e={}){try{const n=this._getPocketbase();if(!n.isAuthenticated())return console.log("User not authenticated, returning empty analytics events"),[];const r=`analytics:events:${JSON.stringify(e)}`,s=x.get(r);if(s)return s;const i={page:e.page||1,perPage:e.perPage||50,sort:e.sort||"-timestamp",filter:this.buildEventFilterString(e)},o=await n.getList("analytics_events",i);if(o.error)throw console.error("PocketBase error fetching analytics events:",o.error),new Error(`Failed to fetch analytics events: ${o.error}`);return x.set(r,o.data,2*60*1e3),o.data}catch(n){return console.warn("Analytics events service error (returning empty array):",n.message),[]}}async getMetrics(e="7d"){try{const n=`analytics:metrics:${e}`,r=x.get(n);if(r)return r;const s=this.getStartDateForTimeframe(e),i=s?`timestamp >= "${s.toISOString()}"`:"",o=await this.getEvents({filter:i}),a={pageViews:o.filter(c=>c.event_type==="page_view").length,uniqueUsers:new Set(o.map(c=>c.user_id).filter(Boolean)).size,sessionDuration:this.calculateAverageSessionDuration(o),conversionRate:this.calculateConversionRate(o)};return x.set(n,a,5*60*1e3),a}catch(n){return console.warn("Analytics metrics service error (returning empty metrics):",n.message),{pageViews:0,uniqueUsers:0,sessionDuration:0,conversionRate:0}}}calculateAverageSessionDuration(e){const n={};e.forEach(s=>{n[s.session_id]||(n[s.session_id]={start:null,end:null});const i=new Date(s.timestamp);(!n[s.session_id].start||i<n[s.session_id].start)&&(n[s.session_id].start=i),(!n[s.session_id].end||i>n[s.session_id].end)&&(n[s.session_id].end=i)});const r=Object.values(n).filter(s=>s.start&&s.end).map(s=>s.end-s.start);return r.length>0?r.reduce((s,i)=>s+i,0)/r.length:0}calculateConversionRate(e){const n=new Set(e.map(s=>s.user_id).filter(Boolean)).size,r=new Set(e.filter(s=>s.event_type==="conversion").map(s=>s.user_id).filter(Boolean)).size;return n>0?r/n*100:0}async getUserBehavior(e={}){try{const n=`analytics:behavior:${JSON.stringify(e)}`,r=x.get(n);if(r)return r;const s=await this.getEvents({...e,eventType:"page_view"}),i={mostVisitedPages:this.getMostVisitedPages(s),userJourney:this.getUserJourney(s),dropoffPoints:this.getDropoffPoints(s)};return x.set(n,i,10*60*1e3),i}catch(n){return console.warn("Analytics user behavior service error (returning empty behavior):",n.message),{mostVisitedPages:[],userJourney:[],dropoffPoints:[]}}}getMostVisitedPages(e){const n={};return e.forEach(r=>{var i;const s=((i=r.event_data)==null?void 0:i.pageUrl)||"unknown";n[s]=(n[s]||0)+1}),Object.entries(n).map(([r,s])=>({page:r,count:s})).sort((r,s)=>s.count-r.count).slice(0,10)}getUserJourney(e){const n={};return e.forEach(r=>{var i;const s=r.user_id;n[s]||(n[s]=[]),n[s].push({page:((i=r.event_data)==null?void 0:i.pageUrl)||"unknown",timestamp:r.timestamp})}),Object.values(n).filter(r=>r.length>1).slice(0,50)}getDropoffPoints(e){const n={},r={},s={};return e.forEach(i=>{var u;const o=i.session_id,a=i.user_id,c=((u=i.event_data)==null?void 0:u.pageUrl)||"unknown";s[o]||(s[o]=[]),s[o].push({page:c,timestamp:i.timestamp,userId:a}),r[c]=(r[c]||0)+1}),Object.values(s).forEach(i=>{var o;i.sort((a,c)=>new Date(a.timestamp)-new Date(c.timestamp));for(let a=0;a<i.length;a++){const c=i[a].page;((o=i[a+1])==null?void 0:o.page)||(n[c]=(n[c]||0)+1)}}),Object.entries(r).map(([i,o])=>{const a=n[i]||0,c=o>0?a/o*100:0;return{page:i,entrances:o,exits:a,dropoffRate:Math.round(c*100)/100}}).sort((i,o)=>o.dropoffRate-i.dropoffRate).slice(0,10)}async getPerformance(e="7d"){try{const n=`analytics:performance:${e}`,r=x.get(n);if(r)return r;const s=await this.getEvents({eventType:"performance",timeframe:e}),i={loadTimes:s.map(o=>{var a;return((a=o.event_data)==null?void 0:a.loadTime)||0}),errorRates:this.calculateErrorRates(s),apiResponseTimes:s.map(o=>{var a;return((a=o.event_data)==null?void 0:a.apiResponseTime)||0})};return x.set(n,i,5*60*1e3),i}catch(n){return console.warn("Analytics performance service error (returning empty performance):",n.message),{loadTimes:[],errorRates:[],apiResponseTimes:[]}}}calculateErrorRates(e){const n=e.length,r=e.filter(s=>{var i;return(i=s.event_data)==null?void 0:i.hasError}).length;return n>0?r/n*100:0}async getConversionFunnel(e){const n=`analytics:funnel:${e}`,r=x.get(n);if(r)return r;try{const s=await this._getPocketbase().getOne("conversion_funnels",e);if(s.error)throw new Error(s.error);return x.set(n,s.data,15*60*1e3),s.data}catch(s){throw new Error(`Failed to fetch conversion funnel: ${s.message}`)}}async getABTestResults(e){const n=`analytics:ab_test:${e}`,r=x.get(n);if(r)return r;try{const s=await this._getPocketbase().getList("ab_test_results",{filter:`test_id = "${e}"`});if(s.error)throw new Error(s.error);return x.set(n,s.data,10*60*1e3),s.data}catch(s){throw new Error(`Failed to fetch A/B test results: ${s.message}`)}}async exportData(e="csv",n={}){try{const r=await this.getEvents(n);return e==="csv"?[["timestamp","event_type","user_id","page_url","event_data"].join(","),...r.map(o=>[o.timestamp,o.event_type,o.user_id,o.page_url,JSON.stringify(o.event_data)].join(","))].join(`
`):r}catch(r){throw new Error(`Failed to export data: ${r.message}`)}}buildEventFilterString(e){var i;const n=[],r=this._getPocketbase(),s=e.userId||((i=r.authStore.model)==null?void 0:i.id);return s&&n.push(`user_id = "${s}"`),e.eventType&&e.eventType!=="all"&&n.push(`event_type = "${e.eventType}"`),e.dateFrom&&n.push(`timestamp >= "${e.dateFrom}"`),e.dateTo&&n.push(`timestamp <= "${e.dateTo}"`),e.filter&&n.push(e.filter),n.join(" && ")}getStartDateForTimeframe(e){const n=new Date;switch(e){case"1d":return new Date(n.getTime()-24*60*60*1e3);case"7d":return new Date(n.getTime()-7*24*60*60*1e3);case"30d":return new Date(n.getTime()-30*24*60*60*1e3);case"90d":return new Date(n.getTime()-90*24*60*60*1e3);case"all":return null;default:return new Date(n.getTime()-7*24*60*60*1e3)}}getMockAnalyticsEvents(){return[{id:"event-1",event_type:"performance",event_data:{metric:"sprint_time",value:4.2,unit:"seconds"},timestamp:new Date(Date.now()-2*60*60*1e3).toISOString(),user_id:"mock-user"},{id:"event-2",event_type:"training_session",event_data:{session_type:"agility",duration:45,exercises_completed:8},timestamp:new Date(Date.now()-24*60*60*1e3).toISOString(),user_id:"mock-user"}]}}const ve=new ru,su={events:[],metrics:{pageViews:0,uniqueUsers:0,sessionDuration:0,conversionRate:0},userBehavior:{mostVisitedPages:[],userJourney:[],dropoffPoints:[]},performance:{loadTimes:[],errorRates:[],apiResponseTimes:[]},isLoading:!1,error:null,filters:{dateRange:"7d",eventType:"all",userId:null}},k={FETCH_EVENTS_START:"FETCH_EVENTS_START",FETCH_EVENTS_SUCCESS:"FETCH_EVENTS_SUCCESS",FETCH_EVENTS_FAILURE:"FETCH_EVENTS_FAILURE",TRACK_EVENT_START:"TRACK_EVENT_START",TRACK_EVENT_SUCCESS:"TRACK_EVENT_SUCCESS",TRACK_EVENT_FAILURE:"TRACK_EVENT_FAILURE",FETCH_METRICS_START:"FETCH_METRICS_START",FETCH_METRICS_SUCCESS:"FETCH_METRICS_SUCCESS",FETCH_METRICS_FAILURE:"FETCH_METRICS_FAILURE",FETCH_USER_BEHAVIOR_START:"FETCH_USER_BEHAVIOR_START",FETCH_USER_BEHAVIOR_SUCCESS:"FETCH_USER_BEHAVIOR_SUCCESS",FETCH_USER_BEHAVIOR_FAILURE:"FETCH_USER_BEHAVIOR_FAILURE",FETCH_PERFORMANCE_START:"FETCH_PERFORMANCE_START",FETCH_PERFORMANCE_SUCCESS:"FETCH_PERFORMANCE_SUCCESS",FETCH_PERFORMANCE_FAILURE:"FETCH_PERFORMANCE_FAILURE",SET_FILTERS:"SET_FILTERS",CLEAR_FILTERS:"CLEAR_FILTERS",CLEAR_ERROR:"CLEAR_ERROR"},iu=(t,e)=>{switch(e.type){case k.FETCH_EVENTS_START:case k.TRACK_EVENT_START:case k.FETCH_METRICS_START:case k.FETCH_USER_BEHAVIOR_START:case k.FETCH_PERFORMANCE_START:return{...t,isLoading:!0,error:null};case k.FETCH_EVENTS_SUCCESS:return{...t,events:e.payload,isLoading:!1,error:null};case k.TRACK_EVENT_SUCCESS:return{...t,events:[e.payload,...t.events],isLoading:!1,error:null};case k.FETCH_METRICS_SUCCESS:return{...t,metrics:e.payload,isLoading:!1,error:null};case k.FETCH_USER_BEHAVIOR_SUCCESS:return{...t,userBehavior:e.payload,isLoading:!1,error:null};case k.FETCH_PERFORMANCE_SUCCESS:return{...t,performance:e.payload,isLoading:!1,error:null};case k.SET_FILTERS:return{...t,filters:{...t.filters,...e.payload}};case k.CLEAR_FILTERS:return{...t,filters:{dateRange:"7d",eventType:"all",userId:null}};case k.FETCH_EVENTS_FAILURE:case k.TRACK_EVENT_FAILURE:case k.FETCH_METRICS_FAILURE:case k.FETCH_USER_BEHAVIOR_FAILURE:case k.FETCH_PERFORMANCE_FAILURE:return{...t,isLoading:!1,error:e.payload};case k.CLEAR_ERROR:return{...t,error:null};default:return t}},Eo=A.createContext(),ou=({children:t})=>{const[e,n]=A.useReducer(iu,su),{isAuthenticated:r,isLoading:s}=qn();A.useEffect(()=>{!s&&r?(console.log("Initializing analytics data for authenticated user..."),(async()=>{try{await Promise.all([a(),c(),u()]),console.log("Analytics data initialization completed")}catch(m){console.error("Failed to initialize analytics data:",m)}})()):console.log("Skipping analytics data initialization - auth not ready:",{authLoading:s,isAuthenticated:r})},[r,s]);const i=async(g={})=>{try{n({type:k.FETCH_EVENTS_START});const m=await ve.getEvents(g);return n({type:k.FETCH_EVENTS_SUCCESS,payload:m}),m}catch(m){throw n({type:k.FETCH_EVENTS_FAILURE,payload:m.message}),m}},o=async g=>{try{n({type:k.TRACK_EVENT_START});const m=await ve.trackEvent(g);return n({type:k.TRACK_EVENT_SUCCESS,payload:m}),m}catch(m){throw n({type:k.TRACK_EVENT_FAILURE,payload:m.message}),m}},a=async(g="7d")=>{try{n({type:k.FETCH_METRICS_START});const m=await ve.getMetrics(g);return n({type:k.FETCH_METRICS_SUCCESS,payload:m}),m}catch(m){throw n({type:k.FETCH_METRICS_FAILURE,payload:m.message}),m}},c=async(g={})=>{try{n({type:k.FETCH_USER_BEHAVIOR_START});const m=await ve.getUserBehavior(g);return n({type:k.FETCH_USER_BEHAVIOR_SUCCESS,payload:m}),m}catch(m){throw n({type:k.FETCH_USER_BEHAVIOR_FAILURE,payload:m.message}),m}},u=async(g="7d")=>{try{n({type:k.FETCH_PERFORMANCE_START});const m=await ve.getPerformance(g);return n({type:k.FETCH_PERFORMANCE_SUCCESS,payload:m}),m}catch(m){throw n({type:k.FETCH_PERFORMANCE_FAILURE,payload:m.message}),m}},T={...e,fetchEvents:i,trackEvent:o,fetchMetrics:a,fetchUserBehavior:c,fetchPerformance:u,setFilters:g=>{n({type:k.SET_FILTERS,payload:g})},clearFilters:()=>{n({type:k.CLEAR_FILTERS})},trackPageView:async g=>{try{const m={type:"page_view",timestamp:new Date().toISOString(),...g};await o(m)}catch(m){console.error("Failed to track page view:",m)}},trackInteraction:async g=>{try{const m={type:"user_interaction",timestamp:new Date().toISOString(),...g};await o(m)}catch(m){console.error("Failed to track interaction:",m)}},trackPerformance:async g=>{try{const m={type:"performance",timestamp:new Date().toISOString(),...g};await o(m)}catch(m){console.error("Failed to track performance:",m)}},getConversionFunnel:async g=>ve.getConversionFunnel(g),getABTestResults:async g=>ve.getABTestResults(g),exportData:async(g="csv",m={})=>ve.exportData(g,m),clearError:()=>{n({type:k.CLEAR_ERROR})}};return S.jsx(Eo.Provider,{value:T,children:t})},k_=()=>{const t=A.useContext(Eo);if(!t)throw new Error("useAnalytics must be used within an AnalyticsProvider");return t};var au=function(){return null};const cu=new Tc({defaultOptions:{queries:{staleTime:5*60*1e3,gcTime:10*60*1e3,retry:(t,e)=>(e==null?void 0:e.status)===404?!1:t<3,refetchOnWindowFocus:!1},mutations:{retry:!1}}}),uu=({children:t})=>S.jsxs(bc,{client:cu,children:[t,S.jsx(au,{initialIsOpen:!1})]}),lu=()=>{const[t,e]=A.useState(navigator.onLine),[n,r]=A.useState("unknown"),[s,i]=A.useState(null);return A.useEffect(()=>{const o=()=>{e(navigator.onLine)},a=()=>{if("connection"in navigator){const c=navigator.connection;switch(i({effectiveType:c.effectiveType,downlink:c.downlink,rtt:c.rtt,saveData:c.saveData}),c.effectiveType){case"4g":r("excellent");break;case"3g":r("good");break;case"2g":r("poor");break;case"slow-2g":r("very-poor");break;default:r("unknown")}}};return a(),window.addEventListener("online",o),window.addEventListener("offline",o),"connection"in navigator&&navigator.connection.addEventListener("change",a),()=>{window.removeEventListener("online",o),window.removeEventListener("offline",o),"connection"in navigator&&navigator.connection.removeEventListener("change",a)}},[]),{isOnline:t,networkQuality:n,connectionInfo:s}},Gs={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_AI_SERVICE_URL:"http://localhost:8080",VITE_API_BASE_URL:"http://localhost:3001",VITE_API_TIMEOUT:"30000",VITE_APP_ENV:"production",VITE_APP_ENVIRONMENT:"development",VITE_APP_NAME:"Flag Football Training App",VITE_APP_VERSION:"1.0.0",VITE_CACHE_TTL:"300000",VITE_DEBUG_LOGGING:"false",VITE_DEV_MODE:"true",VITE_ENABLE_ANALYTICS:"false",VITE_ENABLE_PUSH_NOTIFICATIONS:"true",VITE_ENABLE_SENTRY:"false",VITE_ENABLE_WEARABLE_SYNC:"false",VITE_GOOGLE_ANALYTICS_ID:"your_ga_id",VITE_POCKETBASE_URL:"https://your-pocketbase-instance.fly.dev",VITE_SENTRY_DSN:"your_sentry_dsn",VITE_SUPABASE_ANON_KEY:"pocketbase",VITE_SUPABASE_URL:"http://127.0.0.1:8090",VITE_YOUTUBE_API_KEY:"your_youtube_api_key"},Ft=new Map,cn=t=>{const e=Ft.get(t);return e?Object.fromEntries(Object.entries(e.stores).map(([n,r])=>[n,r.getState()])):{}},du=(t,e,n)=>{if(t===void 0)return{type:"untracked",connection:e.connect(n)};const r=Ft.get(n.name);if(r)return{type:"tracked",store:t,...r};const s={connection:e.connect(n),stores:{}};return Ft.set(n.name,s),{type:"tracked",store:t,...s}},pu=(t,e)=>{if(e===void 0)return;const n=Ft.get(t);n&&(delete n.stores[e],Object.keys(n.stores).length===0&&Ft.delete(t))},fu=t=>{var e,n;if(!t)return;const r=t.split(`
`),s=r.findIndex(o=>o.includes("api.setState"));if(s<0)return;const i=((e=r[s+1])==null?void 0:e.trim())||"";return(n=/.+ (.+) .+/.exec(i))==null?void 0:n[1]},hu=(t,e={})=>(n,r,s)=>{const{enabled:i,anonymousActionType:o,store:a,...c}=e;let u;try{u=(i??(Gs?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!u)return t(n,r,s);const{connection:l,...d}=du(a,u,c);let p=!0;s.setState=(h,b,I)=>{const E=n(h,b);if(!p)return E;const T=I===void 0?{type:o||fu(new Error().stack)||"anonymous"}:typeof I=="string"?{type:I}:I;return a===void 0?(l==null||l.send(T,r()),E):(l==null||l.send({...T,type:`${a}/${T.type}`},{...cn(c.name),[a]:s.getState()}),E)},s.devtools={cleanup:()=>{l&&typeof l.unsubscribe=="function"&&l.unsubscribe(),pu(c.name,a)}};const f=(...h)=>{const b=p;p=!1,n(...h),p=b},_=t(s.setState,r,s);if(d.type==="untracked"?l==null||l.init(_):(d.stores[d.store]=s,l==null||l.init(Object.fromEntries(Object.entries(d.stores).map(([h,b])=>[h,h===d.store?_:b.getState()])))),s.dispatchFromDevtools&&typeof s.dispatch=="function"){let h=!1;const b=s.dispatch;s.dispatch=(...I)=>{(Gs?"production":void 0)!=="production"&&I[0].type==="__setState"&&!h&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),h=!0),b(...I)}}return l.subscribe(h=>{var b;switch(h.type){case"ACTION":if(typeof h.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return sr(h.payload,I=>{if(I.type==="__setState"){if(a===void 0){f(I.state);return}Object.keys(I.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const E=I.state[a];if(E==null)return;JSON.stringify(s.getState())!==JSON.stringify(E)&&f(E);return}s.dispatchFromDevtools&&typeof s.dispatch=="function"&&s.dispatch(I)});case"DISPATCH":switch(h.payload.type){case"RESET":return f(_),a===void 0?l==null?void 0:l.init(s.getState()):l==null?void 0:l.init(cn(c.name));case"COMMIT":if(a===void 0){l==null||l.init(s.getState());return}return l==null?void 0:l.init(cn(c.name));case"ROLLBACK":return sr(h.state,I=>{if(a===void 0){f(I),l==null||l.init(s.getState());return}f(I[a]),l==null||l.init(cn(c.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return sr(h.state,I=>{if(a===void 0){f(I);return}JSON.stringify(s.getState())!==JSON.stringify(I[a])&&f(I[a])});case"IMPORT_STATE":{const{nextLiftedState:I}=h.payload,E=(b=I.computedStates.slice(-1)[0])==null?void 0:b.state;if(!E)return;f(a===void 0?E:E[a]),l==null||l.send(null,I);return}case"PAUSE_RECORDING":return p=!p}return}}),_},mu=hu,sr=(t,e)=>{let n;try{n=JSON.parse(t)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}n!==void 0&&e(n)};function gu(t,e){let n;try{n=t()}catch{return}return{getItem:s=>{var i;const o=c=>c===null?null:JSON.parse(c,void 0),a=(i=n.getItem(s))!=null?i:null;return a instanceof Promise?a.then(o):o(a)},setItem:(s,i)=>n.setItem(s,JSON.stringify(i,void 0)),removeItem:s=>n.removeItem(s)}}const Cr=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return Cr(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return Cr(r)(n)}}}},_u=(t,e)=>(n,r,s)=>{let i={storage:gu(()=>localStorage),partialize:h=>h,version:0,merge:(h,b)=>({...b,...h}),...e},o=!1;const a=new Set,c=new Set;let u=i.storage;if(!u)return t((...h)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...h)},r,s);const l=()=>{const h=i.partialize({...r()});return u.setItem(i.name,{state:h,version:i.version})},d=s.setState;s.setState=(h,b)=>{d(h,b),l()};const p=t((...h)=>{n(...h),l()},r,s);s.getInitialState=()=>p;let f;const _=()=>{var h,b;if(!u)return;o=!1,a.forEach(E=>{var T;return E((T=r())!=null?T:p)});const I=((b=i.onRehydrateStorage)==null?void 0:b.call(i,(h=r())!=null?h:p))||void 0;return Cr(u.getItem.bind(u))(i.name).then(E=>{if(E)if(typeof E.version=="number"&&E.version!==i.version){if(i.migrate){const T=i.migrate(E.state,E.version);return T instanceof Promise?T.then(g=>[!0,g]):[!0,T]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,E.state];return[!1,void 0]}).then(E=>{var T;const[g,m]=E;if(f=i.merge(m,(T=r())!=null?T:p),n(f,!0),g)return l()}).then(()=>{I==null||I(f,void 0),f=r(),o=!0,c.forEach(E=>E(f))}).catch(E=>{I==null||I(void 0,E)})};return s.persist={setOptions:h=>{i={...i,...h},h.storage&&(u=h.storage)},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>_(),hasHydrated:()=>o,onHydrate:h=>(a.add(h),()=>{a.delete(h)}),onFinishHydration:h=>(c.add(h),()=>{c.delete(h)})},i.skipHydration||_(),f||p},Su=_u,yu=Rc()(mu(Su((t,e)=>({user:null,isAuthenticated:!1,theme:"light",currentProgram:null,sessions:[],loading:!1,errors:[],setUser:n=>t({user:n,isAuthenticated:!!n}),clearUser:()=>t({user:null,isAuthenticated:!1}),setTheme:n=>t({theme:n}),toggleTheme:()=>t(n=>({theme:n.theme==="light"?"dark":"light"})),setCurrentProgram:n=>t({currentProgram:n}),setSessions:n=>t({sessions:n}),addSession:n=>t(r=>({sessions:[...r.sessions,n]})),updateSession:(n,r)=>t(s=>({sessions:s.sessions.map(i=>i.id===n?{...i,...r}:i)})),removeSession:n=>t(r=>({sessions:r.sessions.filter(s=>s.id!==n)})),setLoading:n=>t({loading:n}),addError:n=>t(r=>({errors:[...r.errors,{id:Date.now(),message:n}]})),removeError:n=>t(r=>({errors:r.errors.filter(s=>s.id!==n)})),clearErrors:()=>t({errors:[]}),get isLoading(){return e().loading},get hasErrors(){return e().errors.length>0},get isDarkMode(){return e().theme==="dark"}}),{name:"flagfit-app-store",partialize:t=>({theme:t.theme,user:t.user,isAuthenticated:t.isAuthenticated,currentProgram:t.currentProgram})}),{name:"flagfit-app-store"})),Vn=Xr.memo(({size:t="md",className:e=""})=>{const n={sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12",xl:"w-16 h-16"};return S.jsx("div",{className:`flex justify-center items-center ${e}`,children:S.jsx("div",{className:`${n[t]} border-4 border-gray-200 border-t-green-600 rounded-full animate-spin`,role:"status","aria-label":"Loading",children:S.jsx("span",{className:"sr-only",children:"Loading..."})})})});Vn.displayName="LoadingSpinner";const Eu=()=>S.jsx("div",{className:"bg-yellow-500 text-white px-4 py-2 text-center text-sm font-medium",children:S.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[S.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),S.jsx("span",{children:"You are currently offline. Some features may be limited."})]})});class Tu{constructor(){this.config=this.loadConfig(),this.validateConfig()}loadConfig(){return{app:{name:"Flag Football Training App",version:"1.0.0",environment:"development"},api:{pocketbaseUrl:"https://your-pocketbase-instance.fly.dev",timeout:parseInt("30000")||3e4,cacheTTL:parseInt("300000")||3e5,baseUrl:"http://localhost:3001",aiServiceUrl:"http://localhost:8080"},features:{analytics:!1,pushNotifications:!0,wearableSync:!1},dev:{devMode:!0,debugLogging:!1},sentry:{dsn:null,environment:"development"}}}validateConfig(){const e=[];this.isValidUrl(this.config.api.pocketbaseUrl)||e.push("VITE_POCKETBASE_URL must be a valid URL"),this.config.api.timeout<1e3&&e.push("VITE_API_TIMEOUT must be at least 1000ms"),this.config.api.cacheTTL<6e4&&e.push("VITE_CACHE_TTL must be at least 60000ms (1 minute)");const n=["development","staging","production"];if(n.includes(this.config.app.environment)||e.push(`VITE_APP_ENVIRONMENT must be one of: ${n.join(", ")}`),e.length>0&&(console.error("Environment configuration errors:",e),this.config.app.environment==="production"))throw new Error(`Invalid environment configuration: ${e.join(", ")}`)}isValidUrl(e){try{return new URL(e),!0}catch{return!1}}isValidSentryDsn(e){return/^https:\/\/[a-f0-9]+@[a-z0-9.-]+\/\d+$/.test(e)}get isProduction(){return this.config.app.environment==="production"}get isDevelopment(){return this.config.app.environment==="development"}get isStaging(){return this.config.app.environment==="staging"}get debugMode(){return this.config.dev.devMode&&this.config.dev.debugLogging}getConfig(){return this.config}getSection(e){return this.config[e]}}const le=new Tu,Fe={ERROR:0,WARN:1,INFO:2,DEBUG:3};class bu{constructor(){it(this,"consoleTransport",e=>{const{level:n,message:r,meta:s}=e,i=this.getConsoleStyle(n);console.groupCollapsed(`%c[${n}] ${r}`,i),console.log("Timestamp:",e.timestamp),console.log("Meta:",s),console.groupEnd()});it(this,"localStorageTransport",e=>{try{const n=JSON.parse(localStorage.getItem("app_logs")||"[]");n.push(e),n.length>100&&n.splice(0,n.length-100),localStorage.setItem("app_logs",JSON.stringify(n))}catch(n){console.warn("Failed to save log to localStorage:",n)}});it(this,"remoteTransport",async e=>{try{await fetch("/api/logs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(n){console.warn("Failed to send log to remote endpoint:",n)}});this.logLevel=le.debugMode?Fe.DEBUG:Fe.INFO,this.transports=new Set,this.setupDefaultTransports()}setupDefaultTransports(){(le.isDevelopment||le.debugMode)&&this.addTransport("console",this.consoleTransport),le.isProduction&&this.addTransport("remote",this.remoteTransport),this.addTransport("localStorage",this.localStorageTransport)}addTransport(e,n){this.transports.add({name:e,transport:n})}removeTransport(e){this.transports=new Set([...this.transports].filter(n=>n.name!==e))}log(e,n,r={}){if(e>this.logLevel)return;const s={timestamp:new Date().toISOString(),level:Object.keys(Fe)[e],message:n,meta:{...r,userAgent:navigator.userAgent,url:window.location.href,userId:this.getCurrentUserId(),sessionId:this.getSessionId(),buildVersion:le.getConfig().app.version}};this.transports.forEach(({transport:i})=>{try{i(s)}catch(o){console.error("Logging transport failed:",o),this.consoleTransport(s)}})}error(e,n={}){this.log(Fe.ERROR,e,n)}warn(e,n={}){this.log(Fe.WARN,e,n)}info(e,n={}){this.log(Fe.INFO,e,n)}debug(e,n={}){this.log(Fe.DEBUG,e,n)}getConsoleStyle(e){const n={ERROR:"color: #ff6b6b; font-weight: bold;",WARN:"color: #feca57; font-weight: bold;",INFO:"color: #48dbfb; font-weight: bold;",DEBUG:"color: #ff9ff3; font-weight: bold;"};return n[e]||n.INFO}getCurrentUserId(){var e;try{return((e=JSON.parse(localStorage.getItem("pocketbase_auth")||"{}").model)==null?void 0:e.id)||"anonymous"}catch{return"anonymous"}}getSessionId(){return sessionStorage.getItem("session_id")||sessionStorage.setItem("session_id",this.generateSessionId()),sessionStorage.getItem("session_id")}generateSessionId(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}startTimer(e){const n=performance.now();return{end:()=>{const r=performance.now()-n;return this.debug(`Timer [${e}]`,{duration:`${r.toFixed(2)}ms`}),r}}}logRequest(e,n,r,s){const i={url:e,method:n,status:r,duration:s};r>=400?this.error(`HTTP ${r} - ${n} ${e}`,i):r>=300?this.warn(`HTTP ${r} - ${n} ${e}`,i):this.debug(`HTTP ${r} - ${n} ${e}`,i)}logUserAction(e,n,r={}){this.info(`User Action: ${e}`,{action:e,target:n,...r})}logError(e,n=""){this.error(`${n?`${n}: `:""}${e.message}`,{stack:e.stack,name:e.name,context:n})}getStoredLogs(){try{return JSON.parse(localStorage.getItem("app_logs")||"[]")}catch{return[]}}clearStoredLogs(){localStorage.removeItem("app_logs")}}const Ue=new bu,v=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,N=globalThis,je="9.40.0";function Qe(){return Gn(N),N}function Gn(t){const e=t.__SENTRY__=t.__SENTRY__||{};return e.version=e.version||je,e[je]=e[je]||{}}function Wt(t,e,n=N){const r=n.__SENTRY__=n.__SENTRY__||{},s=r[je]=r[je]||{};return s[t]||(s[t]=e())}const vu=["debug","info","warn","error","log","assert","trace"],Iu="Sentry Logger ",Cn={};function yt(t){if(!("console"in N))return t();const e=N.console,n={},r=Object.keys(Cn);r.forEach(s=>{const i=Cn[s];n[s]=e[s],e[s]=i});try{return t()}finally{r.forEach(s=>{e[s]=n[s]})}}function wu(){ns().enabled=!0}function Ru(){ns().enabled=!1}function To(){return ns().enabled}function Cu(...t){ts("log",...t)}function Au(...t){ts("warn",...t)}function Ou(...t){ts("error",...t)}function ts(t,...e){v&&To()&&yt(()=>{N.console[t](`${Iu}[${t}]:`,...e)})}function ns(){return v?Wt("loggerSettings",()=>({enabled:!1})):{enabled:!1}}const y={enable:wu,disable:Ru,isEnabled:To,log:Cu,warn:Au,error:Ou},bo=50,ze="?",zs=/\(error: (.*)\)/,Ws=/captureMessage|captureException/;function vo(...t){const e=t.sort((n,r)=>n[0]-r[0]).map(n=>n[1]);return(n,r=0,s=0)=>{const i=[],o=n.split(`
`);for(let a=r;a<o.length;a++){const c=o[a];if(c.length>1024)continue;const u=zs.test(c)?c.replace(zs,"$1"):c;if(!u.match(/\S*Error: /)){for(const l of e){const d=l(u);if(d){i.push(d);break}}if(i.length>=bo+s)break}}return Nu(i.slice(s))}}function ku(t){return Array.isArray(t)?vo(...t):t}function Nu(t){if(!t.length)return[];const e=Array.from(t);return/sentryWrapped/.test(un(e).function||"")&&e.pop(),e.reverse(),Ws.test(un(e).function||"")&&(e.pop(),Ws.test(un(e).function||"")&&e.pop()),e.slice(0,bo).map(n=>({...n,filename:n.filename||un(e).filename,function:n.function||ze}))}function un(t){return t[t.length-1]||{}}const ir="<anonymous>";function Re(t){try{return!t||typeof t!="function"?ir:t.name||ir}catch{return ir}}function Ks(t){const e=t.exception;if(e){const n=[];try{return e.values.forEach(r=>{r.stacktrace.frames&&n.push(...r.stacktrace.frames)}),n}catch{return}}}const Sn={},Js={};function Kt(t,e){Sn[t]=Sn[t]||[],Sn[t].push(e)}function Jt(t,e){if(!Js[t]){Js[t]=!0;try{e()}catch(n){v&&y.error(`Error while instrumenting ${t}`,n)}}}function He(t,e){const n=t&&Sn[t];if(n)for(const r of n)try{r(e)}catch(s){v&&y.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${Re(r)}
Error:`,s)}}let or=null;function Io(t){const e="error";Kt(e,t),Jt(e,Pu)}function Pu(){or=N.onerror,N.onerror=function(t,e,n,r,s){return He("error",{column:r,error:s,line:n,msg:t,url:e}),or?or.apply(this,arguments):!1},N.onerror.__SENTRY_INSTRUMENTED__=!0}let ar=null;function wo(t){const e="unhandledrejection";Kt(e,t),Jt(e,Lu)}function Lu(){ar=N.onunhandledrejection,N.onunhandledrejection=function(t){return He("unhandledrejection",t),ar?ar.apply(this,arguments):!0},N.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const Ro=Object.prototype.toString;function rs(t){switch(Ro.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return me(t,Error)}}function Et(t,e){return Ro.call(t)===`[object ${e}]`}function Co(t){return Et(t,"ErrorEvent")}function Ys(t){return Et(t,"DOMError")}function xu(t){return Et(t,"DOMException")}function Ut(t){return Et(t,"String")}function ss(t){return typeof t=="object"&&t!==null&&"__sentry_template_string__"in t&&"__sentry_template_values__"in t}function is(t){return t===null||ss(t)||typeof t!="object"&&typeof t!="function"}function Mt(t){return Et(t,"Object")}function zn(t){return typeof Event<"u"&&me(t,Event)}function $u(t){return typeof Element<"u"&&me(t,Element)}function Du(t){return Et(t,"RegExp")}function Wn(t){return!!(t!=null&&t.then&&typeof t.then=="function")}function Fu(t){return Mt(t)&&"nativeEvent"in t&&"preventDefault"in t&&"stopPropagation"in t}function me(t,e){try{return t instanceof e}catch{return!1}}function Ao(t){return!!(typeof t=="object"&&t!==null&&(t.__isVue||t._isVue))}function Oo(t){return typeof Request<"u"&&me(t,Request)}const os=N,Uu=80;function ko(t,e={}){if(!t)return"<unknown>";try{let n=t;const r=5,s=[];let i=0,o=0;const a=" > ",c=a.length;let u;const l=Array.isArray(e)?e:e.keyAttrs,d=!Array.isArray(e)&&e.maxStringLength||Uu;for(;n&&i++<r&&(u=Mu(n,l),!(u==="html"||i>1&&o+s.length*c+u.length>=d));)s.push(u),o+=u.length,n=n.parentNode;return s.reverse().join(a)}catch{return"<unknown>"}}function Mu(t,e){const n=t,r=[];if(!(n!=null&&n.tagName))return"";if(os.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const s=e!=null&&e.length?e.filter(o=>n.getAttribute(o)).map(o=>[o,n.getAttribute(o)]):null;if(s!=null&&s.length)s.forEach(o=>{r.push(`[${o[0]}="${o[1]}"]`)});else{n.id&&r.push(`#${n.id}`);const o=n.className;if(o&&Ut(o)){const a=o.split(/\s+/);for(const c of a)r.push(`.${c}`)}}const i=["aria-label","type","name","title","alt"];for(const o of i){const a=n.getAttribute(o);a&&r.push(`[${o}="${a}"]`)}return r.join("")}function Yt(){try{return os.document.location.href}catch{return""}}function ju(t){if(!os.HTMLElement)return null;let e=t;const n=5;for(let r=0;r<n;r++){if(!e)return null;if(e instanceof HTMLElement){if(e.dataset.sentryComponent)return e.dataset.sentryComponent;if(e.dataset.sentryElement)return e.dataset.sentryElement}e=e.parentNode}return null}function An(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:`${t.slice(0,e)}...`}function Xs(t,e){if(!Array.isArray(t))return"";const n=[];for(let r=0;r<t.length;r++){const s=t[r];try{Ao(s)?n.push("[VueViewModel]"):n.push(String(s))}catch{n.push("[value cannot be serialized]")}}return n.join(e)}function Hu(t,e,n=!1){return Ut(t)?Du(e)?e.test(t):Ut(e)?n?t===e:t.includes(e):!1:!1}function Be(t,e=[],n=!1){return e.some(r=>Hu(t,r,n))}function fe(t,e,n){if(!(e in t))return;const r=t[e];if(typeof r!="function")return;const s=n(r);typeof s=="function"&&No(s,r);try{t[e]=s}catch{v&&y.log(`Failed to replace method "${e}" in object`,t)}}function ie(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch{v&&y.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function No(t,e){try{const n=e.prototype||{};t.prototype=e.prototype=n,ie(t,"__sentry_original__",e)}catch{}}function as(t){return t.__sentry_original__}function Po(t){if(rs(t))return{message:t.message,name:t.name,stack:t.stack,...Zs(t)};if(zn(t)){const e={type:t.type,target:Qs(t.target),currentTarget:Qs(t.currentTarget),...Zs(t)};return typeof CustomEvent<"u"&&me(t,CustomEvent)&&(e.detail=t.detail),e}else return t}function Qs(t){try{return $u(t)?ko(t):Object.prototype.toString.call(t)}catch{return"<unknown>"}}function Zs(t){if(typeof t=="object"&&t!==null){const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}else return{}}function Bu(t,e=40){const n=Object.keys(Po(t));n.sort();const r=n[0];if(!r)return"[object has no keys]";if(r.length>=e)return An(r,e);for(let s=n.length;s>0;s--){const i=n.slice(0,s).join(", ");if(!(i.length>e))return s===n.length?i:An(i,e)}return""}function qu(){const t=N;return t.crypto||t.msCrypto}function ne(t=qu()){let e=()=>Math.random()*16;try{if(t!=null&&t.randomUUID)return t.randomUUID().replace(/-/g,"");t!=null&&t.getRandomValues&&(e=()=>{const n=new Uint8Array(1);return t.getRandomValues(n),n[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,n=>(n^(e()&15)>>n/4).toString(16))}function Lo(t){var e,n;return(n=(e=t.exception)==null?void 0:e.values)==null?void 0:n[0]}function Me(t){const{message:e,event_id:n}=t;if(e)return e;const r=Lo(t);return r?r.type&&r.value?`${r.type}: ${r.value}`:r.type||r.value||n||"<unknown>":n||"<unknown>"}function Ar(t,e,n){const r=t.exception=t.exception||{},s=r.values=r.values||[],i=s[0]=s[0]||{};i.value||(i.value=e||""),i.type||(i.type="Error")}function pt(t,e){const n=Lo(t);if(!n)return;const r={type:"generic",handled:!0},s=n.mechanism;if(n.mechanism={...r,...s,...e},e&&"data"in e){const i={...s==null?void 0:s.data,...e.data};n.mechanism.data=i}}function ei(t){if(Vu(t))return!0;try{ie(t,"__sentry_captured__",!0)}catch{}return!1}function Vu(t){try{return t.__sentry_captured__}catch{}}const xo=1e3;function Ze(){return Date.now()/xo}function Gu(){const{performance:t}=N;if(!(t!=null&&t.now)||!t.timeOrigin)return Ze;const e=t.timeOrigin;return()=>(e+t.now())/xo}let ti;function Z(){return(ti??(ti=Gu()))()}let cr;function zu(){var l;const{performance:t}=N;if(!(t!=null&&t.now))return[void 0,"none"];const e=3600*1e3,n=t.now(),r=Date.now(),s=t.timeOrigin?Math.abs(t.timeOrigin+n-r):e,i=s<e,o=(l=t.timing)==null?void 0:l.navigationStart,c=typeof o=="number"?Math.abs(o+n-r):e,u=c<e;return i||u?s<=c?[t.timeOrigin,"timeOrigin"]:[o,"navigationStart"]:[r,"dateNow"]}function cs(){return cr||(cr=zu()),cr[0]}function Wu(t){const e=Z(),n={sid:ne(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>Ju(n)};return t&&ft(n,t),n}function ft(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),!t.did&&!e.did&&(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||Z(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:ne()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const n=t.timestamp-t.started;t.duration=n>=0?n:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function Ku(t,e){let n={};t.status==="ok"&&(n={status:"exited"}),ft(t,n)}function Ju(t){return{sid:`${t.sid}`,init:t.init,started:new Date(t.started*1e3).toISOString(),timestamp:new Date(t.timestamp*1e3).toISOString(),status:t.status,errors:t.errors,did:typeof t.did=="number"||typeof t.did=="string"?`${t.did}`:void 0,duration:t.duration,abnormal_mechanism:t.abnormal_mechanism,attrs:{release:t.release,environment:t.environment,ip_address:t.ipAddress,user_agent:t.userAgent}}}function Xt(t,e,n=2){if(!e||typeof e!="object"||n<=0)return e;if(t&&Object.keys(e).length===0)return t;const r={...t};for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=Xt(r[s],e[s],n-1));return r}function Ce(){return ne()}function Qt(){return ne().substring(16)}const Or="_sentrySpan";function jt(t,e){e?ie(t,Or,e):delete t[Or]}function On(t){return t[Or]}const Yu=100;let ht=class kr{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:Ce(),sampleRand:Math.random()}}clone(){const e=new kr;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,jt(e,On(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&ft(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,n){return this._tags={...this._tags,[e]:n},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,n){return this._extra={...this._extra,[e]:n},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,n){return n===null?delete this._contexts[e]:this._contexts[e]=n,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const n=typeof e=="function"?e(this):e,r=n instanceof kr?n.getScopeData():Mt(n)?e:void 0,{tags:s,extra:i,user:o,contexts:a,level:c,fingerprint:u=[],propagationContext:l}=r||{};return this._tags={...this._tags,...s},this._extra={...this._extra,...i},this._contexts={...this._contexts,...a},o&&Object.keys(o).length&&(this._user=o),c&&(this._level=c),u.length&&(this._fingerprint=u),l&&(this._propagationContext=l),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,jt(this,void 0),this._attachments=[],this.setPropagationContext({traceId:Ce(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(e,n){var i;const r=typeof n=="number"?n:Yu;if(r<=0)return this;const s={timestamp:Ze(),...e,message:e.message?An(e.message,2048):e.message};return this._breadcrumbs.push(s),this._breadcrumbs.length>r&&(this._breadcrumbs=this._breadcrumbs.slice(-r),(i=this._client)==null||i.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:On(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=Xt(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,n){const r=(n==null?void 0:n.event_id)||ne();if(!this._client)return v&&y.warn("No client configured on scope - will not capture exception!"),r;const s=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:s,...n,event_id:r},this),r}captureMessage(e,n,r){const s=(r==null?void 0:r.event_id)||ne();if(!this._client)return v&&y.warn("No client configured on scope - will not capture message!"),s;const i=new Error(e);return this._client.captureMessage(e,n,{originalException:e,syntheticException:i,...r,event_id:s},this),s}captureEvent(e,n){const r=(n==null?void 0:n.event_id)||ne();return this._client?(this._client.captureEvent(e,{...n,event_id:r},this),r):(v&&y.warn("No client configured on scope - will not capture event!"),r)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}};function Xu(){return Wt("defaultCurrentScope",()=>new ht)}function Qu(){return Wt("defaultIsolationScope",()=>new ht)}let Zu=class{constructor(e,n){let r;e?r=e:r=new ht;let s;n?s=n:s=new ht,this._stack=[{scope:r}],this._isolationScope=s}withScope(e){const n=this._pushScope();let r;try{r=e(n)}catch(s){throw this._popScope(),s}return Wn(r)?r.then(s=>(this._popScope(),s),s=>{throw this._popScope(),s}):(this._popScope(),r)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}};function mt(){const t=Qe(),e=Gn(t);return e.stack=e.stack||new Zu(Xu(),Qu())}function el(t){return mt().withScope(t)}function tl(t,e){const n=mt();return n.withScope(()=>(n.getStackTop().scope=t,e(t)))}function ni(t){return mt().withScope(()=>t(mt().getIsolationScope()))}function nl(){return{withIsolationScope:ni,withScope:el,withSetScope:tl,withSetIsolationScope:(t,e)=>ni(e),getCurrentScope:()=>mt().getScope(),getIsolationScope:()=>mt().getIsolationScope()}}function Tt(t){const e=Gn(t);return e.acs?e.acs:nl()}function U(){const t=Qe();return Tt(t).getCurrentScope()}function oe(){const t=Qe();return Tt(t).getIsolationScope()}function rl(){return Wt("globalScope",()=>new ht)}function Ht(...t){const e=Qe(),n=Tt(e);if(t.length===2){const[r,s]=t;return r?n.withSetScope(r,s):n.withScope(s)}return n.withScope(t[0])}function P(){return U().getClient()}function sl(t){const e=t.getPropagationContext(),{traceId:n,parentSpanId:r,propagationSpanId:s}=e,i={trace_id:n,span_id:s||Qt()};return r&&(i.parent_span_id=r),i}const he="sentry.source",us="sentry.sample_rate",$o="sentry.previous_trace_sample_rate",Bt="sentry.op",We="sentry.origin",kn="sentry.idle_span_finish_reason",il="sentry.measurement_unit",ol="sentry.measurement_value",ri="sentry.custom_span_name",ls="sentry.profile_id",ds="sentry.exclusive_time",al="sentry.link.type",cl=0,Do=1,z=2;function ul(t){if(t<400&&t>=100)return{code:Do};if(t>=400&&t<500)switch(t){case 401:return{code:z,message:"unauthenticated"};case 403:return{code:z,message:"permission_denied"};case 404:return{code:z,message:"not_found"};case 409:return{code:z,message:"already_exists"};case 413:return{code:z,message:"failed_precondition"};case 429:return{code:z,message:"resource_exhausted"};case 499:return{code:z,message:"cancelled"};default:return{code:z,message:"invalid_argument"}}if(t>=500&&t<600)switch(t){case 501:return{code:z,message:"unimplemented"};case 503:return{code:z,message:"unavailable"};case 504:return{code:z,message:"deadline_exceeded"};default:return{code:z,message:"internal_error"}}return{code:z,message:"unknown_error"}}function Fo(t,e){t.setAttribute("http.response.status_code",e);const n=ul(e);n.message!=="unknown_error"&&t.setStatus(n)}const Uo="_sentryScope",Mo="_sentryIsolationScope";function ll(t,e,n){t&&(ie(t,Mo,n),ie(t,Uo,e))}function Nn(t){return{scope:t[Uo],isolationScope:t[Mo]}}const ps="sentry-",dl=/^sentry-/,pl=8192;function jo(t){const e=hl(t);if(!e)return;const n=Object.entries(e).reduce((r,[s,i])=>{if(s.match(dl)){const o=s.slice(ps.length);r[o]=i}return r},{});if(Object.keys(n).length>0)return n}function fl(t){if(!t)return;const e=Object.entries(t).reduce((n,[r,s])=>(s&&(n[`${ps}${r}`]=s),n),{});return ml(e)}function hl(t){if(!(!t||!Ut(t)&&!Array.isArray(t)))return Array.isArray(t)?t.reduce((e,n)=>{const r=si(n);return Object.entries(r).forEach(([s,i])=>{e[s]=i}),e},{}):si(t)}function si(t){return t.split(",").map(e=>e.split("=").map(n=>{try{return decodeURIComponent(n.trim())}catch{return}})).reduce((e,[n,r])=>(n&&r&&(e[n]=r),e),{})}function ml(t){if(Object.keys(t).length!==0)return Object.entries(t).reduce((e,[n,r],s)=>{const i=`${encodeURIComponent(n)}=${encodeURIComponent(r)}`,o=s===0?i:`${e},${i}`;return o.length>pl?(v&&y.warn(`Not adding key: ${n} with val: ${r} to baggage header due to exceeding baggage size limits.`),e):o},"")}function qt(t){if(typeof t=="boolean")return Number(t);const e=typeof t=="string"?parseFloat(t):t;if(!(typeof e!="number"||isNaN(e)||e<0||e>1))return e}const Ho=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function gl(t){if(!t)return;const e=t.match(Ho);if(!e)return;let n;return e[3]==="1"?n=!0:e[3]==="0"&&(n=!1),{traceId:e[1],parentSampled:n,parentSpanId:e[2]}}function _l(t,e){const n=gl(t),r=jo(e);if(!(n!=null&&n.traceId))return{traceId:Ce(),sampleRand:Math.random()};const s=Sl(n,r);r&&(r.sample_rand=s.toString());const{traceId:i,parentSpanId:o,parentSampled:a}=n;return{traceId:i,parentSpanId:o,sampled:a,dsc:r||{},sampleRand:s}}function Bo(t=Ce(),e=Qt(),n){let r="";return n!==void 0&&(r=n?"-1":"-0"),`${t}-${e}${r}`}function Sl(t,e){const n=qt(e==null?void 0:e.sample_rand);if(n!==void 0)return n;const r=qt(e==null?void 0:e.sample_rate);return r&&(t==null?void 0:t.parentSampled)!==void 0?t.parentSampled?Math.random()*r:r+Math.random()*(1-r):Math.random()}const qo=0,fs=1;let ii=!1;function yl(t){const{spanId:e,traceId:n}=t.spanContext(),{data:r,op:s,parent_span_id:i,status:o,origin:a,links:c}=F(t);return{parent_span_id:i,span_id:e,trace_id:n,data:r,op:s,status:o,origin:a,links:c}}function El(t){const{spanId:e,traceId:n,isRemote:r}=t.spanContext(),s=r?e:F(t).parent_span_id,i=Nn(t).scope,o=r?(i==null?void 0:i.getPropagationContext().propagationSpanId)||Qt():e;return{parent_span_id:s,span_id:o,trace_id:n}}function Tl(t){const{traceId:e,spanId:n}=t.spanContext(),r=et(t);return Bo(e,n,r)}function Vo(t){if(t&&t.length>0)return t.map(({context:{spanId:e,traceId:n,traceFlags:r,...s},attributes:i})=>({span_id:e,trace_id:n,sampled:r===fs,attributes:i,...s}))}function qe(t){return typeof t=="number"?oi(t):Array.isArray(t)?t[0]+t[1]/1e9:t instanceof Date?oi(t.getTime()):Z()}function oi(t){return t>9999999999?t/1e3:t}function F(t){var r;if(vl(t))return t.getSpanJSON();const{spanId:e,traceId:n}=t.spanContext();if(bl(t)){const{attributes:s,startTime:i,name:o,endTime:a,status:c,links:u}=t,l="parentSpanId"in t?t.parentSpanId:"parentSpanContext"in t?(r=t.parentSpanContext)==null?void 0:r.spanId:void 0;return{span_id:e,trace_id:n,data:s,description:o,parent_span_id:l,start_timestamp:qe(i),timestamp:qe(a)||void 0,status:Go(c),op:s[Bt],origin:s[We],links:Vo(u)}}return{span_id:e,trace_id:n,start_timestamp:0,data:{}}}function bl(t){const e=t;return!!e.attributes&&!!e.startTime&&!!e.name&&!!e.endTime&&!!e.status}function vl(t){return typeof t.getSpanJSON=="function"}function et(t){const{traceFlags:e}=t.spanContext();return e===fs}function Go(t){if(!(!t||t.code===cl))return t.code===Do?"ok":t.message||"unknown_error"}const Ve="_sentryChildSpans",Nr="_sentryRootSpan";function zo(t,e){const n=t[Nr]||t;ie(e,Nr,n),t[Ve]?t[Ve].add(e):ie(t,Ve,new Set([e]))}function Il(t,e){t[Ve]&&t[Ve].delete(e)}function yn(t){const e=new Set;function n(r){if(!e.has(r)&&et(r)){e.add(r);const s=r[Ve]?Array.from(r[Ve]):[];for(const i of s)n(i)}}return n(t),Array.from(e)}function re(t){return t[Nr]||t}function bt(){const t=Qe(),e=Tt(t);return e.getActiveSpan?e.getActiveSpan():On(U())}function Pr(){ii||(yt(()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly.")}),ii=!0)}let ai=!1;function wl(){if(ai)return;function t(){const e=bt(),n=e&&re(e);if(n){const r="internal_error";v&&y.log(`[Tracing] Root span: ${r} -> Global error occurred`),n.setStatus({code:z,message:r})}}t.tag="sentry_tracingErrorCallback",ai=!0,Io(t),wo(t)}function Ae(t){var n;if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const e=t||((n=P())==null?void 0:n.getOptions());return!!e&&(e.tracesSampleRate!=null||!!e.tracesSampler)}const hs="production",Rl=/^o(\d+)\./,Cl=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function Al(t){return t==="http"||t==="https"}function vt(t,e=!1){const{host:n,path:r,pass:s,port:i,projectId:o,protocol:a,publicKey:c}=t;return`${a}://${c}${e&&s?`:${s}`:""}@${n}${i?`:${i}`:""}/${r&&`${r}/`}${o}`}function Ol(t){const e=Cl.exec(t);if(!e){yt(()=>{console.error(`Invalid Sentry Dsn: ${t}`)});return}const[n,r,s="",i="",o="",a=""]=e.slice(1);let c="",u=a;const l=u.split("/");if(l.length>1&&(c=l.slice(0,-1).join("/"),u=l.pop()),u){const d=u.match(/^\d+/);d&&(u=d[0])}return Wo({host:i,pass:s,path:c,projectId:u,port:o,protocol:n,publicKey:r})}function Wo(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function kl(t){if(!v)return!0;const{port:e,projectId:n,protocol:r}=t;return["protocol","publicKey","host","projectId"].find(o=>t[o]?!1:(y.error(`Invalid Sentry Dsn: ${o} missing`),!0))?!1:n.match(/^\d+$/)?Al(r)?e&&isNaN(parseInt(e,10))?(y.error(`Invalid Sentry Dsn: Invalid port ${e}`),!1):!0:(y.error(`Invalid Sentry Dsn: Invalid protocol ${r}`),!1):(y.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1)}function Nl(t){const e=t.match(Rl);return e==null?void 0:e[1]}function Ko(t){const e=typeof t=="string"?Ol(t):Wo(t);if(!(!e||!kl(e)))return e}const Jo="_frozenDsc";function En(t,e){ie(t,Jo,e)}function Yo(t,e){const n=e.getOptions(),{publicKey:r,host:s}=e.getDsn()||{};let i;n.orgId?i=String(n.orgId):s&&(i=Nl(s));const o={environment:n.environment||hs,release:n.release,public_key:r,trace_id:t,org_id:i};return e.emit("createDsc",o),o}function Xo(t,e){const n=e.getPropagationContext();return n.dsc||Yo(n.traceId,t)}function Oe(t){var _;const e=P();if(!e)return{};const n=re(t),r=F(n),s=r.data,i=n.spanContext().traceState,o=(i==null?void 0:i.get("sentry.sample_rate"))??s[us]??s[$o];function a(h){return(typeof o=="number"||typeof o=="string")&&(h.sample_rate=`${o}`),h}const c=n[Jo];if(c)return a(c);const u=i==null?void 0:i.get("sentry.dsc"),l=u&&jo(u);if(l)return a(l);const d=Yo(t.spanContext().traceId,e),p=s[he],f=r.description;return p!=="url"&&f&&(d.transaction=f),Ae()&&(d.sampled=String(et(n)),d.sample_rand=(i==null?void 0:i.get("sentry.sample_rand"))??((_=Nn(n).scope)==null?void 0:_.getPropagationContext().sampleRand.toString())),a(d),e.emit("createDsc",d,n),d}let Ke=class{constructor(e={}){this._traceId=e.traceId||Ce(),this._spanId=e.spanId||Qt()}spanContext(){return{spanId:this._spanId,traceId:this._traceId,traceFlags:qo}}end(e){}setAttribute(e,n){return this}setAttributes(e){return this}setStatus(e){return this}updateName(e){return this}isRecording(){return!1}addEvent(e,n,r){return this}addLink(e){return this}addLinks(e){return this}recordException(e,n){}};function pe(t,e=100,n=1/0){try{return Lr("",t,e,n)}catch(r){return{ERROR:`**non-serializable** (${r})`}}}function Qo(t,e=3,n=100*1024){const r=pe(t,e);return $l(r)>n?Qo(t,e-1,n):r}function Lr(t,e,n=1/0,r=1/0,s=Dl()){const[i,o]=s;if(e==null||["boolean","string"].includes(typeof e)||typeof e=="number"&&Number.isFinite(e))return e;const a=Pl(t,e);if(!a.startsWith("[object "))return a;if(e.__sentry_skip_normalization__)return e;const c=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:n;if(c===0)return a.replace("object ","");if(i(e))return"[Circular ~]";const u=e;if(u&&typeof u.toJSON=="function")try{const f=u.toJSON();return Lr("",f,c-1,r,s)}catch{}const l=Array.isArray(e)?[]:{};let d=0;const p=Po(e);for(const f in p){if(!Object.prototype.hasOwnProperty.call(p,f))continue;if(d>=r){l[f]="[MaxProperties ~]";break}const _=p[f];l[f]=Lr(f,_,c-1,r,s),d++}return o(e),l}function Pl(t,e){try{if(t==="domain"&&e&&typeof e=="object"&&e._events)return"[Domain]";if(t==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&e===global)return"[Global]";if(typeof window<"u"&&e===window)return"[Window]";if(typeof document<"u"&&e===document)return"[Document]";if(Ao(e))return"[VueViewModel]";if(Fu(e))return"[SyntheticEvent]";if(typeof e=="number"&&!Number.isFinite(e))return`[${e}]`;if(typeof e=="function")return`[Function: ${Re(e)}]`;if(typeof e=="symbol")return`[${String(e)}]`;if(typeof e=="bigint")return`[BigInt: ${String(e)}]`;const n=Ll(e);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(n){return`**non-serializable** (${n})`}}function Ll(t){const e=Object.getPrototypeOf(t);return e!=null&&e.constructor?e.constructor.name:"null prototype"}function xl(t){return~-encodeURI(t).split(/%..|./).length}function $l(t){return xl(JSON.stringify(t))}function Dl(){const t=new WeakSet;function e(r){return t.has(r)?!0:(t.add(r),!1)}function n(r){t.delete(r)}return[e,n]}function It(t,e=[]){return[t,e]}function Fl(t,e){const[n,r]=t;return[n,[...r,e]]}function ci(t,e){const n=t[1];for(const r of n){const s=r[0].type;if(e(r,s))return!0}return!1}function xr(t){const e=Gn(N);return e.encodePolyfill?e.encodePolyfill(t):new TextEncoder().encode(t)}function Ul(t){const[e,n]=t;let r=JSON.stringify(e);function s(i){typeof r=="string"?r=typeof i=="string"?r+i:[xr(r),i]:r.push(typeof i=="string"?xr(i):i)}for(const i of n){const[o,a]=i;if(s(`
${JSON.stringify(o)}
`),typeof a=="string"||a instanceof Uint8Array)s(a);else{let c;try{c=JSON.stringify(a)}catch{c=JSON.stringify(pe(a))}s(c)}}return typeof r=="string"?r:Ml(r)}function Ml(t){const e=t.reduce((s,i)=>s+i.length,0),n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}function jl(t){return[{type:"span"},t]}function Hl(t){const e=typeof t.data=="string"?xr(t.data):t.data;return[{type:"attachment",length:e.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType},e]}const Bl={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",raw_security:"security",log:"log_item"};function ui(t){return Bl[t]}function Zo(t){if(!(t!=null&&t.sdk))return;const{name:e,version:n}=t.sdk;return{name:e,version:n}}function ql(t,e,n,r){var i;const s=(i=t.sdkProcessingMetadata)==null?void 0:i.dynamicSamplingContext;return{event_id:t.event_id,sent_at:new Date().toISOString(),...e&&{sdk:e},...!!n&&r&&{dsn:vt(r)},...s&&{trace:s}}}function Vl(t,e){return e&&(t.sdk=t.sdk||{},t.sdk.name=t.sdk.name||e.name,t.sdk.version=t.sdk.version||e.version,t.sdk.integrations=[...t.sdk.integrations||[],...e.integrations||[]],t.sdk.packages=[...t.sdk.packages||[],...e.packages||[]]),t}function Gl(t,e,n,r){const s=Zo(n),i={sent_at:new Date().toISOString(),...s&&{sdk:s},...!!r&&e&&{dsn:vt(e)}},o="aggregates"in t?[{type:"sessions"},t]:[{type:"session"},t.toJSON()];return It(i,[o])}function zl(t,e,n,r){const s=Zo(n),i=t.type&&t.type!=="replay_event"?t.type:"event";Vl(t,n==null?void 0:n.sdk);const o=ql(t,s,r,e);return delete t.sdkProcessingMetadata,It(o,[[{type:i},t]])}function Wl(t,e){function n(l){return!!l.trace_id&&!!l.public_key}const r=Oe(t[0]),s=e==null?void 0:e.getDsn(),i=e==null?void 0:e.getOptions().tunnel,o={sent_at:new Date().toISOString(),...n(r)&&{trace:r},...!!i&&s&&{dsn:vt(s)}},a=e==null?void 0:e.getOptions().beforeSendSpan,c=a?l=>{const d=F(l),p=a(d);return p||(Pr(),d)}:F,u=[];for(const l of t){const d=c(l);d&&u.push(jl(d))}return It(o,u)}function Kl(t){if(!v)return;const{description:e="< unknown name >",op:n="< unknown op >",parent_span_id:r}=F(t),{spanId:s}=t.spanContext(),i=et(t),o=re(t),a=o===t,c=`[Tracing] Starting ${i?"sampled":"unsampled"} ${a?"root ":""}span`,u=[`op: ${n}`,`name: ${e}`,`ID: ${s}`];if(r&&u.push(`parent ID: ${r}`),!a){const{op:l,description:d}=F(o);u.push(`root ID: ${o.spanContext().spanId}`),l&&u.push(`root op: ${l}`),d&&u.push(`root description: ${d}`)}y.log(`${c}
  ${u.join(`
  `)}`)}function Jl(t){if(!v)return;const{description:e="< unknown name >",op:n="< unknown op >"}=F(t),{spanId:r}=t.spanContext(),i=re(t)===t,o=`[Tracing] Finishing "${n}" ${i?"root ":""}span "${e}" with ID ${r}`;y.log(o)}function li(t){if(!t||t.length===0)return;const e={};return t.forEach(n=>{const r=n.attributes||{},s=r[il],i=r[ol];typeof s=="string"&&typeof i=="number"&&(e[n.name]={value:i,unit:s})}),e}const di=1e3;let Kn=class{constructor(e={}){this._traceId=e.traceId||Ce(),this._spanId=e.spanId||Qt(),this._startTime=e.startTimestamp||Z(),this._links=e.links,this._attributes={},this.setAttributes({[We]:"manual",[Bt]:e.op,...e.attributes}),this._name=e.name,e.parentSpanId&&(this._parentSpanId=e.parentSpanId),"sampled"in e&&(this._sampled=e.sampled),e.endTimestamp&&(this._endTime=e.endTimestamp),this._events=[],this._isStandaloneSpan=e.isStandalone,this._endTime&&this._onSpanEnded()}addLink(e){return this._links?this._links.push(e):this._links=[e],this}addLinks(e){return this._links?this._links.push(...e):this._links=e,this}recordException(e,n){}spanContext(){const{_spanId:e,_traceId:n,_sampled:r}=this;return{spanId:e,traceId:n,traceFlags:r?fs:qo}}setAttribute(e,n){return n===void 0?delete this._attributes[e]:this._attributes[e]=n,this}setAttributes(e){return Object.keys(e).forEach(n=>this.setAttribute(n,e[n])),this}updateStartTime(e){this._startTime=qe(e)}setStatus(e){return this._status=e,this}updateName(e){return this._name=e,this.setAttribute(he,"custom"),this}end(e){this._endTime||(this._endTime=qe(e),Jl(this),this._onSpanEnded())}getSpanJSON(){return{data:this._attributes,description:this._name,op:this._attributes[Bt],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:Go(this._status),timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes[We],profile_id:this._attributes[ls],exclusive_time:this._attributes[ds],measurements:li(this._events),is_segment:this._isStandaloneSpan&&re(this)===this||void 0,segment_id:this._isStandaloneSpan?re(this).spanContext().spanId:void 0,links:Vo(this._links)}}isRecording(){return!this._endTime&&!!this._sampled}addEvent(e,n,r){v&&y.log("[Tracing] Adding an event to span:",e);const s=pi(n)?n:r||Z(),i=pi(n)?{}:n||{},o={name:e,time:qe(s),attributes:i};return this._events.push(o),this}isStandaloneSpan(){return!!this._isStandaloneSpan}_onSpanEnded(){const e=P();if(e&&e.emit("spanEnd",this),!(this._isStandaloneSpan||this===re(this)))return;if(this._isStandaloneSpan){this._sampled?Xl(Wl([this],e)):(v&&y.log("[Tracing] Discarding standalone span because its trace was not chosen to be sampled."),e&&e.recordDroppedEvent("sample_rate","span"));return}const r=this._convertSpanToTransaction();r&&(Nn(this).scope||U()).captureEvent(r)}_convertSpanToTransaction(){var l;if(!fi(F(this)))return;this._name||(v&&y.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>");const{scope:e,isolationScope:n}=Nn(this),r=(l=e==null?void 0:e.getScopeData().sdkProcessingMetadata)==null?void 0:l.normalizedRequest;if(this._sampled!==!0)return;const i=yn(this).filter(d=>d!==this&&!Yl(d)).map(d=>F(d)).filter(fi),o=this._attributes[he];delete this._attributes[ri],i.forEach(d=>{delete d.data[ri]});const a={contexts:{trace:yl(this)},spans:i.length>di?i.sort((d,p)=>d.start_timestamp-p.start_timestamp).slice(0,di):i,start_timestamp:this._startTime,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{capturedSpanScope:e,capturedSpanIsolationScope:n,dynamicSamplingContext:Oe(this)},request:r,...o&&{transaction_info:{source:o}}},c=li(this._events);return c&&Object.keys(c).length&&(v&&y.log("[Measurements] Adding measurements to transaction event",JSON.stringify(c,void 0,2)),a.measurements=c),a}};function pi(t){return t&&typeof t=="number"||t instanceof Date||Array.isArray(t)}function fi(t){return!!t.start_timestamp&&!!t.timestamp&&!!t.span_id&&!!t.trace_id}function Yl(t){return t instanceof Kn&&t.isStandaloneSpan()}function Xl(t){const e=P();if(!e)return;const n=t[1];if(!n||n.length===0){e.recordDroppedEvent("before_send","span");return}e.sendEnvelope(t)}function Ql(t,e,n){if(!Ae(t))return[!1];let r,s;typeof t.tracesSampler=="function"?(s=t.tracesSampler({...e,inheritOrSampleWith:a=>typeof e.parentSampleRate=="number"?e.parentSampleRate:typeof e.parentSampled=="boolean"?Number(e.parentSampled):a}),r=!0):e.parentSampled!==void 0?s=e.parentSampled:typeof t.tracesSampleRate<"u"&&(s=t.tracesSampleRate,r=!0);const i=qt(s);if(i===void 0)return v&&y.warn(`[Tracing] Discarding root span because of invalid sample rate. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(s)} of type ${JSON.stringify(typeof s)}.`),[!1];if(!i)return v&&y.log(`[Tracing] Discarding transaction because ${typeof t.tracesSampler=="function"?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`),[!1,i,r];const o=n<i;return o||v&&y.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(s)})`),[o,i,r]}const ea="__SENTRY_SUPPRESS_TRACING__";function Jn(t){const e=ta();if(e.startInactiveSpan)return e.startInactiveSpan(t);const n=td(t),{forceTransaction:r,parentSpan:s}=t;return(t.scope?o=>Ht(t.scope,o):s!==void 0?o=>Zl(s,o):o=>o())(()=>{const o=U(),a=rd(o,s);return t.onlyIfParent&&!a?new Ke:ed({parentSpan:a,spanArguments:n,forceTransaction:r,scope:o})})}function Zl(t,e){const n=ta();return n.withActiveSpan?n.withActiveSpan(t,e):Ht(r=>(jt(r,t||void 0),e(r)))}function ed({parentSpan:t,spanArguments:e,forceTransaction:n,scope:r}){if(!Ae()){const o=new Ke;if(n||!t){const a={sampled:"false",sample_rate:"0",transaction:e.name,...Oe(o)};En(o,a)}return o}const s=oe();let i;if(t&&!n)i=nd(t,r,e),zo(t,i);else if(t){const o=Oe(t),{traceId:a,spanId:c}=t.spanContext(),u=et(t);i=hi({traceId:a,parentSpanId:c,...e},r,u),En(i,o)}else{const{traceId:o,dsc:a,parentSpanId:c,sampled:u}={...s.getPropagationContext(),...r.getPropagationContext()};i=hi({traceId:o,parentSpanId:c,...e},r,u),a&&En(i,a)}return Kl(i),ll(i,r,s),i}function td(t){const n={isStandalone:(t.experimental||{}).standalone,...t};if(t.startTime){const r={...n};return r.startTimestamp=qe(t.startTime),delete r.startTime,r}return n}function ta(){const t=Qe();return Tt(t)}function hi(t,e,n){var _;const r=P(),s=(r==null?void 0:r.getOptions())||{},{name:i=""}=t,o={spanAttributes:{...t.attributes},spanName:i,parentSampled:n};r==null||r.emit("beforeSampling",o,{decision:!1});const a=o.parentSampled??n,c=o.spanAttributes,u=e.getPropagationContext(),[l,d,p]=e.getScopeData().sdkProcessingMetadata[ea]?[!1]:Ql(s,{name:i,parentSampled:a,attributes:c,parentSampleRate:qt((_=u.dsc)==null?void 0:_.sample_rate)},u.sampleRand),f=new Kn({...t,attributes:{[he]:"custom",[us]:d!==void 0&&p?d:void 0,...c},sampled:l});return!l&&r&&(v&&y.log("[Tracing] Discarding root span because its trace was not chosen to be sampled."),r.recordDroppedEvent("sample_rate","transaction")),r&&r.emit("spanStart",f),f}function nd(t,e,n){const{spanId:r,traceId:s}=t.spanContext(),i=e.getScopeData().sdkProcessingMetadata[ea]?!1:et(t),o=i?new Kn({...n,parentSpanId:r,traceId:s,sampled:i}):new Ke({traceId:s});zo(t,o);const a=P();return a&&(a.emit("spanStart",o),n.endTimestamp&&a.emit("spanEnd",o)),o}function rd(t,e){if(e)return e;if(e===null)return;const n=On(t);if(!n)return;const r=P();return(r?r.getOptions():{}).parentSpanIsAlwaysRootSpan?re(n):n}const Tn={idleTimeout:1e3,finalTimeout:3e4,childSpanTimeout:15e3},sd="heartbeatFailed",id="idleTimeout",od="finalTimeout",ad="externalFinish";function na(t,e={}){const n=new Map;let r=!1,s,i=ad,o=!e.disableAutoFinish;const a=[],{idleTimeout:c=Tn.idleTimeout,finalTimeout:u=Tn.finalTimeout,childSpanTimeout:l=Tn.childSpanTimeout,beforeSpanEnd:d}=e,p=P();if(!p||!Ae()){const w=new Ke,V={sample_rate:"0",sampled:"false",...Oe(w)};return En(w,V),w}const f=U(),_=bt(),h=cd(t);h.end=new Proxy(h.end,{apply(w,V,rt){if(d&&d(h),V instanceof Ke)return;const[kt,...st]=rt,$e=kt||Z(),j=qe($e),De=yn(h).filter(B=>B!==h);if(!De.length)return m(j),Reflect.apply(w,V,[j,...st]);const ye=De.map(B=>F(B).timestamp).filter(B=>!!B),$=ye.length?Math.max(...ye):void 0,H=F(h).start_timestamp,L=Math.min(H?H+u/1e3:1/0,Math.max(H||-1/0,Math.min(j,$||1/0)));return m(L),Reflect.apply(w,V,[L,...st])}});function b(){s&&(clearTimeout(s),s=void 0)}function I(w){b(),s=setTimeout(()=>{!r&&n.size===0&&o&&(i=id,h.end(w))},c)}function E(w){s=setTimeout(()=>{!r&&o&&(i=sd,h.end(w))},l)}function T(w){b(),n.set(w,!0);const V=Z();E(V+l/1e3)}function g(w){if(n.has(w)&&n.delete(w),n.size===0){const V=Z();I(V+c/1e3)}}function m(w){r=!0,n.clear(),a.forEach(j=>j()),jt(f,_);const V=F(h),{start_timestamp:rt}=V;if(!rt)return;V.data[kn]||h.setAttribute(kn,i),y.log(`[Tracing] Idle span "${V.op}" finished`);const st=yn(h).filter(j=>j!==h);let $e=0;st.forEach(j=>{j.isRecording()&&(j.setStatus({code:z,message:"cancelled"}),j.end(w),v&&y.log("[Tracing] Cancelling span since span ended early",JSON.stringify(j,void 0,2)));const De=F(j),{timestamp:ye=0,start_timestamp:$=0}=De,H=$<=w,L=(u+c)/1e3,B=ye-$<=L;if(v){const G=JSON.stringify(j,void 0,2);H?B||y.log("[Tracing] Discarding span since it finished after idle span final timeout",G):y.log("[Tracing] Discarding span since it happened after idle span was finished",G)}(!B||!H)&&(Il(h,j),$e++)}),$e>0&&h.setAttribute("sentry.idle_span_discarded_spans",$e)}return a.push(p.on("spanStart",w=>{if(r||w===h||F(w).timestamp||w instanceof Kn&&w.isStandaloneSpan())return;yn(h).includes(w)&&T(w.spanContext().spanId)})),a.push(p.on("spanEnd",w=>{r||g(w.spanContext().spanId)})),a.push(p.on("idleSpanEnableAutoFinish",w=>{w===h&&(o=!0,I(),n.size&&E())})),e.disableAutoFinish||I(),setTimeout(()=>{r||(h.setStatus({code:z,message:"deadline_exceeded"}),i=od,h.end())},u),h}function cd(t){const e=Jn(t);return jt(U(),e),v&&y.log("[Tracing] Started span is an idle span"),e}const ur=0,mi=1,gi=2;function Je(t){return new ke(e=>{e(t)})}function Pn(t){return new ke((e,n)=>{n(t)})}class ke{constructor(e){this._state=ur,this._handlers=[],this._runExecutor(e)}then(e,n){return new ke((r,s)=>{this._handlers.push([!1,i=>{if(!e)r(i);else try{r(e(i))}catch(o){s(o)}},i=>{if(!n)s(i);else try{r(n(i))}catch(o){s(o)}}]),this._executeHandlers()})}catch(e){return this.then(n=>n,e)}finally(e){return new ke((n,r)=>{let s,i;return this.then(o=>{i=!1,s=o,e&&e()},o=>{i=!0,s=o,e&&e()}).then(()=>{if(i){r(s);return}n(s)})})}_executeHandlers(){if(this._state===ur)return;const e=this._handlers.slice();this._handlers=[],e.forEach(n=>{n[0]||(this._state===mi&&n[1](this._value),this._state===gi&&n[2](this._value),n[0]=!0)})}_runExecutor(e){const n=(i,o)=>{if(this._state===ur){if(Wn(o)){o.then(r,s);return}this._state=i,this._value=o,this._executeHandlers()}},r=i=>{n(mi,i)},s=i=>{n(gi,i)};try{e(r,s)}catch(i){s(i)}}}function $r(t,e,n,r=0){return new ke((s,i)=>{const o=t[r];if(e===null||typeof o!="function")s(e);else{const a=o({...e},n);v&&o.id&&a===null&&y.log(`Event processor "${o.id}" dropped event`),Wn(a)?a.then(c=>$r(t,c,n,r+1).then(s)).then(null,i):$r(t,a,n,r+1).then(s).then(null,i)}})}function ud(t,e){const{fingerprint:n,span:r,breadcrumbs:s,sdkProcessingMetadata:i}=e;ld(t,e),r&&fd(t,r),hd(t,n),dd(t,s),pd(t,i)}function _i(t,e){const{extra:n,tags:r,user:s,contexts:i,level:o,sdkProcessingMetadata:a,breadcrumbs:c,fingerprint:u,eventProcessors:l,attachments:d,propagationContext:p,transactionName:f,span:_}=e;ln(t,"extra",n),ln(t,"tags",r),ln(t,"user",s),ln(t,"contexts",i),t.sdkProcessingMetadata=Xt(t.sdkProcessingMetadata,a,2),o&&(t.level=o),f&&(t.transactionName=f),_&&(t.span=_),c.length&&(t.breadcrumbs=[...t.breadcrumbs,...c]),u.length&&(t.fingerprint=[...t.fingerprint,...u]),l.length&&(t.eventProcessors=[...t.eventProcessors,...l]),d.length&&(t.attachments=[...t.attachments,...d]),t.propagationContext={...t.propagationContext,...p}}function ln(t,e,n){t[e]=Xt(t[e],n,1)}function ld(t,e){const{extra:n,tags:r,user:s,contexts:i,level:o,transactionName:a}=e;Object.keys(n).length&&(t.extra={...n,...t.extra}),Object.keys(r).length&&(t.tags={...r,...t.tags}),Object.keys(s).length&&(t.user={...s,...t.user}),Object.keys(i).length&&(t.contexts={...i,...t.contexts}),o&&(t.level=o),a&&t.type!=="transaction"&&(t.transaction=a)}function dd(t,e){const n=[...t.breadcrumbs||[],...e];t.breadcrumbs=n.length?n:void 0}function pd(t,e){t.sdkProcessingMetadata={...t.sdkProcessingMetadata,...e}}function fd(t,e){t.contexts={trace:El(e),...t.contexts},t.sdkProcessingMetadata={dynamicSamplingContext:Oe(e),...t.sdkProcessingMetadata};const n=re(e),r=F(n).description;r&&!t.transaction&&t.type==="transaction"&&(t.transaction=r)}function hd(t,e){t.fingerprint=t.fingerprint?Array.isArray(t.fingerprint)?t.fingerprint:[t.fingerprint]:[],e&&(t.fingerprint=t.fingerprint.concat(e)),t.fingerprint.length||delete t.fingerprint}let dn,Si,pn;function md(t){const e=N._sentryDebugIds;if(!e)return{};const n=Object.keys(e);return pn&&n.length===Si||(Si=n.length,pn=n.reduce((r,s)=>{dn||(dn={});const i=dn[s];if(i)r[i[0]]=i[1];else{const o=t(s);for(let a=o.length-1;a>=0;a--){const c=o[a],u=c==null?void 0:c.filename,l=e[s];if(u&&l){r[u]=l,dn[s]=[u,l];break}}}return r},{})),pn}function gd(t,e,n,r,s,i){const{normalizeDepth:o=3,normalizeMaxBreadth:a=1e3}=t,c={...e,event_id:e.event_id||n.event_id||ne(),timestamp:e.timestamp||Ze()},u=n.integrations||t.integrations.map(b=>b.name);_d(c,t),Ed(c,u),s&&s.emit("applyFrameMetadata",e),e.type===void 0&&Sd(c,t.stackParser);const l=bd(r,n.captureContext);n.mechanism&&pt(c,n.mechanism);const d=s?s.getEventProcessors():[],p=rl().getScopeData();if(i){const b=i.getScopeData();_i(p,b)}if(l){const b=l.getScopeData();_i(p,b)}const f=[...n.attachments||[],...p.attachments];f.length&&(n.attachments=f),ud(c,p);const _=[...d,...p.eventProcessors];return $r(_,c,n).then(b=>(b&&yd(b),typeof o=="number"&&o>0?Td(b,o,a):b))}function _d(t,e){const{environment:n,release:r,dist:s,maxValueLength:i=250}=e;t.environment=t.environment||n||hs,!t.release&&r&&(t.release=r),!t.dist&&s&&(t.dist=s);const o=t.request;o!=null&&o.url&&(o.url=An(o.url,i))}function Sd(t,e){var r,s;const n=md(e);(s=(r=t.exception)==null?void 0:r.values)==null||s.forEach(i=>{var o,a;(a=(o=i.stacktrace)==null?void 0:o.frames)==null||a.forEach(c=>{c.filename&&(c.debug_id=n[c.filename])})})}function yd(t){var r,s;const e={};if((s=(r=t.exception)==null?void 0:r.values)==null||s.forEach(i=>{var o,a;(a=(o=i.stacktrace)==null?void 0:o.frames)==null||a.forEach(c=>{c.debug_id&&(c.abs_path?e[c.abs_path]=c.debug_id:c.filename&&(e[c.filename]=c.debug_id),delete c.debug_id)})}),Object.keys(e).length===0)return;t.debug_meta=t.debug_meta||{},t.debug_meta.images=t.debug_meta.images||[];const n=t.debug_meta.images;Object.entries(e).forEach(([i,o])=>{n.push({type:"sourcemap",code_file:i,debug_id:o})})}function Ed(t,e){e.length>0&&(t.sdk=t.sdk||{},t.sdk.integrations=[...t.sdk.integrations||[],...e])}function Td(t,e,n){var s,i;if(!t)return null;const r={...t,...t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map(o=>({...o,...o.data&&{data:pe(o.data,e,n)}}))},...t.user&&{user:pe(t.user,e,n)},...t.contexts&&{contexts:pe(t.contexts,e,n)},...t.extra&&{extra:pe(t.extra,e,n)}};return(s=t.contexts)!=null&&s.trace&&r.contexts&&(r.contexts.trace=t.contexts.trace,t.contexts.trace.data&&(r.contexts.trace.data=pe(t.contexts.trace.data,e,n))),t.spans&&(r.spans=t.spans.map(o=>({...o,...o.data&&{data:pe(o.data,e,n)}}))),(i=t.contexts)!=null&&i.flags&&r.contexts&&(r.contexts.flags=pe(t.contexts.flags,3,n)),r}function bd(t,e){if(!e)return t;const n=t?t.clone():new ht;return n.update(e),n}function ra(t,e){return U().captureException(t,void 0)}function vd(t,e){const r={captureContext:e};return U().captureMessage(t,void 0,r)}function sa(t,e){return U().captureEvent(t,e)}function ia(t,e){oe().setContext(t,e)}function Id(t,e){oe().setTag(t,e)}function yi(t){oe().setUser(t)}function wd(){return oe().lastEventId()}function Rd(){const t=P();return(t==null?void 0:t.getOptions().enabled)!==!1&&!!(t!=null&&t.getTransport())}function Ei(t){const e=oe(),n=U(),{userAgent:r}=N.navigator||{},s=Wu({user:n.getUser()||e.getUser(),...r&&{userAgent:r},...t}),i=e.getSession();return(i==null?void 0:i.status)==="ok"&&ft(i,{status:"exited"}),oa(),e.setSession(s),s}function oa(){const t=oe(),n=U().getSession()||t.getSession();n&&Ku(n),aa(),t.setSession()}function aa(){const t=oe(),e=P(),n=t.getSession();n&&e&&e.captureSession(n)}function Ti(t=!1){if(t){oa();return}aa()}const Cd="7";function ca(t){const e=t.protocol?`${t.protocol}:`:"",n=t.port?`:${t.port}`:"";return`${e}//${t.host}${n}${t.path?`/${t.path}`:""}/api/`}function Ad(t){return`${ca(t)}${t.projectId}/envelope/`}function Od(t,e){const n={sentry_version:Cd};return t.publicKey&&(n.sentry_key=t.publicKey),e&&(n.sentry_client=`${e.name}/${e.version}`),new URLSearchParams(n).toString()}function kd(t,e,n){return e||`${Ad(t)}?${Od(t,n)}`}function Nd(t,e){const n=Ko(t);if(!n)return"";const r=`${ca(n)}embed/error-page/`;let s=`dsn=${vt(n)}`;for(const i in e)if(i!=="dsn"&&i!=="onClose")if(i==="user"){const o=e.user;if(!o)continue;o.name&&(s+=`&name=${encodeURIComponent(o.name)}`),o.email&&(s+=`&email=${encodeURIComponent(o.email)}`)}else s+=`&${encodeURIComponent(i)}=${encodeURIComponent(e[i])}`;return`${r}?${s}`}const bi=[];function Pd(t){const e={};return t.forEach(n=>{const{name:r}=n,s=e[r];s&&!s.isDefaultInstance&&n.isDefaultInstance||(e[r]=n)}),Object.values(e)}function Ld(t){const e=t.defaultIntegrations||[],n=t.integrations;e.forEach(s=>{s.isDefaultInstance=!0});let r;if(Array.isArray(n))r=[...e,...n];else if(typeof n=="function"){const s=n(e);r=Array.isArray(s)?s:[s]}else r=e;return Pd(r)}function xd(t,e){const n={};return e.forEach(r=>{r&&ua(t,r,n)}),n}function vi(t,e){for(const n of e)n!=null&&n.afterAllSetup&&n.afterAllSetup(t)}function ua(t,e,n){if(n[e.name]){v&&y.log(`Integration skipped because it was already installed: ${e.name}`);return}if(n[e.name]=e,bi.indexOf(e.name)===-1&&typeof e.setupOnce=="function"&&(e.setupOnce(),bi.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(t),typeof e.preprocessEvent=="function"){const r=e.preprocessEvent.bind(e);t.on("preprocessEvent",(s,i)=>r(s,i,t))}if(typeof e.processEvent=="function"){const r=e.processEvent.bind(e),s=Object.assign((i,o)=>r(i,o,t),{id:e.name});t.addEventProcessor(s)}v&&y.log(`Integration installed: ${e.name}`)}function $d(t,e,n){const r=[{type:"client_report"},{timestamp:Ze(),discarded_events:t}];return It(e?{dsn:e}:{},[r])}function la(t){const e=[];t.message&&e.push(t.message);try{const n=t.exception.values[t.exception.values.length-1];n!=null&&n.value&&(e.push(n.value),n.type&&e.push(`${n.type}: ${n.value}`))}catch{}return e}function Dd(t){var c;const{trace_id:e,parent_span_id:n,span_id:r,status:s,origin:i,data:o,op:a}=((c=t.contexts)==null?void 0:c.trace)??{};return{data:o??{},description:t.transaction,op:a,parent_span_id:n,span_id:r??"",start_timestamp:t.start_timestamp??0,status:s,timestamp:t.timestamp,trace_id:e??"",origin:i,profile_id:o==null?void 0:o[ls],exclusive_time:o==null?void 0:o[ds],measurements:t.measurements,is_segment:!0}}function Fd(t){return{type:"transaction",timestamp:t.timestamp,start_timestamp:t.start_timestamp,transaction:t.description,contexts:{trace:{trace_id:t.trace_id,span_id:t.span_id,parent_span_id:t.parent_span_id,op:t.op,status:t.status,origin:t.origin,data:{...t.data,...t.profile_id&&{[ls]:t.profile_id},...t.exclusive_time&&{[ds]:t.exclusive_time}}}},measurements:t.measurements}}const Ii="Not capturing exception because it's already been captured.",wi="Discarded session because of missing or non-string release",da=Symbol.for("SentryInternalError"),pa=Symbol.for("SentryDoNotSendEventError");function bn(t){return{message:t,[da]:!0}}function lr(t){return{message:t,[pa]:!0}}function Ri(t){return!!t&&typeof t=="object"&&da in t}function Ci(t){return!!t&&typeof t=="object"&&pa in t}class Ud{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=Ko(e.dsn):v&&y.warn("No DSN provided, client will not send events."),this._dsn){const n=kd(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:n})}}captureException(e,n,r){const s=ne();if(ei(e))return v&&y.log(Ii),s;const i={event_id:s,...n};return this._process(this.eventFromException(e,i).then(o=>this._captureEvent(o,i,r))),i.event_id}captureMessage(e,n,r,s){const i={event_id:ne(),...r},o=ss(e)?e:String(e),a=is(e)?this.eventFromMessage(o,n,i):this.eventFromException(e,i);return this._process(a.then(c=>this._captureEvent(c,i,s))),i.event_id}captureEvent(e,n,r){const s=ne();if(n!=null&&n.originalException&&ei(n.originalException))return v&&y.log(Ii),s;const i={event_id:s,...n},o=e.sdkProcessingMetadata||{},a=o.capturedSpanScope,c=o.capturedSpanIsolationScope;return this._process(this._captureEvent(e,i,a||r,c)),i.event_id}captureSession(e){this.sendSession(e),ft(e,{init:!1})}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const n=this._transport;return n?(this.emit("flush"),this._isClientDoneProcessing(e).then(r=>n.flush(e).then(s=>r&&s))):Je(!0)}close(e){return this.flush(e).then(n=>(this.getOptions().enabled=!1,this.emit("close"),n))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some(({name:e})=>e.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const n=this._integrations[e.name];ua(this,e,this._integrations),n||vi(this,[e])}sendEvent(e,n={}){this.emit("beforeSendEvent",e,n);let r=zl(e,this._dsn,this._options._metadata,this._options.tunnel);for(const i of n.attachments||[])r=Fl(r,Hl(i));const s=this.sendEnvelope(r);s&&s.then(i=>this.emit("afterSendEvent",e,i),null)}sendSession(e){const{release:n,environment:r=hs}=this._options;if("aggregates"in e){const i=e.attrs||{};if(!i.release&&!n){v&&y.warn(wi);return}i.release=i.release||n,i.environment=i.environment||r,e.attrs=i}else{if(!e.release&&!n){v&&y.warn(wi);return}e.release=e.release||n,e.environment=e.environment||r}this.emit("beforeSendSession",e);const s=Gl(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(s)}recordDroppedEvent(e,n,r=1){if(this._options.sendClientReports){const s=`${e}:${n}`;v&&y.log(`Recording outcome: "${s}"${r>1?` (${r} times)`:""}`),this._outcomes[s]=(this._outcomes[s]||0)+r}}on(e,n){const r=this._hooks[e]=this._hooks[e]||[];return r.push(n),()=>{const s=r.indexOf(n);s>-1&&r.splice(s,1)}}emit(e,...n){const r=this._hooks[e];r&&r.forEach(s=>s(...n))}sendEnvelope(e){return this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport?this._transport.send(e).then(null,n=>(v&&y.error("Error while sending envelope:",n),n)):(v&&y.error("Transport disabled"),Je({}))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=xd(this,e),vi(this,e)}_updateSessionFromEvent(e,n){var c;let r=n.level==="fatal",s=!1;const i=(c=n.exception)==null?void 0:c.values;if(i){s=!0;for(const u of i){const l=u.mechanism;if((l==null?void 0:l.handled)===!1){r=!0;break}}}const o=e.status==="ok";(o&&e.errors===0||o&&r)&&(ft(e,{...r&&{status:"crashed"},errors:e.errors||Number(s||r)}),this.captureSession(e))}_isClientDoneProcessing(e){return new ke(n=>{let r=0;const s=1,i=setInterval(()=>{this._numProcessing==0?(clearInterval(i),n(!0)):(r+=s,e&&r>=e&&(clearInterval(i),n(!1)))},s)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,n,r,s){const i=this.getOptions(),o=Object.keys(this._integrations);return!n.integrations&&(o!=null&&o.length)&&(n.integrations=o),this.emit("preprocessEvent",e,n),e.type||s.setLastEventId(e.event_id||n.event_id),gd(i,e,n,r,this,s).then(a=>{if(a===null)return a;this.emit("postprocessEvent",a,n),a.contexts={trace:sl(r),...a.contexts};const c=Xo(this,r);return a.sdkProcessingMetadata={dynamicSamplingContext:c,...a.sdkProcessingMetadata},a})}_captureEvent(e,n={},r=U(),s=oe()){return v&&Dr(e)&&y.log(`Captured error event \`${la(e)[0]||"<unknown>"}\``),this._processEvent(e,n,r,s).then(i=>i.event_id,i=>{v&&(Ci(i)?y.log(i.message):Ri(i)?y.warn(i.message):y.warn(i))})}_processEvent(e,n,r,s){const i=this.getOptions(),{sampleRate:o}=i,a=fa(e),c=Dr(e),u=e.type||"error",l=`before send for type \`${u}\``,d=typeof o>"u"?void 0:qt(o);if(c&&typeof d=="number"&&Math.random()>d)return this.recordDroppedEvent("sample_rate","error"),Pn(lr(`Discarding event because it's not included in the random sample (sampling rate = ${o})`));const p=u==="replay_event"?"replay":u;return this._prepareEvent(e,n,r,s).then(f=>{if(f===null)throw this.recordDroppedEvent("event_processor",p),lr("An event processor returned `null`, will not send event.");if(n.data&&n.data.__sentry__===!0)return f;const h=jd(this,i,f,n);return Md(h,l)}).then(f=>{var b;if(f===null){if(this.recordDroppedEvent("before_send",p),a){const E=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",E)}throw lr(`${l} returned \`null\`, will not send event.`)}const _=r.getSession()||s.getSession();if(c&&_&&this._updateSessionFromEvent(_,f),a){const I=((b=f.sdkProcessingMetadata)==null?void 0:b.spanCountBeforeProcessing)||0,E=f.spans?f.spans.length:0,T=I-E;T>0&&this.recordDroppedEvent("before_send","span",T)}const h=f.transaction_info;if(a&&h&&f.transaction!==e.transaction){const I="custom";f.transaction_info={...h,source:I}}return this.sendEvent(f,n),f}).then(null,f=>{throw Ci(f)||Ri(f)?f:(this.captureException(f,{data:{__sentry__:!0},originalException:f}),bn(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${f}`))})}_process(e){this._numProcessing++,e.then(n=>(this._numProcessing--,n),n=>(this._numProcessing--,n))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map(([n,r])=>{const[s,i]=n.split(":");return{reason:s,category:i,quantity:r}})}_flushOutcomes(){v&&y.log("Flushing outcomes...");const e=this._clearOutcomes();if(e.length===0){v&&y.log("No outcomes to send");return}if(!this._dsn){v&&y.log("No dsn provided, will not send outcomes");return}v&&y.log("Sending outcomes:",e);const n=$d(e,this._options.tunnel&&vt(this._dsn));this.sendEnvelope(n)}}function Md(t,e){const n=`${e} must return \`null\` or a valid event.`;if(Wn(t))return t.then(r=>{if(!Mt(r)&&r!==null)throw bn(n);return r},r=>{throw bn(`${e} rejected with ${r}`)});if(!Mt(t)&&t!==null)throw bn(n);return t}function jd(t,e,n,r){const{beforeSend:s,beforeSendTransaction:i,beforeSendSpan:o}=e;let a=n;if(Dr(a)&&s)return s(a,r);if(fa(a)){if(o){const c=o(Dd(a));if(c?a=Xt(n,Fd(c)):Pr(),a.spans){const u=[];for(const l of a.spans){const d=o(l);d?u.push(d):(Pr(),u.push(l))}a.spans=u}}if(i){if(a.spans){const c=a.spans.length;a.sdkProcessingMetadata={...n.sdkProcessingMetadata,spanCountBeforeProcessing:c}}return i(a,r)}}return a}function Dr(t){return t.type===void 0}function fa(t){return t.type==="transaction"}function Hd(t){return[{type:"log",item_count:t.length,content_type:"application/vnd.sentry.items.log+json"},{items:t}]}function Bd(t,e,n,r){const s={};return e!=null&&e.sdk&&(s.sdk={name:e.sdk.name,version:e.sdk.version}),n&&r&&(s.dsn=vt(r)),It(s,[Hd(t)])}function dr(t,e){const n=qd(t)??[];if(n.length===0)return;const r=t.getOptions(),s=Bd(n,r._metadata,r.tunnel,t.getDsn());ha().set(t,[]),t.emit("flushLogs"),t.sendEnvelope(s)}function qd(t){return ha().get(t)}function ha(){return Wt("clientToLogBufferMap",()=>new WeakMap)}function Vd(t,e){e.debug===!0&&(v?y.enable():yt(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})),U().update(e.initialScope);const r=new t(e);return Gd(r),r.init(),r}function Gd(t){U().setClient(t)}const ma=Symbol.for("SentryBufferFullError");function zd(t){const e=[];function n(){return t===void 0||e.length<t}function r(o){return e.splice(e.indexOf(o),1)[0]||Promise.resolve(void 0)}function s(o){if(!n())return Pn(ma);const a=o();return e.indexOf(a)===-1&&e.push(a),a.then(()=>r(a)).then(null,()=>r(a).then(null,()=>{})),a}function i(o){return new ke((a,c)=>{let u=e.length;if(!u)return a(!0);const l=setTimeout(()=>{o&&o>0&&a(!1)},o);e.forEach(d=>{Je(d).then(()=>{--u||(clearTimeout(l),a(!0))},c)})})}return{$:e,add:s,drain:i}}const Wd=60*1e3;function Kd(t,e=Date.now()){const n=parseInt(`${t}`,10);if(!isNaN(n))return n*1e3;const r=Date.parse(`${t}`);return isNaN(r)?Wd:r-e}function Jd(t,e){return t[e]||t.all||0}function Yd(t,e,n=Date.now()){return Jd(t,e)>n}function Xd(t,{statusCode:e,headers:n},r=Date.now()){const s={...t},i=n==null?void 0:n["x-sentry-rate-limits"],o=n==null?void 0:n["retry-after"];if(i)for(const a of i.trim().split(",")){const[c,u,,,l]=a.split(":",5),d=parseInt(c,10),p=(isNaN(d)?60:d)*1e3;if(!u)s.all=r+p;else for(const f of u.split(";"))f==="metric_bucket"?(!l||l.split(";").includes("custom"))&&(s[f]=r+p):s[f]=r+p}else o?s.all=r+Kd(o,r):e===429&&(s.all=r+60*1e3);return s}const Qd=64;function Zd(t,e,n=zd(t.bufferSize||Qd)){let r={};const s=o=>n.drain(o);function i(o){const a=[];if(ci(o,(d,p)=>{const f=ui(p);Yd(r,f)?t.recordDroppedEvent("ratelimit_backoff",f):a.push(d)}),a.length===0)return Je({});const c=It(o[0],a),u=d=>{ci(c,(p,f)=>{t.recordDroppedEvent(d,ui(f))})},l=()=>e({body:Ul(c)}).then(d=>(d.statusCode!==void 0&&(d.statusCode<200||d.statusCode>=300)&&v&&y.warn(`Sentry responded with status code ${d.statusCode} to sent event.`),r=Xd(r,d),d),d=>{throw u("network_error"),v&&y.error("Encountered error running transport request:",d),d});return n.add(l).then(d=>d,d=>{if(d===ma)return v&&y.error("Skipped sending event because buffer is full."),u("queue_overflow"),Je({});throw d})}return{send:i,flush:s}}function ep(t){var e;((e=t.user)==null?void 0:e.ip_address)===void 0&&(t.user={...t.user,ip_address:"{{auto}}"})}function tp(t){var e;"aggregates"in t?((e=t.attrs)==null?void 0:e.ip_address)===void 0&&(t.attrs={...t.attrs,ip_address:"{{auto}}"}):t.ipAddress===void 0&&(t.ipAddress="{{auto}}")}function np(t,e,n=[e],r="npm"){const s=t._metadata||{};s.sdk||(s.sdk={name:`sentry.javascript.${e}`,packages:n.map(i=>({name:`${r}:@sentry/${i}`,version:je})),version:je}),t._metadata=s}function ga(t={}){const e=t.client||P();if(!Rd()||!e)return{};const n=Qe(),r=Tt(n);if(r.getTraceData)return r.getTraceData(t);const s=t.scope||U(),i=t.span||bt(),o=i?Tl(i):rp(s),a=i?Oe(i):Xo(e,s),c=fl(a);return Ho.test(o)?{"sentry-trace":o,baggage:c}:(y.warn("Invalid sentry-trace data. Cannot generate trace data"),{})}function rp(t){const{traceId:e,sampled:n,propagationSpanId:r}=t.getPropagationContext();return Bo(e,r,n)}const sp=100;function Ne(t,e){const n=P(),r=oe();if(!n)return;const{beforeBreadcrumb:s=null,maxBreadcrumbs:i=sp}=n.getOptions();if(i<=0)return;const a={timestamp:Ze(),...t},c=s?yt(()=>s(a,e)):a;c!==null&&(n.emit&&n.emit("beforeAddBreadcrumb",c,e),r.addBreadcrumb(c,i))}let Ai;const ip="FunctionToString",Oi=new WeakMap,op=()=>({name:ip,setupOnce(){Ai=Function.prototype.toString;try{Function.prototype.toString=function(...t){const e=as(this),n=Oi.has(P())&&e!==void 0?e:this;return Ai.apply(n,t)}}catch{}},setup(t){Oi.set(t,!0)}}),ap=op,cp=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,/^Can't find variable: gmo$/,/^undefined is not an object \(evaluating 'a\.[A-Z]'\)$/,`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/,/^Java exception was raised during method invocation$/],up="EventFilters",lp=(t={})=>{let e;return{name:up,setup(n){const r=n.getOptions();e=ki(t,r)},processEvent(n,r,s){if(!e){const i=s.getOptions();e=ki(t,i)}return pp(n,e)?null:n}}},dp=(t={})=>({...lp(t),name:"InboundFilters"});function ki(t={},e={}){return{allowUrls:[...t.allowUrls||[],...e.allowUrls||[]],denyUrls:[...t.denyUrls||[],...e.denyUrls||[]],ignoreErrors:[...t.ignoreErrors||[],...e.ignoreErrors||[],...t.disableErrorDefaults?[]:cp],ignoreTransactions:[...t.ignoreTransactions||[],...e.ignoreTransactions||[]]}}function pp(t,e){if(t.type){if(t.type==="transaction"&&hp(t,e.ignoreTransactions))return v&&y.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${Me(t)}`),!0}else{if(fp(t,e.ignoreErrors))return v&&y.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${Me(t)}`),!0;if(Sp(t))return v&&y.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${Me(t)}`),!0;if(mp(t,e.denyUrls))return v&&y.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${Me(t)}.
Url: ${Ln(t)}`),!0;if(!gp(t,e.allowUrls))return v&&y.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${Me(t)}.
Url: ${Ln(t)}`),!0}return!1}function fp(t,e){return e!=null&&e.length?la(t).some(n=>Be(n,e)):!1}function hp(t,e){if(!(e!=null&&e.length))return!1;const n=t.transaction;return n?Be(n,e):!1}function mp(t,e){if(!(e!=null&&e.length))return!1;const n=Ln(t);return n?Be(n,e):!1}function gp(t,e){if(!(e!=null&&e.length))return!0;const n=Ln(t);return n?Be(n,e):!0}function _p(t=[]){for(let e=t.length-1;e>=0;e--){const n=t[e];if(n&&n.filename!=="<anonymous>"&&n.filename!=="[native code]")return n.filename||null}return null}function Ln(t){var e,n;try{const r=[...((e=t.exception)==null?void 0:e.values)??[]].reverse().find(i=>{var o,a,c;return((o=i.mechanism)==null?void 0:o.parent_id)===void 0&&((c=(a=i.stacktrace)==null?void 0:a.frames)==null?void 0:c.length)}),s=(n=r==null?void 0:r.stacktrace)==null?void 0:n.frames;return s?_p(s):null}catch{return v&&y.error(`Cannot extract url for event ${Me(t)}`),null}}function Sp(t){var e,n;return(n=(e=t.exception)==null?void 0:e.values)!=null&&n.length?!t.message&&!t.exception.values.some(r=>r.stacktrace||r.type&&r.type!=="Error"||r.value):!1}function yp(t,e,n,r,s,i){var a;if(!((a=s.exception)!=null&&a.values)||!i||!me(i.originalException,Error))return;const o=s.exception.values.length>0?s.exception.values[s.exception.values.length-1]:void 0;o&&(s.exception.values=Fr(t,e,r,i.originalException,n,s.exception.values,o,0))}function Fr(t,e,n,r,s,i,o,a){if(i.length>=n+1)return i;let c=[...i];if(me(r[s],Error)){Ni(o,a);const u=t(e,r[s]),l=c.length;Pi(u,s,l,a),c=Fr(t,e,n,r[s],s,[u,...c],u,l)}return Array.isArray(r.errors)&&r.errors.forEach((u,l)=>{if(me(u,Error)){Ni(o,a);const d=t(e,u),p=c.length;Pi(d,`errors[${l}]`,p,a),c=Fr(t,e,n,u,s,[d,...c],d,p)}}),c}function Ni(t,e){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,...t.type==="AggregateError"&&{is_exception_group:!0},exception_id:e}}function Pi(t,e,n,r){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,type:"chained",source:e,exception_id:n,parent_id:r}}function Ep(t){const e="console";Kt(e,t),Jt(e,Tp)}function Tp(){"console"in N&&vu.forEach(function(t){t in N.console&&fe(N.console,t,function(e){return Cn[t]=e,function(...n){He("console",{args:n,level:t});const s=Cn[t];s==null||s.apply(N.console,n)}})})}function bp(t){return t==="warn"?"warning":["fatal","error","warning","log","info","debug"].includes(t)?t:"log"}const vp="Dedupe",Ip=()=>{let t;return{name:vp,processEvent(e){if(e.type)return e;try{if(Rp(e,t))return v&&y.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return t=e}}},wp=Ip;function Rp(t,e){return e?!!(Cp(t,e)||Ap(t,e)):!1}function Cp(t,e){const n=t.message,r=e.message;return!(!n&&!r||n&&!r||!n&&r||n!==r||!Sa(t,e)||!_a(t,e))}function Ap(t,e){const n=Li(e),r=Li(t);return!(!n||!r||n.type!==r.type||n.value!==r.value||!Sa(t,e)||!_a(t,e))}function _a(t,e){let n=Ks(t),r=Ks(e);if(!n&&!r)return!0;if(n&&!r||!n&&r||(n=n,r=r,r.length!==n.length))return!1;for(let s=0;s<r.length;s++){const i=r[s],o=n[s];if(i.filename!==o.filename||i.lineno!==o.lineno||i.colno!==o.colno||i.function!==o.function)return!1}return!0}function Sa(t,e){let n=t.fingerprint,r=e.fingerprint;if(!n&&!r)return!0;if(n&&!r||!n&&r)return!1;n=n,r=r;try{return n.join("")===r.join("")}catch{return!1}}function Li(t){var e,n;return(n=(e=t.exception)==null?void 0:e.values)==null?void 0:n[0]}const Op="thismessage:/";function ya(t){return"isRelative"in t}function Ea(t,e){const n=t.indexOf("://")<=0&&t.indexOf("//")!==0,r=n?Op:void 0;try{if("canParse"in URL&&!URL.canParse(t,r))return;const s=new URL(t,r);return n?{isRelative:n,pathname:s.pathname,search:s.search,hash:s.hash}:s}catch{}}function kp(t){if(ya(t))return t.pathname;const e=new URL(t);return e.search="",e.hash="",["80","443"].includes(e.port)&&(e.port=""),e.password&&(e.password="%filtered%"),e.username&&(e.username="%filtered%"),e.toString()}function lt(t){if(!t)return{};const e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const n=e[6]||"",r=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:n,hash:r,relative:e[5]+n+r}}function Np(t){return t.split(/[?#]/,1)[0]}function Pp(t,e,n,r,s="auto.http.browser"){if(!t.fetchData)return;const{method:i,url:o}=t.fetchData,a=Ae()&&e(o);if(t.endTimestamp&&a){const d=t.fetchData.__span;if(!d)return;const p=r[d];p&&(xp(p,t),delete r[d]);return}const c=!!bt(),u=a&&c?Jn(Dp(o,i,s)):new Ke;if(t.fetchData.__span=u.spanContext().spanId,r[u.spanContext().spanId]=u,n(t.fetchData.url)){const d=t.args[0],p=t.args[1]||{},f=Lp(d,p,Ae()&&c?u:void 0);f&&(t.args[1]=p,p.headers=f)}const l=P();if(l){const d={input:t.args,response:t.response,startTimestamp:t.startTimestamp,endTimestamp:t.endTimestamp};l.emit("beforeOutgoingRequestSpan",u,d)}return u}function Lp(t,e,n){const r=ga({span:n}),s=r["sentry-trace"],i=r.baggage;if(!s)return;const o=e.headers||(Oo(t)?t.headers:void 0);if(o)if($p(o)){const a=new Headers(o);if(a.get("sentry-trace")||a.set("sentry-trace",s),i){const c=a.get("baggage");c?fn(c)||a.set("baggage",`${c},${i}`):a.set("baggage",i)}return a}else if(Array.isArray(o)){const a=[...o];o.find(u=>u[0]==="sentry-trace")||a.push(["sentry-trace",s]);const c=o.find(u=>u[0]==="baggage"&&fn(u[1]));return i&&!c&&a.push(["baggage",i]),a}else{const a="sentry-trace"in o?o["sentry-trace"]:void 0,c="baggage"in o?o.baggage:void 0,u=c?Array.isArray(c)?[...c]:[c]:[],l=c&&(Array.isArray(c)?c.find(d=>fn(d)):fn(c));return i&&!l&&u.push(i),{...o,"sentry-trace":a??s,baggage:u.length>0?u.join(","):void 0}}else return{...r}}function xp(t,e){var n,r;if(e.response){Fo(t,e.response.status);const s=(r=(n=e.response)==null?void 0:n.headers)==null?void 0:r.get("content-length");if(s){const i=parseInt(s);i>0&&t.setAttribute("http.response_content_length",i)}}else e.error&&t.setStatus({code:z,message:"internal_error"});t.end()}function fn(t){return t.split(",").some(e=>e.trim().startsWith(ps))}function $p(t){return typeof Headers<"u"&&me(t,Headers)}function Dp(t,e,n){const r=Ea(t);return{name:r?`${e} ${kp(r)}`:e,attributes:Fp(t,r,e,n)}}function Fp(t,e,n,r){const s={url:t,type:"fetch","http.method":n,[We]:r,[Bt]:"http.client"};return e&&(ya(e)||(s["http.url"]=e.href,s["server.address"]=e.host),e.search&&(s["http.query"]=e.search),e.hash&&(s["http.fragment"]=e.hash)),s}function Ta(t){if(t!==void 0)return t>=400&&t<500?"warning":t>=500?"error":void 0}const Ur=N;function Up(){if(!("fetch"in Ur))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function xi(t){return t&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}function Mp(){var n;if(typeof EdgeRuntime=="string")return!0;if(!Up())return!1;if(xi(Ur.fetch))return!0;let t=!1;const e=Ur.document;if(e&&typeof e.createElement=="function")try{const r=e.createElement("iframe");r.hidden=!0,e.head.appendChild(r),(n=r.contentWindow)!=null&&n.fetch&&(t=xi(r.contentWindow.fetch)),e.head.removeChild(r)}catch(r){v&&y.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",r)}return t}function ba(t,e){const n="fetch";Kt(n,t),Jt(n,()=>va(void 0,e))}function jp(t){const e="fetch-body-resolved";Kt(e,t),Jt(e,()=>va(Bp))}function va(t,e=!1){e&&!Mp()||fe(N,"fetch",function(n){return function(...r){const s=new Error,{method:i,url:o}=qp(r),a={args:r,fetchData:{method:i,url:o},startTimestamp:Z()*1e3,virtualError:s,headers:Vp(r)};return t||He("fetch",{...a}),n.apply(N,r).then(async c=>(t?t(c):He("fetch",{...a,endTimestamp:Z()*1e3,response:c}),c),c=>{if(He("fetch",{...a,endTimestamp:Z()*1e3,error:c}),rs(c)&&c.stack===void 0&&(c.stack=s.stack,ie(c,"framesToPop",1)),c instanceof TypeError&&(c.message==="Failed to fetch"||c.message==="Load failed"||c.message==="NetworkError when attempting to fetch resource."))try{const u=new URL(a.fetchData.url);c.message=`${c.message} (${u.host})`}catch{}throw c})}})}async function Hp(t,e){if(t!=null&&t.body){const n=t.body,r=n.getReader(),s=setTimeout(()=>{n.cancel().then(null,()=>{})},90*1e3);let i=!0;for(;i;){let o;try{o=setTimeout(()=>{n.cancel().then(null,()=>{})},5e3);const{done:a}=await r.read();clearTimeout(o),a&&(e(),i=!1)}catch{i=!1}finally{clearTimeout(o)}}clearTimeout(s),r.releaseLock(),n.cancel().then(null,()=>{})}}function Bp(t){let e;try{e=t.clone()}catch{return}Hp(e,()=>{He("fetch-body-resolved",{endTimestamp:Z()*1e3,response:t})})}function Mr(t,e){return!!t&&typeof t=="object"&&!!t[e]}function $i(t){return typeof t=="string"?t:t?Mr(t,"url")?t.url:t.toString?t.toString():"":""}function qp(t){if(t.length===0)return{method:"GET",url:""};if(t.length===2){const[n,r]=t;return{url:$i(n),method:Mr(r,"method")?String(r.method).toUpperCase():"GET"}}const e=t[0];return{url:$i(e),method:Mr(e,"method")?String(e.method).toUpperCase():"GET"}}function Vp(t){const[e,n]=t;try{if(typeof n=="object"&&n!==null&&"headers"in n&&n.headers)return new Headers(n.headers);if(Oo(e))return new Headers(e.headers)}catch{}}function Gp(){return"npm"}const O=N;let jr=0;function Ia(){return jr>0}function zp(){jr++,setTimeout(()=>{jr--})}function gt(t,e={}){function n(s){return typeof s=="function"}if(!n(t))return t;try{const s=t.__sentry_wrapped__;if(s)return typeof s=="function"?s:t;if(as(t))return t}catch{return t}const r=function(...s){try{const i=s.map(o=>gt(o,e));return t.apply(this,i)}catch(i){throw zp(),Ht(o=>{o.addEventProcessor(a=>(e.mechanism&&(Ar(a,void 0),pt(a,e.mechanism)),a.extra={...a.extra,arguments:s},a)),ra(i)}),i}};try{for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=t[s])}catch{}No(r,t),ie(t,"__sentry_wrapped__",r);try{Object.getOwnPropertyDescriptor(r,"name").configurable&&Object.defineProperty(r,"name",{get(){return t.name}})}catch{}return r}function ms(){const t=Yt(),{referrer:e}=O.document||{},{userAgent:n}=O.navigator||{},r={...e&&{Referer:e},...n&&{"User-Agent":n}};return{url:t,headers:r}}function gs(t,e){const n=_s(t,e),r={type:Xp(e),value:Qp(e)};return n.length&&(r.stacktrace={frames:n}),r.type===void 0&&r.value===""&&(r.value="Unrecoverable error caught"),r}function Wp(t,e,n,r){const s=P(),i=s==null?void 0:s.getOptions().normalizeDepth,o=rf(e),a={__serialized__:Qo(e,i)};if(o)return{exception:{values:[gs(t,o)]},extra:a};const c={exception:{values:[{type:zn(e)?e.constructor.name:r?"UnhandledRejection":"Error",value:tf(e,{isUnhandledRejection:r})}]},extra:a};if(n){const u=_s(t,n);u.length&&(c.exception.values[0].stacktrace={frames:u})}return c}function pr(t,e){return{exception:{values:[gs(t,e)]}}}function _s(t,e){const n=e.stacktrace||e.stack||"",r=Jp(e),s=Yp(e);try{return t(n,r,s)}catch{}return[]}const Kp=/Minified React error #\d+;/i;function Jp(t){return t&&Kp.test(t.message)?1:0}function Yp(t){return typeof t.framesToPop=="number"?t.framesToPop:0}function wa(t){return typeof WebAssembly<"u"&&typeof WebAssembly.Exception<"u"?t instanceof WebAssembly.Exception:!1}function Xp(t){const e=t==null?void 0:t.name;return!e&&wa(t)?t.message&&Array.isArray(t.message)&&t.message.length==2?t.message[0]:"WebAssembly.Exception":e}function Qp(t){const e=t==null?void 0:t.message;return wa(t)?Array.isArray(t.message)&&t.message.length==2?t.message[1]:"wasm exception":e?e.error&&typeof e.error.message=="string"?e.error.message:e:"No error message"}function Zp(t,e,n,r){const s=(n==null?void 0:n.syntheticException)||void 0,i=Ss(t,e,s,r);return pt(i),i.level="error",n!=null&&n.event_id&&(i.event_id=n.event_id),Je(i)}function ef(t,e,n="info",r,s){const i=(r==null?void 0:r.syntheticException)||void 0,o=Hr(t,e,i,s);return o.level=n,r!=null&&r.event_id&&(o.event_id=r.event_id),Je(o)}function Ss(t,e,n,r,s){let i;if(Co(e)&&e.error)return pr(t,e.error);if(Ys(e)||xu(e)){const o=e;if("stack"in e)i=pr(t,e);else{const a=o.name||(Ys(o)?"DOMError":"DOMException"),c=o.message?`${a}: ${o.message}`:a;i=Hr(t,c,n,r),Ar(i,c)}return"code"in o&&(i.tags={...i.tags,"DOMException.code":`${o.code}`}),i}return rs(e)?pr(t,e):Mt(e)||zn(e)?(i=Wp(t,e,n,s),pt(i,{synthetic:!0}),i):(i=Hr(t,e,n,r),Ar(i,`${e}`),pt(i,{synthetic:!0}),i)}function Hr(t,e,n,r){const s={};if(r&&n){const i=_s(t,n);i.length&&(s.exception={values:[{value:e,stacktrace:{frames:i}}]}),pt(s,{synthetic:!0})}if(ss(e)){const{__sentry_template_string__:i,__sentry_template_values__:o}=e;return s.logentry={message:i,params:o},s}return s.message=e,s}function tf(t,{isUnhandledRejection:e}){const n=Bu(t),r=e?"promise rejection":"exception";return Co(t)?`Event \`ErrorEvent\` captured as ${r} with message \`${t.message}\``:zn(t)?`Event \`${nf(t)}\` (type=${t.type}) captured as ${r}`:`Object captured as ${r} with keys: ${n}`}function nf(t){try{const e=Object.getPrototypeOf(t);return e?e.constructor.name:void 0}catch{}}function rf(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const n=t[e];if(n instanceof Error)return n}}const sf=5e3;class of extends Ud{constructor(e){const n=af(e),r=O.SENTRY_SDK_SOURCE||Gp();np(n,"browser",["browser"],r),super(n);const{sendDefaultPii:s,sendClientReports:i,_experiments:o}=this._options,a=o==null?void 0:o.enableLogs;O.document&&(i||a)&&O.document.addEventListener("visibilitychange",()=>{O.document.visibilityState==="hidden"&&(i&&this._flushOutcomes(),a&&dr(this))}),a&&(this.on("flush",()=>{dr(this)}),this.on("afterCaptureLog",()=>{this._logFlushIdleTimeout&&clearTimeout(this._logFlushIdleTimeout),this._logFlushIdleTimeout=setTimeout(()=>{dr(this)},sf)})),s&&(this.on("postprocessEvent",ep),this.on("beforeSendSession",tp))}eventFromException(e,n){return Zp(this._options.stackParser,e,n,this._options.attachStacktrace)}eventFromMessage(e,n="info",r){return ef(this._options.stackParser,e,n,r,this._options.attachStacktrace)}_prepareEvent(e,n,r,s){return e.platform=e.platform||"javascript",super._prepareEvent(e,n,r,s)}}function af(t){var e;return{release:typeof __SENTRY_RELEASE__=="string"?__SENTRY_RELEASE__:(e=O.SENTRY_RELEASE)==null?void 0:e.id,sendClientReports:!0,parentSpanIsAlwaysRootSpan:!0,...t}}const q=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,ee=globalThis,Lt="9.40.0";function wt(){return ys(ee),ee}function ys(t){const e=t.__SENTRY__=t.__SENTRY__||{};return e.version=e.version||Lt,e[Lt]=e[Lt]||{}}function Es(t,e,n=ee){const r=n.__SENTRY__=n.__SENTRY__||{},s=r[Lt]=r[Lt]||{};return s[t]||(s[t]=e())}const cf="Sentry Logger ",Di={};function Ra(t){if(!("console"in ee))return t();const e=ee.console,n={},r=Object.keys(Di);r.forEach(s=>{const i=Di[s];n[s]=e[s],e[s]=i});try{return t()}finally{r.forEach(s=>{e[s]=n[s]})}}function uf(){bs().enabled=!0}function lf(){bs().enabled=!1}function Ca(){return bs().enabled}function df(...t){Ts("log",...t)}function pf(...t){Ts("warn",...t)}function ff(...t){Ts("error",...t)}function Ts(t,...e){q&&Ca()&&Ra(()=>{ee.console[t](`${cf}[${t}]:`,...e)})}function bs(){return q?Es("loggerSettings",()=>({enabled:!1})):{enabled:!1}}const M={enable:uf,disable:lf,isEnabled:Ca,log:df,warn:pf,error:ff},fr="<anonymous>";function Aa(t){try{return!t||typeof t!="function"?fr:t.name||fr}catch{return fr}}const vn={},Fi={};function vs(t,e){vn[t]=vn[t]||[],vn[t].push(e)}function Is(t,e){if(!Fi[t]){Fi[t]=!0;try{e()}catch(n){q&&M.error(`Error while instrumenting ${t}`,n)}}}function Vt(t,e){const n=t&&vn[t];if(n)for(const r of n)try{r(e)}catch(s){q&&M.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${Aa(r)}
Error:`,s)}}const hf=Object.prototype.toString;function ws(t,e){return hf.call(t)===`[object ${e}]`}function Ie(t){return ws(t,"String")}function mf(t){return typeof t=="object"&&t!==null&&"__sentry_template_string__"in t&&"__sentry_template_values__"in t}function Ui(t){return t===null||mf(t)||typeof t!="object"&&typeof t!="function"}function gf(t){return ws(t,"Object")}function _f(t){return ws(t,"RegExp")}function Oa(t){return!!(t!=null&&t.then&&typeof t.then=="function")}const ka=ee,Sf=80;function Pe(t,e={}){if(!t)return"<unknown>";try{let n=t;const r=5,s=[];let i=0,o=0;const a=" > ",c=a.length;let u;const l=Array.isArray(e)?e:e.keyAttrs,d=!Array.isArray(e)&&e.maxStringLength||Sf;for(;n&&i++<r&&(u=yf(n,l),!(u==="html"||i>1&&o+s.length*c+u.length>=d));)s.push(u),o+=u.length,n=n.parentNode;return s.reverse().join(a)}catch{return"<unknown>"}}function yf(t,e){const n=t,r=[];if(!(n!=null&&n.tagName))return"";if(ka.HTMLElement&&n instanceof HTMLElement&&n.dataset){if(n.dataset.sentryComponent)return n.dataset.sentryComponent;if(n.dataset.sentryElement)return n.dataset.sentryElement}r.push(n.tagName.toLowerCase());const s=e!=null&&e.length?e.filter(o=>n.getAttribute(o)).map(o=>[o,n.getAttribute(o)]):null;if(s!=null&&s.length)s.forEach(o=>{r.push(`[${o[0]}="${o[1]}"]`)});else{n.id&&r.push(`#${n.id}`);const o=n.className;if(o&&Ie(o)){const a=o.split(/\s+/);for(const c of a)r.push(`.${c}`)}}const i=["aria-label","type","name","title","alt"];for(const o of i){const a=n.getAttribute(o);a&&r.push(`[${o}="${a}"]`)}return r.join("")}function Ef(t){if(!ka.HTMLElement)return null;let e=t;const n=5;for(let r=0;r<n;r++){if(!e)return null;if(e instanceof HTMLElement){if(e.dataset.sentryComponent)return e.dataset.sentryComponent;if(e.dataset.sentryElement)return e.dataset.sentryElement}e=e.parentNode}return null}function Tf(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:`${t.slice(0,e)}...`}function bf(t,e,n=!1){return Ie(t)?_f(e)?e.test(t):Ie(e)?n?t===e:t.includes(e):!1:!1}function vf(t,e=[],n=!1){return e.some(r=>bf(t,r,n))}function xn(t,e,n){if(!(e in t))return;const r=t[e];if(typeof r!="function")return;const s=n(r);typeof s=="function"&&If(s,r);try{t[e]=s}catch{q&&M.log(`Failed to replace method "${e}" in object`,t)}}function ge(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch{q&&M.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function If(t,e){try{const n=e.prototype||{};t.prototype=e.prototype=n,ge(t,"__sentry_original__",e)}catch{}}function wf(){const t=ee;return t.crypto||t.msCrypto}function Ge(t=wf()){let e=()=>Math.random()*16;try{if(t!=null&&t.randomUUID)return t.randomUUID().replace(/-/g,"");t!=null&&t.getRandomValues&&(e=()=>{const n=new Uint8Array(1);return t.getRandomValues(n),n[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,n=>(n^(e()&15)>>n/4).toString(16))}const Na=1e3;function Pa(){return Date.now()/Na}function Rf(){const{performance:t}=ee;if(!(t!=null&&t.now)||!t.timeOrigin)return Pa;const e=t.timeOrigin;return()=>(e+t.now())/Na}let Mi;function we(){return(Mi??(Mi=Rf()))()}let hr;function Cf(){var l;const{performance:t}=ee;if(!(t!=null&&t.now))return[void 0,"none"];const e=3600*1e3,n=t.now(),r=Date.now(),s=t.timeOrigin?Math.abs(t.timeOrigin+n-r):e,i=s<e,o=(l=t.timing)==null?void 0:l.navigationStart,c=typeof o=="number"?Math.abs(o+n-r):e,u=c<e;return i||u?s<=c?[t.timeOrigin,"timeOrigin"]:[o,"navigationStart"]:[r,"dateNow"]}function ae(){return hr||(hr=Cf()),hr[0]}function Af(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),!t.did&&!e.did&&(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||we(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:Ge()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const n=t.timestamp-t.started;t.duration=n>=0?n:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function La(t,e,n=2){if(!e||typeof e!="object"||n<=0)return e;if(t&&Object.keys(e).length===0)return t;const r={...t};for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=La(r[s],e[s],n-1));return r}function $n(){return Ge()}function xa(){return Ge().substring(16)}const Br="_sentrySpan";function Dn(t,e){e?ge(t,Br,e):delete t[Br]}function Fn(t){return t[Br]}const Of=100;class Ye{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:$n(),sampleRand:Math.random()}}clone(){const e=new Ye;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,Dn(e,Fn(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&Af(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,n){return this._tags={...this._tags,[e]:n},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,n){return this._extra={...this._extra,[e]:n},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,n){return n===null?delete this._contexts[e]:this._contexts[e]=n,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const n=typeof e=="function"?e(this):e,r=n instanceof Ye?n.getScopeData():gf(n)?e:void 0,{tags:s,extra:i,user:o,contexts:a,level:c,fingerprint:u=[],propagationContext:l}=r||{};return this._tags={...this._tags,...s},this._extra={...this._extra,...i},this._contexts={...this._contexts,...a},o&&Object.keys(o).length&&(this._user=o),c&&(this._level=c),u.length&&(this._fingerprint=u),l&&(this._propagationContext=l),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,Dn(this,void 0),this._attachments=[],this.setPropagationContext({traceId:$n(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(e,n){var i;const r=typeof n=="number"?n:Of;if(r<=0)return this;const s={timestamp:Pa(),...e,message:e.message?Tf(e.message,2048):e.message};return this._breadcrumbs.push(s),this._breadcrumbs.length>r&&(this._breadcrumbs=this._breadcrumbs.slice(-r),(i=this._client)==null||i.recordDroppedEvent("buffer_overflow","log_item")),this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:Fn(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=La(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,n){const r=(n==null?void 0:n.event_id)||Ge();if(!this._client)return q&&M.warn("No client configured on scope - will not capture exception!"),r;const s=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:s,...n,event_id:r},this),r}captureMessage(e,n,r){const s=(r==null?void 0:r.event_id)||Ge();if(!this._client)return q&&M.warn("No client configured on scope - will not capture message!"),s;const i=new Error(e);return this._client.captureMessage(e,n,{originalException:e,syntheticException:i,...r,event_id:s},this),s}captureEvent(e,n){const r=(n==null?void 0:n.event_id)||Ge();return this._client?(this._client.captureEvent(e,{...n,event_id:r},this),r):(q&&M.warn("No client configured on scope - will not capture event!"),r)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}function kf(){return Es("defaultCurrentScope",()=>new Ye)}function Nf(){return Es("defaultIsolationScope",()=>new Ye)}class Pf{constructor(e,n){let r;e?r=e:r=new Ye;let s;n?s=n:s=new Ye,this._stack=[{scope:r}],this._isolationScope=s}withScope(e){const n=this._pushScope();let r;try{r=e(n)}catch(s){throw this._popScope(),s}return Oa(r)?r.then(s=>(this._popScope(),s),s=>{throw this._popScope(),s}):(this._popScope(),r)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}}function _t(){const t=wt(),e=ys(t);return e.stack=e.stack||new Pf(kf(),Nf())}function Lf(t){return _t().withScope(t)}function xf(t,e){const n=_t();return n.withScope(()=>(n.getStackTop().scope=t,e(t)))}function ji(t){return _t().withScope(()=>t(_t().getIsolationScope()))}function $f(){return{withIsolationScope:ji,withScope:Lf,withSetScope:xf,withSetIsolationScope:(t,e)=>ji(e),getCurrentScope:()=>_t().getScope(),getIsolationScope:()=>_t().getIsolationScope()}}function Zt(t){const e=ys(t);return e.acs?e.acs:$f()}function de(){const t=wt();return Zt(t).getCurrentScope()}function Df(){const t=wt();return Zt(t).getIsolationScope()}function Rs(...t){const e=wt(),n=Zt(e);if(t.length===2){const[r,s]=t;return r?n.withSetScope(r,s):n.withScope(s)}return n.withScope(t[0])}function xe(){return de().getClient()}const Gt="sentry.source",$a="sentry.sample_rate",Ff="sentry.previous_trace_sample_rate",Xe="sentry.op",K="sentry.origin",en="sentry.measurement_unit",tn="sentry.measurement_value",Hi="sentry.custom_span_name",Uf="sentry.profile_id",Yn="sentry.exclusive_time",Mf=0,jf=1,Hf=2,Da="_sentryScope",Fa="_sentryIsolationScope";function Bf(t,e,n){t&&(ge(t,Fa,n),ge(t,Da,e))}function qr(t){return{scope:t[Da],isolationScope:t[Fa]}}const qf="sentry-",Vf=/^sentry-/;function Gf(t){const e=zf(t);if(!e)return;const n=Object.entries(e).reduce((r,[s,i])=>{if(s.match(Vf)){const o=s.slice(qf.length);r[o]=i}return r},{});if(Object.keys(n).length>0)return n}function zf(t){if(!(!t||!Ie(t)&&!Array.isArray(t)))return Array.isArray(t)?t.reduce((e,n)=>{const r=Bi(n);return Object.entries(r).forEach(([s,i])=>{e[s]=i}),e},{}):Bi(t)}function Bi(t){return t.split(",").map(e=>e.split("=").map(n=>{try{return decodeURIComponent(n.trim())}catch{return}})).reduce((e,[n,r])=>(n&&r&&(e[n]=r),e),{})}function Ua(t){if(typeof t=="boolean")return Number(t);const e=typeof t=="string"?parseFloat(t):t;if(!(typeof e!="number"||isNaN(e)||e<0||e>1))return e}const Ma=0,Cs=1;let qi=!1;function Wf(t){const{spanId:e,traceId:n}=t.spanContext(),{data:r,op:s,parent_span_id:i,status:o,origin:a,links:c}=J(t);return{parent_span_id:i,span_id:e,trace_id:n,data:r,op:s,status:o,origin:a,links:c}}function ja(t){if(t&&t.length>0)return t.map(({context:{spanId:e,traceId:n,traceFlags:r,...s},attributes:i})=>({span_id:e,trace_id:n,sampled:r===Cs,attributes:i,...s}))}function dt(t){return typeof t=="number"?Vi(t):Array.isArray(t)?t[0]+t[1]/1e9:t instanceof Date?Vi(t.getTime()):we()}function Vi(t){return t>9999999999?t/1e3:t}function J(t){var r;if(Jf(t))return t.getSpanJSON();const{spanId:e,traceId:n}=t.spanContext();if(Kf(t)){const{attributes:s,startTime:i,name:o,endTime:a,status:c,links:u}=t,l="parentSpanId"in t?t.parentSpanId:"parentSpanContext"in t?(r=t.parentSpanContext)==null?void 0:r.spanId:void 0;return{span_id:e,trace_id:n,data:s,description:o,parent_span_id:l,start_timestamp:dt(i),timestamp:dt(a)||void 0,status:Ha(c),op:s[Xe],origin:s[K],links:ja(u)}}return{span_id:e,trace_id:n,start_timestamp:0,data:{}}}function Kf(t){const e=t;return!!e.attributes&&!!e.startTime&&!!e.name&&!!e.endTime&&!!e.status}function Jf(t){return typeof t.getSpanJSON=="function"}function nn(t){const{traceFlags:e}=t.spanContext();return e===Cs}function Ha(t){if(!(!t||t.code===Mf))return t.code===jf?"ok":t.message||"unknown_error"}const xt="_sentryChildSpans",Vr="_sentryRootSpan";function Ba(t,e){const n=t[Vr]||t;ge(e,Vr,n),t[xt]?t[xt].add(e):ge(t,xt,new Set([e]))}function Yf(t){const e=new Set;function n(r){if(!e.has(r)&&nn(r)){e.add(r);const s=r[xt]?Array.from(r[xt]):[];for(const i of s)n(i)}}return n(t),Array.from(e)}function se(t){return t[Vr]||t}function tt(){const t=wt(),e=Zt(t);return e.getActiveSpan?e.getActiveSpan():Fn(de())}function Xf(){qi||(Ra(()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly.")}),qi=!0)}function As(t){var n;if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const e=t||((n=xe())==null?void 0:n.getOptions());return!!e&&(e.tracesSampleRate!=null||!!e.tracesSampler)}const Qf="production",Zf=/^o(\d+)\./;function eh(t,e=!1){const{host:n,path:r,pass:s,port:i,projectId:o,protocol:a,publicKey:c}=t;return`${a}://${c}${e&&s?`:${s}`:""}@${n}${i?`:${i}`:""}/${r&&`${r}/`}${o}`}function th(t){const e=t.match(Zf);return e==null?void 0:e[1]}const qa="_frozenDsc";function mr(t,e){ge(t,qa,e)}function nh(t,e){const n=e.getOptions(),{publicKey:r,host:s}=e.getDsn()||{};let i;n.orgId?i=String(n.orgId):s&&(i=th(s));const o={environment:n.environment||Qf,release:n.release,public_key:r,trace_id:t,org_id:i};return e.emit("createDsc",o),o}function Un(t){var _;const e=xe();if(!e)return{};const n=se(t),r=J(n),s=r.data,i=n.spanContext().traceState,o=(i==null?void 0:i.get("sentry.sample_rate"))??s[$a]??s[Ff];function a(h){return(typeof o=="number"||typeof o=="string")&&(h.sample_rate=`${o}`),h}const c=n[qa];if(c)return a(c);const u=i==null?void 0:i.get("sentry.dsc"),l=u&&Gf(u);if(l)return a(l);const d=nh(t.spanContext().traceId,e),p=s[Gt],f=r.description;return p!=="url"&&f&&(d.transaction=f),As()&&(d.sampled=String(nn(n)),d.sample_rand=(i==null?void 0:i.get("sentry.sample_rand"))??((_=qr(n).scope)==null?void 0:_.getPropagationContext().sampleRand.toString())),a(d),e.emit("createDsc",d,n),d}class Xn{constructor(e={}){this._traceId=e.traceId||$n(),this._spanId=e.spanId||xa()}spanContext(){return{spanId:this._spanId,traceId:this._traceId,traceFlags:Ma}}end(e){}setAttribute(e,n){return this}setAttributes(e){return this}setStatus(e){return this}updateName(e){return this}isRecording(){return!1}addEvent(e,n,r){return this}addLink(e){return this}addLinks(e){return this}recordException(e,n){}}function rh(t,e=[]){return[t,e]}function sh(t){return[{type:"span"},t]}function ih(t,e){function n(l){return!!l.trace_id&&!!l.public_key}const r=Un(t[0]),s=e==null?void 0:e.getDsn(),i=e==null?void 0:e.getOptions().tunnel,o={sent_at:new Date().toISOString(),...n(r)&&{trace:r},...!!i&&s&&{dsn:eh(s)}},a=e==null?void 0:e.getOptions().beforeSendSpan,c=a?l=>{const d=J(l),p=a(d);return p||(Xf(),d)}:J,u=[];for(const l of t){const d=c(l);d&&u.push(sh(d))}return rh(o,u)}function oh(t){if(!q)return;const{description:e="< unknown name >",op:n="< unknown op >",parent_span_id:r}=J(t),{spanId:s}=t.spanContext(),i=nn(t),o=se(t),a=o===t,c=`[Tracing] Starting ${i?"sampled":"unsampled"} ${a?"root ":""}span`,u=[`op: ${n}`,`name: ${e}`,`ID: ${s}`];if(r&&u.push(`parent ID: ${r}`),!a){const{op:l,description:d}=J(o);u.push(`root ID: ${o.spanContext().spanId}`),l&&u.push(`root op: ${l}`),d&&u.push(`root description: ${d}`)}M.log(`${c}
  ${u.join(`
  `)}`)}function ah(t){if(!q)return;const{description:e="< unknown name >",op:n="< unknown op >"}=J(t),{spanId:r}=t.spanContext(),i=se(t)===t,o=`[Tracing] Finishing "${n}" ${i?"root ":""}span "${e}" with ID ${r}`;M.log(o)}function ch(t,e,n,r=tt()){const s=r&&se(r);s&&(q&&M.log(`[Measurement] Setting measurement on root span: ${t} = ${e} ${n}`),s.addEvent(t,{[tn]:e,[en]:n}))}function Gi(t){if(!t||t.length===0)return;const e={};return t.forEach(n=>{const r=n.attributes||{},s=r[en],i=r[tn];typeof s=="string"&&typeof i=="number"&&(e[n.name]={value:i,unit:s})}),e}const zi=1e3;class Os{constructor(e={}){this._traceId=e.traceId||$n(),this._spanId=e.spanId||xa(),this._startTime=e.startTimestamp||we(),this._links=e.links,this._attributes={},this.setAttributes({[K]:"manual",[Xe]:e.op,...e.attributes}),this._name=e.name,e.parentSpanId&&(this._parentSpanId=e.parentSpanId),"sampled"in e&&(this._sampled=e.sampled),e.endTimestamp&&(this._endTime=e.endTimestamp),this._events=[],this._isStandaloneSpan=e.isStandalone,this._endTime&&this._onSpanEnded()}addLink(e){return this._links?this._links.push(e):this._links=[e],this}addLinks(e){return this._links?this._links.push(...e):this._links=e,this}recordException(e,n){}spanContext(){const{_spanId:e,_traceId:n,_sampled:r}=this;return{spanId:e,traceId:n,traceFlags:r?Cs:Ma}}setAttribute(e,n){return n===void 0?delete this._attributes[e]:this._attributes[e]=n,this}setAttributes(e){return Object.keys(e).forEach(n=>this.setAttribute(n,e[n])),this}updateStartTime(e){this._startTime=dt(e)}setStatus(e){return this._status=e,this}updateName(e){return this._name=e,this.setAttribute(Gt,"custom"),this}end(e){this._endTime||(this._endTime=dt(e),ah(this),this._onSpanEnded())}getSpanJSON(){return{data:this._attributes,description:this._name,op:this._attributes[Xe],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:Ha(this._status),timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes[K],profile_id:this._attributes[Uf],exclusive_time:this._attributes[Yn],measurements:Gi(this._events),is_segment:this._isStandaloneSpan&&se(this)===this||void 0,segment_id:this._isStandaloneSpan?se(this).spanContext().spanId:void 0,links:ja(this._links)}}isRecording(){return!this._endTime&&!!this._sampled}addEvent(e,n,r){q&&M.log("[Tracing] Adding an event to span:",e);const s=Wi(n)?n:r||we(),i=Wi(n)?{}:n||{},o={name:e,time:dt(s),attributes:i};return this._events.push(o),this}isStandaloneSpan(){return!!this._isStandaloneSpan}_onSpanEnded(){const e=xe();if(e&&e.emit("spanEnd",this),!(this._isStandaloneSpan||this===se(this)))return;if(this._isStandaloneSpan){this._sampled?lh(ih([this],e)):(q&&M.log("[Tracing] Discarding standalone span because its trace was not chosen to be sampled."),e&&e.recordDroppedEvent("sample_rate","span"));return}const r=this._convertSpanToTransaction();r&&(qr(this).scope||de()).captureEvent(r)}_convertSpanToTransaction(){var l;if(!Ki(J(this)))return;this._name||(q&&M.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>");const{scope:e,isolationScope:n}=qr(this),r=(l=e==null?void 0:e.getScopeData().sdkProcessingMetadata)==null?void 0:l.normalizedRequest;if(this._sampled!==!0)return;const i=Yf(this).filter(d=>d!==this&&!uh(d)).map(d=>J(d)).filter(Ki),o=this._attributes[Gt];delete this._attributes[Hi],i.forEach(d=>{delete d.data[Hi]});const a={contexts:{trace:Wf(this)},spans:i.length>zi?i.sort((d,p)=>d.start_timestamp-p.start_timestamp).slice(0,zi):i,start_timestamp:this._startTime,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{capturedSpanScope:e,capturedSpanIsolationScope:n,dynamicSamplingContext:Un(this)},request:r,...o&&{transaction_info:{source:o}}},c=Gi(this._events);return c&&Object.keys(c).length&&(q&&M.log("[Measurements] Adding measurements to transaction event",JSON.stringify(c,void 0,2)),a.measurements=c),a}}function Wi(t){return t&&typeof t=="number"||t instanceof Date||Array.isArray(t)}function Ki(t){return!!t.start_timestamp&&!!t.timestamp&&!!t.span_id&&!!t.trace_id}function uh(t){return t instanceof Os&&t.isStandaloneSpan()}function lh(t){const e=xe();if(!e)return;const n=t[1];if(!n||n.length===0){e.recordDroppedEvent("before_send","span");return}e.sendEnvelope(t)}function dh(t,e,n=()=>{}){let r;try{r=t()}catch(s){throw e(s),n(),s}return ph(r,e,n)}function ph(t,e,n){return Oa(t)?t.then(r=>(n(),r),r=>{throw e(r),n(),r}):(n(),t)}function fh(t,e,n){if(!As(t))return[!1];let r,s;typeof t.tracesSampler=="function"?(s=t.tracesSampler({...e,inheritOrSampleWith:a=>typeof e.parentSampleRate=="number"?e.parentSampleRate:typeof e.parentSampled=="boolean"?Number(e.parentSampled):a}),r=!0):e.parentSampled!==void 0?s=e.parentSampled:typeof t.tracesSampleRate<"u"&&(s=t.tracesSampleRate,r=!0);const i=Ua(s);if(i===void 0)return q&&M.warn(`[Tracing] Discarding root span because of invalid sample rate. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(s)} of type ${JSON.stringify(typeof s)}.`),[!1];if(!i)return q&&M.log(`[Tracing] Discarding transaction because ${typeof t.tracesSampler=="function"?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`),[!1,i,r];const o=n<i;return o||q&&M.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(s)})`),[o,i,r]}const Va="__SENTRY_SUPPRESS_TRACING__";function hh(t,e){const n=Ns();if(n.startSpan)return n.startSpan(t,e);const r=Wa(t),{forceTransaction:s,parentSpan:i,scope:o}=t,a=o==null?void 0:o.clone();return Rs(a,()=>gh(i)(()=>{const u=de(),l=Ka(u,i),p=t.onlyIfParent&&!l?new Xn:za({parentSpan:l,spanArguments:r,forceTransaction:s,scope:u});return Dn(u,p),dh(()=>e(p),()=>{const{status:f}=J(p);p.isRecording()&&(!f||f==="ok")&&p.setStatus({code:Hf,message:"internal_error"})},()=>{p.end()})}))}function Ga(t){const e=Ns();if(e.startInactiveSpan)return e.startInactiveSpan(t);const n=Wa(t),{forceTransaction:r,parentSpan:s}=t;return(t.scope?o=>Rs(t.scope,o):s!==void 0?o=>ks(s,o):o=>o())(()=>{const o=de(),a=Ka(o,s);return t.onlyIfParent&&!a?new Xn:za({parentSpan:a,spanArguments:n,forceTransaction:r,scope:o})})}function ks(t,e){const n=Ns();return n.withActiveSpan?n.withActiveSpan(t,e):Rs(r=>(Dn(r,t||void 0),e(r)))}function za({parentSpan:t,spanArguments:e,forceTransaction:n,scope:r}){if(!As()){const o=new Xn;if(n||!t){const a={sampled:"false",sample_rate:"0",transaction:e.name,...Un(o)};mr(o,a)}return o}const s=Df();let i;if(t&&!n)i=mh(t,r,e),Ba(t,i);else if(t){const o=Un(t),{traceId:a,spanId:c}=t.spanContext(),u=nn(t);i=Ji({traceId:a,parentSpanId:c,...e},r,u),mr(i,o)}else{const{traceId:o,dsc:a,parentSpanId:c,sampled:u}={...s.getPropagationContext(),...r.getPropagationContext()};i=Ji({traceId:o,parentSpanId:c,...e},r,u),a&&mr(i,a)}return oh(i),Bf(i,r,s),i}function Wa(t){const n={isStandalone:(t.experimental||{}).standalone,...t};if(t.startTime){const r={...n};return r.startTimestamp=dt(t.startTime),delete r.startTime,r}return n}function Ns(){const t=wt();return Zt(t)}function Ji(t,e,n){var _;const r=xe(),s=(r==null?void 0:r.getOptions())||{},{name:i=""}=t,o={spanAttributes:{...t.attributes},spanName:i,parentSampled:n};r==null||r.emit("beforeSampling",o,{decision:!1});const a=o.parentSampled??n,c=o.spanAttributes,u=e.getPropagationContext(),[l,d,p]=e.getScopeData().sdkProcessingMetadata[Va]?[!1]:fh(s,{name:i,parentSampled:a,attributes:c,parentSampleRate:Ua((_=u.dsc)==null?void 0:_.sample_rate)},u.sampleRand),f=new Os({...t,attributes:{[Gt]:"custom",[$a]:d!==void 0&&p?d:void 0,...c},sampled:l});return!l&&r&&(q&&M.log("[Tracing] Discarding root span because its trace was not chosen to be sampled."),r.recordDroppedEvent("sample_rate","transaction")),r&&r.emit("spanStart",f),f}function mh(t,e,n){const{spanId:r,traceId:s}=t.spanContext(),i=e.getScopeData().sdkProcessingMetadata[Va]?!1:nn(t),o=i?new Os({...n,parentSpanId:r,traceId:s,sampled:i}):new Xn({traceId:s});Ba(t,o);const a=xe();return a&&(a.emit("spanStart",o),n.endTimestamp&&a.emit("spanEnd",o)),o}function Ka(t,e){if(e)return e;if(e===null)return;const n=Fn(t);if(!n)return;const r=xe();return(r?r.getOptions():{}).parentSpanIsAlwaysRootSpan?se(n):n}function gh(t){return t!==void 0?e=>ks(t,e):e=>e()}function _h(t){if(!t)return{};const e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const n=e[6]||"",r=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:n,hash:r,relative:e[5]+n+r}}const Yi=ee;function Sh(){return"history"in Yi&&!!Yi.history}function yh(t){return t&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}const Qn=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,C=ee,Eh=(t,e)=>t>e[1]?"poor":t>e[0]?"needs-improvement":"good",Rt=(t,e,n,r)=>{let s,i;return o=>{e.value>=0&&(o||r)&&(i=e.value-(s??0),(i||s===void 0)&&(s=e.value,e.delta=i,e.rating=Eh(e.value,n),t(e)))}},Th=()=>`v5-${Date.now()}-${Math.floor(Math.random()*(9e12-1))+1e12}`,rn=(t=!0)=>{var n,r;const e=(r=(n=C.performance)==null?void 0:n.getEntriesByType)==null?void 0:r.call(n,"navigation")[0];if(!t||e&&e.responseStart>0&&e.responseStart<performance.now())return e},Ct=()=>{const t=rn();return(t==null?void 0:t.activationStart)??0},At=(t,e=-1)=>{var i,o;const n=rn();let r="navigate";return n&&((i=C.document)!=null&&i.prerendering||Ct()>0?r="prerender":(o=C.document)!=null&&o.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-"))),{name:t,value:e,rating:"good",delta:0,entries:[],id:Th(),navigationType:r}},gr=new WeakMap;function Ps(t,e){return gr.get(t)||gr.set(t,new e),gr.get(t)}class Mn{constructor(){Mn.prototype.__init.call(this),Mn.prototype.__init2.call(this)}__init(){this._sessionValue=0}__init2(){this._sessionEntries=[]}_processEntry(e){var s;if(e.hadRecentInput)return;const n=this._sessionEntries[0],r=this._sessionEntries[this._sessionEntries.length-1];this._sessionValue&&n&&r&&e.startTime-r.startTime<1e3&&e.startTime-n.startTime<5e3?(this._sessionValue+=e.value,this._sessionEntries.push(e)):(this._sessionValue=e.value,this._sessionEntries=[e]),(s=this._onAfterProcessingUnexpectedShift)==null||s.call(this,e)}}const nt=(t,e,n={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){const r=new PerformanceObserver(s=>{Promise.resolve().then(()=>{e(s.getEntries())})});return r.observe({type:t,buffered:!0,...n}),r}}catch{}},Zn=t=>{let e=!1;return()=>{e||(t(),e=!0)}};let $t=-1;const bh=()=>{var t,e;return((t=C.document)==null?void 0:t.visibilityState)==="hidden"&&!((e=C.document)!=null&&e.prerendering)?0:1/0},jn=t=>{C.document.visibilityState==="hidden"&&$t>-1&&($t=t.type==="visibilitychange"?t.timeStamp:0,Ih())},vh=()=>{addEventListener("visibilitychange",jn,!0),addEventListener("prerenderingchange",jn,!0)},Ih=()=>{removeEventListener("visibilitychange",jn,!0),removeEventListener("prerenderingchange",jn,!0)},er=()=>{var t;if(C.document&&$t<0){const e=Ct();$t=(C.document.prerendering||(t=globalThis.performance.getEntriesByType("visibility-state").filter(r=>r.name==="hidden"&&r.startTime>e)[0])==null?void 0:t.startTime)??bh(),vh()}return{get firstHiddenTime(){return $t}}},sn=t=>{var e;(e=C.document)!=null&&e.prerendering?addEventListener("prerenderingchange",()=>t(),!0):t()},wh=[1800,3e3],Rh=(t,e={})=>{sn(()=>{const n=er(),r=At("FCP");let s;const o=nt("paint",a=>{for(const c of a)c.name==="first-contentful-paint"&&(o.disconnect(),c.startTime<n.firstHiddenTime&&(r.value=Math.max(c.startTime-Ct(),0),r.entries.push(c),s(!0)))});o&&(s=Rt(t,r,wh,e.reportAllChanges))})},Ch=[.1,.25],Ah=(t,e={})=>{Rh(Zn(()=>{var a,c;const n=At("CLS",0);let r;const s=Ps(e,Mn),i=u=>{for(const l of u)s._processEntry(l);s._sessionValue>n.value&&(n.value=s._sessionValue,n.entries=s._sessionEntries,r())},o=nt("layout-shift",i);o&&(r=Rt(t,n,Ch,e.reportAllChanges),(a=C.document)==null||a.addEventListener("visibilitychange",()=>{var u;((u=C.document)==null?void 0:u.visibilityState)==="hidden"&&(i(o.takeRecords()),r(!0))}),(c=C==null?void 0:C.setTimeout)==null||c.call(C,r))}))},tr=t=>{const e=n=>{var r;(n.type==="pagehide"||((r=C.document)==null?void 0:r.visibilityState)==="hidden")&&t(n)};C.document&&(addEventListener("visibilitychange",e,!0),addEventListener("pagehide",e,!0))},Oh=[100,300],kh=(t,e={})=>{sn(()=>{const n=er(),r=At("FID");let s;const i=c=>{c.startTime<n.firstHiddenTime&&(r.value=c.processingStart-c.startTime,r.entries.push(c),s(!0))},o=c=>{c.forEach(i)},a=nt("first-input",o);s=Rt(t,r,Oh,e.reportAllChanges),a&&tr(Zn(()=>{o(a.takeRecords()),a.disconnect()}))})};let Ja=0,_r=1/0,hn=0;const Nh=t=>{t.forEach(e=>{e.interactionId&&(_r=Math.min(_r,e.interactionId),hn=Math.max(hn,e.interactionId),Ja=hn?(hn-_r)/7+1:0)})};let Gr;const Ya=()=>Gr?Ja:performance.interactionCount||0,Ph=()=>{"interactionCount"in performance||Gr||(Gr=nt("event",Nh,{type:"event",buffered:!0,durationThreshold:0}))},Sr=10;let Xa=0;const Lh=()=>Ya()-Xa;class Hn{constructor(){Hn.prototype.__init.call(this),Hn.prototype.__init2.call(this)}__init(){this._longestInteractionList=[]}__init2(){this._longestInteractionMap=new Map}_resetInteractions(){Xa=Ya(),this._longestInteractionList.length=0,this._longestInteractionMap.clear()}_estimateP98LongestInteraction(){const e=Math.min(this._longestInteractionList.length-1,Math.floor(Lh()/50));return this._longestInteractionList[e]}_processEntry(e){var s,i;if((s=this._onBeforeProcessingEntry)==null||s.call(this,e),!(e.interactionId||e.entryType==="first-input"))return;const n=this._longestInteractionList.at(-1);let r=this._longestInteractionMap.get(e.interactionId);if(r||this._longestInteractionList.length<Sr||e.duration>n._latency){if(r?e.duration>r._latency?(r.entries=[e],r._latency=e.duration):e.duration===r._latency&&e.startTime===r.entries[0].startTime&&r.entries.push(e):(r={id:e.interactionId,entries:[e],_latency:e.duration},this._longestInteractionMap.set(r.id,r),this._longestInteractionList.push(r)),this._longestInteractionList.sort((o,a)=>a._latency-o._latency),this._longestInteractionList.length>Sr){const o=this._longestInteractionList.splice(Sr);for(const a of o)this._longestInteractionMap.delete(a.id)}(i=this._onAfterProcessingINPCandidate)==null||i.call(this,r)}}}const Qa=t=>{var n;const e=C.requestIdleCallback||C.setTimeout;((n=C.document)==null?void 0:n.visibilityState)==="hidden"?t():(t=Zn(t),e(t),tr(t))},xh=[200,500],$h=40,Dh=(t,e={})=>{globalThis.PerformanceEventTiming&&"interactionId"in PerformanceEventTiming.prototype&&sn(()=>{Ph();const n=At("INP");let r;const s=Ps(e,Hn),i=a=>{Qa(()=>{for(const u of a)s._processEntry(u);const c=s._estimateP98LongestInteraction();c&&c._latency!==n.value&&(n.value=c._latency,n.entries=c.entries,r())})},o=nt("event",i,{durationThreshold:e.durationThreshold??$h});r=Rt(t,n,xh,e.reportAllChanges),o&&(o.observe({type:"first-input",buffered:!0}),tr(()=>{i(o.takeRecords()),r(!0)}))})};class Fh{_processEntry(e){var n;(n=this._onBeforeProcessingEntry)==null||n.call(this,e)}}const Uh=[2500,4e3],Mh=(t,e={})=>{sn(()=>{const n=er(),r=At("LCP");let s;const i=Ps(e,Fh),o=c=>{e.reportAllChanges||(c=c.slice(-1));for(const u of c)i._processEntry(u),u.startTime<n.firstHiddenTime&&(r.value=Math.max(u.startTime-Ct(),0),r.entries=[u],s())},a=nt("largest-contentful-paint",o);if(a){s=Rt(t,r,Uh,e.reportAllChanges);const c=Zn(()=>{o(a.takeRecords()),a.disconnect(),s(!0)});for(const u of["keydown","click","visibilitychange"])C.document&&addEventListener(u,()=>Qa(c),{capture:!0,once:!0})}})},jh=[800,1800],zr=t=>{var e,n;(e=C.document)!=null&&e.prerendering?sn(()=>zr(t)):((n=C.document)==null?void 0:n.readyState)!=="complete"?addEventListener("load",()=>zr(t),!0):setTimeout(t)},Hh=(t,e={})=>{const n=At("TTFB"),r=Rt(t,n,jh,e.reportAllChanges);zr(()=>{const s=rn();s&&(n.value=Math.max(s.responseStart-Ct(),0),n.entries=[s],r(!0))})},Dt={},Bn={};let Za,ec,tc,nc,rc;function sc(t,e=!1){return on("cls",t,Gh,Za,e)}function ic(t,e=!1){return on("lcp",t,Wh,tc,e)}function Bh(t){return on("fid",t,zh,ec)}function qh(t){return on("ttfb",t,Kh,nc)}function Vh(t){return on("inp",t,Jh,rc)}function St(t,e){return oc(t,e),Bn[t]||(Yh(t),Bn[t]=!0),ac(t,e)}function Ot(t,e){const n=Dt[t];if(n!=null&&n.length)for(const r of n)try{r(e)}catch(s){Qn&&M.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${Aa(r)}
Error:`,s)}}function Gh(){return Ah(t=>{Ot("cls",{metric:t}),Za=t},{reportAllChanges:!0})}function zh(){return kh(t=>{Ot("fid",{metric:t}),ec=t})}function Wh(){return Mh(t=>{Ot("lcp",{metric:t}),tc=t},{reportAllChanges:!0})}function Kh(){return Hh(t=>{Ot("ttfb",{metric:t}),nc=t})}function Jh(){return Dh(t=>{Ot("inp",{metric:t}),rc=t})}function on(t,e,n,r,s=!1){oc(t,e);let i;return Bn[t]||(i=n(),Bn[t]=!0),r&&e({metric:r}),ac(t,e,s?i:void 0)}function Yh(t){const e={};t==="event"&&(e.durationThreshold=0),nt(t,n=>{Ot(t,{entries:n})},e)}function oc(t,e){Dt[t]=Dt[t]||[],Dt[t].push(e)}function ac(t,e,n){return()=>{n&&n();const r=Dt[t];if(!r)return;const s=r.indexOf(e);s!==-1&&r.splice(s,1)}}function Xh(t){return"duration"in t}function yr(t){return typeof t=="number"&&isFinite(t)}function _e(t,e,n,{...r}){const s=J(t).start_timestamp;return s&&s>e&&typeof t.updateStartTime=="function"&&t.updateStartTime(e),ks(t,()=>{const i=Ga({startTime:e,...r});return i&&i.end(n),i})}function Ls(t){var b;const e=xe();if(!e)return;const{name:n,transaction:r,attributes:s,startTime:i}=t,{release:o,environment:a,sendDefaultPii:c}=e.getOptions(),u=e.getIntegrationByName("Replay"),l=u==null?void 0:u.getReplayId(),d=de(),p=d.getUser(),f=p!==void 0?p.email||p.id||p.ip_address:void 0;let _;try{_=d.getScopeData().contexts.profile.profile_id}catch{}const h={release:o,environment:a,user:f||void 0,profile_id:_||void 0,replay_id:l||void 0,transaction:r,"user_agent.original":(b=C.navigator)==null?void 0:b.userAgent,"client.address":c?"{{auto}}":void 0,...s};return Ga({name:n,attributes:h,startTime:i,experimental:{standalone:!0}})}function nr(){return C.addEventListener&&C.performance}function D(t){return t/1e3}function cc(t){let e="unknown",n="unknown",r="";for(const s of t){if(s==="/"){[e,n]=t.split("/");break}if(!isNaN(Number(s))){e=r==="h"?"http":r,n=t.split(r)[1];break}r+=s}return r===t&&(e=r),{name:e,version:n}}function uc(t){try{return PerformanceObserver.supportedEntryTypes.includes(t)}catch{return!1}}function lc(t,e){let n,r=!1;function s(a){!r&&n&&e(a,n),r=!0}tr(()=>{s("pagehide")});const i=t.on("beforeStartNavigationSpan",(a,c)=>{c!=null&&c.isRedirect||(s("navigation"),i==null||i(),o==null||o())}),o=t.on("afterStartPageLoadSpan",a=>{n=a.spanContext().spanId,o==null||o()})}function Qh(t){let e=0,n;if(!uc("layout-shift"))return;const r=sc(({metric:s})=>{const i=s.entries[s.entries.length-1];i&&(e=s.value,n=i)},!0);lc(t,(s,i)=>{Zh(e,n,i,s),r()})}function Zh(t,e,n,r){var u;Qn&&M.log(`Sending CLS span (${t})`);const s=D((ae()||0)+((e==null?void 0:e.startTime)||0)),i=de().getScopeData().transactionName,o=e?Pe((u=e.sources[0])==null?void 0:u.node):"Layout shift",a={[K]:"auto.http.browser.cls",[Xe]:"ui.webvital.cls",[Yn]:(e==null?void 0:e.duration)||0,"sentry.pageload.span_id":n,"sentry.report_event":r};e!=null&&e.sources&&e.sources.forEach((l,d)=>{a[`cls.source.${d+1}`]=Pe(l.node)});const c=Ls({name:o,transaction:i,attributes:a,startTime:s});c&&(c.addEvent("cls",{[en]:"",[tn]:t}),c.end(s))}function em(t){let e=0,n;if(!uc("largest-contentful-paint"))return;const r=ic(({metric:s})=>{const i=s.entries[s.entries.length-1];i&&(e=s.value,n=i)},!0);lc(t,(s,i)=>{tm(e,n,i,s),r()})}function tm(t,e,n,r){Qn&&M.log(`Sending LCP span (${t})`);const s=D((ae()||0)+((e==null?void 0:e.startTime)||0)),i=de().getScopeData().transactionName,o=e?Pe(e.element):"Largest contentful paint",a={[K]:"auto.http.browser.lcp",[Xe]:"ui.webvital.lcp",[Yn]:0,"sentry.pageload.span_id":n,"sentry.report_event":r};e&&(e.element&&(a["lcp.element"]=Pe(e.element)),e.id&&(a["lcp.id"]=e.id),e.url&&(a["lcp.url"]=e.url.trim().slice(0,200)),e.loadTime!=null&&(a["lcp.loadTime"]=e.loadTime),e.renderTime!=null&&(a["lcp.renderTime"]=e.renderTime),e.size!=null&&(a["lcp.size"]=e.size));const c=Ls({name:o,transaction:i,attributes:a,startTime:s});c&&(c.addEvent("lcp",{[en]:"millisecond",[tn]:t}),c.end(s))}const nm=2147483647;let Xi=0,W={},Y,at;function rm({recordClsStandaloneSpans:t,recordLcpStandaloneSpans:e,client:n}){const r=nr();if(r&&ae()){r.mark&&C.performance.mark("sentry-tracing-init");const s=um(),i=e?em(n):cm(),o=lm(),a=t?Qh(n):am();return()=>{s(),i==null||i(),o(),a==null||a()}}return()=>{}}function sm(){St("longtask",({entries:t})=>{const e=tt();if(!e)return;const{op:n,start_timestamp:r}=J(e);for(const s of t){const i=D(ae()+s.startTime),o=D(s.duration);n==="navigation"&&r&&i<r||_e(e,i,i+o,{name:"Main UI thread blocked",op:"ui.long-task",attributes:{[K]:"auto.ui.browser.metrics"}})}})}function im(){new PerformanceObserver(e=>{const n=tt();if(n)for(const r of e.getEntries()){if(!r.scripts[0])continue;const s=D(ae()+r.startTime),{start_timestamp:i,op:o}=J(n);if(o==="navigation"&&i&&s<i)continue;const a=D(r.duration),c={[K]:"auto.ui.browser.metrics"},u=r.scripts[0],{invoker:l,invokerType:d,sourceURL:p,sourceFunctionName:f,sourceCharPosition:_}=u;c["browser.script.invoker"]=l,c["browser.script.invoker_type"]=d,p&&(c["code.filepath"]=p),f&&(c["code.function"]=f),_!==-1&&(c["browser.script.source_char_position"]=_),_e(n,s,s+a,{name:"Main UI thread blocked",op:"ui.long-animation-frame",attributes:c})}}).observe({type:"long-animation-frame",buffered:!0})}function om(){St("event",({entries:t})=>{const e=tt();if(e){for(const n of t)if(n.name==="click"){const r=D(ae()+n.startTime),s=D(n.duration),i={name:Pe(n.target),op:`ui.interaction.${n.name}`,startTime:r,attributes:{[K]:"auto.ui.browser.metrics"}},o=Ef(n.target);o&&(i.attributes["ui.component_name"]=o),_e(e,r,r+s,i)}}})}function am(){return sc(({metric:t})=>{const e=t.entries[t.entries.length-1];e&&(W.cls={value:t.value,unit:""},at=e)},!0)}function cm(){return ic(({metric:t})=>{const e=t.entries[t.entries.length-1];e&&(W.lcp={value:t.value,unit:"millisecond"},Y=e)},!0)}function um(){return Bh(({metric:t})=>{const e=t.entries[t.entries.length-1];if(!e)return;const n=D(ae()),r=D(e.startTime);W.fid={value:t.value,unit:"millisecond"},W["mark.fid"]={value:n+r,unit:"second"}})}function lm(){return qh(({metric:t})=>{t.entries[t.entries.length-1]&&(W.ttfb={value:t.value,unit:"millisecond"})})}function dm(t,e){const n=nr(),r=ae();if(!(n!=null&&n.getEntries)||!r)return;const s=D(r),i=n.getEntries(),{op:o,start_timestamp:a}=J(t);if(i.slice(Xi).forEach(c=>{const u=D(c.startTime),l=D(Math.max(0,c.duration));if(!(o==="navigation"&&a&&s+u<a))switch(c.entryType){case"navigation":{hm(t,c,s);break}case"mark":case"paint":case"measure":{pm(t,c,u,l,s,e.ignorePerformanceApiSpans);const d=er(),p=c.startTime<d.firstHiddenTime;c.name==="first-paint"&&p&&(W.fp={value:c.startTime,unit:"millisecond"}),c.name==="first-contentful-paint"&&p&&(W.fcp={value:c.startTime,unit:"millisecond"});break}case"resource":{_m(t,c,c.name,u,l,s,e.ignoreResourceSpans);break}}}),Xi=Math.max(i.length-1,0),Sm(t),o==="pageload"){Em(W);const c=W["mark.fid"];c&&W.fid&&(_e(t,c.value,c.value+D(W.fid.value),{name:"first input delay",op:"ui.action",attributes:{[K]:"auto.ui.browser.metrics"}}),delete W["mark.fid"]),(!("fcp"in W)||!e.recordClsOnPageloadSpan)&&delete W.cls,e.recordLcpOnPageloadSpan||delete W.lcp,Object.entries(W).forEach(([u,l])=>{ch(u,l.value,l.unit)}),t.setAttribute("performance.timeOrigin",s),t.setAttribute("performance.activationStart",Ct()),ym(t,e)}Y=void 0,at=void 0,W={}}function pm(t,e,n,r,s,i){if(["mark","measure"].includes(e.entryType)&&vf(e.name,i))return;const o=rn(!1),a=D(o?o.requestStart:0),c=s+Math.max(n,a),u=s+n,l=u+r,d={[K]:"auto.resource.browser.metrics"};c!==u&&(d["sentry.browser.measure_happened_before_request"]=!0,d["sentry.browser.measure_start_time"]=c),fm(d,e),c<=l&&_e(t,c,l,{name:e.name,op:e.entryType,attributes:d})}function fm(t,e){try{const n=e.detail;if(!n)return;if(typeof n=="object"){for(const[r,s]of Object.entries(n))if(s&&Ui(s))t[`sentry.browser.measure.detail.${r}`]=s;else if(s!==void 0)try{t[`sentry.browser.measure.detail.${r}`]=JSON.stringify(s)}catch{}return}if(Ui(n)){t["sentry.browser.measure.detail"]=n;return}try{t["sentry.browser.measure.detail"]=JSON.stringify(n)}catch{}}catch{}}function hm(t,e,n){["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach(r=>{mn(t,e,r,n)}),mn(t,e,"secureConnection",n,"TLS/SSL"),mn(t,e,"fetch",n,"cache"),mn(t,e,"domainLookup",n,"DNS"),gm(t,e,n)}function mn(t,e,n,r,s=n){const i=mm(n),o=e[i],a=e[`${n}Start`];!a||!o||_e(t,r+D(a),r+D(o),{op:`browser.${s}`,name:e.name,attributes:{[K]:"auto.ui.browser.metrics",...n==="redirect"&&e.redirectCount!=null?{"http.redirect_count":e.redirectCount}:{}}})}function mm(t){return t==="secureConnection"?"connectEnd":t==="fetch"?"domainLookupStart":`${t}End`}function gm(t,e,n){const r=n+D(e.requestStart),s=n+D(e.responseEnd),i=n+D(e.responseStart);e.responseEnd&&(_e(t,r,s,{op:"browser.request",name:e.name,attributes:{[K]:"auto.ui.browser.metrics"}}),_e(t,i,s,{op:"browser.response",name:e.name,attributes:{[K]:"auto.ui.browser.metrics"}}))}function _m(t,e,n,r,s,i,o){if(e.initiatorType==="xmlhttprequest"||e.initiatorType==="fetch")return;const a=e.initiatorType?`resource.${e.initiatorType}`:"resource.other";if(o!=null&&o.includes(a))return;const c=_h(n),u={[K]:"auto.resource.browser.metrics"};Er(u,e,"transferSize","http.response_transfer_size"),Er(u,e,"encodedBodySize","http.response_content_length"),Er(u,e,"decodedBodySize","http.decoded_response_content_length");const l=e.deliveryType;l!=null&&(u["http.response_delivery_type"]=l);const d=e.renderBlockingStatus;if(d&&(u["resource.render_blocking_status"]=d),c.protocol&&(u["url.scheme"]=c.protocol.split(":").pop()),c.host&&(u["server.address"]=c.host),u["url.same_origin"]=n.includes(C.location.origin),e.nextHopProtocol!=null){const{name:_,version:h}=cc(e.nextHopProtocol);u["network.protocol.name"]=_,u["network.protocol.version"]=h}const p=i+r,f=p+s;_e(t,p,f,{name:n.replace(C.location.origin,""),op:a,attributes:u})}function Sm(t){const e=C.navigator;if(!e)return;const n=e.connection;n&&(n.effectiveType&&t.setAttribute("effectiveConnectionType",n.effectiveType),n.type&&t.setAttribute("connectionType",n.type),yr(n.rtt)&&(W["connection.rtt"]={value:n.rtt,unit:"millisecond"})),yr(e.deviceMemory)&&t.setAttribute("deviceMemory",`${e.deviceMemory} GB`),yr(e.hardwareConcurrency)&&t.setAttribute("hardwareConcurrency",String(e.hardwareConcurrency))}function ym(t,e){Y&&e.recordLcpOnPageloadSpan&&(Y.element&&t.setAttribute("lcp.element",Pe(Y.element)),Y.id&&t.setAttribute("lcp.id",Y.id),Y.url&&t.setAttribute("lcp.url",Y.url.trim().slice(0,200)),Y.loadTime!=null&&t.setAttribute("lcp.loadTime",Y.loadTime),Y.renderTime!=null&&t.setAttribute("lcp.renderTime",Y.renderTime),t.setAttribute("lcp.size",Y.size)),at!=null&&at.sources&&e.recordClsOnPageloadSpan&&at.sources.forEach((n,r)=>t.setAttribute(`cls.source.${r+1}`,Pe(n.node)))}function Er(t,e,n,r){const s=e[n];s!=null&&s<nm&&(t[r]=s)}function Em(t){const e=rn(!1);if(!e)return;const{responseStart:n,requestStart:r}=e;r<=n&&(t["ttfb.requestTime"]={value:n-r,unit:"millisecond"})}function Tm(){return nr()&&ae()?St("element",bm):()=>{}}const bm=({entries:t})=>{const e=tt(),n=e?se(e):void 0,r=n?J(n).description:de().getScopeData().transactionName;t.forEach(s=>{var f,_;const i=s;if(!i.identifier)return;const o=i.name,a=i.renderTime,c=i.loadTime,[u,l]=c?[D(c),"load-time"]:a?[D(a),"render-time"]:[we(),"entry-emission"],d=o==="image-paint"?D(Math.max(0,(a??0)-(c??0))):0,p={[K]:"auto.ui.browser.elementtiming",[Xe]:"ui.elementtiming",[Gt]:"component","sentry.span_start_time_source":l,"sentry.transaction_name":r,"element.id":i.id,"element.type":((_=(f=i.element)==null?void 0:f.tagName)==null?void 0:_.toLowerCase())||"unknown","element.size":i.naturalWidth&&i.naturalHeight?`${i.naturalWidth}x${i.naturalHeight}`:void 0,"element.render_time":a,"element.load_time":c,"element.url":i.url||void 0,"element.identifier":i.identifier,"element.paint_type":o};hh({name:`element[${i.identifier}]`,attributes:p,startTime:u,onlyIfParent:!0},h=>{h.end(u+d)})})},vm=1e3;let Qi,Wr,Kr;function Im(t){const e="dom";vs(e,t),Is(e,wm)}function wm(){if(!C.document)return;const t=Vt.bind(null,"dom"),e=Zi(t,!0);C.document.addEventListener("click",e,!1),C.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(n=>{var i,o;const s=(i=C[n])==null?void 0:i.prototype;(o=s==null?void 0:s.hasOwnProperty)!=null&&o.call(s,"addEventListener")&&(xn(s,"addEventListener",function(a){return function(c,u,l){if(c==="click"||c=="keypress")try{const d=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},p=d[c]=d[c]||{refCount:0};if(!p.handler){const f=Zi(t);p.handler=f,a.call(this,c,f,l)}p.refCount++}catch{}return a.call(this,c,u,l)}}),xn(s,"removeEventListener",function(a){return function(c,u,l){if(c==="click"||c=="keypress")try{const d=this.__sentry_instrumentation_handlers__||{},p=d[c];p&&(p.refCount--,p.refCount<=0&&(a.call(this,c,p.handler,l),p.handler=void 0,delete d[c]),Object.keys(d).length===0&&delete this.__sentry_instrumentation_handlers__)}catch{}return a.call(this,c,u,l)}}))})}function Rm(t){if(t.type!==Wr)return!1;try{if(!t.target||t.target._sentryId!==Kr)return!1}catch{}return!0}function Cm(t,e){return t!=="keypress"?!1:e!=null&&e.tagName?!(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable):!0}function Zi(t,e=!1){return n=>{if(!n||n._sentryCaptured)return;const r=Am(n);if(Cm(n.type,r))return;ge(n,"_sentryCaptured",!0),r&&!r._sentryId&&ge(r,"_sentryId",Ge());const s=n.type==="keypress"?"input":n.type;Rm(n)||(t({event:n,name:s,global:e}),Wr=n.type,Kr=r?r._sentryId:void 0),clearTimeout(Qi),Qi=C.setTimeout(()=>{Kr=void 0,Wr=void 0},vm)}}function Am(t){try{return t.target}catch{return null}}let gn;function xs(t){const e="history";vs(e,t),Is(e,Om)}function Om(){if(C.addEventListener("popstate",()=>{const e=C.location.href,n=gn;if(gn=e,n===e)return;Vt("history",{from:n,to:e})}),!Sh())return;function t(e){return function(...n){const r=n.length>2?n[2]:void 0;if(r){const s=gn,i=km(String(r));if(gn=i,s===i)return e.apply(this,n);Vt("history",{from:s,to:i})}return e.apply(this,n)}}xn(C.history,"pushState",t),xn(C.history,"replaceState",t)}function km(t){try{return new URL(t,C.location.origin).toString()}catch{return t}}const In={};function Nm(t){const e=In[t];if(e)return e;let n=C[t];if(yh(n))return In[t]=n.bind(C);const r=C.document;if(r&&typeof r.createElement=="function")try{const s=r.createElement("iframe");s.hidden=!0,r.head.appendChild(s);const i=s.contentWindow;i!=null&&i[t]&&(n=i[t]),r.head.removeChild(s)}catch(s){Qn&&M.warn(`Could not create sandbox iframe for ${t} check, bailing to window.${t}: `,s)}return n&&(In[t]=n.bind(C))}function eo(t){In[t]=void 0}const ct="__sentry_xhr_v3__";function dc(t){const e="xhr";vs(e,t),Is(e,Pm)}function Pm(){if(!C.XMLHttpRequest)return;const t=XMLHttpRequest.prototype;t.open=new Proxy(t.open,{apply(e,n,r){const s=new Error,i=we()*1e3,o=Ie(r[0])?r[0].toUpperCase():void 0,a=Lm(r[1]);if(!o||!a)return e.apply(n,r);n[ct]={method:o,url:a,request_headers:{}},o==="POST"&&a.match(/sentry_key/)&&(n.__sentry_own_request__=!0);const c=()=>{const u=n[ct];if(u&&n.readyState===4){try{u.status_code=n.status}catch{}const l={endTimestamp:we()*1e3,startTimestamp:i,xhr:n,virtualError:s};Vt("xhr",l)}};return"onreadystatechange"in n&&typeof n.onreadystatechange=="function"?n.onreadystatechange=new Proxy(n.onreadystatechange,{apply(u,l,d){return c(),u.apply(l,d)}}):n.addEventListener("readystatechange",c),n.setRequestHeader=new Proxy(n.setRequestHeader,{apply(u,l,d){const[p,f]=d,_=l[ct];return _&&Ie(p)&&Ie(f)&&(_.request_headers[p.toLowerCase()]=f),u.apply(l,d)}}),e.apply(n,r)}}),t.send=new Proxy(t.send,{apply(e,n,r){const s=n[ct];if(!s)return e.apply(n,r);r[0]!==void 0&&(s.body=r[0]);const i={startTimestamp:we()*1e3,xhr:n};return Vt("xhr",i),e.apply(n,r)}})}function Lm(t){if(Ie(t))return t;try{return t.toString()}catch{}}const Tr=[],wn=new Map,xm=60;function $m(){if(nr()&&ae()){const e=Dm();return()=>{e()}}return()=>{}}const to={click:"click",pointerdown:"click",pointerup:"click",mousedown:"click",mouseup:"click",touchstart:"click",touchend:"click",mouseover:"hover",mouseout:"hover",mouseenter:"hover",mouseleave:"hover",pointerover:"hover",pointerout:"hover",pointerenter:"hover",pointerleave:"hover",dragstart:"drag",dragend:"drag",drag:"drag",dragenter:"drag",dragleave:"drag",dragover:"drag",drop:"drag",keydown:"press",keyup:"press",keypress:"press",input:"press"};function Dm(){return Vh(Fm)}const Fm=({metric:t})=>{if(t.value==null)return;const e=D(t.value);if(e>xm)return;const n=t.entries.find(_=>_.duration===t.value&&to[_.name]);if(!n)return;const{interactionId:r}=n,s=to[n.name],i=D(ae()+n.startTime),o=tt(),a=o?se(o):void 0,u=(r!=null?wn.get(r):void 0)||a,l=u?J(u).description:de().getScopeData().transactionName,d=Pe(n.target),p={[K]:"auto.http.browser.inp",[Xe]:`ui.interaction.${s}`,[Yn]:n.duration},f=Ls({name:d,transaction:l,attributes:p,startTime:i});f&&(f.addEvent("inp",{[en]:"millisecond",[tn]:t.value}),f.end(i+e))};function Um(){const t=({entries:e})=>{const n=tt(),r=n&&se(n);e.forEach(s=>{if(!Xh(s)||!r)return;const i=s.interactionId;if(i!=null&&!wn.has(i)){if(Tr.length>10){const o=Tr.shift();wn.delete(o)}Tr.push(i),wn.set(i,r)}})};St("event",t),St("first-input",t)}function Mm(t,e=Nm("fetch")){let n=0,r=0;function s(i){const o=i.body.length;n+=o,r++;const a={body:i.body,method:"POST",referrerPolicy:"strict-origin",headers:t.headers,keepalive:n<=6e4&&r<15,...t.fetchOptions};if(!e)return eo("fetch"),Pn("No fetch implementation available");try{return e(t.url,a).then(c=>(n-=o,r--,{statusCode:c.status,headers:{"x-sentry-rate-limits":c.headers.get("X-Sentry-Rate-Limits"),"retry-after":c.headers.get("Retry-After")}}))}catch(c){return eo("fetch"),n-=o,r--,Pn(c)}}return Zd(t,s)}const jm=30,Hm=50;function Jr(t,e,n,r){const s={filename:t,function:e==="<anonymous>"?ze:e,in_app:!0};return n!==void 0&&(s.lineno=n),r!==void 0&&(s.colno=r),s}const Bm=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,qm=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Vm=/\((\S*)(?::(\d+))(?::(\d+))\)/,Gm=t=>{const e=Bm.exec(t);if(e){const[,r,s,i]=e;return Jr(r,ze,+s,+i)}const n=qm.exec(t);if(n){if(n[2]&&n[2].indexOf("eval")===0){const o=Vm.exec(n[2]);o&&(n[2]=o[1],n[3]=o[2],n[4]=o[3])}const[s,i]=pc(n[1]||ze,n[2]);return Jr(i,s,n[3]?+n[3]:void 0,n[4]?+n[4]:void 0)}},zm=[jm,Gm],Wm=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Km=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Jm=t=>{const e=Wm.exec(t);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const i=Km.exec(e[3]);i&&(e[1]=e[1]||"eval",e[3]=i[1],e[4]=i[2],e[5]="")}let r=e[3],s=e[1]||ze;return[s,r]=pc(s,r),Jr(r,s,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}},Ym=[Hm,Jm],Xm=[zm,Ym],Qm=vo(...Xm),pc=(t,e)=>{const n=t.indexOf("safari-extension")!==-1,r=t.indexOf("safari-web-extension")!==-1;return n||r?[t.indexOf("@")!==-1?t.split("@")[0]:ze,n?`safari-extension:${e}`:`safari-web-extension:${e}`]:[t,e]},X=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,_n=1024,Zm="Breadcrumbs",eg=(t={})=>{const e={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...t};return{name:Zm,setup(n){e.console&&Ep(sg(n)),e.dom&&Im(rg(n,e.dom)),e.xhr&&dc(ig(n)),e.fetch&&ba(og(n)),e.history&&xs(ag(n)),e.sentry&&n.on("beforeSendEvent",ng(n))}}},tg=eg;function ng(t){return function(n){P()===t&&Ne({category:`sentry.${n.type==="transaction"?"transaction":"event"}`,event_id:n.event_id,level:n.level,message:Me(n)},{event:n})}}function rg(t,e){return function(r){if(P()!==t)return;let s,i,o=typeof e=="object"?e.serializeAttribute:void 0,a=typeof e=="object"&&typeof e.maxStringLength=="number"?e.maxStringLength:void 0;a&&a>_n&&(X&&y.warn(`\`dom.maxStringLength\` cannot exceed ${_n}, but a value of ${a} was configured. Sentry will use ${_n} instead.`),a=_n),typeof o=="string"&&(o=[o]);try{const u=r.event,l=cg(u)?u.target:u;s=ko(l,{keyAttrs:o,maxStringLength:a}),i=ju(l)}catch{s="<unknown>"}if(s.length===0)return;const c={category:`ui.${r.name}`,message:s};i&&(c.data={"ui.component_name":i}),Ne(c,{event:r.event,name:r.name,global:r.global})}}function sg(t){return function(n){if(P()!==t)return;const r={category:"console",data:{arguments:n.args,logger:"console"},level:bp(n.level),message:Xs(n.args," ")};if(n.level==="assert")if(n.args[0]===!1)r.message=`Assertion failed: ${Xs(n.args.slice(1)," ")||"console.assert"}`,r.data.arguments=n.args.slice(1);else return;Ne(r,{input:n.args,level:n.level})}}function ig(t){return function(n){if(P()!==t)return;const{startTimestamp:r,endTimestamp:s}=n,i=n.xhr[ct];if(!r||!s||!i)return;const{method:o,url:a,status_code:c,body:u}=i,l={method:o,url:a,status_code:c},d={xhr:n.xhr,input:u,startTimestamp:r,endTimestamp:s},p={category:"xhr",data:l,type:"http",level:Ta(c)};t.emit("beforeOutgoingRequestBreadcrumb",p,d),Ne(p,d)}}function og(t){return function(n){if(P()!==t)return;const{startTimestamp:r,endTimestamp:s}=n;if(s&&!(n.fetchData.url.match(/sentry_key/)&&n.fetchData.method==="POST"))if(n.fetchData.method,n.fetchData.url,n.error){const i=n.fetchData,o={data:n.error,input:n.args,startTimestamp:r,endTimestamp:s},a={category:"fetch",data:i,level:"error",type:"http"};t.emit("beforeOutgoingRequestBreadcrumb",a,o),Ne(a,o)}else{const i=n.response,o={...n.fetchData,status_code:i==null?void 0:i.status};n.fetchData.request_body_size,n.fetchData.response_body_size,i==null||i.status;const a={input:n.args,response:i,startTimestamp:r,endTimestamp:s},c={category:"fetch",data:o,type:"http",level:Ta(o.status_code)};t.emit("beforeOutgoingRequestBreadcrumb",c,a),Ne(c,a)}}}function ag(t){return function(n){if(P()!==t)return;let r=n.from,s=n.to;const i=lt(O.location.href);let o=r?lt(r):void 0;const a=lt(s);o!=null&&o.path||(o=i),i.protocol===a.protocol&&i.host===a.host&&(s=a.relative),i.protocol===o.protocol&&i.host===o.host&&(r=o.relative),Ne({category:"navigation",data:{from:r,to:s}})}}function cg(t){return!!t&&!!t.target}const ug=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],lg="BrowserApiErrors",dg=(t={})=>{const e={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,unregisterOriginalCallbacks:!1,...t};return{name:lg,setupOnce(){e.setTimeout&&fe(O,"setTimeout",no),e.setInterval&&fe(O,"setInterval",no),e.requestAnimationFrame&&fe(O,"requestAnimationFrame",fg),e.XMLHttpRequest&&"XMLHttpRequest"in O&&fe(XMLHttpRequest.prototype,"send",hg);const n=e.eventTarget;n&&(Array.isArray(n)?n:ug).forEach(s=>mg(s,e))}}},pg=dg;function no(t){return function(...e){const n=e[0];return e[0]=gt(n,{mechanism:{data:{function:Re(t)},handled:!1,type:"instrument"}}),t.apply(this,e)}}function fg(t){return function(e){return t.apply(this,[gt(e,{mechanism:{data:{function:"requestAnimationFrame",handler:Re(t)},handled:!1,type:"instrument"}})])}}function hg(t){return function(...e){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(s=>{s in n&&typeof n[s]=="function"&&fe(n,s,function(i){const o={mechanism:{data:{function:s,handler:Re(i)},handled:!1,type:"instrument"}},a=as(i);return a&&(o.mechanism.data.handler=Re(a)),gt(i,o)})}),t.apply(this,e)}}function mg(t,e){var s,i;const r=(s=O[t])==null?void 0:s.prototype;(i=r==null?void 0:r.hasOwnProperty)!=null&&i.call(r,"addEventListener")&&(fe(r,"addEventListener",function(o){return function(a,c,u){try{gg(c)&&(c.handleEvent=gt(c.handleEvent,{mechanism:{data:{function:"handleEvent",handler:Re(c),target:t},handled:!1,type:"instrument"}}))}catch{}return e.unregisterOriginalCallbacks&&_g(this,a,c),o.apply(this,[a,gt(c,{mechanism:{data:{function:"addEventListener",handler:Re(c),target:t},handled:!1,type:"instrument"}}),u])}}),fe(r,"removeEventListener",function(o){return function(a,c,u){try{const l=c.__sentry_wrapped__;l&&o.call(this,a,l,u)}catch{}return o.call(this,a,c,u)}}))}function gg(t){return typeof t.handleEvent=="function"}function _g(t,e,n){t&&typeof t=="object"&&"removeEventListener"in t&&typeof t.removeEventListener=="function"&&t.removeEventListener(e,n)}const Sg=()=>({name:"BrowserSession",setupOnce(){if(typeof O.document>"u"){X&&y.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.");return}Ei({ignoreDuration:!0}),Ti(),xs(({from:t,to:e})=>{t!==void 0&&t!==e&&(Ei({ignoreDuration:!0}),Ti())})}}),yg="GlobalHandlers",Eg=(t={})=>{const e={onerror:!0,onunhandledrejection:!0,...t};return{name:yg,setupOnce(){Error.stackTraceLimit=50},setup(n){e.onerror&&(bg(n),ro("onerror")),e.onunhandledrejection&&(vg(n),ro("onunhandledrejection"))}}},Tg=Eg;function bg(t){Io(e=>{const{stackParser:n,attachStacktrace:r}=fc();if(P()!==t||Ia())return;const{msg:s,url:i,line:o,column:a,error:c}=e,u=Rg(Ss(n,c||s,void 0,r,!1),i,o,a);u.level="error",sa(u,{originalException:c,mechanism:{handled:!1,type:"onerror"}})})}function vg(t){wo(e=>{const{stackParser:n,attachStacktrace:r}=fc();if(P()!==t||Ia())return;const s=Ig(e),i=is(s)?wg(s):Ss(n,s,void 0,r,!0);i.level="error",sa(i,{originalException:s,mechanism:{handled:!1,type:"onunhandledrejection"}})})}function Ig(t){if(is(t))return t;try{if("reason"in t)return t.reason;if("detail"in t&&"reason"in t.detail)return t.detail.reason}catch{}return t}function wg(t){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(t)}`}]}}}function Rg(t,e,n,r){const s=t.exception=t.exception||{},i=s.values=s.values||[],o=i[0]=i[0]||{},a=o.stacktrace=o.stacktrace||{},c=a.frames=a.frames||[],u=r,l=n,d=Ut(e)&&e.length>0?e:Yt();return c.length===0&&c.push({colno:u,filename:d,function:ze,in_app:!0,lineno:l}),t}function ro(t){X&&y.log(`Global Handler attached: ${t}`)}function fc(){const t=P();return(t==null?void 0:t.getOptions())||{stackParser:()=>[],attachStacktrace:!1}}const Cg=()=>({name:"HttpContext",preprocessEvent(t){var r;if(!O.navigator&&!O.location&&!O.document)return;const e=ms(),n={...e.headers,...(r=t.request)==null?void 0:r.headers};t.request={...e,...t.request,headers:n}}}),Ag="cause",Og=5,kg="LinkedErrors",Ng=(t={})=>{const e=t.limit||Og,n=t.key||Ag;return{name:kg,preprocessEvent(r,s,i){const o=i.getOptions();yp(gs,o.stackParser,n,e,r,s)}}},Pg=Ng;function Lg(){return xg()?(X&&yt(()=>{console.error("[Sentry] You cannot use Sentry.init() in a browser extension, see: https://docs.sentry.io/platforms/javascript/best-practices/browser-extensions/")}),!0):!1}function xg(){var i;if(typeof O.window>"u")return!1;const t=O;if(t.nw)return!1;const e=t.chrome||t.browser;if(!((i=e==null?void 0:e.runtime)!=null&&i.id))return!1;const n=Yt(),r=["chrome-extension","moz-extension","ms-browser-extension","safari-web-extension"];return!(O===O.top&&r.some(o=>n.startsWith(`${o}://`)))}function $g(t){return[dp(),ap(),pg(),tg(),Tg(),Pg(),wp(),Cg(),Sg()]}function Dg(t={}){const e=!t.skipBrowserExtensionCheck&&Lg(),n={...t,enabled:e?!1:t.enabled,stackParser:ku(t.stackParser||Qm),integrations:Ld({integrations:t.integrations,defaultIntegrations:t.defaultIntegrations==null?$g():t.defaultIntegrations}),transport:t.transport||Mm};return Vd(of,n)}function Fg(t={}){const e=O.document,n=(e==null?void 0:e.head)||(e==null?void 0:e.body);if(!n){X&&y.error("[showReportDialog] Global document not defined");return}const r=U(),s=P(),i=s==null?void 0:s.getDsn();if(!i){X&&y.error("[showReportDialog] DSN not configured");return}const o={...t,user:{...r.getUser(),...t.user},eventId:t.eventId||wd()},a=O.document.createElement("script");a.async=!0,a.crossOrigin="anonymous",a.src=Nd(i,o);const{onLoad:c,onClose:u}=o;if(c&&(a.onload=c),u){const l=d=>{if(d.data==="__sentry_reportdialog_closed__")try{u()}finally{O.removeEventListener("message",l)}};O.addEventListener("message",l)}n.appendChild(a)}function ue(t=0){return((cs()||performance.timeOrigin)+t)/1e3}function Ug(t){const e=[];if(t.nextHopProtocol!=null){const{name:n,version:r}=cc(t.nextHopProtocol);e.push(["network.protocol.version",r],["network.protocol.name",n])}return cs()?[...e,["http.request.redirect_start",ue(t.redirectStart)],["http.request.fetch_start",ue(t.fetchStart)],["http.request.domain_lookup_start",ue(t.domainLookupStart)],["http.request.domain_lookup_end",ue(t.domainLookupEnd)],["http.request.connect_start",ue(t.connectStart)],["http.request.secure_connection_start",ue(t.secureConnectionStart)],["http.request.connection_end",ue(t.connectEnd)],["http.request.request_start",ue(t.requestStart)],["http.request.response_start",ue(t.responseStart)],["http.request.response_end",ue(t.responseEnd)]]:e}const so=new WeakMap,br=new Map,hc={traceFetch:!0,traceXHR:!0,enableHTTPTimings:!0,trackFetchStreamPerformance:!1};function Mg(t,e){const{traceFetch:n,traceXHR:r,trackFetchStreamPerformance:s,shouldCreateSpanForRequest:i,enableHTTPTimings:o,tracePropagationTargets:a,onRequestSpanStart:c}={...hc,...e},u=typeof i=="function"?i:p=>!0,l=p=>Hg(p,a),d={};n&&(t.addEventProcessor(p=>(p.type==="transaction"&&p.spans&&p.spans.forEach(f=>{if(f.op==="http.client"){const _=br.get(f.span_id);_&&(f.timestamp=_/1e3,br.delete(f.span_id))}}),p)),s&&jp(p=>{if(p.response){const f=so.get(p.response);f&&p.endTimestamp&&br.set(f,p.endTimestamp)}}),ba(p=>{const f=Pp(p,u,l,d);if(p.response&&p.fetchData.__span&&so.set(p.response,p.fetchData.__span),f){const _=mc(p.fetchData.url),h=_?lt(_).host:void 0;f.setAttributes({"http.url":_,"server.address":h}),o&&io(f),c==null||c(f,{headers:p.headers})}})),r&&dc(p=>{var _;const f=Bg(p,u,l,d);if(f){o&&io(f);let h;try{h=new Headers((_=p.xhr.__sentry_xhr_v3__)==null?void 0:_.request_headers)}catch{}c==null||c(f,{headers:h})}})}function jg(t){return t.entryType==="resource"&&"initiatorType"in t&&typeof t.nextHopProtocol=="string"&&(t.initiatorType==="fetch"||t.initiatorType==="xmlhttprequest")}function io(t){const{url:e}=F(t).data;if(!e||typeof e!="string")return;const n=St("resource",({entries:r})=>{r.forEach(s=>{jg(s)&&s.name.endsWith(e)&&(Ug(s).forEach(o=>t.setAttribute(...o)),setTimeout(n))})})}function Hg(t,e){const n=Yt();if(n){let r,s;try{r=new URL(t,n),s=new URL(n).origin}catch{return!1}const i=r.origin===s;return e?Be(r.toString(),e)||i&&Be(r.pathname,e):i}else{const r=!!t.match(/^\/(?!\/)/);return e?Be(t,e):r}}function Bg(t,e,n,r){const s=t.xhr,i=s==null?void 0:s[ct];if(!s||s.__sentry_own_request__||!i)return;const{url:o,method:a}=i,c=Ae()&&e(o);if(t.endTimestamp&&c){const h=s.__sentry_xhr_span_id__;if(!h)return;const b=r[h];b&&i.status_code!==void 0&&(Fo(b,i.status_code),b.end(),delete r[h]);return}const u=mc(o),l=lt(u||o),d=Np(o),p=!!bt(),f=c&&p?Jn({name:`${a} ${d}`,attributes:{url:o,type:"xhr","http.method":a,"http.url":u,"server.address":l==null?void 0:l.host,[We]:"auto.http.browser",[Bt]:"http.client",...(l==null?void 0:l.search)&&{"http.query":l==null?void 0:l.search},...(l==null?void 0:l.hash)&&{"http.fragment":l==null?void 0:l.hash}}}):new Ke;s.__sentry_xhr_span_id__=f.spanContext().spanId,r[s.__sentry_xhr_span_id__]=f,n(o)&&qg(s,Ae()&&p?f:void 0);const _=P();return _&&_.emit("beforeOutgoingRequestSpan",f,t),f}function qg(t,e){const{"sentry-trace":n,baggage:r}=ga({span:e});n&&Vg(t,n,r)}function Vg(t,e,n){var s;const r=(s=t.__sentry_xhr_v3__)==null?void 0:s.request_headers;if(!(r!=null&&r["sentry-trace"]))try{if(t.setRequestHeader("sentry-trace",e),n){const i=r==null?void 0:r.baggage;(!i||!Gg(i))&&t.setRequestHeader("baggage",n)}}catch{}}function Gg(t){return t.split(",").some(e=>e.trim().startsWith("sentry-"))}function mc(t){try{return new URL(t,O.location.origin).href}catch{return}}function zg(){O.document?O.document.addEventListener("visibilitychange",()=>{const t=bt();if(!t)return;const e=re(t);if(O.document.hidden&&e){const n="cancelled",{op:r,status:s}=F(e);X&&y.log(`[Tracing] Transaction: ${n} -> since tab moved to the background, op: ${r}`),s||e.setStatus({code:z,message:n}),e.setAttribute("sentry.cancellation_reason","document.hidden"),e.end()}}):X&&y.warn("[Tracing] Could not set up background tab detection due to lack of global document")}const Wg=3600,gc="sentry_previous_trace",Kg="sentry.previous_trace";function Jg(t,{linkPreviousTrace:e,consistentTraceSampling:n}){const r=e==="session-storage";let s=r?Qg():void 0;t.on("spanStart",o=>{if(re(o)!==o)return;const a=U().getPropagationContext();s=Yg(s,o,a),r&&Xg(s)});let i=!0;n&&t.on("beforeSampling",o=>{if(!s)return;const a=U(),c=a.getPropagationContext();if(i&&c.parentSpanId){i=!1;return}a.setPropagationContext({...c,dsc:{...c.dsc,sample_rate:String(s.sampleRate),sampled:String(Yr(s.spanContext))},sampleRand:s.sampleRand}),o.parentSampled=Yr(s.spanContext),o.parentSampleRate=s.sampleRate,o.spanAttributes={...o.spanAttributes,[$o]:s.sampleRate}})}function Yg(t,e,n){const r=F(e);function s(){var a,c;try{return Number((a=n.dsc)==null?void 0:a.sample_rate)??Number((c=r.data)==null?void 0:c[us])}catch{return 0}}const i={spanContext:e.spanContext(),startTimestamp:r.start_timestamp,sampleRate:s(),sampleRand:n.sampleRand};if(!t)return i;const o=t.spanContext;return o.traceId===r.trace_id?t:(Date.now()/1e3-t.startTimestamp<=Wg&&(X&&y.log(`Adding previous_trace ${o} link to span ${{op:r.op,...e.spanContext()}}`),e.addLink({context:o,attributes:{[al]:"previous_trace"}}),e.setAttribute(Kg,`${o.traceId}-${o.spanId}-${Yr(o)?1:0}`)),i)}function Xg(t){try{O.sessionStorage.setItem(gc,JSON.stringify(t))}catch(e){X&&y.warn("Could not store previous trace in sessionStorage",e)}}function Qg(){var t;try{const e=(t=O.sessionStorage)==null?void 0:t.getItem(gc);return JSON.parse(e)}catch{return}}function Yr(t){return t.traceFlags===1}const Zg="BrowserTracing",e_={...Tn,instrumentNavigation:!0,instrumentPageLoad:!0,markBackgroundSpan:!0,enableLongTask:!0,enableLongAnimationFrame:!0,enableInp:!0,enableElementTiming:!0,ignoreResourceSpans:[],ignorePerformanceApiSpans:[],detectRedirects:!0,linkPreviousTrace:"in-memory",consistentTraceSampling:!1,_experiments:{},...hc},t_=(t={})=>{const e={name:void 0,source:void 0},n=O.document,{enableInp:r,enableElementTiming:s,enableLongTask:i,enableLongAnimationFrame:o,_experiments:{enableInteractions:a,enableStandaloneClsSpans:c,enableStandaloneLcpSpans:u},beforeStartSpan:l,idleTimeout:d,finalTimeout:p,childSpanTimeout:f,markBackgroundSpan:_,traceFetch:h,traceXHR:b,trackFetchStreamPerformance:I,shouldCreateSpanForRequest:E,enableHTTPTimings:T,ignoreResourceSpans:g,ignorePerformanceApiSpans:m,instrumentPageLoad:w,instrumentNavigation:V,detectRedirects:rt,linkPreviousTrace:kt,consistentTraceSampling:st,onRequestSpanStart:$e}={...e_,...t};let j,De;function ye($,H,L=!0){const B=H.op==="pageload",G=l?l(H):H,Ee=G.attributes||{};if(H.name!==G.name&&(Ee[he]="custom",G.attributes=Ee),!L){const Pt=Ze();Jn({...G,startTime:Pt}).end(Pt);return}e.name=G.name,e.source=Ee[he];const Te=na(G,{idleTimeout:d,finalTimeout:p,childSpanTimeout:f,disableAutoFinish:B,beforeSpanEnd:Pt=>{j==null||j(),dm(Pt,{recordClsOnPageloadSpan:!c,recordLcpOnPageloadSpan:!u,ignoreResourceSpans:g,ignorePerformanceApiSpans:m}),ao($,void 0);const $s=U(),Sc=$s.getPropagationContext();$s.setPropagationContext({...Sc,traceId:Te.spanContext().traceId,sampled:et(Te),dsc:Oe(Pt)})}});ao($,Te);function Nt(){n&&["interactive","complete"].includes(n.readyState)&&$.emit("idleSpanEnableAutoFinish",Te)}B&&n&&(n.addEventListener("readystatechange",()=>{Nt()}),Nt())}return{name:Zg,setup($){if(wl(),j=rm({recordClsStandaloneSpans:c||!1,recordLcpStandaloneSpans:u||!1,client:$}),r&&$m(),s&&Tm(),o&&N.PerformanceObserver&&PerformanceObserver.supportedEntryTypes&&PerformanceObserver.supportedEntryTypes.includes("long-animation-frame")?im():i&&sm(),a&&om(),rt&&n){const L=()=>{De=Z()};addEventListener("click",L,{capture:!0}),addEventListener("keydown",L,{capture:!0,passive:!0})}function H(){const L=zt($);L&&!F(L).timestamp&&(X&&y.log(`[Tracing] Finishing current active span with op: ${F(L).op}`),L.setAttribute(kn,"cancelled"),L.end())}$.on("startNavigationSpan",(L,B)=>{if(P()!==$)return;if(B!=null&&B.isRedirect){X&&y.warn("[Tracing] Detected redirect, navigation span will not be the root span, but a child span."),ye($,{op:"navigation.redirect",...L},!1);return}H(),oe().setPropagationContext({traceId:Ce(),sampleRand:Math.random()});const G=U();G.setPropagationContext({traceId:Ce(),sampleRand:Math.random()}),G.setSDKProcessingMetadata({normalizedRequest:void 0}),ye($,{op:"navigation",...L})}),$.on("startPageLoadSpan",(L,B={})=>{if(P()!==$)return;H();const G=B.sentryTrace||oo("sentry-trace"),Ee=B.baggage||oo("baggage"),Te=_l(G,Ee),Nt=U();Nt.setPropagationContext(Te),Nt.setSDKProcessingMetadata({normalizedRequest:ms()}),ye($,{op:"pageload",...L})})},afterAllSetup($){let H=Yt();if(kt!=="off"&&Jg($,{linkPreviousTrace:kt,consistentTraceSampling:st}),O.location){if(w){const L=cs();n_($,{name:O.location.pathname,startTime:L?L/1e3:void 0,attributes:{[he]:"url",[We]:"auto.pageload.browser"}})}V&&xs(({to:L,from:B})=>{if(B===void 0&&(H==null?void 0:H.indexOf(L))!==-1){H=void 0;return}H=void 0;const G=Ea(L),Ee=zt($),Te=Ee&&rt&&i_(Ee,De);r_($,{name:(G==null?void 0:G.pathname)||O.location.pathname,attributes:{[he]:"url",[We]:"auto.navigation.browser"}},{url:L,isRedirect:Te})})}_&&zg(),a&&s_($,d,p,f,e),r&&Um(),Mg($,{traceFetch:h,traceXHR:b,trackFetchStreamPerformance:I,tracePropagationTargets:$.getOptions().tracePropagationTargets,shouldCreateSpanForRequest:E,enableHTTPTimings:T,onRequestSpanStart:$e})}}};function n_(t,e,n){t.emit("startPageLoadSpan",e,n),U().setTransactionName(e.name);const r=zt(t);return r&&t.emit("afterStartPageLoadSpan",r),r}function r_(t,e,n){const{url:r,isRedirect:s}=n||{};t.emit("beforeStartNavigationSpan",e,{isRedirect:s}),t.emit("startNavigationSpan",e,{isRedirect:s});const i=U();return i.setTransactionName(e.name),r&&!s&&i.setSDKProcessingMetadata({normalizedRequest:{...ms(),url:r}}),zt(t)}function oo(t){const e=O.document,n=e==null?void 0:e.querySelector(`meta[name=${t}]`);return(n==null?void 0:n.getAttribute("content"))||void 0}function s_(t,e,n,r,s){const i=O.document;let o;const a=()=>{const c="ui.action.click",u=zt(t);if(u){const l=F(u).op;if(["navigation","pageload"].includes(l)){X&&y.warn(`[Tracing] Did not create ${c} span because a pageload or navigation span is in progress.`);return}}if(o&&(o.setAttribute(kn,"interactionInterrupted"),o.end(),o=void 0),!s.name){X&&y.warn(`[Tracing] Did not create ${c} transaction because _latestRouteName is missing.`);return}o=na({name:s.name,op:c,attributes:{[he]:s.source||"url"}},{idleTimeout:e,finalTimeout:n,childSpanTimeout:r})};i&&addEventListener("click",a,{capture:!0})}const _c="_sentry_idleSpan";function zt(t){return t[_c]}function ao(t,e){ie(t,_c,e)}const co=.3;function i_(t,e){const n=F(t),r=Ze(),s=n.start_timestamp;return!(r-s>co||e&&r-e<=co)}const uo="9.40.0";function o_(t,e,n=[e],r="npm"){const s=t._metadata||{};s.sdk||(s.sdk={name:`sentry.javascript.${e}`,packages:n.map(i=>({name:`${r}:@sentry/${i}`,version:uo})),version:uo}),t._metadata=s}function a_(t){const e={...t};return o_(e,"react"),ia("react",{version:A.version}),Dg(e)}class c_{constructor(){this.isInitialized=!1,console.log("Sentry explicitly disabled via VITE_ENABLE_SENTRY")}init(){const e=le.getConfig();if(!e.sentry.dsn){Ue.warn("Sentry DSN not provided, error tracking disabled");return}try{a_({dsn:e.sentry.dsn,environment:e.sentry.environment,debug:le.isDevelopment,integrations:[t_({tracePropagationTargets:[e.api.pocketbaseUrl,e.api.baseUrl,e.api.aiServiceUrl]})],tracesSampleRate:le.isProduction?.1:1,sampleRate:le.isProduction?.8:1,release:`${e.app.name}@${e.app.version}`,beforeSend:(n,r)=>this.beforeSendFilter(n,r),initialScope:{tags:{component:"react-app",version:e.app.version}}}),this.isInitialized=!0,Ue.info("Sentry initialized successfully")}catch(n){Ue.error("Failed to initialize Sentry",{error:n.message})}}beforeSendFilter(e,n){var r,s,i,o,a,c,u,l;return le.isDevelopment&&(o=(i=(s=(r=e.exception)==null?void 0:r.values)==null?void 0:s[0])==null?void 0:i.value)!=null&&o.includes("Loading chunk")||(l=(u=(c=(a=e.exception)==null?void 0:a.values)==null?void 0:c[0])==null?void 0:u.value)!=null&&l.includes("Extension context invalidated")?null:(n.originalException&&(e.extra={...e.extra,originalException:n.originalException}),e)}captureException(e,n={}){if(!this.isInitialized){Ue.error("Sentry not initialized, logging error locally",{error:e,context:n});return}Ht(r=>{Object.keys(n).forEach(s=>{r.setContext(s,n[s])}),ra(e)})}captureMessage(e,n="info",r={}){if(!this.isInitialized){Ue.info(`Sentry message: ${e}`,r);return}Ht(s=>{Object.keys(r).forEach(i=>{s.setContext(i,r[i])}),s.setLevel(n),vd(e)})}setUser(e){this.isInitialized&&yi({id:e.id,email:e.email,username:e.username||e.name})}clearUser(){this.isInitialized&&yi(null)}addBreadcrumb(e,n="custom",r="info",s={}){this.isInitialized&&Ne({message:e,category:n,level:r,data:s,timestamp:Date.now()/1e3})}setTag(e,n){this.isInitialized&&Id(e,n)}setContext(e,n){this.isInitialized&&ia(e,n)}startTransaction(e,n="navigation"){return this.isInitialized?(void 0)({name:e,op:n}):null}measure(e,n){if(!this.isInitialized)return n();const r=this.startTransaction(e,"function");try{const s=n();return s&&typeof s.then=="function"?s.finally(()=>{r==null||r.finish()}):(r==null||r.finish(),s)}catch(s){throw r==null||r.setStatus("internal_error"),r==null||r.finish(),s}}captureApiCall(e,n,r,s){var o;if(!this.isInitialized)return;this.addBreadcrumb(`${n} ${e} - ${r}`,"http",r>=400?"error":"info",{url:e,method:n,status:r,duration:s});const i=(o=(void 0)().getScope())==null?void 0:o.getSpan();if(i){const a=i.startChild({op:"http.client",description:`${n} ${e}`});a.setData("http.method",n),a.setData("http.url",e),a.setData("http.status_code",r),a.setData("duration",s),a.finish()}}showReportDialog(e={}){this.isInitialized&&Fg({title:"Report a Problem",subtitle:"Help us improve the application",subtitle2:"Your feedback is valuable to us.",labelName:"Name",labelEmail:"Email",labelComments:"What happened?",labelClose:"Close",labelSubmit:"Submit",...e})}isAvailable(){return this.isInitialized}}const vr=new c_;class u_ extends Xr.Component{constructor(n){super(n);it(this,"handleReportError",()=>{var n,r,s;if(vr.isAvailable())vr.showReportDialog({eventId:this.state.eventId});else{const i=encodeURIComponent("Application Error Report"),o=encodeURIComponent(`
Error: ${((n=this.state.error)==null?void 0:n.message)||"Unknown error"}
Stack: ${((r=this.state.error)==null?void 0:r.stack)||"Not available"}
Component Stack: ${((s=this.state.errorInfo)==null?void 0:s.componentStack)||"Not available"}
      `);window.location.href=`mailto:support@flagfitpro.com?subject=${i}&body=${o}`}});it(this,"handleReload",()=>{window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null,eventId:null}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(n,r){Ue.logError(n,"React Error Boundary");const s=vr.captureException(n,{errorBoundary:{componentStack:r.componentStack,errorBoundaryStack:r.errorBoundaryStack||"Not available"},react:{componentStack:r.componentStack}});this.setState({error:n,errorInfo:r,eventId:s})}render(){return this.state.hasError?S.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:S.jsx("div",{className:"max-w-md w-full mx-4",children:S.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-6 border-l-4 border-red-500",children:[S.jsxs("div",{className:"flex items-center mb-4",children:[S.jsx("div",{className:"flex-shrink-0",children:S.jsx("svg",{className:"h-8 w-8 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:S.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),S.jsx("div",{className:"ml-3",children:S.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Something went wrong"})})]}),S.jsxs("div",{className:"mb-4",children:[S.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"We're sorry for the inconvenience. An unexpected error occurred while loading this page."}),this.state.error&&S.jsx("div",{className:"bg-gray-50 p-3 rounded text-xs text-gray-700 font-mono",children:this.state.error.message})]}),S.jsxs("div",{className:"flex space-x-3",children:[S.jsx("button",{onClick:this.handleReload,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Reload Page"}),S.jsx("button",{onClick:this.handleReportError,className:"flex-1 bg-gray-100 text-gray-700 px-4 py-2 rounded-md text-sm font-medium hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",children:"Report Error"})]}),S.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:S.jsxs("p",{className:"text-xs text-gray-500",children:["Error ID: ",this.state.eventId||"Not available"]})})]})})}):this.props.children}}const l_=A.lazy(()=>Le(()=>import("./LoginView-BlYSjgJi.js"),__vite__mapDeps([0,1,2,3,4,5]))),d_=A.lazy(()=>Le(()=>import("./RegisterView-DjOVWxmZ.js"),__vite__mapDeps([6,1,2,3,4,5]))),p_=A.lazy(()=>Le(()=>import("./DashboardView-C6zp57Bm.js"),__vite__mapDeps([7,1,2,3,4,5]))),f_=A.lazy(()=>Le(()=>import("./TrainingView-CyGNwCIP.js"),__vite__mapDeps([8,1,2,3,4,5]))),h_=A.lazy(()=>Le(()=>import("./ProfileView-GtV9ClBi.js"),__vite__mapDeps([9,1,2]))),m_=A.lazy(()=>Le(()=>import("./OnboardingView-ChZoCbxI.js"),__vite__mapDeps([10,1,2,3,4,5]))),g_=A.lazy(()=>Le(()=>import("./TournamentsView-BIz4h_-F.js"),__vite__mapDeps([11,1,2,3]))),__=A.lazy(()=>Le(()=>import("./CommunityView-BOxvDMyr.js"),__vite__mapDeps([12,1,2,3]))),ot=({children:t})=>{const{isAuthenticated:e,isLoading:n}=qn();return n?S.jsx(Vn,{}):e?t:S.jsx(Rn,{to:"/login",replace:!0})},lo=({children:t})=>{const{isAuthenticated:e,isLoading:n}=qn();return n?S.jsx(Vn,{}):e?S.jsx(Rn,{to:"/dashboard",replace:!0}):t},S_=()=>S.jsx(Ic,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:S.jsx(A.Suspense,{fallback:S.jsx("div",{className:"min-h-screen flex items-center justify-center",children:S.jsx(Vn,{size:"lg"})}),children:S.jsxs(wc,{children:[S.jsx(ce,{path:"/login",element:S.jsx(lo,{children:S.jsx(l_,{})})}),S.jsx(ce,{path:"/register",element:S.jsx(lo,{children:S.jsx(d_,{})})}),S.jsx(ce,{path:"/dashboard",element:S.jsx(ot,{children:S.jsx(p_,{})})}),S.jsx(ce,{path:"/training",element:S.jsx(ot,{children:S.jsx(f_,{})})}),S.jsx(ce,{path:"/profile",element:S.jsx(ot,{children:S.jsx(h_,{})})}),S.jsx(ce,{path:"/onboarding",element:S.jsx(ot,{children:S.jsx(m_,{})})}),S.jsx(ce,{path:"/tournaments",element:S.jsx(ot,{children:S.jsx(g_,{})})}),S.jsx(ce,{path:"/community",element:S.jsx(ot,{children:S.jsx(__,{})})}),S.jsx(ce,{path:"/",element:S.jsx(Rn,{to:"/dashboard",replace:!0})}),S.jsx(ce,{path:"*",element:S.jsx(Rn,{to:"/dashboard",replace:!0})})]})})}),y_=()=>{const{isOnline:t}=lu(),{isDarkMode:e}=yu();return S.jsx(Cc,{theme:{algorithm:e?Ds.darkAlgorithm:Ds.defaultAlgorithm,token:{colorPrimary:"#3B82F6",colorSuccess:"#10B981",colorWarning:"#F59E0B",colorError:"#EF4444"}},children:S.jsxs("div",{className:"app",children:[!t&&S.jsx(Eu,{}),S.jsx(nu,{children:S.jsx(ou,{children:S.jsx(S_,{})})})]})})},E_=()=>S.jsx(u_,{children:S.jsx(uu,{children:S.jsx(Kc,{children:S.jsx(y_,{})})})});Ue.info("Application starting",{timestamp:new Date().toISOString(),userAgent:navigator.userAgent,viewport:{width:window.innerWidth,height:window.innerHeight}});const T_=Ir.createRoot(document.getElementById("root"));T_.render(S.jsx(Xr.StrictMode,{children:S.jsx(E_,{})}));export{Vn as L,O_ as a,k_ as b,qn as u};
//# sourceMappingURL=index-C_obb-0t.js.map
